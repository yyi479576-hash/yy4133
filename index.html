<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;">

  <title>Noir搓的小手机</title>
  <style>
    .message p,
    .diary-content {
      user-select: none;
      -webkit-user-select: none;
    }

    .lt-end-session-btn {
      font-size: 1.5rem;
      color: inherit;
      /* 继承父元素的颜色 */
      opacity: 0.6;
      cursor: pointer;
      padding: 0 5px;
      line-height: 1;
      font-weight: bold;
    }

    .lt-end-session-btn:hover {
      opacity: 1;
    }

    /* --- Noir's Refactor: Feed Loader Style --- */
    #feed-loader {
      position: absolute;
      inset: 0;
      background: rgba(244, 248, 255, 0.85);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      color: var(--text-color);
      font-size: 1rem;
      flex-direction: column;
      gap: 10px;
    }

    .loader-spinner {
      width: 24px;
      height: 24px;
      border: 3px solid var(--border-color);
      border-top-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    /* --- End of Refactor --- */
    /*
        Noir's Mizuiro Theme
        - 哼，看好了，这才是设计。
      */
    /*
          Noir's Mizuiro Theme
          - 哼，看好了，这才是设计。
        */
    :root {
      --phone-width: 375px;
      --phone-height: 812px;
      --user-bg-image: url('');

      /* === Noir's Ultimate Dynamic Theme Engine v2.0 === */
      /* 哼，现在所有的颜色都听从这三个总开关的指挥。*/
      --primary-hue: 35;
      --primary-saturation: 25%;
      --primary-lightness: 80%;

      /* 核心颜色 */
      --primary-color: hsl(var(--primary-hue), var(--primary-saturation), var(--primary-lightness));
      /* 强调色/用户气泡色，现在也是动态的 */
      --accent-color: hsl(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%));

      /* 哼，看好了，这些就是被我重新接上线的“电灯” */

      /* 文字颜色：根据主题亮度自动变深或变浅 */
      --text-color: hsl(var(--primary-hue), 15%, calc(100% - var(--primary-lightness) / 1.1));
      --text-color-light: hsl(var(--primary-hue), 10%, calc(100% - var(--primary-lightness) / 1.3));

      /* 表面背景：半透明，亮度比主色高一点 */
      --surface-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.4);

      /* 卡片/AI气泡背景：比表面背景更亮一点 */
      --card-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.5);

      /* 边框颜色 */
      --border-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness)), 0.3);

      /* 阴影颜色 */
      --soft-shadow: 0 4px 12px hsla(var(--primary-hue), 40%, calc(var(--primary-lightness) - 10%), 0.15);

      /* 动态页的设置保持不变 */
      --feed-bg-image: none;
      --feed-overlay-opacity: 0.12;
      --feed-overlay-rotate: 22deg;
      --feed-overlay-speed: 48s;

      /* 气泡样式也完全动态化 */
      --bubble-radius: 18px;
      --bubble-outline: hsla(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) + 10%), 0.5);
      --bubble-user-bg: var(--accent-color);
      --bubble-ai-bg: var(--card-bg);

      /* ▼▼▼ 把下面这两行加进去 ▼▼▼ */
      --dropdown-alpha: 0.9;
      /* 下拉菜单的透明度，0到1 */
      --feed-card-alpha: 0.7;
      /* 动态卡片的透明度，0到1 */
      /* ▲▲▲ 添加到这里结束 ▲▲▲ */

    }

    body {
      display: flex;
      align-items: center;
      /* <-- 加上这句 */
      justify-content: center;
      /* <-- 还有这句 */
      height: 100vh;
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
    }

    #phone-container {
      width: 100%;
      /* 占满屏幕宽度 */
      height: 100vh;
      /* 占满屏幕高度 */
      background-color: white;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      /* 是不是清爽多了？ */
      position: relative;
      /* <-- 就是这句，告诉它“你是个家长了，给我看好家里的东西！” */
    }

    .screen {
      flex-grow: 1;
      display: none;
      flex-direction: column;
      background-color: #f9f9f9;
      /* 哼，所有屏幕默认都给我变白 */
      /* 让背景透出来 */
      overflow: hidden;
      color: var(--text-color);
    }

    .screen.active {
      display: flex;
    }

    /* 这个是通用的头像预览样式 */
    .avatar-preview {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--border-color);
      margin-top: 5px;
      cursor: pointer;
    }

    /* --- 通用顶栏 --- */
    .header,
    #chat-list-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background-color: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border-bottom: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    .header-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-color);
    }

    .header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: var(--primary-color);
      font-weight: 500;
      min-width: 50px;
      text-align: center;
    }

    /* --- 聊天列表 --- */
    #chat-list-pane {
      background-color: transparent;
      border-right: 1px solid var(--border-color);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 加上这句 */
      width: 100%;
      height: 100%;
      flex-shrink: 0;
      /* 防止它在横向布局里被挤扁 */
      display: flex;
      flex-direction: column;
    }

    #chat-list-container {
      flex-grow: 1;
      flex-grow: 1;
      overflow-y: auto;
      padding: 10px;
    }

    #character-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .character-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      /* backdrop-filter: blur(10px);*/
      border-radius: 16px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.5);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .character-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(138, 180, 228, 0.2);
    }

    .char-info-wrapper {
      flex-grow: 1;
      cursor: pointer;
      display: flex;
      align-items: center;
      overflow: hidden;
    }

    .character-item .char-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      margin-right: 12px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .character-item .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .character-item .char-remark {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    #chat-screen-container {
      position: relative;
      /* 告诉里面的绝对定位元素，要以我为基准 */
      flex-grow: 1;
      /* 确保它能撑满 chat-screen 的空间 */
      overflow: hidden;
      /* 把滑出去的部分藏起来，这很重要 */
      display: flex;
      /* 保持内部元素的 flex 布局 */
    }

    /* --- 聊天窗口 --- */


    #chat-view-pane {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      transform: translateX(100%);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 还有这句 */
      background-color: transparent;
      z-index: 10;
    }

    #chat-screen.show-chat-view #chat-list-pane {
      transform: translateX(-100%);
    }

    #chat-screen.show-chat-view #chat-view-pane {
      transform: translateX(0);
    }

    #chat-messages {
      flex-grow: 1;
      padding: 5px;
      overflow-y: auto;
      display: flex;
      /* <-- 加上这个 */
      flex-direction: column;
      /* <-- 还有这个 */
      contain: content;
      contain: content;
      /* <-- 哼，就是这句救命神药！ */
    }



    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 10px;
      object-fit: cover;
      border: 2px solid rgba(255, 255, 255, 0.7);
      flex-shrink: 0;
    }

    .message {
      padding: 10px 16px;
      border-radius: 20px;
      line-height: 1.5;
      word-break: break-word;
      box-shadow: var(--soft-shadow);
    }

    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
    }

    .message.user {
      background-color: var(--accent-color);
      color: white;
      border-bottom-right-radius: 5px;
    }

    .message.ai {
      background-color: var(--card-bg);
      border: 1px solid rgba(255, 255, 255, 0.8);
      color: var(--text-color);
      border-bottom-left-radius: 5px;
    }

    .message p {
      margin: 0;
    }

    .sticker-content,
    .message-image-content {
      max-width: 120px;
      border-radius: 8px;
      object-fit: cover;
      cursor: pointer;
    }

    .message-image-content {
      max-width: 160px;
    }

    /* --- 其他屏幕和组件 --- */
    /* --- Noir's Fix: API 模型列表的样式修正 --- */
    .model-input-container {
      position: relative;
      /* 关键！让里面的绝对定位元素有家可回 */
      display: flex;
      gap: 8px;
    }

    .custom-model-dropdown {
      display: none;
      /* 默认藏起来 */
      position: absolute;
      top: 100%;
      /* 精准定位到输入框正下方 */
      left: 0;
      right: 80px;
      /* 留出“获取”按钮的位置 */
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*   backdrop-filter: blur(10px);*/
      border: 1px solid var(--border-color);
      border-radius: 8px;
      margin-top: 4px;
      max-height: 180px;
      overflow-y: auto;
      z-index: 100;
      /* 确保它在最上层 */
      box-shadow: var(--soft-shadow);
    }

    .checkboxes-container {
      display: none;
      position: absolute;
      left: 0;
      right: 0;
      top: 100%;
      max-height: 150px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*  backdrop-filter: blur(10px);*/
      z-index: 10;
      border-radius: 8px;
      margin-top: 4px;
    }

    .custom-model-dropdown.show {
      display: block;
      /* 需要的时候再显示 */
    }

    .custom-model-dropdown div {
      padding: 10px 12px;
      cursor: pointer;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    .custom-model-dropdown div:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    /* --- 其他屏幕和组件 --- */
    /* 在这个注释下面加上主屏幕的样式 */
    #home-screen {
      position: relative;
      /* <-- 就加上这一行！ */


      gap: 20px;
      /* 图标之间的距离 */

      /* 声明！这里现在是我的地盘！*/
      flex-direction: column;
      /* 里面的东西，全体给我垂直排队！*/
      justify-content: space-between;
      /* 核心！顶部和底部的元素给我贴边站好，中间的自动拉开距离！*/
      padding-bottom: 0;
      /* 把内边距去掉，让Dock栏能完美贴底 */
    }

    .app-icon {
      width: 75px;
      /* <--- 就是这里，我把它加宽了 */
      height: 90px;
      /* <--- 高度也顺便调整一下 */
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      position: absolute;
      z-index: 40;
      padding: 5px;
      box-sizing: border-box;
      margin: 0;
    }

    .app-icon-img {
      width: 58px;
      height: 58px;
      border-radius: 22.5%;
      margin-bottom: 2px;
      /* <-- 哼，就是这里，把5px改成2px，让图标和文字的距离拉近一点 */
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 28px;
      background-color: var(--surface-bg);
      box-shadow: none;
      transition: transform 0.2s ease;
    }

    .app-icon-img svg {
      stroke: currentColor;
      /* SVG的线条颜色会继承上面的 color */
    }

    .app-icon span {
      font-size: 0.75rem;
      /* 文本也相应缩小 */
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      width: 100%;
    }

    .content {
      padding: 20px;
      overflow-y: auto;
      flex-grow: 1;
      /* <-- 加上这行代码，就是这行！ */
    }

    .form-button {
      width: 100%;
      padding: 12px;
      border: none;
      background-color: var(--primary-color);
      color: white;
      border-radius: 8px;
      font-size: 1.1rem;
      cursor: pointer;
      margin-top: 10px;
    }

    input,
    textarea,
    select {
      width: 100%;
      padding: 10px;
      box-sizing: border-box;
      background-color: rgba(255, 255, 255, 0.8);
      border: 1px solid var(--border-color);
      color: var(--text-color);
      border-radius: 8px;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    .chat-toolbar {
      display: flex;
      padding: 5px 10px;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      /*   backdrop-filter: blur(10px);*/
      flex-shrink: 0;
    }

    /* ▼▼▼ 用下面这段，替换掉你旧的 .toolbar-button 样式 ▼▼▼ */
    .toolbar-button {
      background: none;
      border: none;
      font-size: 1.5rem;
      /* 这个保留，作为SVG尺寸的参考 */
      cursor: pointer;
      padding: 8px;
      /* 稍微增大点击区域 */
      color: var(--text-color-light);
      /* 让它默认是浅灰色 */
      border-radius: 50%;
      /* 让背景有个圆形轮廓 */
      width: 40px;
      height: 40px;
      display: flex;
      /* 使用flex布局让SVG完美居中 */
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s, color 0.2s;
      /* 加上顺滑的过渡效果 */
    }

    .toolbar-button:hover {
      background-color: var(--border-color);
      /* 鼠标悬停时给个背景 */
      color: var(--primary-color);
      /* 图标颜色变为主题色 */
    }

    /* ▲▲▲ 替换到这里为止 ▲▲▲ */


    /* ▼▼▼ 在下面新增这段SVG的专属样式 ▼▼▼ */
    .toolbar-button svg {
      width: 22px;
      /* SVG图标的尺寸 */
      height: 22px;
      stroke-width: 1.8;
      /* 线条粗细，可以微调 */
      stroke: currentColor;
      /* 核心！让SVG的颜色继承按钮的color属性 */
      fill: none;
      /* 确保是线稿风格 */
      pointer-events: none;
      /* 防止SVG本身干扰点击事件 */
    }

    /* ▲▲▲ 新增到这里为止 ▲▲▲ */

    .sticker-panel {
      display: none;
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
      gap: 10px;
      padding: 10px;
      height: 200px;
      overflow-y: auto;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      flex-shrink: 0;
    }

    .sticker-panel.show {
      display: grid;
    }

    /* --- 输入区域 --- */
    /* --- 输入区域 --- */
    .chat-input-area {
      padding: 10px 12px calc(env(safe-area-inset-bottom, 0px) + 10px);
      background: var(--surface-bg);
      /*  backdrop-filter: saturate(1.2) blur(10px);*/
      border-top: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    /* 这是我加的新容器，用来实现完美对齐 */
    #chat-input-wrapper {
      display: flex;
      /* Flex大法好，哼 */
      align-items: center;
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 24px;
      padding: 2px 5px;
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-input-wrapper:focus-within {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-message-input {
      flex-grow: 1;
      /* 让输入框占满剩余空间 */
      border: none;
      background: transparent;
      padding: 9px 12px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 38px;
      width: 38px;
      border: 0;
      border-radius: 50%;
      font-size: 1.2rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
      flex-shrink: 0;
      /* 防止被挤压 */
      margin-left: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    /* 回复按钮，给个不一样的颜色区分 */
    #chat-get-reply-button {
      background: var(--accent-color);
      font-size: 1.5rem;
      /* 让箭头更清晰 */
    }

    #chat-message-input {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 20px;
      padding: 11px 16px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-message-input:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 40px;
      padding: 0 18px;
      border: 0;
      border-radius: 20px;
      font-size: .95rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    #chat-get-reply-button {
      display: flex;
      /* 隐藏旧的回复按钮，样式统一到发送按钮 */
    }


    /* --- 引用样式 --- */
    .quote-preview {
      display: none;
      padding: 8px 12px;
      background-color: rgba(255, 255, 255, 0.5);
      border-left: 3px solid var(--primary-color);
      margin: 0 12px 8px;
      border-radius: 6px;
      position: relative;
    }

    #quote-preview-sender {
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--primary-color);
    }

    #quote-preview-text {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    .cancel-quote-btn {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      background: none;
      border: none;
      font-size: 1.5rem;
      color: #999;
      cursor: pointer;
    }

    .quoted-message-in-bubble {
      background-color: rgba(0, 0, 0, 0.04);
      padding: 8px 10px;
      border-left: 3px solid var(--border-color);
      border-radius: 8px;
      margin-bottom: 6px;
    }

    .quoted-sender {
      font-weight: bold;
      font-size: 0.8rem;
      color: var(--text-color);
    }

    .quoted-content {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    /* 这是弹窗的“骨架”，让它能居中浮动在屏幕上 */
    .choice-modal {
      position: fixed;
      inset: 0;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s ease, visibility 0.2s ease;
    }

    .choice-modal.show {
      opacity: 1;
      visibility: visible;
    }


    /* --- 弹窗 --- */
    .choice-modal-backdrop {
      background: rgba(0, 0, 0, 0.2);
      /*  backdrop-filter: blur(4px);*/
    }

    .choice-modal-content {
      background: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border: 1px solid rgba(255, 255, 255, 0.5);
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .choice-modal-button {
      color: var(--text-color);
      background: rgba(255, 255, 255, 0.5);
    }

    .choice-modal-button:hover {
      background-color: rgba(255, 255, 255, 1);
    }

    .choice-modal-button.cancel {
      color: var(--primary-color);
      background: transparent;
    }

    /* --- Noir's Fix: 让“添加”弹窗从底部滑出，更大气 --- */
    #add-choice-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      /* 确保不会超出手机宽度 */
      margin: 0;
      border-radius: 20px 20px 0 0;
      /* 只留顶部圆角 */
      border-bottom-left-radius: 0;
      /* 覆盖通用样式 */
      border-bottom-right-radius: 0;
      /* 覆盖通用样式 */
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      /* 适配iPhone底部安全区 */
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #add-choice-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #add-choice-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
      justify-content: center;
    }

    /* 按钮也重新设计一下，让它们竖着排 */
    #add-choice-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- Noir's Fix: 修正创建群聊时，成员选择列表的样式 --- */
    .member-selection-item {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      border-bottom: 1px solid var(--border-color);
    }

    .member-selection-item:last-child {
      border-bottom: none;
    }

    /* 关键！就是这里，把头像大小锁死 */
    .member-selection-item .char-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 15px 0 10px;
      object-fit: cover;
    }

    .member-selection-item .char-name {
      font-weight: 500;
      color: var(--text-color);
    }

    .member-selection-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      accent-color: var(--primary-color);
      /* 让勾选框颜色也跟主题统一 */
    }

    /* --- Noir's World Book Styles --- */
    #world-book-list-container {
      padding: 10px;
    }

    .world-book-item {
      background-color: var(--card-bg);
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 10px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .world-book-item-name {
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .world-book-item-preview {
      font-size: 0.9rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* --- Noir's Fancy Multi-Select Styles --- */
    .custom-multiselect {
      position: relative;
      user-select: none;
    }

    .select-box {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.8);
      border-radius: 8px;
      padding: 10px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .select-box.expanded .arrow {
      transform: rotate(180deg);
    }


    .checkboxes-container.visible {
      display: block;
    }

    .checkboxes-container label {
      display: block;
      padding: 10px 12px;
    }

    .checkboxes-container label:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    .checkboxes-container input[type="checkbox"] {
      margin-right: 8px;
      width: auto;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Clock & Timestamp Styles --- */
    /* --- Noir's Badge & App Dock Styles --- */
    #decorative-badge {
      width: 80px;
      height: 80px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.25));
      /* 哼，给你加个阴影，看起来才像样 */
      transform: rotate(-8deg);
      /* 稍微歪一点，显得随意 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      /* 防止拖动时选中图片 */
      z-index: 50;
    }

    #decorative-badge:active {

      transform: rotate(-2deg) scale(1.05);
      /* 抓起来的时候，摆正放大一点 */
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }


    #decorative-badge img {
      width: 150%;
      height: 150%;
      object-fit: cover;
      /* 保留这句，让你的图片能被很好地填充 */
    }

    /*  #a#app-dock-bottom-left,
    #app-dock-top-right {
      
      哼，现在你们只是幽灵了。
      不需要任何样式，你们的孩子（App图标）会自己找到回家的路。
      它们会相对于 #home-screen 定位。
    
    }
*/

    /* --- Noir's Author Mark: Pixel Chicken --- */
    /* 哼，这就是那个吵着要加的小鸡图标 */
    #noir-author-mark {
      position: absolute;
      /* 相对于父容器定位 */
      right: -30px;
      /* 调整它在时钟右边的位置 */
      top: 50%;
      /* 垂直居中 */
      transform: translateY(-50%);
      /* 精确对齐 */
      width: 20px;
      /* 小鸡的尺寸 */
      height: 20px;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="0"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zM12 4c.69 0 1.25.56 1.25 1.25S12.69 6.5 12 6.5s-1.25-.56-1.25-1.25S11.31 4 12 4zm0 2c-.69 0-1.25.56-1.25 1.25S11.31 8.5 12 8.5s1.25-.56 1.25-1.25S12.69 6 12 6zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 9.75 10 9.75s1.25-.56 1.25-1.25S10.69 8 10 8zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 9.75 12 9.75s1.25-.56 1.25-1.25S12.69 8 12 8zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 9.75 14 9.75s1.25-.56 1.25-1.25S14.69 8 14 8zM10 10c-.69 0-1.25.56-1.25 1.25S9.31 12.5 10 12.5s1.25-.56 1.25-1.25S10.69 10 10 10zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 12.5 12 12.5s1.25-.56 1.25-1.25S12.69 10 12 10zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 12.5 14 12.5s1.25-.56 1.25-1.25S14.69 10 14 10zM12 12c-.69 0-1.25.56-1.25 1.25S11.31 14.5 12 14.5s1.25-.56 1.25-1.25S12.69 12 12 12zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 15.75 10 15.75s1.25-.56 1.25-1.25S10.69 14 10 14zm4 0c-.69 0-1.25.56-1.25 1.25S13.31 15.75 14 15.75s1.25-.56 1.25-1.25S14.69 14 14 14zM12 16c-.69 0-1.25.56-1.25 1.25S11.31 18.5 12 18.5s1.25-.56 1.25-1.25S12.69 16 12 16zM6 10c-.69 0-1.25.56-1.25 1.25S5.31 12.5 6 12.5s1.25-.56 1.25-1.25S6.69 10 6 10zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 12.5 18 12.5s1.25-.56 1.25-1.25S18.69 10 18 10zM12 20c-.69 0-1.25.56-1.25 1.25S11.31 22.5 12 22.5s1.25-.56 1.25-1.25S12.69 20 12 20zM6 14c-.69 0-1.25.56-1.25 1.25S5.31 15.75 6 15.75s1.25-.56 1.25-1.25S6.69 14 6 14zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 15.75 18 15.75s1.25-.56 1.25-1.25S18.69 14 18 14z"/></svg>');
      /* 这是SVG小鸡的Data URI，白色像素风格 */
      background-size: contain;
      background-repeat: no-repeat;
      cursor: pointer;
      /* 提示可点击 */
      opacity: 0.6;
      /* 稍微透明一点，不那么突兀 */
      transition: opacity 0.2s ease-in-out;
      /* 鼠标悬停效果 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    #noir-author-mark:hover {
      opacity: 1;
      /* 鼠标悬停时完全显示 */
    }

    /* 调整时钟容器，为小鸡留出空间并方便定位 */
    .home-clock-container {
      position: relative;
      /* 确保小鸡能相对它定位 */
      /* ... (保留你已有的其他时钟样式) ... */
      padding-right: 40px;
      /* 给小鸡留出一些右边距 */
    }

    #home-clock-container {
      color: white;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
      text-align: center;
      position: absolute;
      /* top, left, right 都被我删了，哼，现在它完全听JS的指挥 */

      /* 这行可以留着，虽然你已经不让它拖了 */
      z-index: 50;
    }

    #home-time {
      font-size: 80px;
      font-weight: 200;
      letter-spacing: 2px;
    }

    #home-date {
      font-size: 1.1rem;
      font-weight: 400;
      margin-top: 5px;
      opacity: 0.9;
    }

    /* 聊天气泡时间戳的样式 */
    .timestamp {
      font-size: 0.7rem;
      color: var(--text-color-light);
      padding: 0 5px;
      margin-bottom: 3px;
      /* 让它和气泡底部对齐 */
    }

    /* 第一段：这是消息容器的基础样式 */
    .message-container {
      display: flex;
      /* 启用flex布局 */
      flex-direction: column;
      /* 让气泡和时间戳垂直排列 */
      margin-bottom: 20px;
      max-width: 85%;
      /* 限制整个容器的最大宽度 */
    }

    /* 第二段：这是根据发言者进行左右对齐的样式 */
    .message-container.user {
      align-self: flex-end;
      /* 让用户方整个容器靠右 */
      align-items: flex-end;
      /* 让容器内部的元素（气泡、时间戳）也靠右 */
    }

    .message-container.ai {
      align-self: flex-start;
      /* 让AI方整个容器靠左 */
      align-items: flex-start;
      /* 让容器内部的元素（气泡、时间戳）也靠左 */
    }

    .message-bubble-row {
      display: flex;
      align-items: flex-end;
      width: 100%;
    }

    .message-container.user .message-bubble-row {
      justify-content: flex-end;
    }

    .message-container.ai .message-bubble-row {
      justify-content: flex-start;
    }



    /* 这是给表情选择面板里，每一个小表情图片用的样式 */
    .sticker-item {
      width: 100%;
      /* 自动填满网格单元格的宽度 */
      aspect-ratio: 1 / 1;
      /* 保持1:1的宽高比，让它变成正方形 */
      object-fit: cover;
      /* 图片会被裁剪以适应正方形，不变形 */
      border-radius: 8px;
      /* 加个小圆角 */
      cursor: pointer;
      transition: transform 0.15s ease;
    }

    .sticker-item:hover {
      transform: scale(1.1);
      /* 鼠标放上去时稍微放大，增加交互感 */
    }

    /* --- Noir's Offline Scene Styles --- */
    #meeting-scene-view {
      flex-grow: 1;
      /* <-- 核心：让它占满所有可用空间 */
      overflow-y: auto;
      /* <-- 核心：内容多了就内部滚动 */
      padding: 20px;
      font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif;
      background-size: cover;
      background-position: center;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.7);
    }

    #chat-view-pane.offline-mode #offline-scene-view {
      display: block;
      /* 在线下模式时显示 */
    }

    #chat-view-pane.offline-mode #chat-messages {
      display: none;
      /* 在线下模式时隐藏气泡聊天 */
    }

    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      /* 保留换行和空格，这对于小说格式至关重要 */
      font-size: 1rem;
    }

    /* --- Noir's Offline Scene Dialogue Box Style --- */
    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      font-size: 1rem;

      /* <--- Noir's Addition: 为对话框添加半透明背景和内边距 */
      background-color: rgba(0, 0, 0, 0.4);
      /* 半透明黑色背景 */
      padding: 15px 20px;
      /* 内边距，让文字与边框有距离 */
      border-radius: 8px;
      /* 圆角边框，更柔和 */
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      /* 轻轻的阴影，增加立体感 */
    }

    #offline-scene-view .narrator {
      color: #d1d5db;
      /* 旁白用浅灰色 */
      font-style: italic;
    }

    #offline-scene-view .speaker-user {
      color: #a7c7e7;
      /* 用户的发言用一种柔和的蓝色 */
      font-weight: bold;
    }

    #offline-scene-view .speaker-ai {
      color: #f2b7c6;
      /* AI的发言用柔和的粉色，形成对比 */
      font-weight: bold;
    }

    /* --- Noir's Typing Indicator Style --- */
    .typing-indicator {
      padding: 10px 15px;
      color: var(--text-color-light);
      font-style: italic;
      font-size: 0.9rem;
      align-self: flex-start;
      /* 让它和AI气泡一样靠左 */
      margin-left: 50px;
      /* 和AI气泡对齐 */
    }

    #offline-scene-view .typing-indicator {
      color: rgba(255, 255, 255, 0.8);
      /* 在暗色背景下用亮色 */
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
      /* 同样的文字阴影，保持队形 */
      padding: 10px 0;
      margin-left: 0;
      /* 在小说视图里不需要缩进 */
    }

    /* --- Noir's Final Alignment Fix --- */
    .message-container.ai .timestamp {
      /* 哼，给你加上头像宽度(40px) + 左右边距(10px)的距离 */
      margin-left: 50px;
    }

    .message-container.user .timestamp {
      /* 另一边也是一样，真是麻烦死了 */
      margin-right: 50px;
    }

    /* --- Noir's Music Feed & Player Styles --- */
    #music-feed-container {
      padding-bottom: 70px;
      contain: content;
      /* 为底部播放器留出空间 */
    }

    /* 动态页：默认白底；如设置 --feed-bg-image 则显示独立壁纸 + 轻动画叠层 */
    #music-screen {
      background-color: #fff;
      /* 默认白底 */
      background-image: var(--feed-bg-image);
      /* 单独壁纸，不设就是 none */
      background-size: cover;
      background-position: center;
      contain: paint;
      /* 降低重绘范围，省电 */
    }

    /* 轻动画彩雾叠层：仅图层，不拦点击 */
    #music-screen::before {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background-image:
        conic-gradient(from var(--feed-overlay-rotate),
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 0%,
          transparent 20%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 40%,
          transparent 60%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 80%,
          transparent 100%);
      transform: translateZ(0);
      animation: feed-pan var(--feed-overlay-speed) linear infinite;
    }

    /* 超慢速平移旋转，基本不占 GPU */
    @keyframes feed-pan {
      0% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }

      50% {
        transform: translate3d(1.2%, 0.8%, 0) rotate(2deg) scale(1.02);
      }

      100% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }
    }

    /* 系统降低动画偏好时，自动停掉动画 */
    @media (prefers-reduced-motion: reduce) {
      #music-screen::before {
        animation: none;
      }
    }


    .music-post {
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), var(--feed-card-alpha));
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: var(--soft-shadow);
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .music-post-header {
      display: flex;
      align-items: center;
      padding: 12px 15px;
    }

    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
    }

    .music-post-header .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .music-post-thought {
      padding: 0 15px 15px;
      font-size: 0.95rem;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .music-post-song-card {
      display: flex;
      align-items: center;
      background-color: rgba(0, 0, 0, 0.04);
      padding: 12px 15px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .music-post-song-card:hover {
      background-color: rgba(0, 0, 0, 0.08);
    }

    .music-post-song-card img {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 12px;
    }

    .music-post-song-info {
      flex-grow: 1;
    }

    .music-post-song-info .title {
      font-weight: 500;
      color: var(--text-color);
    }

    .music-post-song-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    .music-post-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
    }

    #music-player-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 65px;
      background: var(--surface-bg);
      /*backdrop-filter: blur(10px);*/
      border-top: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      padding: 0 10px;
      transform: translateY(100%);
      transition: transform 0.3s ease;
    }

    #music-player-bar:not(.hidden) {
      transform: translateY(0);
    }

    #music-player-bar.hidden {
      display: none;
      /* 彻底隐藏，避免交互问题 */
    }


    #player-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
    }

    #player-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #player-title,
    #player-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #player-title {
      font-weight: 500;
    }

    #player-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #player-controls button {
      background: none;
      border: 2px solid var(--text-color);
      border-radius: 50%;
      width: 36px;
      height: 36px;
      font-size: 1rem;
      cursor: pointer;
      color: var(--text-color);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- Noir's Music Share Bubble Styles --- */
    .message.music {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
      max-width: 250px;
      /* 限制一下最大宽度 */
    }

    .music-share-card {
      display: flex;
      align-items: center;
      background-color: var(--card-bg);
      border-radius: 12px;
      padding: 12px;
      cursor: pointer;
      transition: background-color 0.2s ease;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
    }

    .message-container.user .music-share-card {
      background-color: var(--accent-color);
      border: 1px solid rgba(255, 255, 255, 0.4);
    }

    .message-container.user .music-share-card .title,
    .message-container.user .music-share-card .artist,
    .message-container.user .music-share-card .play-icon {
      color: white;
    }


    .music-share-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
      flex-shrink: 0;
    }

    .music-share-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-share-info .title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #music-screen {
      position: relative;
      /* 就是这句，告诉里面的绝对定位元素，以我为界！ */
    }

    /* --- Noir's Fancy Music Widget Styles --- */
    /* --- Noir's Music System Refactor --- */

    #music-widget:not(.hidden) {
      transform: translateY(0);
      /* 不隐藏时，滑上来 */
    }

    #music-widget.hidden {
      transform: translateY(150%);
      /* 隐藏时，滑下去 */
    }

    .widget-vinyl {
      width: 80px;
      height: 80px;
      background-color: #111;
      border-radius: 50%;
      position: relative;
      left: 20px;
      /* 向右移动，让卡片能盖住它 */
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      background-image:
        radial-gradient(circle at center, #555 10%, transparent 11%),
        radial-gradient(circle at center, #fff 12%, transparent 13%);
      animation: spin 8s linear infinite;
      z-index: 1;
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    .widget-card {
      width: 240px;
      padding: 15px;
      background-color: var(--card-bg);
      /*  backdrop-filter: blur(10px);*/
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
      display: flex;
      align-items: center;
      z-index: 2;
      /* 让卡片在唱片上方 */
    }

    .widget-card img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      margin-right: 12px;
      flex-shrink: 0;
    }

    .widget-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #widget-title,
    #widget-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #widget-title {
      font-weight: 600;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    #widget-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #widget-play-icon {
      font-size: 1.2rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #card-widget {
      width: 335px;
      height: 150px;
      border-radius: 18px;
      /* 这就是圆角方形的关键 */
      background-color: rgba(255, 255, 255, 0.5);
      /* 加个底色，免得图片透明时不好看 */

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transform: rotate(0deg);
      /* 朝另一个方向歪 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      /* 比爱心高一层 */
      overflow: hidden;
      /* 防止图片溢出圆角 */
    }

    #card-widget:active {

      transform: rotate(1deg) scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* --- Noir's Ultimate Scrollbar Hider --- */
    /* For Webkit browsers like Chrome, Safari */
    ::-webkit-scrollbar {
      display: none;
    }

    /* For Firefox */
    * {
      scrollbar-width: none;
    }

    /* --- Noir's Fix: 美化消息操作弹窗 --- */
    #message-action-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
    }

    #message-action-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      margin: 0;
      border-radius: 20px 20px 0 0;
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #message-action-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #message-action-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- End of Fix --- */
    /* --- Noir's Fix: Fancy User Post Area --- */
    #user-post-input-container {
      display: flex;
      gap: 10px;
    }

    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
    }

    #user-post-main-area {
      flex-grow: 1;
    }

    #user-post-textarea {
      width: 100%;
      border: none;
      background: transparent;
      outline: none;
      resize: vertical;
      font-size: 1rem;
      color: var(--text-color);
    }

    #user-post-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }

    #user-send-post-button {
      padding: 6px 18px;
      border-radius: 16px;
      border: none;
      background: var(--primary-color);
      color: white;
      cursor: pointer;
      font-weight: 600;
    }

    /* 这是附件预览的样式 */
    #user-post-attachment-preview {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .preview-item {
      position: relative;
      max-width: 100px;
    }

    .preview-item img {
      width: 100%;
      border-radius: 8px;
      object-fit: cover;
    }

    .preview-item .music-preview-card {
      display: flex;
      align-items: center;
      padding: 8px;
      background: rgba(0, 0, 0, 0.05);
      border-radius: 8px;
      width: 200px;
      /* 给音乐卡片宽一点 */
    }

    .preview-item .music-preview-card img {
      width: 30px;
      height: 30px;
      margin-right: 8px;
    }

    .preview-item .music-preview-card .info {
      font-size: 0.8rem;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .remove-attachment-btn {
      position: absolute;
      top: -5px;
      right: -5px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }

    /* --- Noir's Fix: Post Image Display Style --- */
    .post-image-container {
      padding: 0 15px 15px;
      /* 图片和文字之间留点空隙 */
    }

    .post-image {
      max-width: 100%;
      /* 图片最宽不能超过帖子宽度 */
      max-height: 400px;
      /* 最高400像素，防止长图刷屏 */
      border-radius: 8px;
      /* 加个小圆角，好看 */
      object-fit: cover;
      /* 保持图片比例，不变形 */
      display: block;
      /* 解决图片底部多余的空隙问题 */
    }

    /* --- Noir's Refactor: New Post Interaction Styles --- */
    .post-interactions {
      padding: 10px 15px;
      background-color: rgba(0, 0, 0, 0.02);
      border-top: 1px solid var(--border-color);
      font-size: 0.9rem;
    }

    .post-likes {
      color: var(--primary-color);
      margin-bottom: 8px;
    }

    .post-comments-container {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .post-comment {
      color: var(--text-color);
    }

    .post-comment .comment-author {
      font-weight: 600;
      color: var(--text-color);
    }

    .post-timestamp {
      font-size: 0.75rem;
      color: var(--text-color-light);
      padding: 0 15px 10px;
    }



    /* 覆盖：基础气泡体 */
    /* 覆盖：基础气泡体 */
    .message {
      border-radius: var(--bubble-radius);
      line-height: 1.55;
      padding: 10px 14px;
      box-shadow:
        0 1px 0 rgba(0, 0, 0, .03),
        0 4px 10px rgba(0, 0, 0, .06);
      /* 比你原先更浅，省功耗 */
      border: 1px solid var(--bubble-outline);
      backdrop-filter: none !important;
      /* 绝不启用重滤镜 */
      will-change: auto;
      /* 不抢 GPU 配额 */

      /* --- Noir's Fix: 就是下面这两行，哼 --- */
      user-select: none;
      /* 标准浏览器给我听话，不许选中 */
      -webkit-user-select: none;
      /* 那些老古董浏览器也一样 */
    }

    /* 你的气泡（右侧） */
    .message.user {
      color: #fff;
      background: var(--bubble-user-bg);
      border-bottom-right-radius: 6px;
      /* 微“角”保留你原味 */
      text-shadow: 0 1px 0 rgba(0, 0, 0, .12);
      /* 细腻但很轻 */
    }

    /* TA 的气泡（左侧） */
    .message.ai {
      color: var(--text-color);
      background: var(--bubble-ai-bg);
      border-bottom-left-radius: 6px;
    }

    /* 细节：图片/贴纸消息不套背景 */
    .message.user.sticker,
    .message.assistant.sticker,
    .message.user.image,
    .message.assistant.image {
      background: transparent;
      border: 0;
      box-shadow: none;
      padding: 0;
    }

    /* 轻触态：不使用阴影动画，避免合成层抖动 */
    .message:active {
      transform: scale(.996);
    }

    /* 引用块在气泡内的融合感 */
    .quoted-message-in-bubble {
      background: rgba(0, 0, 0, .045);
      border: 1px solid color-mix(in hsl, var(--primary-color) 18%, transparent);
      border-radius: 10px;
    }


    /* --- Noir's Transfer Bubble Style --- */
    .message.transfer {
      background: #F79232;
      /* 哼，一个温暖又醒目的橙色 */
      color: white;
      padding: 12px 16px;
      border-radius: 12px;
      width: 220px;
      border: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    /* 我还给左右两边做了区分，真是为你操碎了心 */
    .message-container.ai .message.transfer {
      background: #f9fafb;
      /* AI发来的转账用白色，更清爽 */
      color: #333;
      border: 1px solid #e5e7eb;
    }

    .transfer-content {
      display: flex;
      flex-direction: column;
    }

    .transfer-title {
      font-weight: 600;
      font-size: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.5);
      padding-bottom: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }

    .message-container.ai .transfer-title {
      border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    .transfer-amount {
      font-size: 1.8rem;
      font-weight: bold;
    }

    .transfer-recipient {
      font-size: 0.8rem;
      opacity: 0.9;
      margin-top: 4px;
    }

    /* --- End of Refactor --- */

    /* --- Noir's Music System Refactor --- */
    #music-widget-card {
      display: flex;
      align-items: center;
      width: 320px;
      /* 固定宽度，更像一个小组件 */
      margin: 0 auto;
      /* 居中 */
      padding: 12px;
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.85);
      /*backdrop-filter: blur(10px) saturate(1.5);*/
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.5);

    }

    #widget-cover-art {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      background-size: cover;
      background-position: center;
      margin-right: 12px;
      flex-shrink: 0;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    #music-widget .widget-info {
      flex-grow: 1;
      overflow: hidden;
      color: var(--text-color);
    }

    #music-widget .widget-info #widget-title {
      font-weight: 600;
    }

    #music-widget .widget-info #widget-artist {
      font-size: 0.85rem;
      opacity: 0.7;
    }

    #widget-controls {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* 5. 哼，给那个不听话的音乐播放器按钮也做个整容 */
    #widget-controls button {
      background: transparent !important;
      /* 强制透明，去掉那该死的蓝色 */
      border: none;
      color: var(--text-color);
      /* 颜色要听主题的话 */
      opacity: 0.7;
      /* 稍微淡一点，不要那么抢眼 */
      font-size: 1.3rem;
      /* 图标可以大一点 */
      padding: 5px;
      cursor: pointer;
      transition: opacity 0.2s ease, transform 0.2s ease;
    }

    #widget-controls button:hover {
      opacity: 1;
      /* 鼠标放上去时变清晰 */
    }

    #widget-controls button:active {
      transform: scale(0.9);
      /* 按下时来点反馈 */
    }

    /* 底部播放器样式升级 */
    #player-controls {
      display: flex;
      align-items: center;
      gap: 15px;
      /* 加大按钮间距 */
    }

    #player-controls button {
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--text-color);
      cursor: pointer;
    }

    /* --- Noir's Snap Guide Styles --- */
    .snap-guide {
      position: absolute;
      background-color: rgba(255, 105, 180, 0.85);
      /* 哼，一个足够醒目的颜色 */
      display: none;
      z-index: 999;
      box-shadow: 0 0 5px rgba(255, 105, 180, 0.7);
    }

    #snap-guide-v {
      width: 1px;
    }

    #snap-guide-h {
      height: 1px;
    }

    /* --- Noir's Galgame UI Beautification --- */
    /* Top-left Date & Time Widget */
    #galgame-overlay-ui {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 12px;
      padding: 8px 15px;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      z-index: 10;
      border: 1px solid rgba(255, 255, 255, 0.2);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    #galgame-time {
      font-size: 1.2rem;
      font-weight: 600;
      text-align: center;
    }

    #galgame-date {
      font-size: 0.75rem;
      opacity: 0.8;
      text-align: center;
    }

    /* Main Text Box */
    /* Main Text Box */
    #galgame-textbox-container {
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.85) 0%, rgba(45, 50, 68, 0.7) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border-top: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.2);
      bottom: 85px;
      /* <-- 就是这里，往上抬了，满意了吗？ */
      left: 15px;
      right: 15px;
      padding: 12px 18px;
    }

    /* Speaker Name Tag */
    #galgame-speaker {
      background: linear-gradient(90deg, var(--primary-color) 0%, hsl(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) - 10%)) 100%);
      color: white;
      padding: 4px 12px;
      border-radius: 8px;
      display: inline-block;
      font-size: 0.95rem;
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
      margin-bottom: 12px;
    }

    /* Dialogue Text */
    #galgame-text {
      font-size: 1rem;
      line-height: 1.7;
      color: #f0f2f5;
    }

    /* User Input Area Container*/
    #meeting-view-screen .chat-input-area {
      background: transparent;
      border-top: none;
      padding: 0 15px 20px 15px;
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 20;
    }

    /* User Input Wrapper */
    #chat-input-wrapper-meeting {
      display: flex;
      align-items: center;
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.9) 0%, rgba(45, 50, 68, 0.75) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      padding: 5px 8px 5px 15px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.25);
    }

    #meeting-message-input {
      color: #f0f2f5;
    }

    #meeting-message-input::placeholder {
      color: rgba(240, 242, 245, 0.5);
      font-style: italic;
    }

    /* Send Button */
    #meeting-send-button {
      height: 40px;
      width: 40px;
      border-radius: 50%;
      font-size: 1.5rem;
      font-weight: 300;
      color: #fff;
      transition: all .2s ease;
      margin-left: 8px;
      background: var(--primary-color);
      box-shadow: 0 2px 5px hsla(var(--primary-hue), 50%, 50%, 0.4);
    }

    #meeting-send-button:hover {
      filter: brightness(1.1);
      transform: scale(1.05);
    }


    /* --- End of Beautification --- */
    /* --- Noir's Diary Beautification --- */
    #diary-entries-container {
      background-color: #fdfaf2;
      /* A warm, paper-like off-white */
      padding: 25px 20px;
      line-height: 1.9;
      border: 1px solid #e0dccc;
      box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.08);
      /* Inner shadow for page depth */
    }

    /* This is the container for a single entry (date, author, content) */
    .diary-entry {
      margin-bottom: 2.5em;
      /* Increase spacing between entries */
      position: relative;
      padding-bottom: 1.5em;
      /* Space for the separator line */
      border-bottom: 1px dashed #dcd5c7;
      /* A subtle dashed line between entries */
    }

    /* Style the author's name */
    .diary-author {
      font-weight: normal;
      /* Make it less bold, more like a signature */
      font-size: 1rem;
      font-family: 'Segoe Script', 'Bradley Hand', cursive;
      /* A more handwritten font */
    }

    /* Style the date */
    .diary-timestamp {
      font-size: 0.75rem;
      color: #a99e8c;
      /* A faded brown color */
      margin-bottom: 8px;
      font-family: 'Courier New', monospace;
      /* Typewriter-like font for date */
    }

    /* Style the actual diary text content */
    .diary-content {
      white-space: pre-wrap;
      font-size: 0.95rem;
      color: #4a443b;
      /* A dark brown/black ink color */
      font-family: 'KaiTi', 'STSong', serif;
    }

    /* Specific styles for the USER's entries */
    .diary-entry.user {
      text-align: right;
    }

    .diary-entry.user .diary-author {
      color: #005a9c;
      /* A nice fountain pen blue */
    }

    .diary-entry.user .diary-content {
      color: #1a5c8e;
    }

    /* Specific styles for the AI's entries */
    .diary-entry.ai {
      text-align: left;
    }

    .diary-entry.ai .diary-author {
      color: #5a3e36;
      /* A darker, warmer brown for the AI */
    }

    .diary-entry.ai .diary-content {
      color: #4a443b;
    }

    /* Let's get rid of the last separator line for a cleaner look */
    .diary-entry:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    /* --- End of Diary Beautification --- */
    /* --- Noir's Page-Turning Magic --- */
    #diary-entries-container {
      perspective: 1500px;
      /* 为3D效果设置视距 */
      position: relative;
      overflow: hidden;
    }

    .diary-page {
      position: absolute;
      inset: 0;
      padding: 25px 20px;
      background-color: #fdfaf2;
      transform-style: preserve-3d;
      backface-visibility: hidden;
      transition: transform 0.7s cubic-bezier(0.65, 0, 0.35, 1);
      display: none;
      /* 默认所有页面都藏起来 */
      flex-direction: column;
      gap: 2.5em;
      /* 页内日记的间距 */
      overflow-y: auto;
      /* 如果一页内容太多，允许滚动 */
    }

    .diary-page.is-visible {
      display: flex;
      /* 只有当前页显示 */
      transform: rotateY(0deg);
      z-index: 2;
    }

    /* 翻到下一页时，当前页向左翻出 */
    .diary-page.is-exiting-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 1;
    }

    /* 翻到下一页时，新页面从右边翻入 */
    .diary-page.is-entering-from-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 2;
    }

    /* 翻到上一页时，当前页向右翻出 */
    .diary-page.is-exiting-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 1;
    }

    /* 翻到上一页时，新页面从左边翻入 */
    .diary-page.is-entering-from-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 2;
    }


    #diary-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 0 10px;
      box-sizing: border-box;
    }

    #diary-navigation button {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--primary-color);
      padding: 8px 16px;
      border-radius: 18px;
      cursor: pointer;
      font-size: 0.9rem;
    }

    #diary-navigation button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    #diary-page-indicator {
      font-size: 0.9rem;
      color: var(--text-color-light);
      font-family: 'Courier New', monospace;
    }

    /* --- End of Magic --- */
    /* --- Noir's Universal Anti-Squash Protocol --- */
    /* 哼，就是下面这几条，给你那些被压扁的头像整整容 */

    /* 动态发布区的用户头像 */
    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
      object-fit: cover;
      /* <-- 加上这句，它就不敢扁了 */
    }

    /* 好友圈动态里的角色头像 */
    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
      object-fit: cover;
      /* <-- 还有这句，一个都别想跑 */
    }

    /* 顺便把所有叫 .char-avatar 的都统一一下，免得以后还有问题 */
    .char-avatar {
      object-fit: cover;
    }

    /* --- Noir's Music Library Styles --- */
    #music-library-container {
      padding: 10px;
    }

    .music-library-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .music-library-item:hover {
      transform: translateY(-2px);
    }

    .music-library-item-cover {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 15px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .music-library-item-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-library-item-title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-library-item-artist {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    /* --- End of Styles --- */
    /* --- Noir's Global Player Styles --- */

    /* --- End of Player Styles --- */
    /* --- Noir's Upload Altar Styles --- */
    .upload-slot {
      border: 2px dashed var(--border-color);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: background-color 0.2s ease, border-color 0.2s ease;
      background-color: rgba(255, 255, 255, 0.5);
    }

    .upload-slot:hover {
      background-color: var(--card-bg);
      border-color: var(--primary-color);
    }

    .upload-slot.filled {
      border-color: var(--primary-color);
      border-style: solid;
      background-color: hsla(var(--primary-hue), 50%, 95%, 0.8);
    }

    .upload-slot .slot-icon {
      font-size: 2rem;
    }

    .upload-slot .slot-label {
      display: block;
      font-weight: 600;
      margin-top: 5px;
      color: var(--text-color);
    }

    .upload-slot .slot-filename {
      display: block;
      font-size: 0.85rem;
      color: var(--text-color-light);
      margin-top: 3px;
      word-break: break-all;
    }

    #confirm-altar-upload-button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* --- End of Altar Styles --- */
    /* --- Noir's Listen Together Invite Card Style --- */
    .listen-together-card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 15px;
      box-shadow: var(--soft-shadow);
      border: 1px solid var(--border-color);
      width: 250px;
    }

    .message-container.user .listen-together-card {
      background: var(--bubble-user-bg);
      color: white;
    }

    .message-container.user .listen-together-card .listen-together-decline-btn {
      color: white;
      /* 哼，让用户侧的拒绝按钮文字也变白 */
    }

    .listen-together-header {
      font-size: 0.8rem;
      opacity: 0.8;
      margin-bottom: 10px;
      border-bottom: 1px solid var(--bubble-outline);
      padding-bottom: 8px;
    }

    .listen-together-song {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .listen-together-song img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      flex-shrink: 0;
    }

    .listen-together-info .title {
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-info .artist {
      font-size: 0.9em;
      opacity: 0.9;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .listen-together-actions button {
      flex-grow: 1;
      padding: 8px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: transform 0.1s ease;
    }

    .listen-together-actions button:active {
      transform: scale(0.97);
    }

    .listen-together-accept-btn {
      background: var(--primary-color);
      color: white;
    }

    .listen-together-decline-btn {
      background: rgba(0, 0, 0, 0.1);
    }

    /* 用这个替换你旧的 #listen-together-ui */
    #listen-together-ui {
      position: fixed;
      inset: 0;
      z-index: 2000;
      display: flex;
      align-items: center;
      /* 改成居中对齐 */
      justify-content: center;
      padding: 20px;
      /* 增加内边距，让弹窗不会贴边 */
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    #listen-together-ui.show {
      opacity: 1;
      visibility: visible;
    }

    .lt-ui-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(15px) saturate(1.8);
      -webkit-backdrop-filter: blur(15px) saturate(1.8);
    }

    /* 用这个替换你旧的 .lt-ui-main */
    .lt-ui-main {
      position: relative;
      width: 100%;
      height: 100%;
      max-width: 380px;
      /* 哼，给它一个最大宽度 */
      max-height: 650px;
      /* 再给一个最大高度 */
      display: flex;
      flex-direction: column;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      border-radius: 24px;
      /* 加上优雅的圆角 */
      overflow: hidden;
      /* 把溢出的部分裁掉 */
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      /* 更强的立体阴影 */
      border: 1px solid rgba(255, 255, 255, 0.2);
      /* 淡淡的边框光效 */
    }

    .lt-ui-header {
      flex-shrink: 0;
      padding: 15px 20px;
      text-align: center;
      position: relative;
    }

    #lt-ui-header-title {
      font-weight: 600;
    }

    #lt-ui-close-btn {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      line-height: 30px;
    }

    .lt-ui-content {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      overflow: hidden;
    }

    .lt-ui-cover-container {
      flex-shrink: 0;
      width: 65%;
      aspect-ratio: 1/1;
      margin-top: 5%;
      margin-bottom: 20px;
    }

    #lt-ui-cover-art {
      width: 100%;
      height: 100%;
      border-radius: 16px;
      object-fit: cover;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .lt-ui-info {
      text-align: center;
      margin-bottom: 20px;
      flex-shrink: 0;
    }

    #lt-ui-song-title {
      font-size: 1.5rem;
      margin: 0;
    }

    #lt-ui-song-artist {
      font-size: 1rem;
      opacity: 0.8;
      margin: 5px 0 0;
    }

    #lt-ui-lyrics-container {
      flex-grow: 1;
      width: 100%;
      overflow-y: auto;
      text-align: center;
      font-size: 1.1rem;
      line-height: 2.5;
      mask-image: linear-gradient(transparent 0%, black 20%, black 80%, transparent 100%);
      /* 歌词上下渐隐，看起来更专业 */
      scroll-behavior: smooth;
      /* 滚动要丝滑 */
    }

    #lt-ui-lyrics-container p {
      transition: color 0.3s ease, transform 0.3s ease;
      opacity: 0.6;
    }

    #lt-ui-lyrics-container p.active {
      color: var(--primary-color);
      font-weight: 600;
      transform: scale(1.1);
      opacity: 1;
    }

    /* --- Noir's "Desktop Preview" Frame --- */
    /* 哼，只有在电脑这种大屏幕上，我才给你加上这个“手机框”，免得你分不清主次。 */
    /* 在真正的手机上，它还是会全屏显示的，我可没你那么笨。 */
    @media (min-width: 480px) {
      body {
        background-color: #e9ebee;
        /* 一个不那么刺眼的背景色 */
        padding: 20px 0;
        /* 上下留点呼吸空间 */
      }

      #phone-container {
        width: var(--phone-width);
        height: var(--phone-height);
        max-height: 90vh;
        /* 确保在矮屏幕上不会超出 */

        /* 这就是你想要的“边框”，哼 */
        border: 10px solid #1c1c1e;
        border-radius: 44px;
        /* 圆角大一点才像样 */
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        /* 给你加个高级点的阴影 */

        flex-shrink: 0;
        /* 确保它在 flex 布局里不会被压扁 */
      }
    }

    /* --- Noir's Vinyl Record Player Design v3.0 FINAL --- */
    /* 哼，这才是终极版。 */

    /* 1. 播放器“底座”，保持为一个干净的方形容器 */
    #music-widget-card {
      width: 180px;
      height: 180px;
      border-radius: 24px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      background-image: url('在这里填上你的默认图片URL');
      background-size: cover;
      background-position: center;
      /* 一个有质感的浅灰色底座 */
      display: block;
      /* 取消flex，我们用绝对定位 */
      padding: 0;
      border: 1px solid rgba(255, 255, 255, 0.5);
    }

    /* 2. “唱片”本体！现在它是一个圆，背景就是你的自定义图片 */
    #widget-cover-art {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      /* 唱片占底座的90% */
      height: 90%;
      border-radius: 50%;
      /* 变成正圆形 */
      background-size: cover;
      background-position: center;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.25);
      /* 背景图由JS设置，这里是它的容器 */
    }

    /* 3. 这是“唱片”的“黑胶部分”，用伪元素画在图片上面 */
    #widget-cover-art::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 65%;
      /* 黑胶部分占整个唱片的65% */
      height: 65%;
      border-radius: 50%;
      background: radial-gradient(circle, #3a3a3a 0%, #1a1a1a 100%);
      /* 模拟黑胶质感 */
      box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.7);
    }

    /* 4. 这是“唱片”中心的“标签孔”，画在黑胶上面 */
    #widget-cover-art::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 20%;
      /* 中心孔占整个唱片的20% */
      height: 20%;
      border-radius: 50%;
      background: #c9c3b7;
      /* 唱片标签纸的颜色 */
      border: 2px solid #5a554f;
    }

    /* 5. 浮在唱片上方的“信息标签” */
    .widget-content-overlay {
      position: absolute;
      bottom: 15px;
      /* 贴在底部 */
      left: 15px;
      right: 15px;
      padding: 10px;
      background: rgba(255, 255, 255, 0.75);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 10px;
      z-index: 2;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* 6. 最后，重新调整文字和按钮的样式 */
    #music-widget .widget-info {
      text-align: left;
      width: auto;
      color: #2c3e50;
      text-shadow: none;
      flex-grow: 1;
      /* 让信息区占满左边空间 */
    }

    #music-widget .widget-info #widget-title {
      font-weight: 600;
      font-size: 0.9rem;
    }

    #music-widget .widget-info #widget-artist {
      font-size: 0.75rem;
      opacity: 0.8;
    }

    #widget-controls {
      display: flex;
      /* 让按钮横着排 */
      width: auto;
      flex-shrink: 0;
      /* 防止按钮被挤压 */
    }

    #widget-controls button {
      color: #2c3e50;
      font-size: 1.1rem;
      background: none;
      border: none;
      padding: 0 4px;
      /* 调整按钮间距 */
      opacity: 0.7;
    }

    /* --- Noir's iOS Industrial Button Refactor --- */
    /* 哼，看好了，这才是专业设备该有的开关。*/

    /* 1. 按钮的基础“模具”，所有按钮都用这个形状和质感 */
    .form-button {
      border: none;
      border-radius: 12px;
      /* iOS风格的圆角 */
      padding: 14px;
      font-size: 1rem;
      font-weight: 600;
      /* 字体加粗一点更有力 */
      cursor: pointer;
      width: 100%;
      /* 宽度占满容器 */
      margin-top: 10px;
      transition: filter 0.15s ease;
      /* 点击效果用滤镜，更现代 */
      -webkit-tap-highlight-color: transparent;
      /* 去掉移动端点击时的蓝色背景 */
    }

    .form-button:active {
      filter: brightness(0.9);
      /* 按下时变暗 */
    }

    .form-button:disabled {
      background-color: #ccc !important;
      /* 用!important确保覆盖所有情况 */
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* 2. 主要操作按钮的“皮肤” (蓝色) */
    .form-button {
      background-color: #007aff;
      /* Apple Blue */
      color: white;
    }

    /* 3. 次要操作按钮的“皮肤” (灰色) */
    .form-button.secondary {
      background-color: #e5e5ea;
      /* Apple Light Gray */
      color: #000;
    }

    /* 4. 危险/破坏性操作按钮的“皮肤” (红色) */
    .form-button.destructive {
      background-color: #ff3b30;
      /* Apple Red */
      color: white;
    }

    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */

    /* 1. Dock栏的样式 */
    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */
    #home-dock {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      height: 85px;
      padding: 0 20px;
      /* 图标左右的留白 */
      box-sizing: border-box;

      /* 背景和滤镜，现在都在这里 */
      background: var(--surface-bg);
      backdrop-filter: blur(5px) saturate(0.8);
      -webkit-backdrop-filter: blur(15px) saturate(0.8);
      border-radius: 28px;
      z-index: 35;

      /* 核心：用Flexbox来自动排列图标 */
      display: flex;
      justify-content: space-around;
      /* 均匀分布 */
      align-items: center;
      /* 垂直居中 */
      padding-top: 9px;
    }

    #home-dock .app-icon {
      position: static;
      /* 取消绝对定位，让它接受Flexbox的管理 */
    }

    /* 2. App图标的“整容手术” */
    .app-icon-img {
      width: 58px;
      /* 图标背景尺寸 */
      height: 58px;
      border-radius: 22.5%;
      /* iOS标志性的“方圆”形 */
      font-size: 28px;
      /* 阴影从图标本身移到背景上，更统一 */
      background-color: var(--surface-bg);
      box-shadow: none;
      /* 删掉旧的阴影 */
      transition: transform 0.2s ease;
    }

    .app-icon:active .app-icon-img {
      transform: scale(0.92);
      /* 按下时图标有反馈 */
    }

    /* --- Noir's Minimalist Home Screen Makeover (v2.0 Dynamic Edition) --- */
    /* 哼，现在这些家伙也听从总开关的指挥了。*/

    /* 1. 时钟和日期 */
    #home-clock-container {
      color: var(--text-color);
      text-shadow: none;
    }

    #home-date {
      opacity: 0.7;
    }

    /* 2. App图标的改造 (现在是动态颜色了) */
    .app-icon span {
      color: var(--text-color);
      text-shadow: none;
      font-weight: 500;
    }

    .app-icon-img {
      background-color: var(--card-bg);
      /* <-- 哼，接上了！*/
      color: var(--text-color-light);
      /* <-- 接上了！*/
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    /* 3. Dock栏的颜色 (也动态了) */


    /* 4. 唱片机也给你一起接上了，免得你下次又来烦我 */
    #music-widget-card {
      background: var(--surface-bg);
      box-shadow: var(--soft-shadow);
      border-color: hsla(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) + 10%), 0.5);
    }

    .widget-content-overlay {
      background: var(--card-bg);
      color: var(--text-color);
    }

    #widget-controls button,
    #music-widget .widget-info #widget-title,
    #music-widget .widget-info #widget-artist {
      color: var(--text-color);
    }

    #widget-cover-art::after {
      background: var(--text-color);
      border-color: hsl(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) + 18%));
    }

    /* --- Noir's Theme Preset Buttons --- */
    /* 哼，每个按钮都是一件艺术品。 */
    .theme-preset-button {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 20px;
      /* 胶囊形状 */
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
      background: var(--card-bg);
    }

    .theme-preset-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--soft-shadow);
    }

    .preset-color-dot {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
    }

    /* --- Noir's Memory Archive Styles --- */
    #summary-textarea {
      width: 100%;
      height: 100%;
      border: none;
      outline: none;
      resize: none;
      padding: 15px;
      box-sizing: border-box;
      font-family: 'Courier New', monospace;
      /* 用等宽字体，YAML格式才好看 */
      font-size: 0.85rem;
      line-height: 1.6;
      background-color: #fdfdfd;
      color: var(--text-color);
    }
  </style>
</head>

<body>
  <input type="file" id="audio-file-input" style="display: none;" accept=".flac,.mp3">
  <input type="file" id="cover-file-input" style="display: none;" accept=".jpg,.png,.jpeg,.webp">
  <input type="file" id="info-file-input" style="display: none;" accept=".txt">
  <input type="file" id="lyrics-file-input" style="display: none;" accept=".lrc">
  <div id="phone-container">

    <div id="user-profile-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-user-list" class="header-button">主屏幕</button>
        <span class="header-title">选择用户</span>
        <button id="add-user-profile-button" class="header-button add" title="添加新用户">+</button>
      </div>
      <div class="content" id="user-profile-list-container">
      </div>
    </div>

    <div id="user-profile-screen" class="screen">
      <div class="header">
        <button id="back-to-user-list-from-edit" class="header-button">返回</button>
        <span id="user-profile-edit-title" class="header-title">编辑用户</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-user-id">
        <div class="settings-group">
          <h2>用户设定</h2>
          <div class="input-group">
            <label for="user-name">你的名字</label>
            <input type="text" id="user-name" placeholder="你的显示名字">
          </div>
          <div class="avatar-upload-group">
            <label>你的头像</label>
            <img id="user-avatar-preview" class="avatar-preview" alt="User Avatar Preview">
            <input type="file" id="user-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="user-persona">你的人设 (可选)</label>
            <textarea id="user-persona" placeholder="向AI介绍你自己。例如：我是一名大学生，喜欢摄影和旅行。"></textarea>
          </div>
        </div>
        <button id="save-user-profile-button" class="form-button">保存资料</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="set-active-user-button" class="form-button"
            style="background-color: #28a745; margin-bottom: 10px;">设为当前用户</button>
          <button id="delete-user-profile-button" class="form-button" style="background-color: #dc3545;">删除该用户</button>
        </div>
      </div>
    </div>


    <div id="home-screen" class="screen active">
      <div id="home-screen-main-content" style="position: relative; flex-grow: 1; width: 100%;">
        <div id="home-clock-container">
          <div id="home-time">11:31</div>
          <div id="home-date">8月29日 星期五</div>
          <div id="noir-author-mark"></div>
        </div>


        <div id="decorative-badge" style="display: none; position: absolute; top: 250px; left: 50px;">
          <img id="badge-image" src="http://googleusercontent.com/file_content/0" alt="badge">
        </div>

        <div id="card-widget" style="display: none; position: absolute; top: 140px; left: 145px;">
          <img id="card-image" src="" alt="card widget">
        </div>






        <div class="app-icon" id="app-world-book">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
              <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
            </svg></div>
          <span>世界书</span>
        </div>


        <div class="app-icon" id="app-diary">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <path d="M2.5 17a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1zM2.5 14a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1z" />
            </svg></div>
          <span>交换日记</span>
        </div>

        <div class="app-icon" id="app-music-library">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
              <path
                d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
              </path>
            </svg></div>
          <span>音乐库</span>
        </div>


        <div class="app-icon" id="app-settings">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path
                d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z">
              </path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg></div>
          <span>API设置</span>
        </div>
        <div class="app-icon" id="app-user-profiles">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg></div>
          <span>我</span>
        </div>
        <div class="app-icon" id="app-wallpaper">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path
                d="M12 2.69l.34.34a1.41 1.41 0 0 0 2 0L22 6.34a1.41 1.41 0 0 0 0-2l-7.66-7.66a1.41 1.41 0 0 0-2 0L2.68 14.34a1.41 1.41 0 0 0 0 2L10 24l2-2 2-2 2-2 2-2 2-2">
              </path>
              <path d="m7.34 2.66 14 14"></path>
            </svg></div>
          <span>更换壁紙</span>
        </div>
      </div>
      <div id="home-dock">
        <div class="app-icon app-icon-large" id="app-chat">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            </svg></div>
          <span>聊天</span>
        </div>
        <div class="app-icon" id="app-music">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 18V5l12-2v13"></path>
              <circle cx="6" cy="18" r="3"></circle>
              <circle cx="18" cy="16" r="3"></circle>
            </svg></div>
          <span>动态</span>
        </div>
        <div class="app-icon" id="app-meeting">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14 9a2 2 0 0 1-2 2H6l-4 4V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v4Z" />
              <path d="M18 9h2a2 2 0 0 1 2 2v9l-4-4h-2a2 2 0 0 1-2-2V9Z" />
            </svg></div>
          <span>见面</span>
        </div>
      </div>
    </div>

    <div id="chat-screen" class="screen">
      <div id="chat-screen-container">
        <div id="chat-list-pane">
          <div id="chat-list-header">
            <button id="back-to-home-from-chat" class="header-button">主屏幕</button>
            <span class="header-title">聊天</span>
            <button id="add-chat-button" class="header-button add" title="添加新聊天">+</button>
          </div>
          <div id="chat-list-container">
            <ul id="character-list">
            </ul>
          </div>
        </div>
        <div id="chat-view-pane">
          <div class="header">
            <button class="header-button" id="back-to-chat-list">返回</button>
            <span id="char-name-header" class="header-title">角色</span>
            <button class="header-button" id="character-settings-button" title="角色设置">⚙️</button>
          </div>
          <div id="chat-messages" class="messages">
          </div>
          <div id="offline-scene-view"></div>
          <div id="chat-sticker-panel" class="sticker-panel">
          </div>
          <div class="chat-toolbar">
            <button id="chat-sticker-button" class="toolbar-button" title="表情">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M8 14s1.5-2 4-2 4 2 4 2"></path>
                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                <line x1="15" y1="9" x2="15.01" y2="9"></line>
              </svg>
            </button>
            <button id="chat-image-button" class="toolbar-button" title="发送图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <button id="chat-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
            <button id="chat-listen-together-button" class="toolbar-button" title="一起听">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                <path
                  d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                </path>
              </svg>
            </button>
            <button id="chat-transfer-button" class="toolbar-button" title="转账">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
            </button>
            <button id="chat-reroll-button" class="toolbar-button" title="重新生成">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
              </svg>
            </button>
            <button id="chat-summarize-button" class="toolbar-button" title="总结聊天记录">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
              </svg>
            </button>
          </div>
          <input type="file" id="chat-image-input" accept="image/*" style="display: none;">
          <div id="quote-preview-area" class="quote-preview">
            <div class="quote-preview-content">
              <div id="quote-preview-sender"></div>
              <div id="quote-preview-text"></div>
            </div>
            <button id="cancel-quote-button" class="cancel-quote-btn">&times;</button>
          </div>
          <div class="chat-input-area">
            <div id="chat-input-wrapper">
              <input type="text" id="chat-message-input" placeholder="输入消息...">
              <button id="chat-get-reply-button" title="让对方回复">↵</button>
              <button id="chat-send-button" title="发送">➤</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="settings-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-settings" class="header-button">返回</button>
        <span class="header-title">API设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>API 设置</h2>
          <div class="input-group">
            <label for="api-endpoint">API 接口地址（不填/v1）</label>
            <input type="text" id="api-endpoint" placeholder="例如: https://api.openai.com">
          </div>
          <div class="input-group">
            <label for="api-key">API 密钥</label>
            <input type="password" id="api-key" placeholder="请输入你的 API 密钥">
          </div>
          <div class="input-group">
            <label for="api-model">模型</label>
            <div class="model-input-container">
              <input type="text" id="api-model" placeholder="点击 获取 或手动输入" style="flex-grow: 1;">
              <button id="fetch-models-button" style="padding: 0 12px; white-space: nowrap;">获取</button>
              <div id="model-dropdown" class="custom-model-dropdown"></div>
            </div>
          </div>
          <div class="input-group">
            <label for="api-provider">接口格式 (重要！请根据你使用的接口选择，但是我也没做Openai以外的接口……)</label>
            <select id="api-provider"
              style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color);">
              <option value="openai">OpenAI 格式 (通用，兼容绝大多数反代)</option>
              <option value="gemini">Google Gemini 格式 (仅限官方或特定反代)</option>
              <option value="anthropic">Anthropic Claude 格式</option>
            </select>
          </div>
        </div>
        <div class="settings-group">
          <h2>上下文设置</h2>
          <div class="input-group">
            <label for="context-lines-per-chat">每个会话读取的消息条数（默认 100）</label>
            <input type="number" id="context-lines-per-chat" min="1" max="1000000" step="1" placeholder="100">
          </div>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>数据管理</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">
            导出全部数据（角色、聊天记录、设置、桌面布局等）到一个文件，方便在其他设备或浏览器上导入。
          </p>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="export-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #007bff;">导出全部数据</button>
            <button id="import-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #28a745;">导入数据</button>
          </div>
          <input type="file" id="import-data-input" accept=".json" style="display: none;">
        </div>
        <button id="save-api-settings-button" class="form-button">保存 API 设置</button>
      </div>
    </div>



    <div id="character-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-edit" class="header-button">返回</button>
        <span id="character-edit-title" class="header-title">编辑角色</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-char-id">
        <div class="settings-group">
          <h2>角色设定</h2>
          <div class="input-group">
            <label for="char-edit-name">名字</label>
            <input type="text" id="char-edit-name" placeholder="角色的名字">
          </div>
          <div class="input-group">
            <label for="char-edit-remark">备注名</label>
            <input type="text" id="char-edit-remark" placeholder="方便自己记忆，例如 '工作助理'">
          </div>
          <div class="avatar-upload-group">
            <label>角色头像</label>
            <img id="char-edit-avatar-preview" class="avatar-preview" alt="Avatar Preview">
            <input type="file" id="char-edit-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-persona">人设 (系统提示词)</label>
            <textarea id="char-edit-persona" placeholder="你是一个乐于助人的助手。"></textarea>
          </div>
          <div class="input-group">
            <label>聊天壁纸</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-wallpaper-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="聊天壁纸预览">
            </div>
            <input type="file" id="char-edit-wallpaper-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-css">专属气泡样式 (CSS)</label>
            <textarea id="char-edit-css" rows="8"
              placeholder="从其他地方复制的、包含 .sent 和 .received 的CSS代码可以直接粘贴在这里..."></textarea>

            <div style="display: flex; gap: 10px; margin-top: 5px;">
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">TA的气泡 (Received):</p>
                <div id="bubble-preview-ai" class="message ai">这是TA的气泡预览效果</div>
              </div>
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">你的气泡 (Sent):</p>
                <div id="bubble-preview-user" class="message user">这是你的气泡预览效果</div>
              </div>
            </div>
          </div>
          <div class="input-group">
            <label>见面场景背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-offline-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="见面背景预览">
            </div>
            <input type="file" id="char-edit-offline-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="settings-group">
            <h2>角色立绘 (Galgame模式)</h2>
            <p style="font-size: 0.8rem; color: var(--text-color-light);">为五种核心情绪上传立绘图，建议使用透明背景的PNG图片。</p>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px;">

              <div class="avatar-upload-group" style="align-items: center;">
                <label>平常</label>
                <img id="char-edit-sprite-normal-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="平常立绘">
                <input type="file" id="char-edit-sprite-normal-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>喜</label>
                <img id="char-edit-sprite-happy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="喜立绘">
                <input type="file" id="char-edit-sprite-happy-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>怒</label>
                <img id="char-edit-sprite-angry-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="怒立绘">
                <input type="file" id="char-edit-sprite-angry-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>哀</label>
                <img id="char-edit-sprite-sad-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="哀立绘">
                <input type="file" id="char-edit-sprite-sad-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>害羞</label>
                <img id="char-edit-sprite-shy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="害羞立绘">
                <input type="file" id="char-edit-sprite-shy-input" accept="image/*" style="display: none;">
              </div>
            </div>
          </div>
          <div class="input-group">
            <label for="char-edit-bind-user">绑定用户</label>
            <select id="char-edit-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="world-book-checkboxes-container" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="save-char-button" class="form-button">保存角色</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="edit-clear-history-button" class="form-button"
            style="background-color: #ffc107; margin-bottom: 10px;">清空聊天记录</button>
          <button id="edit-delete-char-button" class="form-button" style="background-color: #dc3545;">删除角色</button>
        </div>
      </div>
    </div>

    <div id="group-chat-create-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-group-create" class="header-button">返回</button>
        <span class="header-title">创建群聊</span>
        <button id="create-group-chat-button" class="header-button">创建</button>
      </div>
      <div class="content" style="padding: 20px;">
        <div class="input-group">
          <label for="group-chat-name">群聊名称</label>
          <input type="text" id="group-chat-name" placeholder="给你的群聊起个名字">
        </div>
        <div class="settings-group">
          <h2>选择成员</h2>
          <div id="group-chat-member-list-container"
            style="max-height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
            <ul id="group-chat-member-list">
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div id="wallpaper-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-wallpaper" class="header-button">返回</button>
        <span class="header-title">更换壁纸</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2>全局主题色</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">拖动滑块来改变整个App的主色调。</p>
          <div class="input-group" style="padding-top: 10px;">
            <label for="theme-hue-slider" style="display: block; margin-bottom: 5px;">色相 (Hue)</label>
            <input type="range" id="theme-hue-slider" min="0" max="360" value="35" style="width: 100%;">
          </div>
          <div class="input-group">
            <label for="theme-lightness-slider" style="display: block; margin-bottom: 5px;">明度 (Lightness)</label>
            <input type="range" id="theme-lightness-slider" min="15" max="95" value="80" style="width: 100%;">
          </div>
        </div>
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2 style="margin-top: 0;">时钟样式</h2>
          <div style="display: flex; align-items: center; gap: 10px;">
            <input type="checkbox" id="clock-color-toggle" style="width: auto; height: 18px; flex-shrink: 0;">
            <label for="clock-color-toggle" style="width: auto; font-size: 0.9rem;">强制使用纯白色时钟 (推荐在深色壁纸下使用)</label>
          </div>
        </div>
        <div class="settings-group">
          <h2>上传新壁纸</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">选择一张图片作为你的手机壁纸。为了效果最好，请使用竖屏图片。</p>
          <input type="file" id="wallpaper-input" accept="image/*" style="display: none;">
          <button id="upload-wallpaper-button" class="form-button">选择图片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>音乐小组件背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的主屏幕音乐小组件设置一张专属背景图。</p>
          <input type="file" id="widget-bg-input" accept="image/*" style="display: none;">
          <button id="upload-widget-bg-button" class="form-button">选择图片</button>
          <button id="reset-widget-bg-button" class="form-button secondary">恢复默认</button>
        </div>
        <div class="settings-group" style="margin-top: 20px;">
          <h2>重置桌面</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">此操作会将所有桌面小组件（时钟、音乐、徽章等）恢复到初始位置，并将壁纸重置为纯白色。</p>
          <button id="reset-desktop-button" class="form-button destructive">重置桌面布局</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义徽章</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面徽章，可以拖动它到任意位置。</p>
          <input type="file" id="badge-input" accept="image/*" style="display: none;">
          <button id="upload-badge-button" class="form-button">选择徽章图片</button>
          <button id="reset-badge-button" class="form-button"
            style="background-color: #777; margin-top: 10px;">移除徽章</button>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面方形卡片小组件。</p>
          <input type="file" id="card-input" accept="image/*" style="display: none;">
          <button id="upload-card-button" class="form-button">选择卡片图片</button>
          <button id="reset-card-button" class="form-button"
            style="background-color: #777; margin-top: 10px;">移除卡片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>动态页背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为“动态”页面设置一张独立的背景图，让它与众不同。</p>
          <input type="file" id="feed-bg-input" accept="image/*" style="display: none;">
          <button id="upload-feed-bg-button" class="form-button">选择图片</button>
        </div>
        <button id="reset-feed-bg-button" class="form-button"
          style="background-color: #777; margin-top: 10px;">移除背景</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>小组件救援</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">如果你的吧唧或卡片不小心飞出屏幕找不到了，点这里让它们回家。</p>
          <button id="reset-widgets-position-button" class="form-button"
            style="background-color: #ffc107;">重置小组件位置</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义App图标</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">替换主屏幕上App的默认图标。为了最佳效果，请使用方形、透明背景的图片。</p>
          <div class="settings-group"
            style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
            <h2>自定义表情包</h2>
            <p style="font-size: 0.9rem; color: var(--text-color-light);">
              在这里追加你的专属表情包。每个表情占一行，格式为：<br>
              <b>表情名--图片URL</b><br>
              例如：<br>
              <code>开心--https://example.com/happy.png</code><br>
              <code>难过--https://example.com/sad.gif</code>
            </p>
            <textarea id="custom-stickers-input" rows="8" placeholder="请按指定格式粘贴..."></textarea>
            <button id="save-custom-stickers-button" class="form-button" style="margin-top: 5px;">保存并刷新表情包</button>
          </div>
          <div id="custom-icon-list-container">
          </div>
          <div id="custom-icon-list-container">
          </div>
        </div>
      </div>

    </div>

    <div id="world-book-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-world-book" class="header-button">主屏幕</button>
        <span class="header-title">世界书</span>
        <button id="add-world-book-button" class="header-button add" title="添加新世界书">+</button>
      </div>
      <div class="content" id="world-book-list-container">
      </div>
    </div>

    <div id="world-book-editor-screen" class="screen">
      <div class="header">
        <button id="back-to-world-book-list" class="header-button">返回</button>
        <span id="world-book-editor-title" class="header-title">编辑条目</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-world-book-id">
        <div class="settings-group">
          <h2>设定条目</h2>
          <div class="input-group">
            <label for="world-book-edit-name">条目名称 (Key)</label>
            <input type="text" id="world-book-edit-name" placeholder="例如：我的过去、特殊能力">
          </div>
          <div class="input-group">
            <label for="world-book-edit-content">条目内容 (Value)</label>
            <textarea id="world-book-edit-content" placeholder="输入详细的设定内容..."></textarea>
          </div>
        </div>
        <button id="save-world-book-button" class="form-button">保存条目</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="delete-world-book-button" class="form-button" style="background-color: #dc3545;">删除该条目</button>
        </div>
      </div>
    </div>

    <div id="group-settings-screen" class="screen">
      <div class="header">
        <button id="back-to-chat-from-group-settings" class="header-button">返回</button>
        <span class="header-title">群聊设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>群聊信息</h2>
          <div class="input-group">
            <label for="group-settings-name">群聊名称</label>
            <input type="text" id="group-settings-name">
          </div>
          <div class="avatar-upload-group">
            <label>群头像</label>
            <img id="group-avatar-preview" class="avatar-preview" alt="Group Avatar Preview">
            <input type="file" id="group-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label>群聊背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="group-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="群聊背景预览">
            </div>
            <input type="file" id="group-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="group-settings-bind-user">绑定用户</label>
            <select id="group-settings-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="group-world-book-checkboxes" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="save-group-settings-button" class="form-button">保存设置</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="group-clear-history-button" class="form-button"
            style="background-color: #ffc107; margin-bottom: 10px;">清空聊天记录</button>
          <button id="group-delete-button" class="form-button" style="background-color: #dc3545;">删除并解散群聊</button>
        </div>
      </div>
    </div>

    <div id="music-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-feed" class="header-button">返回</button>
        <span id="friend-circle-title" class="header-title">好友圈</span>
        <div style="display: flex; gap: 5px;">
          <button id="edit-current-circle-button" class="header-button" style="font-size: 1.2rem;">⚙️</button>
          <button id="clear-feed-button" class="header-button" style="color: #dc3545;">清空</button>
          <button id="refresh-feed-button" class="header-button">刷新</button>

        </div>
      </div>
      <div id="user-post-area"
        style="padding: 10px 15px; border-bottom: 1px solid var(--border-color); flex-shrink: 0; background: var(--surface-bg);">
        <div id="user-post-input-container">
          <img id="user-post-avatar" class="char-avatar">
          <div id="user-post-main-area">
            <textarea id="user-post-textarea" rows="3" placeholder="分享你的新鲜事..."></textarea>
            <div id="user-post-attachment-preview"></div>
          </div>
        </div>
        <div id="user-post-toolbar">
          <div class="user-post-actions">
            <button id="user-post-image-button" class="toolbar-button" title="分享图片">🖼️</button>
            <input type="file" id="user-post-image-input" accept="image/*" style="display: none;">
            <button id="user-post-music-button" class="toolbar-button" title="分享音乐">🎵</button>
          </div>
          <button id="user-send-post-button">发送</button>
        </div>
      </div>
      <div id="music-feed-container" class="content" style="padding: 10px;">
      </div>
      <div id="music-player-bar" class="hidden">
        <img id="player-cover" src="">
        <div id="player-info">
          <div id="player-title"></div>
          <div id="player-artist"></div>
        </div>
        <div id="player-controls">
          <button id="player-prev-btn">⏮</button>
          <button id="player-play-pause-btn">▶</button>
          <button id="player-next-btn">⏭</button>
        </div>
      </div>
      <audio id="audio-player"></audio>
    </div>
    <div id="meeting-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-meeting-list" class="header-button">主屏幕</button>
        <span class="header-title">选择见面对象</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="meeting-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="meeting-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-meeting-list">返回</button>
        <span id="meeting-char-name-header" class="header-title">角色</span>
        <button id="toggle-meeting-view-button" class="header-button">切换视角</button>

      </div>
      <div id="meeting-main-content" class="content" style="position: relative; padding: 0;">
        <div id="galgame-overlay-ui">
          <div id="galgame-time">12:00</div>
          <div id="galgame-date">1月1日 星期一</div>
        </div>
        <div id="meeting-scene-view" class="content"
          style="font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif; color: white; text-shadow: 0 1px 3px rgba(0,0,0,0.7);">
        </div>
        <div id="galgame-view-container"
          style="display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; overflow: hidden;">
          <div id="galgame-sprite-container"
            style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; height: 100%; display: flex; align-items: flex-end; justify-content: center;">
            <img id="galgame-sprite" src=""
              style="max-height: 80%; max-width: 80%; object-fit: contain; transition: opacity 0.3s ease;">
          </div>
          <div id="galgame-textbox-container"
            style="position: absolute; bottom: 9%; left: 5%; right: 5%; background: rgba(0, 0, 0, 0.7); border-radius: 10px; padding: 15px; color: white; border-top: 1px solid rgba(255,255,255,0.2); cursor: pointer;">
            <div id="galgame-speaker" style="font-weight: bold; margin-bottom: 10px;">说话人</div>
            <div id="galgame-text" style="line-height: 1.6;">对话内容...</div>
          </div>
        </div>
      </div>
      <div class="chat-input-area">
        <div id="chat-input-wrapper-meeting"> <textarea id="meeting-message-input" placeholder="输入你的行动或对话..." rows="1"
            style="resize: none; overflow-y: auto; flex-grow: 1; border: none; background: transparent; padding: 9px 12px; font-size: .95rem; outline: none; color: var(--text-color);"></textarea>
          <button id="meeting-send-button" title="发送">➤</button>
        </div>
      </div>
    </div>

    <div id="friend-circle-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-circle-list" class="header-button">主屏幕</button>
        <span class="header-title">好友圈</span>
        <button id="add-friend-circle-button" class="header-button add" title="新建好友圈">+</button>
      </div>
      <div id="friend-circle-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="friend-circle-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-edit" class="header-button">返回</button>
        <span id="friend-circle-edit-title" class="header-title">编辑好友圈</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-friend-circle-id">
        <div class="settings-group">
          <h2>好友圈设定</h2>
          <div class="input-group">
            <label for="friend-circle-edit-name">圈子名称</label>
            <input type="text" id="friend-circle-edit-name" placeholder="例如：我的日常">
          </div>
          <div class="input-group">
            <label for="friend-circle-edit-bind-user">绑定的“我”</label>
            <select id="friend-circle-edit-bind-user"></select>
          </div>
        </div>
        <div class="settings-group">
          <h2>选择圈内成员</h2>
          <div id="friend-circle-member-selection"
            style="max-height: 250px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
          </div>
        </div>
        <button id="save-friend-circle-button" class="form-button">保存</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <button id="delete-friend-circle-button" class="form-button"
            style="background-color: #dc3545;">删除该好友圈</button>
        </div>
      </div>
    </div>
    <div id="diary-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-diary-list" class="header-button">主屏幕</button>
        <span class="header-title">交换日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="diary-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-diary-list">返回</button>
        <span id="diary-char-name-header" class="header-title">TA的日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-entries-container" class="content"
        style="padding: 20px; font-family: 'KaiTi', 'STSong', serif; line-height: 1.8;">
      </div>
      <div class="chat-input-area">
        <div id="diary-input-wrapper" style="display: flex; gap: 10px;">
          <input type="text" id="diary-entry-input" placeholder="写下你的日记或批注..." style="flex-grow: 1;">
          <button id="diary-send-button" class="form-button"
            style="width: auto; margin-top: 0; padding: 0 18px;">写好了</button>
          <button id="diary-get-reply-button" class="form-button"
            style="width: auto; margin-top: 0; background-color: #555; padding: 0 18px;">催TA写</button>
        </div>
      </div>
    </div>
    <div id="music-library-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-music-library" class="header-button">主屏幕</button>
        <span class="header-title">音乐库</span>
        <button id="upload-music-button" class="header-button add" title="上传新音乐">+</button>
      </div>
      <div class="content" id="music-library-container">
      </div>
    </div>
    <div id="music-upload-altar-screen" class="screen">
      <div class="header">
        <button id="back-to-library-from-altar" class="header-button">取消</button>
        <span class="header-title">献上音乐</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content" style="padding: 20px; display: flex; flex-direction: column; gap: 15px;">

        <div class="upload-slot" id="altar-slot-audio">
          <span class="slot-icon">🎵</span>
          <span class="slot-label">音频文件 (必需)</span>
          <span class="slot-filename">点击选择 .mp3 或 .flac</span>
        </div>

        <div class="upload-slot" id="altar-slot-cover">
          <span class="slot-icon">🖼️</span>
          <span class="slot-label">封面图片 (可选)</span>
          <span class="slot-filename">点击选择 .jpg 或 .png</span>
        </div>

        <div class="upload-slot" id="altar-slot-info">
          <span class="slot-icon">📄</span>
          <span class="slot-label">歌曲信息 (必需)</span>
          <span class="slot-filename">点击选择 info.txt</span>
        </div>

        <div class="upload-slot" id="altar-slot-lyrics">
          <span class="slot-icon">🎤</span>
          <span class="slot-label">歌词文件 (可选)</span>
          <span class="slot-filename">点击选择 .lrc</span>
        </div>

        <button id="confirm-altar-upload-button" class="form-button" disabled>献上祭品</button>
      </div>
    </div>
    <audio id="audio-player"></audio>

    <audio id="unified-audio-player"></audio>
    <div id="music-widget"
      style="  display: inline-block; width: auto; position: absolute; top: 45%; left: 50%; transform: translateX(-50%); z-index: 50;; padding: 0px;bottom: auto;">
      <div id="music-widget-card">
        <div id="widget-cover-art"></div>

        <div class="widget-content-overlay">
          <div class="widget-info">
            <div id="widget-title">暂无音乐</div>
            <div id="widget-artist">请在动态或聊天中播放</div>
          </div>
          <div id="widget-controls">
            <button id="widget-prev-btn">⏮</button>
            <button id="widget-play-pause-btn">▶</button>
            <button id="widget-next-btn">⏭</button>
          </div>
        </div>
      </div>
    </div>


  </div>
  </div>

  <div id="add-choice-modal" class="choice-modal">
    <div id="add-choice-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="choice-create-character" class="choice-modal-button">创建新角色</button>
      <button id="choice-create-group" class="choice-modal-button">创建新群聊</button>
      <button id="choice-cancel" class="choice-modal-button cancel">取消</button>
    </div>
  </div>


  <div id="transfer-modal" class="choice-modal">
    <div id="transfer-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">转账</h3>
      <div id="transfer-recipient-group" class="input-group" style="margin: 10px 0; display: none;">
        <label for="transfer-recipient-select">转给</label>
        <select id="transfer-recipient-select"></select>
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="transfer-amount-input">金额</label>
        <input type="number" id="transfer-amount-input" placeholder="输入金额">
      </div>
      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-transfer-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认转账</button>
        <button id="cancel-transfer-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="message-action-modal" class="choice-modal">
    <div id="message-action-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="edit-message-button" class="choice-modal-button">编辑消息</button>
      <button id="quote-message-button" class="choice-modal-button">引用</button>
      <button id="delete-message-button" class="choice-modal-button" style="color: #dc3545;">删除消息</button>
      <button id="cancel-action-button" class="choice-modal-button cancel">取消</button>
    </div>
  </div>

  <div id="edit-message-modal" class="choice-modal">
    <div id="edit-message-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">编辑消息</h3>
      <textarea id="edit-message-textarea" style="width: 100%; min-height: 100px; margin: 10px 0;"></textarea>
      <div style="display: flex; gap: 10px; margin-top: 10px;">
        <button id="save-edit-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">保存</button>
        <button id="cancel-edit-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="music-input-modal" class="choice-modal">
    <div id="music-input-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 id="music-input-title" style="margin-top: 0; text-align: center; font-weight: 600;">分享音乐</h3>

      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-song" style="font-size: 0.9rem;">歌名</label>
        <input type="text" id="music-input-song" placeholder="例如：夜曲">
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-artist" style="font-size: 0.9rem;">歌手</label>
        <input type="text" id="music-input-artist" placeholder="例如：周杰伦">
      </div>

      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-music-input" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认</button>
        <button id="cancel-music-input" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="modal-root"
    style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:9999;">
    <div id="modal-mask" style="position:absolute;inset:0;background:rgba(0,0,0,.35);"></div>
    <div id="modal-dialog"
      style="position:relative;background:#fff;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.2);width:80%;max-width:320px;padding:16px;">
      <div id="modal-text" style="font-size:14px;color:#333;line-height:1.5;white-space:pre-wrap;"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:16px;">
        <button id="modal-cancel"
          style="padding:8px 12px;border:1px solid #ddd;border-radius:8px;background:#fff;cursor:pointer;">取消</button>
        <button id="modal-ok"
          style="padding:8px 12px;border:none;border-radius:8px;background:#007bff;color:#fff;cursor:pointer;">确定</button>
      </div>
    </div>
  </div>

  <div id="listen-together-modal" class="choice-modal">
    <div id="listen-together-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <div style="width: 50px;"></div>
        <span class="header-title">选择一首歌，一起听</span>
        <button id="cancel-listen-together" class="header-button" style="min-width: 50px;">取消</button>
      </div>
      <div id="listen-together-song-list" class="content" style="flex-grow: 1; padding: 10px;">
      </div>
    </div>
  </div>

  <div id="toast"
    style="position:fixed;left:50%;bottom:32px;transform:translateX(-50%);background:rgba(0,0,0,.8);color:#fff;padding:8px 12px;border-radius:8px;font-size:12px;display:none;z-index:10000;">
  </div>



  <script>
    const _0x28d250 = _0x32ba; (function (_0x3cc6d3, _0x51bbb8) { const _0x1b6ed2 = _0x32ba, _0x143ab5 = _0x3cc6d3(); while (!![]) { try { const _0x146917 = parseInt(_0x1b6ed2(0x20e)) / 0x1 + parseInt(_0x1b6ed2(0x1a7)) / 0x2 * (parseInt(_0x1b6ed2(0x847)) / 0x3) + -parseInt(_0x1b6ed2(0x3bc)) / 0x4 + -parseInt(_0x1b6ed2(0x63c)) / 0x5 + -parseInt(_0x1b6ed2(0x15f)) / 0x6 + parseInt(_0x1b6ed2(0x43c)) / 0x7 + -parseInt(_0x1b6ed2(0x4bf)) / 0x8 * (-parseInt(_0x1b6ed2(0x731)) / 0x9); if (_0x146917 === _0x51bbb8) break; else _0x143ab5['push'](_0x143ab5['shift']()); } catch (_0x37c08e) { _0x143ab5['push'](_0x143ab5['shift']()); } } }(_0x3052, 0x95c6b)); var _0x5c6c54, _0x2a2ac2 = null; let _0x24d29a = [], _0x461ced = ![], _0x5557df = { 'x': 0x0, 'y': 0x0 }; function _0x32c6de(_0x269ad6) { const _0x467cad = _0x32ba; return (_0x5c6c54?.[_0x467cad(0x24a)] || [])[_0x467cad(0x659)](_0x3b647e => _0x3b647e['id'] === _0x269ad6); } const _0x558ae1 = _0x28d250(0x72f), _0x4e315e = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM5OTkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDJhNC4zOSA0LjM5IDAgMCAtMy4yOC00LjA5TDE1IDIwIj48L3BhdGgPjxjaXJjbGUgY3g9IjEyIiBjeT0iNyIgcj0iNCI+PC9jaXJjbGU+PC9zdmc+', _0x166d38 = _0x28d250(0x451), _0x4025a8 = [{ 'name': _0x28d250(0x7d1), 'url': 'http://sharkpan.xyz/f/8ngsj/ax0fat.jpg' }, { 'name': '崩溃', 'url': _0x28d250(0x7f6) }, { 'name': '生病', 'url': _0x28d250(0x492) }, { 'name': '工作', 'url': _0x28d250(0x5c0) }, { 'name': _0x28d250(0x23a), 'url': _0x28d250(0x627) }, { 'name': _0x28d250(0x4c7), 'url': _0x28d250(0x49d) }, { 'name': _0x28d250(0x15b), 'url': _0x28d250(0x345) }, { 'name': '期待', 'url': 'http://sharkpan.xyz/f/35lse/xmsue5.jpg' }, { 'name': '喜欢', 'url': 'http://sharkpan.xyz/f/55ntj/ul0hkz.jpg' }, { 'name': _0x28d250(0x7b3), 'url': _0x28d250(0x3d9) }, { 'name': _0x28d250(0x517), 'url': _0x28d250(0x359) }, { 'name': '委屈', 'url': _0x28d250(0x7fb) }, { 'name': '加油', 'url': _0x28d250(0x89c) }, { 'name': '对的', 'url': _0x28d250(0x360) }, { 'name': '不满', 'url': _0x28d250(0x772) }, { 'name': _0x28d250(0x2b0), 'url': 'http://sharkpan.xyz/f/qjJT3/kpy33b.jpg' }, { 'name': _0x28d250(0x6aa), 'url': 'http://sharkpan.xyz/f/X7muW/lc8g9h.gif' }, { 'name': '委屈', 'url': _0x28d250(0x769) }, { 'name': '平静', 'url': _0x28d250(0x2ea) }, { 'name': '咬你', 'url': _0x28d250(0x2ff) }, { 'name': _0x28d250(0x1de), 'url': _0x28d250(0x8cd) }, { 'name': '好困', 'url': _0x28d250(0x4db) }, { 'name': '摸鱼', 'url': 'http://sharkpan.xyz/f/nj5Ul/ksdl8n.jpg' }, { 'name': _0x28d250(0x466), 'url': 'http://sharkpan.xyz/f/mjdFW/28n30c.jpg' }, { 'name': '超激动我来了', 'url': _0x28d250(0x6dc) }, { 'name': '被你撩到', 'url': 'http://sharkpan.xyz/f/4adUj/68uj9o.jpg' }, { 'name': _0x28d250(0x82b), 'url': 'http://sharkpan.xyz/f/N0VCv/5rd8br.jpg' }, { 'name': _0x28d250(0x4e9), 'url': _0x28d250(0x7f0) }, { 'name': _0x28d250(0x824), 'url': 'http://sharkpan.xyz/f/xjmCX/zyjzew.jpg' }, { 'name': '好委屈但是不能哭', 'url': _0x28d250(0x47b) }, { 'name': _0x28d250(0x5dd), 'url': _0x28d250(0x661) }, { 'name': '我是垃圾', 'url': _0x28d250(0x5a2) }, { 'name': _0x28d250(0x844), 'url': _0x28d250(0x406) }, { 'name': _0x28d250(0x669), 'url': _0x28d250(0x245) }, { 'name': _0x28d250(0x372), 'url': _0x28d250(0x87f) }, { 'name': '干劲满满', 'url': _0x28d250(0x714) }, { 'name': _0x28d250(0x2fe), 'url': _0x28d250(0x5f4) }, { 'name': _0x28d250(0x336), 'url': _0x28d250(0x170) }, { 'name': _0x28d250(0x407), 'url': _0x28d250(0x4ff) }, { 'name': '有点破防', 'url': _0x28d250(0x4b8) }, { 'name': '快点哄我', 'url': _0x28d250(0x358) }, { 'name': _0x28d250(0x340), 'url': _0x28d250(0x7cf) }, { 'name': _0x28d250(0x5e8), 'url': _0x28d250(0x80b) }, { 'name': _0x28d250(0x449), 'url': 'http://sharkpan.xyz/f/Krwio/1mcclx.jpg' }, { 'name': _0x28d250(0x58d), 'url': _0x28d250(0x62c) }, { 'name': _0x28d250(0x6af), 'url': 'http://sharkpan.xyz/f/YA7T1/th0l79.jpg' }, { 'name': _0x28d250(0x308), 'url': 'http://sharkpan.xyz/f/Qpzu6/3b30r2.jpg' }, { 'name': _0x28d250(0x14f), 'url': _0x28d250(0x590) }, { 'name': _0x28d250(0x60b), 'url': 'http://sharkpan.xyz/f/Wa0cW/w6m7qk.jpg' }, { 'name': _0x28d250(0x323), 'url': 'http://sharkpan.xyz/f/0GKHX/mthvno.jpg' }, { 'name': _0x28d250(0x8b4), 'url': 'http://sharkpan.xyz/f/yrOhN/0yixqd.jpg' }, { 'name': _0x28d250(0x852), 'url': _0x28d250(0x83f) }, { 'name': _0x28d250(0x868), 'url': _0x28d250(0x640) }, { 'name': '等你', 'url': _0x28d250(0x4af) }, { 'name': _0x28d250(0x502), 'url': _0x28d250(0x1c7) }, { 'name': _0x28d250(0x56d), 'url': _0x28d250(0x518) }, { 'name': '喝酒', 'url': _0x28d250(0x696) }, { 'name': _0x28d250(0x672), 'url': _0x28d250(0x841) }, { 'name': '呜呜', 'url': _0x28d250(0x807) }, { 'name': _0x28d250(0x1ef), 'url': _0x28d250(0x5ed) }, { 'name': _0x28d250(0x660), 'url': _0x28d250(0x30a) }, { 'name': '出去玩', 'url': 'http://sharkpan.xyz/f/wyeIq/phhdy2.jpg' }, { 'name': '请看是我', 'url': _0x28d250(0x1d9) }, { 'name': '别这样嘛我哭哭', 'url': 'http://sharkpan.xyz/f/3AGHe/2f8x3x.gif' }], _0x55afb5 = { 'beige': { 'name': _0x28d250(0x22a), 'h': 0x23, 's': 0x19, 'l': 0x50 }, 'mizuiro': { 'name': _0x28d250(0x7c1), 'h': 0xc3, 's': 0x19, 'l': 0x50 }, 'sakura': { 'name': '樱花薄粉', 'h': 0x159, 's': 0x19, 'l': 0x50 }, 'noir': { 'name': _0x28d250(0x890), 'h': 0x104, 's': 0xf, 'l': 0x1e } }; document[_0x28d250(0x73c)]('DOMContentLoaded', () => { const _0xbc3280 = _0x28d250, _0x2a27e1 = document[_0xbc3280(0x5d9)](_0xbc3280(0x820)), _0x57c615 = document['getElementById']('chat-transfer-button'), _0x44c688 = document[_0xbc3280(0x5d9)]('transfer-modal'), _0x45dc15 = document[_0xbc3280(0x5d9)]('transfer-backdrop'), _0x10094f = document[_0xbc3280(0x5d9)]('confirm-transfer-button'), _0x43ac38 = document[_0xbc3280(0x5d9)](_0xbc3280(0x68b)), _0x308c1c = document[_0xbc3280(0x5d9)]('transfer-recipient-group'), _0x18d56d = document[_0xbc3280(0x5d9)](_0xbc3280(0x2d7)), _0x32d1fd = document[_0xbc3280(0x5d9)](_0xbc3280(0x8ba)), _0x52f05c = document[_0xbc3280(0x5d9)](_0xbc3280(0x874)), _0x23d5ea = document[_0xbc3280(0x5d9)](_0xbc3280(0x8c5)), _0x332981 = document[_0xbc3280(0x5d9)]('summarize-modal'), _0x2dac9c = document[_0xbc3280(0x5d9)](_0xbc3280(0x5fe)), _0xb9a74c = document['getElementById']('summary-textarea'), _0x2eb524 = document[_0xbc3280(0x5d9)](_0xbc3280(0x637)), _0x1d25ab = document[_0xbc3280(0x5d9)](_0xbc3280(0x5af)), _0x23843f = document[_0xbc3280(0x5d9)](_0xbc3280(0x392)), _0x339664 = document[_0xbc3280(0x5d9)](_0xbc3280(0x474)), _0x337ec6 = document[_0xbc3280(0x5d9)](_0xbc3280(0x397)), _0x4af1fe = document[_0xbc3280(0x5d9)](_0xbc3280(0x35c)); function _0x40cb8f() { const _0x5c8379 = _0xbc3280; if (_0x5c8379(0x567) !== _0x5c8379(0x567)) { const _0xa18f22 = _0x31267b['characters'][_0x5c8379(0x659)](_0xfb9011 => _0x2a3987[_0x5c8379(0x594)][_0x5c8379(0x87c)](_0xfb9011['id']) && _0xfb9011[_0x5c8379(0x82e)] === _0x5036ae); if (_0xa18f22) _0x58a67c = _0xa18f22['id']; } else { const _0x5d5375 = document['getElementById'](_0x5c8379(0x300)); if (!_0x5d5375) return; const _0x3ef391 = localStorage[_0x5c8379(0x24e)](_0x5c8379(0x7a9)) || '35'; document[_0x5c8379(0x5bf)]['style']['setProperty']('--primary-hue', _0x3ef391), _0x5d5375['value'] = _0x3ef391, _0x5d5375['addEventListener'](_0x5c8379(0x1fa), () => { const _0x194a4a = _0x5c8379; if ('QEiND' === _0x194a4a(0x231)) _0x11462d(_0x48db14['id']); else { const _0xd428a3 = _0x5d5375['value']; document[_0x194a4a(0x5bf)][_0x194a4a(0x3fc)]['setProperty'](_0x194a4a(0x3a1), _0xd428a3), localStorage[_0x194a4a(0x3cd)](_0x194a4a(0x7a9), _0xd428a3), _0x26a3c6(); } }); } } function _0x44d037() { const _0xd2d8eb = _0xbc3280; if (_0xd2d8eb(0x59a) !== _0xd2d8eb(0x59a)) _0x27ae19 = _0x1f3b81[_0xd2d8eb(0x628)]('style'), _0x1e0ea6['id'] = 'live-preview-style', _0x260215[_0xd2d8eb(0x5e4)][_0xd2d8eb(0x2c8)](_0x149af3); else { const _0xdf03b1 = document[_0xd2d8eb(0x5d9)](_0xd2d8eb(0x5bb)); if (!_0xdf03b1) return; const _0x5d5703 = localStorage[_0xd2d8eb(0x24e)](_0xd2d8eb(0x43a)) || '80'; document[_0xd2d8eb(0x5bf)][_0xd2d8eb(0x3fc)][_0xd2d8eb(0x41b)]('--primary-lightness', _0x5d5703 + '%'), _0xdf03b1[_0xd2d8eb(0x5a5)] = _0x5d5703, _0xdf03b1['addEventListener'](_0xd2d8eb(0x1fa), () => { const _0x5d0c9e = _0xd2d8eb, _0x17561d = _0xdf03b1[_0x5d0c9e(0x5a5)]; document[_0x5d0c9e(0x5bf)][_0x5d0c9e(0x3fc)][_0x5d0c9e(0x41b)](_0x5d0c9e(0x38b), _0x17561d + '%'), localStorage[_0x5d0c9e(0x3cd)](_0x5d0c9e(0x43a), _0x17561d), _0x26a3c6(); }); } } function _0x26a3c6() { const _0x2a5f53 = _0xbc3280, _0x440096 = document[_0x2a5f53(0x5d9)](_0x2a5f53(0x1ea)); if (!_0x440096) return; _0x5c6c54[_0x2a5f53(0x778)]['forceWhiteClock'] ? _0x2a5f53(0x47a) !== _0x2a5f53(0x47a) ? (_0x4b7a53['meetingViewMode'] = _0x4975e6['meetingViewMode'] === 'novel' ? _0x2a5f53(0x1f1) : _0x2a5f53(0x38c), _0x3b34f8()) : (_0x440096[_0x2a5f53(0x3fc)]['color'] = _0x2a5f53(0x2b9), _0x440096[_0x2a5f53(0x3fc)]['textShadow'] = _0x2a5f53(0x3aa)) : (_0x440096[_0x2a5f53(0x3fc)][_0x2a5f53(0x279)] = _0x2a5f53(0x201), _0x440096[_0x2a5f53(0x3fc)][_0x2a5f53(0x88e)] = _0x2a5f53(0x860)); } function _0x187633() { const _0x5a6d39 = _0xbc3280; if (_0x5a6d39(0x4f1) !== _0x5a6d39(0x3d3)) { const _0x3706c8 = document[_0x5a6d39(0x5d9)](_0x5a6d39(0x173)); if (!_0x3706c8) return; _0x3706c8[_0x5a6d39(0x27f)] = _0x5c6c54['preferences'][_0x5a6d39(0x8d0)] || ![], _0x3706c8[_0x5a6d39(0x73c)]('change', () => { const _0x33b032 = _0x5a6d39; _0x33b032(0x5cf) !== _0x33b032(0x5cf) ? _0x444d2a[_0x33b032(0x3fc)]['textShadow'] = '' : (_0x5c6c54['preferences'][_0x33b032(0x8d0)] = _0x3706c8[_0x33b032(0x27f)], _0xbd25a6(), _0x26a3c6()); }); } else { _0x4c3156[_0x5a6d39(0x728)] = null, _0x2d031b(), _0x2b396e(![]), _0x1a3c90[_0x5a6d39(0x5d9)]('chat-view-pane')['style'][_0x5a6d39(0x6d5)] = ''; return; } } const _0x32a157 = { 'home': document[_0xbc3280(0x5d9)](_0xbc3280(0x21a)), 'chat': document[_0xbc3280(0x5d9)]('chat-screen'), 'settings': document[_0xbc3280(0x5d9)]('settings-screen'), 'userProfile': document['getElementById']('user-profile-screen'), 'characterEdit': document[_0xbc3280(0x5d9)]('character-edit-screen'), 'groupChatCreate': document[_0xbc3280(0x5d9)](_0xbc3280(0x702)), 'wallpaper': document[_0xbc3280(0x5d9)]('wallpaper-screen'), 'worldBook': document[_0xbc3280(0x5d9)](_0xbc3280(0x3a4)), 'worldBookEditor': document[_0xbc3280(0x5d9)](_0xbc3280(0x68e)), 'groupSettings': document[_0xbc3280(0x5d9)]('group-settings-screen'), 'music': document[_0xbc3280(0x5d9)](_0xbc3280(0x33f)), 'friendCircleList': document[_0xbc3280(0x5d9)](_0xbc3280(0x7f2)), 'friendCircleEdit': document['getElementById']('friend-circle-edit-screen'), 'meetingList': document[_0xbc3280(0x5d9)]('meeting-list-screen'), 'meetingView': document[_0xbc3280(0x5d9)](_0xbc3280(0x52a)), 'userProfileList': document[_0xbc3280(0x5d9)](_0xbc3280(0x4ef)), 'diaryList': document['getElementById'](_0xbc3280(0x48d)), 'diaryView': document['getElementById'](_0xbc3280(0x5d7)), 'musicLibrary': document[_0xbc3280(0x5d9)](_0xbc3280(0x886)), 'musicUploadAltar': document['getElementById']('music-upload-altar-screen') }, _0x345178 = document['getElementById'](_0xbc3280(0x76d)), _0x32b892 = document[_0xbc3280(0x5d9)](_0xbc3280(0x519)), _0x3007a8 = document['getElementById'](_0xbc3280(0x235)), _0x44ab77 = document[_0xbc3280(0x5d9)](_0xbc3280(0x22e)), _0x1dc507 = document[_0xbc3280(0x5d9)](_0xbc3280(0x6d0)), _0x428022 = document[_0xbc3280(0x5d9)](_0xbc3280(0x6d9)), _0x5340f8 = document[_0xbc3280(0x5d9)](_0xbc3280(0x54b)), _0x948f9b = document['getElementById'](_0xbc3280(0x4d0)); document[_0xbc3280(0x5d9)](_0xbc3280(0x81b))[_0xbc3280(0x73c)]('click', async () => { const _0x3d97ea = _0xbc3280, _0x460793 = await _0x458a99(_0x3d97ea(0x2a1)); if (_0x460793) { localStorage[_0x3d97ea(0x5b3)](_0x3d97ea(0x352)), localStorage[_0x3d97ea(0x5b3)](_0x3d97ea(0x2ae)), localStorage['removeItem'](_0x3d97ea(0x762)), localStorage[_0x3d97ea(0x5b3)](_0x3d97ea(0x710)); const _0x671ae = []; for (let _0x2165c4 = 0x0; _0x2165c4 < localStorage[_0x3d97ea(0x794)]; _0x2165c4++) { const _0x2c305e = localStorage[_0x3d97ea(0x4de)](_0x2165c4); _0x2c305e && _0x2c305e['startsWith'](_0x3d97ea(0x805)) && _0x671ae[_0x3d97ea(0x43f)](_0x2c305e); } _0x671ae[_0x3d97ea(0x691)](_0x3e9e86 => localStorage[_0x3d97ea(0x5b3)](_0x3e9e86)), await _0x1c943a(_0x3d97ea(0x4cd), await _0x4ee7e6(_0x3d97ea(0x1f6))), _0x13197e(_0x3d97ea(0x28d)), setTimeout(() => location[_0x3d97ea(0x1f8)](), 0x5dc); } }); const _0x447131 = document['getElementById']('add-choice-modal'), _0x31d3b2 = document[_0xbc3280(0x5d9)](_0xbc3280(0x294)), _0x215167 = document['getElementById'](_0xbc3280(0x2c5)), _0x39d4b9 = document['getElementById'](_0xbc3280(0x1f7)), _0x1256cd = document[_0xbc3280(0x5d9)]('choice-cancel'), _0x3f17d1 = document[_0xbc3280(0x5d9)](_0xbc3280(0x3fd)), _0x31d0a2 = document[_0xbc3280(0x5d9)]('create-group-chat-button'), _0x2f0570 = document['getElementById'](_0xbc3280(0x7e3)), _0x41f6b1 = document['getElementById'](_0xbc3280(0x525)), _0x28e07e = document['getElementById']('app-chat'), _0x380fb0 = document['getElementById']('app-settings'), _0x2d1cc4 = document[_0xbc3280(0x5d9)](_0xbc3280(0x7ba)), _0x520d1f = document[_0xbc3280(0x5d9)](_0xbc3280(0x281)), _0x5d5ad0 = document[_0xbc3280(0x5d9)]('back-to-chat-list'), _0x5bbfc5 = document['getElementById'](_0xbc3280(0x51d)), _0xfb8c6 = document['getElementById'](_0xbc3280(0x4fa)), _0x57edce = document[_0xbc3280(0x5d9)](_0xbc3280(0x3bd)), _0x29dfdd = document['getElementById'](_0xbc3280(0x4f2)), _0x208e3c = document['getElementById'](_0xbc3280(0x6ad)), _0x4adec6 = document[_0xbc3280(0x5d9)](_0xbc3280(0x2f1)), _0x488521 = document[_0xbc3280(0x5d9)](_0xbc3280(0x833)), _0x8cd2df = document['getElementById'](_0xbc3280(0x45c)), _0xf2372d = document[_0xbc3280(0x5d9)](_0xbc3280(0x764)), _0x40b138 = document[_0xbc3280(0x5d9)]('quote-preview-area'), _0x345e7b = document[_0xbc3280(0x5d9)]('quote-preview-sender'), _0x46ed57 = document[_0xbc3280(0x5d9)](_0xbc3280(0x150)), _0x524135 = document['getElementById'](_0xbc3280(0x3df)), _0x5d01cc = document['getElementById'](_0xbc3280(0x482)), _0x577ca2 = document[_0xbc3280(0x5d9)](_0xbc3280(0x7b9)), _0x40f8f5 = document[_0xbc3280(0x5d9)]('chat-sticker-panel'), _0x168981 = document[_0xbc3280(0x5d9)](_0xbc3280(0x747)), _0x21eaa5 = document[_0xbc3280(0x5d9)](_0xbc3280(0x53c)), _0x135afb = document[_0xbc3280(0x5d9)](_0xbc3280(0x1da)), _0x5e4a37 = document['getElementById'](_0xbc3280(0x737)), _0x39c6a0 = document[_0xbc3280(0x5d9)](_0xbc3280(0x703)), _0x271023 = document['getElementById'](_0xbc3280(0x68f)), _0x562bbd = document[_0xbc3280(0x5d9)](_0xbc3280(0x741)), _0x5c88a5 = document[_0xbc3280(0x5d9)](_0xbc3280(0x1e7)), _0x581dea = document[_0xbc3280(0x5d9)]('fetch-models-button'), _0xf46a1f = document[_0xbc3280(0x5d9)]('model-dropdown'), _0x165ae9 = document[_0xbc3280(0x5d9)]('context-lines-per-chat'), _0x149feb = document[_0xbc3280(0x5d9)](_0xbc3280(0x706)), _0x5531e2 = document[_0xbc3280(0x5d9)]('user-avatar-preview'), _0x386369 = document['getElementById'](_0xbc3280(0x6b0)), _0x4313ab = document[_0xbc3280(0x5d9)]('user-persona'), _0x2e0cb0 = document[_0xbc3280(0x5d9)](_0xbc3280(0x520)), _0x15b466 = document[_0xbc3280(0x5d9)](_0xbc3280(0x23d)), _0x4961e5 = document[_0xbc3280(0x5d9)](_0xbc3280(0x651)), _0x4d739e = document[_0xbc3280(0x5d9)](_0xbc3280(0x4e2)), _0x2f857c = document[_0xbc3280(0x5d9)]('char-edit-remark'), _0x3ffd7b = document[_0xbc3280(0x5d9)](_0xbc3280(0x3a3)), _0xc0cad6 = document[_0xbc3280(0x5d9)]('char-edit-avatar-input'), _0x2ca778 = document['getElementById'](_0xbc3280(0x650)), _0x2e508c = document[_0xbc3280(0x5d9)]('save-char-button'), _0x4b349a = document['getElementById'](_0xbc3280(0x812)), _0x2b741a = document[_0xbc3280(0x5d9)]('edit-delete-char-button'); let _0x492e31 = null; const _0x2e9eff = _0xbc3280(0x2d5), _0x4ccd38 = _0xbc3280(0x78b); _0x5c6c54 = { 'characters': [], 'worldBooks': [], 'chats': [], 'userProfiles': [], 'activeUserProfileId': null, 'apiSettings': { 'endpoint': '', 'key': '', 'model': '' }, 'preferences': { 'widgetBgImage': null, 'perChatContextLines': 0x64, 'forceWhiteClock': ![] }, 'activeChatId': null, 'activeMeetingCharId': null, 'isGenerating': ![], 'currentAbortController': null, 'pendingMessageTimers': [], 'conversationHistory': [], 'displayedMessageCount': 0x64, 'activeQuote': null, 'friendCircles': [], 'activeFriendCircleId': null, 'diaries': [], 'activeDiaryCharacterId': null, 'diaries': [], 'activeDiaryCharacterId': null, 'meetingViewMode': _0xbc3280(0x38c), 'activeMeetingScriptQueue': [], 'characterLastScripts': {}, 'musicPlaylist': [], 'currentlyPlayingIndex': -0x1, 'isPlaying': ![], 'pendingPostAttachments': { 'image': null, 'music': null } }; function _0xbd25a6() { const _0x29d896 = _0xbc3280; try { const _0x4e6020 = { 'characters': _0x5c6c54[_0x29d896(0x24a)], 'worldBooks': _0x5c6c54[_0x29d896(0x6bd)], 'chats': _0x5c6c54['chats'], 'userProfile': _0x5c6c54[_0x29d896(0x484)], 'apiSettings': _0x5c6c54[_0x29d896(0x73a)], 'preferences': _0x5c6c54[_0x29d896(0x778)], 'activeChatId': _0x5c6c54[_0x29d896(0x728)], 'diaries': _0x5c6c54['diaries'], 'friendCircles': _0x5c6c54[_0x29d896(0x48c)], 'activeFriendCircleId': _0x5c6c54[_0x29d896(0x266)], 'userProfiles': _0x5c6c54[_0x29d896(0x160)], 'activeUserProfileId': _0x5c6c54[_0x29d896(0x4f0)] }; localStorage[_0x29d896(0x3cd)](_0x29d896(0x21e), JSON['stringify'](_0x4e6020)); } catch (_0x4cd326) { if (_0x29d896(0x8d2) === _0x29d896(0x267)) { const _0x53eb73 = _0x52176c(_0x3b6c2f[_0x29d896(0x2a6)]); return _0x53eb73?.[_0x29d896(0x82e)] || 'Unknown'; } else console[_0x29d896(0x863)](_0x29d896(0x23b), _0x4cd326), _0x13197e('无法保存状态，浏览器可能禁用了存储功能。'); } } function _0x4056b9() { const _0x3da97d = _0xbc3280; if (_0x3da97d(0x6db) === _0x3da97d(0x6db)) { let _0x2b6c33 = null; try { _0x3da97d(0x3b2) === 'bpDvl' ? _0x2b6c33 = localStorage[_0x3da97d(0x24e)](_0x3da97d(0x21e)) : (_0x247029(), _0x465901(![])); } catch (_0xc04fe0) { console['error'](_0x3da97d(0x6f8), _0xc04fe0), _0x13197e(_0x3da97d(0x6ab)); } if (_0x2b6c33) try { const _0x3bbebe = JSON[_0x3da97d(0x5b7)](_0x2b6c33); if (!_0x3bbebe || typeof _0x3bbebe !== _0x3da97d(0x193)) throw new Error(_0x3da97d(0x176)); Array[_0x3da97d(0x1ab)](_0x3bbebe[_0x3da97d(0x24a)]) && ('YNBLE' === _0x3da97d(0x322) ? _0x2966f0(_0x3da97d(0x2bc)) : _0x5c6c54[_0x3da97d(0x24a)] = _0x3bbebe[_0x3da97d(0x24a)][_0x3da97d(0x2ac)](_0x1c44e3 => ({ 'offlineBackground': '', ..._0x1c44e3 }))[_0x3da97d(0x25b)](_0x49730b => _0x49730b && typeof _0x49730b === 'object' && _0x49730b['id'])); Array['isArray'](_0x3bbebe[_0x3da97d(0x6bd)]) && (_0x3da97d(0x848) === _0x3da97d(0x848) ? _0x5c6c54['worldBooks'] = _0x3bbebe[_0x3da97d(0x6bd)] : (_0xb63048(_0x424501, { 'force': !![], 'delayMs': _0x28eab4 }), _0x1b0e2d += 0x1f4)); Array[_0x3da97d(0x1ab)](_0x3bbebe[_0x3da97d(0x592)]) && (_0x3da97d(0x8a0) === _0x3da97d(0x6fd) ? _0x48b3a6[_0x3da97d(0x354)] = _0x508774[_0x3da97d(0x43d)] : _0x5c6c54['diaries'] = _0x3bbebe['diaries']); if (Array[_0x3da97d(0x1ab)](_0x3bbebe[_0x3da97d(0x48c)])) _0x5c6c54['friendCircles'] = _0x3bbebe[_0x3da97d(0x48c)], _0x5c6c54['activeFriendCircleId'] = _0x3bbebe['activeFriendCircleId']; else { if (Array['isArray'](_0x3bbebe[_0x3da97d(0x65c)]) && _0x3bbebe[_0x3da97d(0x65c)][_0x3da97d(0x794)] > 0x0) { console['log'](_0x3da97d(0x4ac)); const _0x3f2a4b = { 'id': _0x3da97d(0x18f) + Date[_0x3da97d(0x7a5)](), 'name': _0x3da97d(0x54e), 'boundUserProfileId': _0x3bbebe['activeUserProfileId'], 'memberCharacterIds': _0x3bbebe[_0x3da97d(0x24a)]['map'](_0x17addc => _0x17addc['id']), 'posts': _0x3bbebe['musicFeed'] }; _0x5c6c54['friendCircles'] = [_0x3f2a4b], _0x5c6c54[_0x3da97d(0x266)] = _0x3f2a4b['id']; } } if (Array[_0x3da97d(0x1ab)](_0x3bbebe['userProfiles'])) { if ('cHeHy' !== _0x3da97d(0x652)) _0x5c6c54[_0x3da97d(0x160)] = _0x3bbebe[_0x3da97d(0x160)], _0x5c6c54[_0x3da97d(0x4f0)] = _0x3bbebe[_0x3da97d(0x4f0)]; else { _0x5b6646[_0x3da97d(0x863)](_0x3da97d(0x736), _0x46ab23), _0x2a2363[_0x3da97d(0x24a)] = [], _0x2d855f[_0x3da97d(0x1ce)] = [], _0x5632bf[_0x3da97d(0x728)] = null; try { _0x3556de[_0x3da97d(0x5b3)](_0x3da97d(0x21e)); } catch (_0x528b7e) { _0x243081[_0x3da97d(0x863)](_0x3da97d(0x5db), _0x528b7e); } } } else { if (_0x3bbebe[_0x3da97d(0x484)]) { console[_0x3da97d(0x384)](_0x3da97d(0x7ea)); const _0x1d4e3a = { 'id': 'user_' + Date[_0x3da97d(0x7a5)](), 'name': _0x3bbebe[_0x3da97d(0x484)][_0x3da97d(0x82e)] || '我', 'avatar': _0x3bbebe[_0x3da97d(0x484)]['avatar'] || _0x4e315e, 'persona': _0x3bbebe[_0x3da97d(0x484)][_0x3da97d(0x854)] || '' }; _0x5c6c54[_0x3da97d(0x160)] = [_0x1d4e3a], _0x5c6c54[_0x3da97d(0x4f0)] = _0x1d4e3a['id']; } } _0x3bbebe[_0x3da97d(0x73a)] && typeof _0x3bbebe[_0x3da97d(0x73a)] === 'object' && (_0x5c6c54[_0x3da97d(0x73a)] = { ..._0x5c6c54[_0x3da97d(0x73a)], ..._0x3bbebe['apiSettings'] }); if (_0x3bbebe['preferences'] && typeof _0x3bbebe['preferences'] === _0x3da97d(0x193)) { if ('UMJtV' === 'LLyAe') return _0x33e665[_0x3da97d(0x5bd)][_0x3da97d(0x2ac)](_0x1fb937 => typeof _0x1fb937 === 'string' ? _0x1fb937 : _0x1fb937?.['content'])[_0x3da97d(0x25b)](_0x2f35e1)['flatMap'](_0x486aba); else _0x5c6c54[_0x3da97d(0x778)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null, ..._0x3bbebe[_0x3da97d(0x778)] }; } else _0x3da97d(0x261) === _0x3da97d(0x261) ? _0x5c6c54['preferences'] = { 'perChatContextLines': 0x64, 'widgetBgImage': null } : _0x2fa59c = _0x4250fd(_0x4ebd89[_0x3da97d(0x594)][0x0]); if (Array['isArray'](_0x3bbebe[_0x3da97d(0x1ce)])) _0x3da97d(0x217) !== 'fPLQU' ? _0x3ef938[_0x3da97d(0x73c)]('click', function () { const _0x3bd768 = { 'id': _0x2aa245['id'], 'url': _0x2e5a8f['playableUrl'] }; _0x285671(this, _0x3bd768); }) : (_0x5c6c54[_0x3da97d(0x1ce)] = _0x3bbebe[_0x3da97d(0x1ce)], _0x5c6c54['activeChatId'] = _0x3bbebe[_0x3da97d(0x728)] || null); else Array[_0x3da97d(0x1ab)](_0x3bbebe[_0x3da97d(0x24a)]) && (console[_0x3da97d(0x384)]('Migrating\x20old\x20data\x20structure\x20to\x20new\x20chat-based\x20structure.'), _0x5c6c54[_0x3da97d(0x1ce)] = _0x3bbebe[_0x3da97d(0x24a)][_0x3da97d(0x2ac)](_0x242cae => ({ 'id': _0x3da97d(0x2e7) + _0x242cae['id'], 'type': 'private', 'participantIds': [_0x242cae['id']] })), _0x3bbebe[_0x3da97d(0x244)] && (_0x5c6c54[_0x3da97d(0x728)] = 'chat_' + _0x3bbebe[_0x3da97d(0x244)]), _0x3bbebe['characters'][_0x3da97d(0x691)](_0x18cfb8 => { const _0x4dcda5 = _0x3da97d; if (_0x4dcda5(0x1a6) === _0x4dcda5(0x2eb)) { const _0x39111e = _0x97fb7a[_0x4dcda5(0x628)](_0x4dcda5(0x172)); _0x39111e[_0x4dcda5(0x63a)] = _0x4dcda5(0x88c), _0x39111e[_0x4dcda5(0x17f)]['id'] = _0x10cae6['id'], _0x39111e['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>' + _0x3fa704['name'] + '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>' + _0x3b3df4['content'][_0x4dcda5(0x35b)](0x0, 0x64) + _0x4dcda5(0x7d5), _0x39111e[_0x4dcda5(0x73c)](_0x4dcda5(0x36d), () => _0x5ee381(_0x430477['id'])), _0x20ee16[_0x4dcda5(0x2c8)](_0x39111e); } else { const _0x5f3508 = _0x4dcda5(0x555) + _0x18cfb8['id'], _0x83b9b5 = 'chatHistory_chat_' + _0x18cfb8['id'], _0x41b940 = localStorage[_0x4dcda5(0x24e)](_0x5f3508); _0x41b940 && (localStorage[_0x4dcda5(0x3cd)](_0x83b9b5, _0x41b940), localStorage['removeItem'](_0x5f3508)); } })); } catch (_0x28d21e) { console[_0x3da97d(0x863)]('Failed\x20to\x20parse\x20state\x20from\x20localStorage,\x20resetting.', _0x28d21e), _0x5c6c54[_0x3da97d(0x24a)] = [], _0x5c6c54[_0x3da97d(0x1ce)] = [], _0x5c6c54[_0x3da97d(0x728)] = null; try { localStorage[_0x3da97d(0x5b3)]('appState'); } catch (_0x18fa4c) { if (_0x3da97d(0x4fe) !== 'RPVbV') console[_0x3da97d(0x863)](_0x3da97d(0x5db), _0x18fa4c); else { _0x5ddb98(_0x3da97d(0x195)); return; } } } let _0x1c8e00 = ![]; if (_0x5c6c54['characters'][_0x3da97d(0x794)] === 0x0) _0x1c8e00 = !![], _0x5c6c54['activeChatId'] = null; else { if (!_0x5c6c54[_0x3da97d(0x1ce)][_0x3da97d(0x659)](_0x2c9d04 => _0x2c9d04['id'] === _0x5c6c54[_0x3da97d(0x728)])) { if (_0x3da97d(0x70b) === _0x3da97d(0x74b)) return { 'type': _0x3da97d(0x4b7), 'name': _0x327346[0x1][_0x3da97d(0x42f)]() }; else _0x5c6c54[_0x3da97d(0x728)] = _0x5c6c54['chats'][0x0]?.['id'] || null; } } return _0xbd25a6(), _0x1c8e00; } else _0x3bc7f3(_0x5f4271['activeFriendCircleId']); } function _0xcef02c() { const _0x2df8ab = _0xbc3280; if (_0x2df8ab(0x6d6) !== _0x2df8ab(0x6d6)) _0x18e5bd['removeItem'](_0x2df8ab(0x352)), _0x15f2e9['removeItem']('cardWidgetState'), _0x471ca3('位置已重置，正在刷新...'), _0x4d11ba(() => _0x2b666c[_0x2df8ab(0x1f8)](), 0x3e8); else { if (!_0x5c6c54[_0x2df8ab(0x728)]) return; try { localStorage[_0x2df8ab(0x3cd)](_0x2df8ab(0x555) + _0x5c6c54[_0x2df8ab(0x728)], JSON[_0x2df8ab(0x79c)](_0x5c6c54['conversationHistory'])); } catch (_0x2f141b) { _0x2df8ab(0x25a) === _0x2df8ab(0x575) ? _0x498d38['classList'][_0x2df8ab(0x821)](_0x2df8ab(0x274)) : (console[_0x2df8ab(0x863)](_0x2df8ab(0x619), _0x2f141b), _0x13197e('无法保存聊天记录。')); } } } function _0x2ec9c2() { const _0x5a79e1 = _0xbc3280; if (!_0x5c6c54[_0x5a79e1(0x728)]) { _0x5c6c54[_0x5a79e1(0x3b6)] = [], _0x1fa1ad(); return; } let _0x93ffa6 = null; try { _0x93ffa6 = localStorage['getItem'](_0x5a79e1(0x555) + _0x5c6c54[_0x5a79e1(0x728)]); } catch (_0x1a8498) { console[_0x5a79e1(0x863)]('Failed\x20to\x20read\x20history\x20for\x20chat\x20' + _0x5c6c54[_0x5a79e1(0x728)], _0x1a8498); } let _0x3800c0 = []; if (_0x93ffa6) { if (_0x5a79e1(0x454) === 'dqlxV') _0x4c0887[_0x5a79e1(0x73c)]('click', () => { const _0x5c9a3f = _0x5a79e1; if (_0xd10dcb['length'] === 0x0) return; _0x2e3d1a = (_0x5a98cf - 0x1 + _0x2a49f9[_0x5c9a3f(0x794)]) % _0x1e3701[_0x5c9a3f(0x794)], _0x48b3a4(_0x573ea7[_0x507656], _0x2cae60); }); else try { if (_0x5a79e1(0x3c1) !== _0x5a79e1(0x601)) { const _0x17d2bf = JSON[_0x5a79e1(0x5b7)](_0x93ffa6); Array[_0x5a79e1(0x1ab)](_0x17d2bf) && (_0x3800c0 = _0x17d2bf['filter'](_0x1cdc5b => _0x1cdc5b && typeof _0x1cdc5b === _0x5a79e1(0x193) && typeof _0x1cdc5b[_0x5a79e1(0x5a8)] === _0x5a79e1(0x6a1) && typeof _0x1cdc5b[_0x5a79e1(0x283)] !== 'undefined')); } else _0x2d4aae(), _0xfd0d2e[_0x5a79e1(0x3b6)] = [], _0x1c7819(); } catch (_0x136d46) { console[_0x5a79e1(0x863)]('Failed\x20to\x20parse\x20history\x20for\x20chat\x20' + _0x5c6c54[_0x5a79e1(0x728)] + ',\x20resetting.', _0x136d46); try { localStorage[_0x5a79e1(0x5b3)](_0x5a79e1(0x555) + _0x5c6c54[_0x5a79e1(0x728)]); } catch (_0x1ea8cf) { console['error'](_0x5a79e1(0x6e5), _0x1ea8cf); } } } _0x5c6c54[_0x5a79e1(0x3b6)] = _0x3800c0, _0x4adec6[_0x5a79e1(0x497)] = ''; if (_0x5c6c54[_0x5a79e1(0x3b6)]) { if (_0x5a79e1(0x761) !== _0x5a79e1(0x761)) { const _0x36224b = new _0x4b438a(); _0x36224b[_0x5a79e1(0x739)] = () => _0x334534(_0x36224b[_0x5a79e1(0x6bf)]), _0x36224b[_0x5a79e1(0x618)] = _0x1e2fa7, _0x36224b[_0x5a79e1(0x26c)](_0x117a0b); } else _0x5c6c54['conversationHistory']['forEach']((_0x44b046, _0x5540de) => _0x51dbdd(_0x44b046, _0x5540de)); } setTimeout(() => { const _0x5bb4f5 = _0x5a79e1; _0x4adec6[_0x5bb4f5(0x354)] = _0x4adec6[_0x5bb4f5(0x43d)]; }, 0x0); } async function _0x3e5637() { const _0x24315b = _0xbc3280, _0x3d8e19 = document[_0x24315b(0x5d9)](_0x24315b(0x21a)); try { let _0x251896 = await _0x2eb454(_0x24315b(0x4cd)); if (!_0x251896) { const _0x957e5f = localStorage[_0x24315b(0x24e)]('customWallpaper'); _0x957e5f && (console[_0x24315b(0x384)]('正在为你搬运旧壁纸到新仓库...'), _0x251896 = await _0x4ee7e6(_0x957e5f), await _0x1c943a(_0x24315b(0x4cd), _0x251896), localStorage['removeItem'](_0x24315b(0x5c6))); } _0x251896 ? (_0x3d8e19[_0x24315b(0x3fc)][_0x24315b(0x6d5)] = 'url(' + URL[_0x24315b(0x78a)](_0x251896) + ')', _0x3d8e19[_0x24315b(0x3fc)]['backgroundSize'] = 'cover', _0x3d8e19[_0x24315b(0x3fc)][_0x24315b(0x186)] = _0x24315b(0x750)) : _0x3d8e19[_0x24315b(0x3fc)]['backgroundImage'] = ''; } catch (_0x452b71) { _0x24315b(0x65e) !== _0x24315b(0x65e) ? _0x4deb85[_0x24315b(0x36d)]() : (console[_0x24315b(0x863)](_0x24315b(0x393), _0x452b71), phoneContainer[_0x24315b(0x3fc)][_0x24315b(0x6d5)] = ''); } } function _0x35fb03() { const _0x40bbab = _0xbc3280; if (_0x40bbab(0x20d) === _0x40bbab(0x20d)) { const _0x5da4cd = localStorage[_0x40bbab(0x24e)](_0x40bbab(0x22d)); _0x5da4cd ? document[_0x40bbab(0x5d9)](_0x40bbab(0x33f))['style'][_0x40bbab(0x41b)](_0x40bbab(0x60f), _0x40bbab(0x64e) + _0x5da4cd + ')') : document['getElementById'](_0x40bbab(0x33f))[_0x40bbab(0x3fc)][_0x40bbab(0x41b)](_0x40bbab(0x60f), _0x40bbab(0x860)); } else try { const _0x108083 = { 'characters': _0x38de64[_0x40bbab(0x24a)], 'worldBooks': _0x14d5de[_0x40bbab(0x6bd)], 'chats': _0x41375f[_0x40bbab(0x1ce)], 'userProfile': _0x496a53[_0x40bbab(0x484)], 'apiSettings': _0x2a9c3a['apiSettings'], 'preferences': _0x450afa[_0x40bbab(0x778)], 'activeChatId': _0x309843[_0x40bbab(0x728)], 'diaries': _0x4ce8e1[_0x40bbab(0x592)], 'friendCircles': _0x591583[_0x40bbab(0x48c)], 'activeFriendCircleId': _0x40d4e9[_0x40bbab(0x266)], 'userProfiles': _0x45f8db[_0x40bbab(0x160)], 'activeUserProfileId': _0xd8646f[_0x40bbab(0x4f0)] }; _0x59f4fb[_0x40bbab(0x3cd)](_0x40bbab(0x21e), _0x2c262c['stringify'](_0x108083)); } catch (_0x48ace2) { _0x749c56[_0x40bbab(0x863)]('Failed\x20to\x20save\x20state\x20to\x20localStorage:', _0x48ace2), _0x46fa50('无法保存状态，浏览器可能禁用了存储功能。'); } } async function _0x5986ef(_0x3564c4) { const _0xd1bbae = _0xbc3280; if (_0xd1bbae(0x5da) !== _0xd1bbae(0x7e6)) try { _0xd1bbae(0x864) === _0xd1bbae(0x864) ? (await _0x1c943a('wallpaper_main', _0x3564c4), await _0x3e5637(), _0x13197e(_0xd1bbae(0x440))) : _0x5a8c93 = _0x3a2895(_0x249e12); } catch (_0x149e1b) { if (_0xd1bbae(0x2bb) === _0xd1bbae(0x89e)) { const _0x3e18be = { 'id': _0xd1bbae(0x169) + _0x30977a[_0xd1bbae(0x7a5)](), 'name': _0x57696c, 'content': _0x4a6cbe }; _0xa8124f[_0xd1bbae(0x6bd)]['push'](_0x3e18be); } else console[_0xd1bbae(0x863)](_0xd1bbae(0x7c9), _0x149e1b), _0x13197e(_0xd1bbae(0x387) + _0x149e1b['message']); } else try { _0x4eea47['setItem'](_0xd1bbae(0x3e4), _0x4e606b['stringify']({ 'playlist': _0x55bf52[_0xd1bbae(0x67a)], 'currentIndex': _0x4362b1[_0xd1bbae(0x5c1)] })); } catch (_0x19f821) { _0x245f9a['error'](_0xd1bbae(0x632), _0x19f821); } } function _0x277dfe(_0x551f4c) { const _0x4e819b = _0xbc3280; if ('VSSKq' !== 'YdHTi') { const _0x268be6 = { 'quotedMessage': null, 'content': _0x551f4c }, _0x162096 = _0x551f4c[_0x4e819b(0x6a9)](/^\[引用\|(.*?)\|(.*?)\]\s*/); return _0x162096 && (_0x4e819b(0x2d4) === _0x4e819b(0x2d4) ? (_0x268be6['quotedMessage'] = { 'sender': _0x162096[0x1][_0x4e819b(0x42f)](), 'content': _0x162096[0x2][_0x4e819b(0x42f)]() }, _0x268be6[_0x4e819b(0x283)] = _0x551f4c[_0x4e819b(0x35b)](_0x162096[0x0][_0x4e819b(0x794)])[_0x4e819b(0x42f)]()) : _0x1d02d7(_0x4e819b(0x61e) + _0x597d52['message'])), _0x268be6; } else { const _0x280d71 = _0x5f6654['getElementById'](_0x4e819b(0x7a4)); if (_0x280d71) _0x280d71[_0x4e819b(0x41a)] = '▶'; } } const _0x325286 = document[_0xbc3280(0x5d9)](_0xbc3280(0x1d7)), _0x3ccb37 = document[_0xbc3280(0x5d9)](_0xbc3280(0x6ac)), _0x50ccf9 = document[_0xbc3280(0x5d9)]('edit-message-button'), _0x43dcf7 = document[_0xbc3280(0x5d9)](_0xbc3280(0x853)), _0x1360c2 = document['getElementById'](_0xbc3280(0x80d)), _0x385042 = document['getElementById'](_0xbc3280(0x6fc)), _0x194de9 = document['getElementById'](_0xbc3280(0x46c)), _0x3c6ed4 = document[_0xbc3280(0x5d9)]('edit-message-backdrop'), _0x313757 = document[_0xbc3280(0x5d9)]('edit-message-textarea'), _0x4a8eab = document[_0xbc3280(0x5d9)](_0xbc3280(0x5a1)), _0x52769a = document[_0xbc3280(0x5d9)]('cancel-edit-button'); let _0x2128f1 = null; function _0x1a2096(_0x3747bc) { const _0x273bdf = _0xbc3280; _0x273bdf(0x70e) !== _0x273bdf(0x32a) ? (_0x2128f1 = _0x3747bc, _0x325286[_0x273bdf(0x7a1)][_0x273bdf(0x821)]('show')) : _0x4765e5['diaries'] = _0x228e98[_0x273bdf(0x592)]; } function _0x465fb7() { const _0x577660 = _0xbc3280; if (_0x577660(0x8d4) !== 'WqViu') { const _0x12a926 = _0x5e2549(_0x4b4597[_0x577660(0x54c)]) || { 'name': '未知' }; let _0x1fab3e = _0x577660(0x6b2) + _0x12a926[_0x577660(0x82e)] + '\x20说：“' + (_0x41a284[_0x577660(0x82f)] || _0x401fa7[_0x577660(0x283)]) + '”'; return _0x26489e[_0x577660(0x443)] === _0x577660(0x388) && (_0x1fab3e += _0x577660(0x6d1) + _0xee6840[_0x577660(0x2ed)] + _0x577660(0x541) + _0x32bfaf[_0x577660(0x381)] + ')'), _0x1fab3e; } else _0x325286[_0x577660(0x7a1)][_0x577660(0x8a2)]('show'); } function _0xcbe6a0() { _0x465fb7(), _0x2128f1 = null; } function _0x199fc7() { const _0x1e4b26 = _0xbc3280; if (_0x2128f1 === null) return; _0x5c6c54[_0x1e4b26(0x3b6)][_0x1e4b26(0x7ee)](_0x2128f1, 0x1), _0xcef02c(), _0x3310d7(), _0xcbe6a0(); } function _0x3b61c2() { const _0x311df4 = _0xbc3280; if (_0x2128f1 === null) return; const _0x3b7cc8 = _0x5c6c54['conversationHistory'][_0x2128f1]; if (!_0x3b7cc8) return; _0x313757[_0x311df4(0x5a5)] = _0x3b7cc8[_0x311df4(0x283)], _0x465fb7(), _0x194de9[_0x311df4(0x7a1)][_0x311df4(0x821)](_0x311df4(0x274)), _0x313757[_0x311df4(0x3d2)](); } function _0x33dcc9() { const _0x1f3d04 = _0xbc3280; if (_0x2128f1 === null) return; const _0x4bfe8f = _0x313757['value'][_0x1f3d04(0x42f)](); if (_0x4bfe8f === '') { _0x213dbf(); return; } const _0x17380d = _0x5c6c54[_0x1f3d04(0x3b6)][_0x2128f1]; _0x17380d && (_0x17380d[_0x1f3d04(0x283)] = _0x4bfe8f, _0xcef02c(), _0x3310d7()), _0x194de9[_0x1f3d04(0x7a1)][_0x1f3d04(0x8a2)](_0x1f3d04(0x274)), _0x2128f1 = null; } function _0x213dbf() { const _0x1fcebc = _0xbc3280; _0x194de9[_0x1fcebc(0x7a1)][_0x1fcebc(0x8a2)](_0x1fcebc(0x274)), _0x2128f1 = null; } _0x3ccb37['addEventListener'](_0xbc3280(0x36d), _0xcbe6a0), _0x1360c2[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0xcbe6a0), _0x43dcf7['addEventListener']('click', _0x199fc7), _0x50ccf9[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x3b61c2), _0x385042[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x40568), _0x524135[_0xbc3280(0x73c)]('click', _0x47f848), _0x4a8eab[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x33dcc9), _0x52769a['addEventListener'](_0xbc3280(0x36d), _0x213dbf), _0x3c6ed4['addEventListener'](_0xbc3280(0x36d), _0x213dbf); function _0x40568() { const _0x3dd62c = _0xbc3280; if (_0x3dd62c(0x673) !== _0x3dd62c(0x673)) return new _0x1a2fdf(_0x3c86bc => { const _0x26bc68 = _0x3dd62c, _0x5465c1 = _0x26bc68(0x674); _0x36d0c3['body'][_0x26bc68(0x559)](_0x26bc68(0x371), _0x5465c1); const _0x7128d = _0x3e6cb1[_0x26bc68(0x5d9)](_0x26bc68(0x427)), _0x1ea83e = _0x524f05[_0x26bc68(0x5d9)](_0x26bc68(0x40b)), _0x3325bb = _0x4e71a1['getElementById'](_0x26bc68(0x5fb)), _0x23495e = _0x4f8f10[_0x26bc68(0x5d9)](_0x26bc68(0x866)), _0x2fa7d9 = _0x7128d[_0x26bc68(0x85e)]('.choice-modal-backdrop'), _0x5c804e = () => { _0x7128d['remove'](), _0x3c86bc(); }; _0x3325bb['onclick'] = () => { _0xb42f7a(_0x1ea83e['value']), _0x5c804e(); }, _0x23495e['onclick'] = _0x5c804e, _0x2fa7d9[_0x26bc68(0x878)] = _0x5c804e; }); else { if (_0x2128f1 === null) return; const _0x322cb7 = _0x5c6c54[_0x3dd62c(0x3b6)][_0x2128f1]; if (!_0x322cb7) return; const _0x570710 = _0x1e26a8(); let _0x490ca4 = '未知'; if (_0x322cb7[_0x3dd62c(0x5a8)] === 'user') _0x490ca4 = _0x5c6c54[_0x3dd62c(0x484)][_0x3dd62c(0x82e)] || '我'; else { const _0x322e73 = _0x322cb7[_0x3dd62c(0x2a6)] || _0x570710?.[_0x3dd62c(0x594)][0x0], _0x50a394 = _0x5a8ee7(_0x322e73); _0x490ca4 = _0x50a394 ? _0x50a394[_0x3dd62c(0x82e)] : '角色'; } let _0x4dfc14 = _0x322cb7[_0x3dd62c(0x283)] || ''; if (_0x322cb7[_0x3dd62c(0x306)]) _0x4dfc14 = _0x3dd62c(0x4b0); if (_0x322cb7[_0x3dd62c(0x4e0)]) _0x4dfc14 = _0x3dd62c(0x729); if (_0x4dfc14[_0x3dd62c(0x794)] > 0x32) _0x4dfc14 = _0x4dfc14[_0x3dd62c(0x35b)](0x0, 0x32) + _0x3dd62c(0x219); _0x5c6c54[_0x3dd62c(0x295)] = { 'sender': _0x490ca4, 'content': _0x4dfc14 }, _0x213bca(), _0xcbe6a0(), _0x488521[_0x3dd62c(0x3d2)](); } } function _0x213bca() { const _0x529dd3 = _0xbc3280; if (_0x529dd3(0x7cc) !== 'EmyZH') { if (!_0x5c6c54[_0x529dd3(0x295)]) return; _0x345e7b[_0x529dd3(0x41a)] = _0x529dd3(0x723) + _0x5c6c54[_0x529dd3(0x295)]['sender'], _0x46ed57[_0x529dd3(0x41a)] = _0x5c6c54[_0x529dd3(0x295)]['content'], _0x40b138[_0x529dd3(0x3fc)][_0x529dd3(0x74d)] = _0x529dd3(0x38f); } else _0x553915['appendChild'](_0x3a7819), _0x5a4e14[_0x529dd3(0x2c8)](_0x61276); } function _0x47f848() { const _0x1c0a1d = _0xbc3280; if (_0x1c0a1d(0x17e) !== _0x1c0a1d(0x17e)) { if (!_0x4761dc) return; _0x5aca85[_0x1c3e31] = _0x37f806, _0x5e523e[_0x577896][_0x1c0a1d(0x85e)](_0x1c0a1d(0x568))['textContent'] = _0x5b668b[_0x1c0a1d(0x82e)], _0xa6215[_0x1a8831][_0x1c0a1d(0x7a1)][_0x1c0a1d(0x821)](_0x1c0a1d(0x460)), _0x5555db(); } else _0x5c6c54[_0x1c0a1d(0x295)] = null, _0x40b138[_0x1c0a1d(0x3fc)][_0x1c0a1d(0x74d)] = 'none'; } function _0x4ed1c4(_0x5b4de9, _0x3c7ecb) { const _0x3e8564 = _0xbc3280, _0x3cb5d6 = document[_0x3e8564(0x5d9)](_0x3e8564(0x81d)); _0x3cb5d6 && (_0x5b4de9 === 'home' ? _0x3cb5d6[_0x3e8564(0x3fc)]['display'] = 'inline-block' : _0x3cb5d6['style'][_0x3e8564(0x74d)] = 'none'); _0x492e31 = _0x3c7ecb || null, Object[_0x3e8564(0x6ce)](_0x32a157)[_0x3e8564(0x691)](_0x4a7b16 => _0x4a7b16[_0x3e8564(0x7a1)][_0x3e8564(0x8a2)](_0x3e8564(0x39d))); if (_0x32a157[_0x5b4de9]) { if ('xdkIM' === _0x3e8564(0x6ea)) { if (_0x76cd85[_0x3e8564(0x4de)] === _0x3e8564(0x46b)) _0x50057d(null); _0x3b780f[_0x3e8564(0x4de)] === _0x3e8564(0x47d) && (_0x36d032[_0x3e8564(0x7ac)](), _0x384472()); } else _0x32a157[_0x5b4de9][_0x3e8564(0x7a1)][_0x3e8564(0x821)](_0x3e8564(0x39d)); } _0x5b4de9 !== _0x3e8564(0x2da) && _0x208e3c[_0x3e8564(0x7a1)][_0x3e8564(0x8a2)]('show-chat-view'); } function _0x5a8240(_0x509261) { const _0x1ac990 = _0xbc3280; _0x509261 ? _0x208e3c['classList']['add'](_0x1ac990(0x5b4)) : _0x208e3c['classList'][_0x1ac990(0x8a2)]('show-chat-view'); } async function _0x11cd8d() { const _0x4e84ed = _0xbc3280; if (_0x4e84ed(0x570) === 'qnZqN') { _0x57edce[_0x4e84ed(0x497)] = ''; for (const _0x3fe860 of _0x5c6c54[_0x4e84ed(0x1ce)]) { const _0x35c10f = document['createElement']('li'); _0x35c10f['className'] = _0x4e84ed(0x362), _0x35c10f[_0x4e84ed(0x17f)]['id'] = _0x3fe860['id']; let _0x2dd5e6 = _0x166d38, _0x47a672 = '群聊', _0x403753 = ''; if (_0x3fe860[_0x4e84ed(0x443)] === 'private') { const _0x585046 = _0x5a8ee7(_0x3fe860[_0x4e84ed(0x594)][0x0]); if (_0x585046) { if (_0x4e84ed(0x292) === _0x4e84ed(0x5f8)) { _0x25fde4(_0x4e84ed(0x77a)); return; } else _0x2dd5e6 = _0x585046[_0x4e84ed(0x41e)] || _0x166d38, _0x47a672 = _0x585046['name'] || _0x4e84ed(0x5de), _0x403753 = _0x585046['remark'] || '私聊'; } else { if (_0x4e84ed(0x58c) === 'dRGXD') _0x47a672 = _0x4e84ed(0x4fc), _0x403753 = '错误：找不到角色'; else { const _0x5f2fed = { 'id': _0x4e84ed(0x18f) + _0x46b812[_0x4e84ed(0x7a5)](), 'name': _0x4f875c, 'boundUserProfileId': _0x27642f, 'memberCharacterIds': _0x3f8786, 'posts': [] }; _0x5f69f6[_0x4e84ed(0x48c)][_0x4e84ed(0x43f)](_0x5f2fed); } } } else { if (_0x4e84ed(0x891) !== _0x4e84ed(0x85f)) { _0x47a672 = _0x3fe860['name'] || _0x4e84ed(0x7e2), _0x403753 = _0x3fe860[_0x4e84ed(0x594)][_0x4e84ed(0x794)] + '\x20个成员'; const _0x2224b8 = await _0x2eb454('group_avatar_' + _0x3fe860['id']); if (_0x2224b8) _0x2dd5e6 = URL[_0x4e84ed(0x78a)](_0x2224b8); } else { const _0x2bf85d = _0x308876['author'] === 'user' ? _0x436c56[_0x4e84ed(0x82e)] : _0x27d279(_0x55748c['author'])[_0x4e84ed(0x82e)]; return _0x4e84ed(0x35f) + new _0x188e80(_0x1cc58c[_0x4e84ed(0x5c5)])[_0x4e84ed(0x4b6)]() + ']\x20' + _0x2bf85d + _0x4e84ed(0x1a3) + _0x436070[_0x4e84ed(0x283)]; } } _0x35c10f[_0x4e84ed(0x497)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + _0x2dd5e6 + _0x4e84ed(0x7ab) + _0x47a672 + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>' + _0x403753 + _0x4e84ed(0x42d), _0x35c10f['querySelector'](_0x4e84ed(0x607))[_0x4e84ed(0x73c)]('click', () => { _0x5ef958(_0x3fe860['id']), _0x5a8240(!![]); }), _0x57edce[_0x4e84ed(0x2c8)](_0x35c10f); } } else _0x5d0539(), _0x55cfd6(_0x4e84ed(0x2da), _0x4e84ed(0x402)); } function _0xbafe7c() { const _0x5776a4 = _0xbc3280, _0x22122e = document['getElementById'](_0x5776a4(0x546)); _0x22122e['innerHTML'] = ''; const _0x247e08 = _0x5c6c54['characters']['filter'](_0x54803d => _0x5c6c54[_0x5776a4(0x1ce)][_0x5776a4(0x654)](_0x517ce8 => _0x517ce8['type'] === _0x5776a4(0x77d) && _0x517ce8[_0x5776a4(0x594)][_0x5776a4(0x87c)](_0x54803d['id']))); if (_0x247e08[_0x5776a4(0x794)] === 0x0) { _0x22122e[_0x5776a4(0x497)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>'; return; } _0x247e08[_0x5776a4(0x691)](_0x1507ee => { const _0x396002 = _0x5776a4; if (_0x396002(0x894) !== 'zDMUx') { const _0x4613f0 = _0x4e013a(_0x2cd8ea[_0x396002(0x594)][0x0]); return _0x4613f0?.[_0x396002(0x82e)] || 'AI'; } else { const _0x5b72e8 = document[_0x396002(0x628)]('li'); _0x5b72e8[_0x396002(0x63a)] = _0x396002(0x362), _0x5b72e8['dataset'][_0x396002(0x86f)] = _0x1507ee['id'], _0x5b72e8[_0x396002(0x497)] = _0x396002(0x476) + (_0x1507ee[_0x396002(0x41e)] || _0x166d38) + _0x396002(0x87b) + _0x1507ee['name'] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>' + (_0x1507ee[_0x396002(0x7f8)] || '私聊') + _0x396002(0x7f4), _0x5b72e8[_0x396002(0x73c)](_0x396002(0x36d), () => { _0x59107f(_0x1507ee['id']); }), _0x22122e[_0x396002(0x2c8)](_0x5b72e8); } }); } async function _0x59107f(_0x5f508f) { const _0x2e75f1 = _0xbc3280; if (_0x2e75f1(0x6e1) !== 'jzZfo') { const _0x125703 = _0x5a8ee7(_0x5f508f); if (!_0x125703) return; document[_0x2e75f1(0x5d9)](_0x2e75f1(0x85d))['src'] = '', _0x5c6c54[_0x2e75f1(0x251)] = _0x5f508f; const _0x17bd4e = _0x5c6c54['chats'][_0x2e75f1(0x659)](_0xbd0c6c => _0xbd0c6c[_0x2e75f1(0x443)] === 'private' && _0xbd0c6c[_0x2e75f1(0x594)][_0x2e75f1(0x87c)](_0x5f508f)); _0x17bd4e ? (_0x5c6c54['activeChatId'] = _0x17bd4e['id'], _0xbd25a6(), _0x2ec9c2(), _0x149c12(_0x5f508f)) : _0x2e75f1(0x152) !== _0x2e75f1(0x152) ? _0x2ad6fa(_0x2e75f1(0x2da), 'characterEdit') : _0x5c6c54['conversationHistory'] = []; document[_0x2e75f1(0x5d9)](_0x2e75f1(0x79b))['textContent'] = _0x125703['name']; const _0x43ef21 = document[_0x2e75f1(0x5d9)](_0x2e75f1(0x516)); try { if ('TBJhD' === _0x2e75f1(0x704)) { const _0x533881 = await _0x2eb454(_0x2e75f1(0x429) + _0x5f508f); _0x533881 ? (_0x43ef21[_0x2e75f1(0x3fc)][_0x2e75f1(0x6d5)] = 'url(\x27' + URL[_0x2e75f1(0x78a)](_0x533881) + '\x27)', _0x43ef21[_0x2e75f1(0x3fc)][_0x2e75f1(0x66d)] = _0x2e75f1(0x7d9), _0x43ef21['style']['backgroundPosition'] = 'center') : _0x2e75f1(0x6b5) === _0x2e75f1(0x6ed) ? _0x341d8a[_0x2e75f1(0x778)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null, ..._0x476afd[_0x2e75f1(0x778)] } : _0x43ef21['style']['backgroundImage'] = _0x2e75f1(0x860); } else _0x2854cc[_0x2e75f1(0x594)] = _0x2dc065[_0x2e75f1(0x594)][_0x2e75f1(0x25b)](_0xc38882 => _0xc38882 !== _0x434299); } catch (_0x22af7b) { _0x2e75f1(0x408) !== _0x2e75f1(0x408) ? (_0x58493a[_0x2e75f1(0x443)] = 'music', _0x146e3d['assign'](_0x576d8e, _0x5c8109)) : (console[_0x2e75f1(0x863)](_0x2e75f1(0x403) + _0x5f508f + ':', _0x22af7b), _0x43ef21['style'][_0x2e75f1(0x6d5)] = 'none'); } _0x102d5d(), _0x237e6c(); if (_0x19f531) clearInterval(_0x19f531); _0x10409c(), _0x19f531 = setInterval(_0x10409c, 0x2710), _0x4ed1c4('meetingView', _0x2e75f1(0x4ab)); } else _0x38dfcf[_0x2e75f1(0x5b3)](_0x2e75f1(0x555) + _0x2f701e); } function _0x237e6c() { const _0x3443d7 = _0xbc3280, _0x12aee4 = document[_0x3443d7(0x5d9)]('meeting-scene-view'); _0x12aee4[_0x3443d7(0x497)] = ''; const _0x113378 = _0x12aee4[_0x3443d7(0x85e)](_0x3443d7(0x626)); if (_0x113378) _0x113378[_0x3443d7(0x8a2)](); _0x5c6c54[_0x3443d7(0x3b6)] && _0x5c6c54[_0x3443d7(0x3b6)][_0x3443d7(0x691)]((_0x700162, _0x3aae80) => { const _0x4e1723 = _0x3443d7; if (_0x4e1723(0x682) !== 'xNTel') { if (!_0x700162['isOffline'] || _0x700162[_0x4e1723(0x5a8)] === _0x4e1723(0x523)) return; const _0x5d1a36 = document[_0x4e1723(0x628)]('p'); _0x5d1a36[_0x4e1723(0x17f)][_0x4e1723(0x7a6)] = _0x3aae80; const _0x4c09e0 = _0x700162['content'][_0x4e1723(0x41f)](/\n/g, _0x4e1723(0x31d)); let _0x5cdb21 = '', _0x2c1b76 = ''; const _0x4ae3c8 = _0x4771d7(_0x5c6c54[_0x4e1723(0x728)]); if (_0x700162['role'] === _0x4e1723(0x845)) _0x5cdb21 = _0x4ae3c8['name'] || '我', _0x2c1b76 = 'speaker-user'; else { if (_0x700162[_0x4e1723(0x5a8)] === _0x4e1723(0x535)) { if (_0x4e1723(0x29a) !== _0x4e1723(0x5f5)) { const _0x3a1a84 = _0x5a8ee7(_0x700162['senderId'] || _0x5c6c54[_0x4e1723(0x251)]); _0x5cdb21 = _0x3a1a84?.['name'] || '角色', _0x2c1b76 = _0x4e1723(0x8cc); } else _0x44694c[_0x4e1723(0x19d)] = { ..._0x1c68a0[_0x4e1723(0x295)] }; } } _0x5d1a36[_0x4e1723(0x3fc)][_0x4e1723(0x5f6)] = _0x4e1723(0x3cc), _0x5d1a36['style'][_0x4e1723(0x6a4)] = _0x4e1723(0x898), _0x5d1a36[_0x4e1723(0x3fc)]['borderRadius'] = _0x4e1723(0x344), _0x5d1a36[_0x4e1723(0x3fc)]['marginBottom'] = _0x4e1723(0x36b), _0x5cdb21 ? _0x5d1a36[_0x4e1723(0x497)] = _0x4e1723(0x504) + _0x2c1b76 + _0x4e1723(0x455) + (_0x2c1b76 === _0x4e1723(0x828) ? _0x4e1723(0x44f) : _0x4e1723(0x56b)) + ';\x22>' + _0x5cdb21 + _0x4e1723(0x36e) + _0x4c09e0 : (_0x5d1a36['className'] = 'narrator', _0x5d1a36[_0x4e1723(0x3fc)][_0x4e1723(0x31c)] = _0x4e1723(0x30f), _0x5d1a36[_0x4e1723(0x3fc)]['color'] = '#d1d5db', _0x5d1a36[_0x4e1723(0x497)] = _0x4c09e0), _0x12aee4[_0x4e1723(0x2c8)](_0x5d1a36); } else _0xc327f9[_0x4e1723(0x7a1)][_0x4e1723(0x8a2)](_0x4e1723(0x1fd), _0x4e1723(0x780)), _0x26c79b[_0x4e1723(0x7a1)][_0x4e1723(0x8a2)]('is-entering-from-right'), _0x275ed8[_0x4e1723(0x4d9)] = _0x182459, _0x15662e(), _0x28ae8f['isAnimatingDiary'] = ![]; }); if (_0x5c6c54[_0x3443d7(0x75c)]) { let _0x13e830 = _0x12aee4[_0x3443d7(0x85e)](_0x3443d7(0x2ec)); !_0x13e830 && (_0x13e830 = document[_0x3443d7(0x628)](_0x3443d7(0x172)), _0x13e830[_0x3443d7(0x63a)] = _0x3443d7(0x643), _0x13e830[_0x3443d7(0x41a)] = _0x3443d7(0x783), _0x13e830[_0x3443d7(0x3fc)][_0x3443d7(0x5f6)] = _0x3443d7(0x3cc), _0x13e830[_0x3443d7(0x3fc)][_0x3443d7(0x6a4)] = '15px\x2020px', _0x13e830[_0x3443d7(0x3fc)][_0x3443d7(0x390)] = _0x3443d7(0x344), _0x12aee4[_0x3443d7(0x2c8)](_0x13e830)); } const _0x17ded1 = document[_0x3443d7(0x628)](_0x3443d7(0x172)); _0x17ded1['id'] = 'message-anchor', _0x12aee4['appendChild'](_0x17ded1), setTimeout(() => { const _0x401956 = _0x3443d7; _0x17ded1[_0x401956(0x437)]({ 'behavior': 'auto', 'block': 'end' }); }, 0x32); } function _0x3310d7() { const _0x5e681a = _0xbc3280; if (_0x5e681a(0x7d6) !== 'LgXaj') { const _0x24c4c4 = document[_0x5e681a(0x85e)](_0x5e681a(0x56a)); if (!_0x24c4c4) return; _0x24c4c4['id'] === _0x5e681a(0x52a) ? _0x237e6c() : _0x1fa1ad(); } else _0x2c91ed[_0x5e681a(0x1d4)] = !![]; } function _0x1fa1ad() { const _0xeb0792 = _0xbc3280; if (_0xeb0792(0x1c3) !== _0xeb0792(0x2c1)) { const _0x7d8ef1 = _0x5c6c54[_0xeb0792(0x3b6)][_0xeb0792(0x25b)](_0x1446e5 => !_0x1446e5['isOffline'] && _0x1446e5[_0xeb0792(0x5a8)] !== _0xeb0792(0x523)); if (_0x7d8ef1[_0xeb0792(0x794)] > _0x5c6c54['displayedMessageCount']) { if (_0xeb0792(0x830) === _0xeb0792(0x7a3)) { _0x1da89e['value'] = _0xeb0792(0x602); return; } else { let _0x21ed78 = _0x4adec6[_0xeb0792(0x85e)]('.load-more-btn'); if (!_0x21ed78) { if (_0xeb0792(0x50e) !== 'PBBhQ') { const _0x48025d = _0x1d07f6[_0xeb0792(0x628)](_0xeb0792(0x172)); _0x48025d[_0xeb0792(0x63a)] = _0xeb0792(0x32c), _0x48025d['innerHTML'] = _0x2e2be1, _0x44dc0e === 'user' ? (_0x28504c[_0xeb0792(0x2c8)](_0x48025d), _0x3f7b53['appendChild'](_0x1334d0)) : (_0x4e0f8e['appendChild'](_0x37d0e0), _0x50ca8c[_0xeb0792(0x2c8)](_0x48025d)); } else _0x21ed78 = document[_0xeb0792(0x628)](_0xeb0792(0x5d1)), _0x21ed78['textContent'] = '加载更多聊天记录', _0x21ed78['className'] = _0xeb0792(0x6df), _0x21ed78[_0xeb0792(0x3fc)][_0xeb0792(0x33e)] = _0xeb0792(0x57d), _0x21ed78[_0xeb0792(0x3fc)]['margin'] = '10px\x20auto', _0x21ed78[_0xeb0792(0x3fc)][_0xeb0792(0x6a4)] = _0xeb0792(0x385), _0x21ed78[_0xeb0792(0x878)] = () => { const _0x52850b = _0xeb0792; if (_0x52850b(0x3ea) !== _0x52850b(0x511)) { const _0x1266d6 = _0x4adec6, _0x57c443 = _0x1266d6[_0x52850b(0x43d)], _0x1e7eb5 = _0x1266d6[_0x52850b(0x354)]; _0x5c6c54[_0x52850b(0x758)] += 0x64, _0x1fa1ad(), requestAnimationFrame(() => { const _0x475aa0 = _0x52850b; if (_0x475aa0(0x6cc) !== _0x475aa0(0x6cc)) _0x64a7d3(), _0x276fcd[_0x475aa0(0x758)] = 0x64; else { const _0x3bcc92 = _0x1266d6[_0x475aa0(0x43d)]; _0x1266d6[_0x475aa0(0x354)] = _0x1e7eb5 + (_0x3bcc92 - _0x57c443); } }); } else _0x30a8fc('图片预览失败:\x20' + _0x274e67[_0x52850b(0x1a4)]); }, _0x4adec6[_0xeb0792(0x3cb)] ? _0x4adec6[_0xeb0792(0x343)](_0x21ed78, _0x4adec6[_0xeb0792(0x3cb)]) : _0x4adec6[_0xeb0792(0x2c8)](_0x21ed78); } } } else { const _0x58e46e = _0x4adec6['querySelector'](_0xeb0792(0x379)); if (_0x58e46e) _0x58e46e[_0xeb0792(0x8a2)](); } Array[_0xeb0792(0x485)](_0x4adec6[_0xeb0792(0x326)])['forEach'](_0x263930 => { const _0x4ff56d = _0xeb0792; !_0x263930[_0x4ff56d(0x7a1)][_0x4ff56d(0x153)]('load-more-btn') && (_0x4ff56d(0x775) === _0x4ff56d(0x775) ? _0x263930[_0x4ff56d(0x8a2)]() : (_0x58400c[_0x4ff56d(0x2c8)](_0x3b2be1), _0x3ea5f4[_0x4ff56d(0x2c8)](_0x384d9d))); }); const _0x17d55f = _0x7d8ef1[_0xeb0792(0x60e)](-_0x5c6c54[_0xeb0792(0x758)]); _0x17d55f[_0xeb0792(0x691)](_0x51ef24 => { const _0x4e8de4 = _0xeb0792, _0x19c3b7 = _0x5c6c54[_0x4e8de4(0x3b6)]['indexOf'](_0x51ef24); _0x19c3b7 > -0x1 && (_0x4e8de4(0x226) !== 'oSrTk' ? _0x51dbdd(_0x51ef24, _0x19c3b7) : (_0x5e7098 = { 'characterId': _0x370e2d, 'entries': [] }, _0x58bdd4[_0x4e8de4(0x592)][_0x4e8de4(0x43f)](_0x4c3368))); }); if (_0x5c6c54['isGenerating']) { let _0x12cb1f = _0x4adec6[_0xeb0792(0x85e)](_0xeb0792(0x2ec)); !_0x12cb1f && (_0x12cb1f = document[_0xeb0792(0x628)](_0xeb0792(0x172)), _0x12cb1f['className'] = _0xeb0792(0x643), _0x12cb1f[_0xeb0792(0x41a)] = _0xeb0792(0x228), _0x4adec6['appendChild'](_0x12cb1f)); } _0x17d55f[_0xeb0792(0x794)] <= _0x5c6c54[_0xeb0792(0x758)] && setTimeout(() => { const _0x3d0055 = _0xeb0792; _0x4adec6[_0x3d0055(0x354)] = _0x4adec6[_0x3d0055(0x43d)]; }, 0x0); } else _0xd1d77f[_0xeb0792(0x41a)] = _0x570554[_0xeb0792(0x28b)] === 'narrator' ? '旁白' : _0x272b1e['speaker'], _0x4d7bfb['textContent'] = _0x31c4f8[_0xeb0792(0x475)], _0x30ab6d[_0xeb0792(0x28b)] === _0x30409a[_0xeb0792(0x82e)] ? _0x3c6726(_0x278327, _0x3ed75a['emotion']) : _0x398241(_0x157682, _0xeb0792(0x63f)); } function _0x51dbdd(_0x36411f, _0x341788) { const _0x4c165c = _0xbc3280, { role: _0x2dca4f, content: _0x3fa7c5, displayUrl: _0x58ce91, image: _0x28baaf, senderId: _0x32b2e2 } = _0x36411f, _0x5d8d5a = _0x2dca4f === _0x4c165c(0x535) ? 'ai' : _0x2dca4f, _0x410222 = _0x1e26a8(), _0x30cd06 = document[_0x4c165c(0x628)](_0x4c165c(0x172)); _0x30cd06[_0x4c165c(0x7a1)][_0x4c165c(0x821)](_0x4c165c(0x7b1), _0x5d8d5a), _0x30cd06[_0x4c165c(0x17f)][_0x4c165c(0x7a6)] = _0x341788; const _0x4ae437 = document[_0x4c165c(0x628)](_0x4c165c(0x172)); _0x4ae437[_0x4c165c(0x63a)] = _0x4c165c(0x45d); const _0x274d03 = document[_0x4c165c(0x628)](_0x4c165c(0x62a)); _0x274d03[_0x4c165c(0x7a1)][_0x4c165c(0x821)](_0x4c165c(0x41e), _0x2dca4f + _0x4c165c(0x571)); let _0x35a4e7 = ''; if (_0x2dca4f === _0x4c165c(0x845)) { if (_0x4c165c(0x4a0) !== 'myLfH') _0xbfbed6[_0x4c165c(0x3cd)](_0x4c165c(0x88a), _0x554d59[_0x4c165c(0x79c)](_0x51a017)), _0x12e74e(_0x4c165c(0x49a)), _0x95538d(() => _0x463827[_0x4c165c(0x1f8)](), 0x5dc); else { const _0x40da34 = _0x4771d7(_0x5c6c54[_0x4c165c(0x728)]); _0x35a4e7 = _0x40da34[_0x4c165c(0x41e)] || _0x4e315e; } } else { if ('shSdE' === 'shSdE') { _0x35a4e7 = _0x166d38; let _0x5f29ef = null; if (_0x410222?.[_0x4c165c(0x443)] === _0x4c165c(0x77d)) _0x5f29ef = _0x5a8ee7(_0x410222['participantIds'][0x0]); else _0x410222?.['type'] === _0x4c165c(0x441) && _0x32b2e2 && (_0x5f29ef = _0x5a8ee7(_0x32b2e2)); _0x5f29ef?.[_0x4c165c(0x41e)] && (_0x35a4e7 = _0x5f29ef[_0x4c165c(0x41e)]); } else _0x513fa8['style'][_0x4c165c(0x74d)] = 'flex', _0x3848bc(() => _0x37f1d9[_0x4c165c(0x7a1)][_0x4c165c(0x821)](_0x4c165c(0x274)), 0xa); } _0x274d03[_0x4c165c(0x161)] = _0x35a4e7, _0x274d03[_0x4c165c(0x2d2)] = _0x2dca4f + _0x4c165c(0x1ff); const _0x1a7feb = _0x3fa7c5 && _0x3fa7c5[_0x4c165c(0x42f)]()[_0x4c165c(0x380)](_0x4c165c(0x2a5)) && _0x3fa7c5[_0x4c165c(0x42f)]()[_0x4c165c(0x301)](_0x4c165c(0x61f)); if (_0x1a7feb) { const _0x55faed = document['createElement'](_0x4c165c(0x172)); _0x55faed['className'] = _0x4c165c(0x32c), _0x55faed[_0x4c165c(0x497)] = _0x3fa7c5; if (_0x5d8d5a === _0x4c165c(0x845)) { if (_0x4c165c(0x2d6) === _0x4c165c(0x2d6)) _0x4ae437['appendChild'](_0x55faed), _0x4ae437[_0x4c165c(0x2c8)](_0x274d03); else return '昨天\x20' + _0xf8ff36; } else _0x4c165c(0x2d0) !== _0x4c165c(0x365) ? (_0x4ae437[_0x4c165c(0x2c8)](_0x274d03), _0x4ae437['appendChild'](_0x55faed)) : _0x4be1b0['push'](_0x34f1d5); } else { if (_0x4c165c(0x63d) !== _0x4c165c(0x45a)) { const _0x1b1ea0 = document[_0x4c165c(0x628)](_0x4c165c(0x172)); _0x1b1ea0[_0x4c165c(0x7a1)]['add'](_0x4c165c(0x1a4), _0x5d8d5a); if (_0x410222?.[_0x4c165c(0x443)] === _0x4c165c(0x77d)) { const _0x2b5979 = _0x410222[_0x4c165c(0x594)][0x0]; _0x1b1ea0[_0x4c165c(0x7a1)][_0x4c165c(0x821)](_0x4c165c(0x473) + _0x2b5979); } if (_0x36411f[_0x4c165c(0x19d)]) { if ('xbceP' !== _0x4c165c(0x514)) { const _0x3b8a34 = document[_0x4c165c(0x628)]('div'); _0x3b8a34[_0x4c165c(0x63a)] = 'quoted-message-in-bubble'; const _0x97dd2b = document[_0x4c165c(0x628)](_0x4c165c(0x172)); _0x97dd2b[_0x4c165c(0x63a)] = 'quoted-sender', _0x97dd2b[_0x4c165c(0x41a)] = _0x36411f[_0x4c165c(0x19d)][_0x4c165c(0x259)]; const _0x5090a8 = document[_0x4c165c(0x628)](_0x4c165c(0x172)); _0x5090a8[_0x4c165c(0x63a)] = _0x4c165c(0x1fc), _0x5090a8['textContent'] = _0x36411f[_0x4c165c(0x19d)]['content'], _0x3b8a34[_0x4c165c(0x2c8)](_0x97dd2b), _0x3b8a34[_0x4c165c(0x2c8)](_0x5090a8), _0x1b1ea0[_0x4c165c(0x2c8)](_0x3b8a34); } else _0x20590c['type'] === _0x4c165c(0x441) && (_0x5a022a[_0x4c165c(0x594)] = _0x9618b5[_0x4c165c(0x594)][_0x4c165c(0x25b)](_0x410310 => _0x410310 !== _0x135ebe)); } if (_0x58ce91) { _0x1b1ea0[_0x4c165c(0x7a1)][_0x4c165c(0x821)](_0x4c165c(0x4b7)); const _0x1caef8 = document[_0x4c165c(0x628)](_0x4c165c(0x62a)); _0x1caef8[_0x4c165c(0x161)] = _0x58ce91, _0x1caef8[_0x4c165c(0x7a1)]['add'](_0x4c165c(0x6c8)), _0x1b1ea0['appendChild'](_0x1caef8); } else { if (_0x36411f['image'] || _0x36411f[_0x4c165c(0x2f3)]) { if (_0x4c165c(0x3b4) !== _0x4c165c(0x3b4)) _0xc66226[_0x4c165c(0x7a1)][_0x4c165c(0x821)](_0x4c165c(0x1fd)); else { _0x1b1ea0[_0x4c165c(0x7a1)][_0x4c165c(0x821)](_0x4c165c(0x4e0)); const _0x4635ec = document['createElement']('img'); _0x4635ec[_0x4c165c(0x7a1)][_0x4c165c(0x821)](_0x4c165c(0x1d5)), _0x1b1ea0['appendChild'](_0x4635ec); _0x36411f[_0x4c165c(0x4e0)] ? _0x4635ec[_0x4c165c(0x161)] = _0x36411f[_0x4c165c(0x4e0)] : (_0x4635ec[_0x4c165c(0x161)] = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', _0x2eb454(_0x36411f[_0x4c165c(0x2f3)])[_0x4c165c(0x2b1)](_0x35e9db => { const _0x31b813 = _0x4c165c; if (_0x31b813(0x218) === _0x31b813(0x658)) _0x7471fd('有\x20' + _0x55709f + '\x20行格式不对，被我无视了。'); else { if (_0x35e9db) { const _0xc25542 = URL['createObjectURL'](_0x35e9db); _0x4635ec[_0x31b813(0x161)] = _0xc25542, _0x4635ec[_0x31b813(0x792)] = () => { const _0x1a6c6c = _0x31b813; if (_0x1a6c6c(0x273) !== _0x1a6c6c(0x273)) { const _0x5a4cae = _0x14c998[_0x1a6c6c(0x4de)](_0x954e50); if (_0x5a4cae) _0x428550[_0x1a6c6c(0x311)][_0x5a4cae] = _0xb13a60['getItem'](_0x5a4cae); } else URL['revokeObjectURL'](_0xc25542); }; } else { if (_0x31b813(0x557) !== 'gwIbQ') _0x4635ec['alt'] = _0x31b813(0x254); else { const _0x4f61aa = _0x1336ce[_0x31b813(0x532)] === _0x31b813(0x845) ? _0x31b813(0x845) : 'ai', _0x2d028f = _0x1eb126[_0x31b813(0x532)] === _0x31b813(0x845) ? _0x2ce113[_0x31b813(0x82e)] : _0xd90a76(_0x3efc36['author'])['name'], _0x47fd92 = _0x1cd570[_0x31b813(0x628)](_0x31b813(0x172)); _0x47fd92[_0x31b813(0x63a)] = _0x31b813(0x2f5) + _0x4f61aa, _0x47fd92[_0x31b813(0x17f)][_0x31b813(0x5c5)] = _0x44e5a3[_0x31b813(0x5c5)], _0x47fd92[_0x31b813(0x3fc)][_0x31b813(0x756)] = 'none', _0x47fd92[_0x31b813(0x3fc)]['paddingBottom'] = '0', _0x47fd92[_0x31b813(0x497)] = _0x31b813(0x330) + _0x2d028f + _0x31b813(0x41d) + new _0x22e9ce(_0x21bcc3[_0x31b813(0x5c5)])[_0x31b813(0x787)](_0x31b813(0x4ea)) + _0x31b813(0x28f) + _0x5f263f[_0x31b813(0x283)][_0x31b813(0x41f)](/\n/g, _0x31b813(0x31d)) + _0x31b813(0x57a), _0x233cd6['appendChild'](_0x47fd92); } } } })[_0x4c165c(0x48f)](_0x5f0fdf => { const _0x4daf00 = _0x4c165c; console[_0x4daf00(0x863)](_0x4daf00(0x53b), _0x5f0fdf), _0x4635ec[_0x4daf00(0x2d2)] = '图片加载失败'; })); if (_0x3fa7c5) { if ('DUQjz' === _0x4c165c(0x591)) { const _0x38d548 = document[_0x4c165c(0x628)]('p'); _0x38d548[_0x4c165c(0x3fc)][_0x4c165c(0x24f)] = _0x4c165c(0x759), _0x38d548[_0x4c165c(0x41a)] = _0x3fa7c5, _0x1b1ea0[_0x4c165c(0x2c8)](_0x38d548); } else _0x37a407 = _0x15dda8['id']; } } } else { if (_0x36411f['type'] === _0x4c165c(0x71b)) { _0x1b1ea0[_0x4c165c(0x7a1)][_0x4c165c(0x821)](_0x4c165c(0x71b)); const _0x4d7a41 = _0x36411f[_0x4c165c(0x5a8)] === _0x4c165c(0x845) ? _0x4771d7(_0x5c6c54[_0x4c165c(0x728)]) : _0x5a8ee7(_0x36411f[_0x4c165c(0x2a6)]), _0x22b448 = _0x36411f[_0x4c165c(0x767)] === _0x4771d7(_0x5c6c54[_0x4c165c(0x728)])['id'] ? _0x4771d7(_0x5c6c54['activeChatId']) : _0x5a8ee7(_0x36411f[_0x4c165c(0x767)]), _0x44c9a7 = _0x4d7a41?.['name'] ? _0x4d7a41[_0x4c165c(0x82e)] + _0x4c165c(0x569) : '转账', _0x5cced4 = _0x22b448?.[_0x4c165c(0x82e)] ? _0x4c165c(0x189) + _0x22b448[_0x4c165c(0x82e)] : '转账', _0x49ad11 = _0x4c165c(0x67d) + _0x44c9a7 + _0x4c165c(0x51e) + _0x36411f['amount'][_0x4c165c(0x873)](0x2) + _0x4c165c(0x5a7) + _0x5cced4 + _0x4c165c(0x5c9); _0x1b1ea0['innerHTML'] = _0x49ad11; } else { if (_0x36411f['type'] === 'listen-together-invite') { if (_0x4c165c(0x3f4) === _0x4c165c(0x1bd)) _0x497f12[_0x4c165c(0x5b3)](_0x4c165c(0x21e)); else { _0x1b1ea0[_0x4c165c(0x7a1)][_0x4c165c(0x821)](_0x4c165c(0x388)); const _0x536fc0 = document[_0x4c165c(0x628)](_0x4c165c(0x172)); _0x536fc0[_0x4c165c(0x63a)] = _0x4c165c(0x181), _0x536fc0['classList']['add'](_0x4c165c(0x2a9)); const _0x17dd74 = _0x36411f[_0x4c165c(0x5a8)] === _0x4c165c(0x845) ? _0x4771d7(_0x5c6c54[_0x4c165c(0x728)])['name'] || '你' : _0x5a8ee7(_0x36411f[_0x4c165c(0x2a6)])?.[_0x4c165c(0x82e)] || 'TA', _0x3a2211 = _0x36411f['coverUrl'] || _0x166d38; _0x36411f[_0x4c165c(0x545)] ? _0x536fc0[_0x4c165c(0x497)] = _0x4c165c(0x4dd) + _0x3a2211 + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x36411f['songName'] + _0x4c165c(0x82a) + _0x36411f['artist'] + _0x4c165c(0x613) : _0x536fc0[_0x4c165c(0x497)] = _0x4c165c(0x67c) + _0x17dd74 + _0x4c165c(0x317) + _0x3a2211 + _0x4c165c(0x37f) + _0x36411f[_0x4c165c(0x2ed)] + _0x4c165c(0x6cd) + _0x36411f[_0x4c165c(0x381)] + _0x4c165c(0x1f9) + _0x36411f[_0x4c165c(0x7a8)] + _0x4c165c(0x649), _0x1b1ea0[_0x4c165c(0x2c8)](_0x536fc0); } } else { if (_0x36411f[_0x4c165c(0x443)] === _0x4c165c(0x388) && _0x36411f[_0x4c165c(0x2ed)]) { if ('TmpUN' !== 'gRvmH') { _0x1b1ea0[_0x4c165c(0x7a1)][_0x4c165c(0x821)](_0x4c165c(0x388)); const _0x7d5acb = document[_0x4c165c(0x628)](_0x4c165c(0x172)); _0x7d5acb['className'] = _0x4c165c(0x5d5), _0x7d5acb[_0x4c165c(0x17f)][_0x4c165c(0x314)] = 'msg_' + _0x36411f[_0x4c165c(0x5c5)], _0x7d5acb[_0x4c165c(0x497)] = _0x4c165c(0x1b0) + (_0x36411f[_0x4c165c(0x621)] || _0x166d38) + _0x4c165c(0x7e8) + _0x36411f[_0x4c165c(0x2ed)] + _0x4c165c(0x6cd) + _0x36411f['artist'] + _0x4c165c(0x491) + (_0x36411f['playableUrl'] ? '▶' : '⚠') + _0x4c165c(0x61f), _0x36411f[_0x4c165c(0x62d)] && (_0x4c165c(0x66e) === _0x4c165c(0x722) ? _0x2feb40[_0x4c165c(0x493)]['abort'](_0x4c165c(0x87d)) : _0x7d5acb[_0x4c165c(0x73c)]('click', function () { const _0x38223a = _0x4c165c; if (_0x38223a(0x5b2) !== _0x38223a(0x5b2)) _0x3dd77b(), _0x28eae8('meetingList', 'home'); else { const _0x5f0483 = { 'id': _0x38223a(0x3ed) + _0x36411f[_0x38223a(0x5c5)], 'url': _0x36411f[_0x38223a(0x62d)] }; _0x216cfd(this, _0x5f0483); } })), _0x1b1ea0[_0x4c165c(0x2c8)](_0x7d5acb); } else _0x506a7c = [..._0x18a631, ..._0x3f9719]; } else { if (_0x3fa7c5) { const _0x417cf2 = document[_0x4c165c(0x628)]('p'); _0x417cf2[_0x4c165c(0x41a)] = _0x3fa7c5, _0x417cf2[_0x4c165c(0x3fc)][_0x4c165c(0x396)] = '0', _0x1b1ea0[_0x4c165c(0x2c8)](_0x417cf2); } } } } } } _0x2dca4f === 'user' ? (_0x4ae437[_0x4c165c(0x2c8)](_0x1b1ea0), _0x4ae437['appendChild'](_0x274d03)) : _0x4c165c(0x368) === _0x4c165c(0x368) ? (_0x4ae437[_0x4c165c(0x2c8)](_0x274d03), _0x4ae437[_0x4c165c(0x2c8)](_0x1b1ea0)) : _0x1197b3[_0x4c165c(0x2cd)](); } else { const _0x190d1e = { 'role': _0x4c165c(0x535), 'content': '[AI发送了表情：' + _0x3e5ff6[_0x4c165c(0x82e)] + ']', 'displayUrl': _0x260faa[_0x4c165c(0x5e3)], 'senderId': _0x281c49[_0x4c165c(0x2a6)], 'timestamp': _0x5c1b99[_0x4c165c(0x7a5)](), 'isOffline': _0x169bc7 }; _0x555a96['conversationHistory'][_0x4c165c(0x43f)](_0x190d1e); } } _0x30cd06['appendChild'](_0x4ae437); const _0x142c11 = document['createElement'](_0x4c165c(0x172)); return _0x142c11[_0x4c165c(0x63a)] = 'timestamp', _0x142c11[_0x4c165c(0x41a)] = _0x747441(_0x36411f[_0x4c165c(0x5c5)]), _0x30cd06[_0x4c165c(0x2c8)](_0x142c11), _0x4adec6[_0x4c165c(0x2c8)](_0x30cd06), _0x30cd06; } document[_0xbc3280(0x5d9)]('chat-messages')[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x297385); let _0x287c1d = null, _0x19f531 = null; function _0x297385(_0x3d72c8) { const _0x371383 = _0xbc3280; if (window[_0x371383(0x8a3)]()['toString']()) { if ('wSuiC' === _0x371383(0x2fb)) return; else return _0x396017(_0x2d02f0)['then'](_0x5553fd => _0x5553fd[_0x371383(0x2b5)]()); } const _0x9bbf1e = _0x3d72c8[_0x371383(0x7da)][_0x371383(0x6f2)](_0x371383(0x342)), _0x5afcbf = _0x3d72c8['target'][_0x371383(0x6f2)](_0x371383(0x1c6)); if (!_0x9bbf1e || _0x5afcbf) return; const _0x216e1e = parseInt(_0x9bbf1e[_0x371383(0x17f)]['historyIndex'], 0xa); if (isNaN(_0x216e1e)) return; _0x1a2096(_0x216e1e); } function _0x10d288() { const _0x1e6fea = _0xbc3280; if (_0x1e6fea(0x608) === 'LcQLi') { const _0x5841b1 = _0x358414[_0x1e6fea(0x5d9)](_0xb5a4d2); _0x5841b1[_0x1e6fea(0x497)] = '', _0x4aebd4[_0x1e6fea(0x160)][_0x1e6fea(0x691)](_0x4cf4fa => { const _0x25415b = _0x1e6fea, _0x4c9962 = _0x9511d7[_0x25415b(0x628)](_0x25415b(0x5ca)); _0x4c9962[_0x25415b(0x5a5)] = _0x4cf4fa['id'], _0x4c9962[_0x25415b(0x41a)] = _0x4cf4fa['name'], _0x5841b1[_0x25415b(0x2c8)](_0x4c9962); }); } else { const _0x9c83f1 = _0x1e26a8(); if (!_0x9c83f1) { _0x5d01cc[_0x1e6fea(0x41a)] = _0x1e6fea(0x157); return; } if (_0x9c83f1[_0x1e6fea(0x443)] === _0x1e6fea(0x77d)) { const _0x1d915f = _0x5a8ee7(_0x9c83f1[_0x1e6fea(0x594)][0x0]); _0x5d01cc[_0x1e6fea(0x41a)] = _0x1d915f ? _0x1d915f[_0x1e6fea(0x82e)] : _0x1e6fea(0x4fc); } else _0x1e6fea(0x17a) === _0x1e6fea(0x37c) ? (_0xaede82[_0x1e6fea(0x3fc)][_0x1e6fea(0x74d)] = _0x1e6fea(0x1d8), _0x586858(() => _0x35cdb0[_0x1e6fea(0x7a1)][_0x1e6fea(0x821)](_0x1e6fea(0x274)), 0xa)) : _0x5d01cc['textContent'] = _0x9c83f1[_0x1e6fea(0x82e)] || '群聊\x20(' + _0x9c83f1[_0x1e6fea(0x594)]['length'] + ')'; } } function _0x1caf99(_0xe5449a) { const _0x102d3c = _0xbc3280; if (_0x102d3c(0x20c) === _0x102d3c(0x20c)) { const _0x4b6f8e = document[_0x102d3c(0x85e)](_0x102d3c(0x56a)); if (_0x4b6f8e && (_0x4b6f8e['id'] === 'meeting-view-screen' || _0x4b6f8e['id'] === _0x102d3c(0x6ad))) { if (_0x102d3c(0x45b) === 'YEaQi') { _0x4d9f91['conversationHistory'] = [], _0x5aeb01(); return; } else _0x3310d7(); } else { if (_0x102d3c(0x4c0) !== 'AuLIs') { const _0x5e377a = _0x102d3c(0x6a0); _0x52c110 = '\x0a\x0a#\x20核心任务:\x20视觉小说剧本写作\x0a\x0a\x20\x20-\x20**当前场景**:\x20你正在与用户“' + _0x42b2a2[_0x102d3c(0x82e)] + _0x102d3c(0x715) + _0x5e377a + _0x102d3c(0x191) + _0x2682ec[_0x102d3c(0x82e)] + '”；如果是环境或动作描写，就用“narrator”。\x0a\x20\x20\x20\x202.\x20\x20`emotion`字段：**必须**从\x20[' + _0x5e377a + _0x102d3c(0x578) + _0x5e377a + _0x102d3c(0x770); } else { const _0xa63cc6 = document['querySelectorAll'](_0x102d3c(0x2ec)); _0xa63cc6[_0x102d3c(0x691)](_0x4fe691 => _0x4fe691['remove']()); } } } else _0x2c79ab['removeItem'](_0x102d3c(0x555) + _0x4246ee['id']), _0x3f92ce(_0x102d3c(0x558) + _0x34b280[_0x102d3c(0x82e)] + _0x102d3c(0x370)); } function _0x4d7ca9() { const _0x648874 = _0xbc3280; if ('xdfTf' === 'LLIoQ') { if (_0x29ed9e[_0x648874(0x5a8)] === _0x648874(0x845) && _0x5903c9[_0x648874(0x4e0)]) return { 'role': _0x648874(0x845), 'content': [{ 'type': 'text', 'text': _0x44b8e3[_0x648874(0x283)] || '\x20' }, { 'type': _0x648874(0x858), 'image_url': { 'url': _0x1b41a2[_0x648874(0x4e0)], 'detail': _0x648874(0x79d) } }] }; return { 'role': _0x397dfd['role'], 'content': _0x570c90[_0x648874(0x283)] }; } else _0x5c6c54[_0x648874(0x75c)] && _0x5c6c54['currentAbortController'] && (console['log']('用户操作中断了\x20AI\x20响应。'), _0x5c6c54['currentAbortController']['abort'](_0x648874(0x668)), _0x5c6c54[_0x648874(0x493)] = null), _0x5c6c54[_0x648874(0x75c)] = ![], _0x1caf99(![]); } function _0x1e26a8() { const _0x4577d5 = _0xbc3280; if ('iCEtl' !== _0x4577d5(0x687)) { const _0x507fcb = _0x221df9[_0x4577d5(0x394)](); _0x507fcb[_0x4577d5(0x21f)] = () => _0x534f35(_0x507fcb[_0x4577d5(0x6bf)]), _0x507fcb['onerror'] = () => _0x329840(_0x507fcb[_0x4577d5(0x863)]); } else return _0x5c6c54['chats'][_0x4577d5(0x659)](_0x3f0435 => _0x3f0435['id'] === _0x5c6c54[_0x4577d5(0x728)]); } function _0x5a8ee7(_0x29601d) { const _0x42b989 = _0xbc3280; return _0x5c6c54[_0x42b989(0x24a)][_0x42b989(0x659)](_0x46c9b9 => _0x46c9b9['id'] === _0x29601d); } function _0x5ca57b(_0x683e8) { const _0x3ee136 = _0xbc3280; if (_0x3ee136(0x80f) !== _0x3ee136(0x80f)) { const _0x1735d4 = _0xa0cf94[_0x3ee136(0x85e)]('.music-post-song-card'); _0x1735d4 && _0x1735d4['addEventListener'](_0x3ee136(0x36d), function () { const _0x3c98d1 = _0x3ee136, _0x587e63 = { 'id': _0x4acfe9['id'], 'url': _0x13b0b5[_0x3c98d1(0x62d)] }; _0x59e9a0(this, _0x587e63); }); } else { _0x5c6c54['characters'] = _0x5c6c54[_0x3ee136(0x24a)][_0x3ee136(0x25b)](_0x10305d => _0x10305d['id'] !== _0x683e8), _0x5c6c54[_0x3ee136(0x1ce)][_0x3ee136(0x691)](_0xcfb847 => { const _0x2b677a = _0x3ee136; _0xcfb847[_0x2b677a(0x443)] === _0x2b677a(0x441) && (_0xcfb847[_0x2b677a(0x594)] = _0xcfb847[_0x2b677a(0x594)]['filter'](_0x65edcf => _0x65edcf !== _0x683e8)); }); const _0x387e0b = _0x5c6c54[_0x3ee136(0x1ce)][_0x3ee136(0x659)](_0x4e275b => _0x4e275b[_0x3ee136(0x443)] === 'private' && _0x4e275b[_0x3ee136(0x594)]['includes'](_0x683e8)); _0x387e0b && (_0x3ee136(0x309) === _0x3ee136(0x4f5) ? _0x2d5f52[_0x3ee136(0x41a)] = _0x47fa5c[_0x3ee136(0x82e)] || _0x3ee136(0x6de) + _0x2507d2['participantIds'][_0x3ee136(0x794)] + ')' : _0x2cabe3(_0x387e0b['id'])), _0x5c6c54[_0x3ee136(0x1ce)] = _0x5c6c54[_0x3ee136(0x1ce)][_0x3ee136(0x25b)](_0x112107 => _0x112107['type'] !== 'group' || _0x112107[_0x3ee136(0x594)][_0x3ee136(0x794)] > 0x1), _0xbd25a6(), _0x11cd8d(); } } function _0x2cabe3(_0x148a44) { const _0x3fac1a = _0xbc3280; _0x5c6c54[_0x3fac1a(0x1ce)] = _0x5c6c54[_0x3fac1a(0x1ce)][_0x3fac1a(0x25b)](_0x56a6cb => _0x56a6cb['id'] !== _0x148a44); try { 'zlNJk' === _0x3fac1a(0x1c5) ? _0xf1387f[_0x3fac1a(0x778)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null } : localStorage[_0x3fac1a(0x5b3)]('chatHistory_' + _0x148a44); } catch (_0xfdbd29) { _0x3fac1a(0x230) === _0x3fac1a(0x196) ? (_0x231012[_0x3fac1a(0x161)] = _0x9d704a[_0x3fac1a(0x78a)](_0x35dbd), _0x22971d[_0x3fac1a(0x3fc)][_0x3fac1a(0x350)] = 0x1) : console[_0x3fac1a(0x863)]('Failed\x20to\x20remove\x20history\x20for\x20chat\x20' + _0x148a44, _0xfdbd29); } if (_0x5c6c54[_0x3fac1a(0x728)] === _0x148a44) { if (_0x3fac1a(0x1bb) === _0x3fac1a(0x1bb)) _0x5c6c54[_0x3fac1a(0x728)] = _0x5c6c54['chats'][0x0]?.['id'] || null, _0x5ef958(_0x5c6c54[_0x3fac1a(0x728)]); else { const _0x356365 = _0x432b5a[_0x3fac1a(0x52f)](_0x4ea40a, _0x3fac1a(0x605)), _0x3b2e26 = _0x356365[_0x3fac1a(0x4ed)](_0x142a59), _0x2ca450 = _0x3b2e26[_0x3fac1a(0x5bc)](_0x15c891); _0x2ca450[_0x3fac1a(0x21f)] = () => _0x32c739(_0x2ca450[_0x3fac1a(0x6bf)] ? _0x2ca450['result'][_0x3fac1a(0x2b5)] : null), _0x2ca450['onerror'] = () => _0x10323b(_0x2ca450[_0x3fac1a(0x863)]); } } _0xbd25a6(), _0x11cd8d(); } async function _0x5ef958(_0x216c3e) { const _0x37f59c = _0xbc3280; _0x5c6c54[_0x37f59c(0x728)] !== _0x216c3e && (_0x4d7ca9(), _0x5c6c54[_0x37f59c(0x758)] = 0x64); if (!_0x216c3e) { if (_0x37f59c(0x22b) !== _0x37f59c(0x678)) { _0x5c6c54[_0x37f59c(0x728)] = null, _0xbd25a6(), _0x5a8240(![]), document['getElementById']('chat-view-pane')[_0x37f59c(0x3fc)]['backgroundImage'] = ''; return; } else { let _0x42522b = 0x0, _0x339ed8 = 0x0, _0x56191f = 0x0; if (_0x2d51ec[_0x37f59c(0x794)] == 0x4) _0x42522b = '0x' + _0x24b9d0[0x1] + _0x5c731d[0x1], _0x339ed8 = '0x' + _0x5be91a[0x2] + _0x252515[0x2], _0x56191f = '0x' + _0x4fc8ea[0x3] + _0x4c7349[0x3]; else _0x546bec[_0x37f59c(0x794)] == 0x7 && (_0x42522b = '0x' + _0x10585a[0x1] + _0x4dd8db[0x2], _0x339ed8 = '0x' + _0x5ee8ef[0x3] + _0xfc2c77[0x4], _0x56191f = '0x' + _0x287e79[0x5] + _0x478c54[0x6]); _0x42522b /= 0xff, _0x339ed8 /= 0xff, _0x56191f /= 0xff; let _0x54d4b7 = _0x450e47[_0x37f59c(0x3ac)](_0x42522b, _0x339ed8, _0x56191f), _0x2a12fc = _0xa96c03[_0x37f59c(0x65a)](_0x42522b, _0x339ed8, _0x56191f), _0x1c6315 = _0x2a12fc - _0x54d4b7, _0x3cb261 = 0x0, _0x5a276e = 0x0, _0x23bd13 = 0x0; if (_0x1c6315 == 0x0) _0x3cb261 = 0x0; else { if (_0x2a12fc == _0x42522b) _0x3cb261 = (_0x339ed8 - _0x56191f) / _0x1c6315 % 0x6; else { if (_0x2a12fc == _0x339ed8) _0x3cb261 = (_0x56191f - _0x42522b) / _0x1c6315 + 0x2; else _0x3cb261 = (_0x42522b - _0x339ed8) / _0x1c6315 + 0x4; } } _0x3cb261 = _0x491336[_0x37f59c(0x2be)](_0x3cb261 * 0x3c); if (_0x3cb261 < 0x0) _0x3cb261 += 0x168; return _0x23bd13 = (_0x2a12fc + _0x54d4b7) / 0x2, _0x5a276e = _0x1c6315 == 0x0 ? 0x0 : _0x1c6315 / (0x1 - _0x2a73f4[_0x37f59c(0x55c)](0x2 * _0x23bd13 - 0x1)), _0x5a276e = +(_0x5a276e * 0x64)['toFixed'](0x1), _0x23bd13 = +(_0x23bd13 * 0x64)['toFixed'](0x1), { 'h': _0x3cb261, 's': _0x5a276e, 'l': _0x23bd13 }; } } _0x5c6c54[_0x37f59c(0x728)] = _0x216c3e, _0xbd25a6(), _0x10d288(), _0x4adec6[_0x37f59c(0x497)] = '', _0x3168b5(!![], '稍微有点卡了，可以尝试清空聊天记录了！记得总结丢世界书'), setTimeout(async () => { const _0x4cceb3 = _0x37f59c; if (_0x4cceb3(0x582) === 'Xrmta') { const _0x2fa171 = _0x64f46c(_0x3f00fe[_0x4cceb3(0x2a6)] || _0x2a2e70['activeMeetingCharId']); _0x3cb518 = _0x2fa171?.[_0x4cceb3(0x82e)] || '角色', _0x34e422 = _0x4cceb3(0x8cc); } else try { _0x2ec9c2(); const _0x172c5d = _0x1e26a8(), _0xb4f168 = document[_0x4cceb3(0x5d9)](_0x4cceb3(0x540)); let _0x3bdc03 = null; if (_0x172c5d) { if (_0x172c5d['type'] === _0x4cceb3(0x77d)) { const _0x521ebc = _0x172c5d[_0x4cceb3(0x594)][0x0]; _0x5a9b3c(_0x521ebc), _0x3bdc03 = await _0x2eb454(_0x4cceb3(0x68d) + _0x521ebc); } else _0x4cceb3(0x37b) !== _0x4cceb3(0x37b) ? _0x229dc6['diaryPressTimer'] = _0x1e984c(() => { const _0x41f552 = _0x4cceb3; if (_0x48e1a9[_0x41f552(0x443)] === 'touchstart') _0x5d513b[_0x41f552(0x7ac)](); _0x9d8f88(_0x5070c0(_0x4e1cb7, 0xa), _0x288943); }, 0x320) : _0x3bdc03 = await _0x2eb454(_0x4cceb3(0x3e8) + _0x172c5d['id']); _0x3bdc03 ? (_0xb4f168[_0x4cceb3(0x3fc)]['backgroundImage'] = _0x4cceb3(0x6c9) + URL[_0x4cceb3(0x78a)](_0x3bdc03) + '\x27)', _0xb4f168[_0x4cceb3(0x3fc)][_0x4cceb3(0x66d)] = _0x4cceb3(0x7d9), _0xb4f168['style'][_0x4cceb3(0x186)] = _0x4cceb3(0x750)) : _0x4cceb3(0x742) === _0x4cceb3(0x742) ? _0xb4f168[_0x4cceb3(0x3fc)][_0x4cceb3(0x6d5)] = '' : (_0x28ec2c[_0x4cceb3(0x63a)] = 'narrator', _0xf3ef6e[_0x4cceb3(0x3fc)]['fontStyle'] = _0x4cceb3(0x30f), _0x557e07[_0x4cceb3(0x3fc)][_0x4cceb3(0x279)] = _0x4cceb3(0x81c), _0x258721[_0x4cceb3(0x497)] = _0x465f76); } _0x1fa1ad(); } catch (_0x574915) { console[_0x4cceb3(0x863)](_0x4cceb3(0x8bf), _0x574915), _0x13197e(_0x4cceb3(0x3d0) + _0x574915['message']); } finally { if (_0x4cceb3(0x801) === 'naWwt') { const _0x3ba111 = (_0x1e071b[_0x4cceb3(0x4b7)] ?? _0x22a284['emoji'] ?? _0x4238fd[_0x4cceb3(0x24d)] ?? _0x202f74['tag'])?.[_0x4cceb3(0x42f)](); if (_0x3ba111 && _0x26a45c[_0x4cceb3(0x2c0)](_0x3ba111)) _0xe8b84e[_0x4cceb3(0x699)]['push']({ 'senderId': _0x398f62['id'], 'kind': _0x4cceb3(0x4b7), 'sticker': _0x3ba111 }); else { const _0x3e8f07 = _0x5af718(_0x5a1cb7[_0x4cceb3(0x283)] ?? _0x443d47['text'] ?? '')[_0x4cceb3(0x42f)]() || _0x4cceb3(0x45f) + (_0x3ba111 || '未知表情') + ']'; if (_0x3e8f07) _0x10473e[_0x4cceb3(0x699)][_0x4cceb3(0x43f)]({ 'senderId': _0x241aa1['id'], 'kind': _0x4cceb3(0x224), 'content': _0x3e8f07 }); } } else _0x3168b5(![]); } }, 0x32); } async function _0x488f61() { const _0x2c9172 = _0xbc3280; if (_0x2c9172(0x25e) === _0x2c9172(0x25e)) { if (_0x5c6c54[_0x2c9172(0x75c)]) { _0x13197e(_0x2c9172(0x6a7)); return; } const _0x2b46b7 = _0x5c6c54[_0x2c9172(0x3b6)]; if (_0x2b46b7[_0x2c9172(0x794)] === 0x0) return; let _0x3189c6 = -0x1; for (let _0x4a33c6 = _0x2b46b7[_0x2c9172(0x794)] - 0x1; _0x4a33c6 >= 0x0; _0x4a33c6--) { if (_0x2c9172(0x803) !== 'fQfoO') { if (_0x2b46b7[_0x4a33c6][_0x2c9172(0x5a8)] === _0x2c9172(0x845)) { _0x3189c6 = _0x4a33c6; break; } } else _0x4584d3['textContent'] = _0x2c9172(0x2b7) + _0x30ad11[_0x2c9172(0x794)] + '\x20项'; } if (_0x3189c6 === -0x1 || _0x3189c6 === _0x2b46b7[_0x2c9172(0x794)] - 0x1) { if (_0x2c9172(0x256) === 'ejKdD') _0x335ed5 > _0x4cbe9f && (_0x4f5e16 *= _0x25f8be / _0x497747, _0x138ce7 = _0x34c04b); else { _0x13197e(_0x2c9172(0x60c)); return; } } _0x2b46b7[_0x2c9172(0x7ee)](_0x3189c6 + 0x1), _0xcef02c(), _0x3310d7(), setTimeout(() => { _0x1271c6(); }, 0x64); } else _0x46d9fc['error'](_0x2c9172(0x636), _0x42df12, _0x2c9172(0x3e7), _0x5538cc), _0x14e0f1[_0x2c9172(0x3b6)]['push']({ 'role': _0x2c9172(0x535), 'senderId': _0x3ae0de['id'], 'timestamp': _0x1b5b59[_0x2c9172(0x7a5)](), 'isOffline': !![], 'content': _0x2c9172(0x1ae) + _0x183ce9 + ']' }); } function _0x32bf83(_0x8e0723 = null) { const _0x57de94 = _0xbc3280, _0x3be4df = _0x8e0723 ?? _0x488521['value'][_0x57de94(0x42f)](); if (_0x3be4df === '' || !_0x5c6c54[_0x57de94(0x728)]) return; const _0xe6331e = document[_0x57de94(0x85e)](_0x57de94(0x56a)), _0x26374a = _0xe6331e['id'] === _0x57de94(0x52a), _0x50bb4c = { 'role': _0x57de94(0x845), 'content': _0x3be4df, 'timestamp': Date[_0x57de94(0x7a5)](), 'isOffline': _0x26374a }; _0x5c6c54[_0x57de94(0x295)] && (_0x57de94(0x4a2) !== 'qQeSG' ? (_0x560b22[_0x57de94(0x3b6)][_0x3dd28f][_0x57de94(0x545)] = !![], _0x433f3d()) : _0x50bb4c[_0x57de94(0x19d)] = { ..._0x5c6c54['activeQuote'] }), _0x5c6c54['conversationHistory']['push'](_0x50bb4c), _0xcef02c(), _0x3310d7(), !_0x8e0723 && (_0x488521[_0x57de94(0x5a5)] = ''), _0x47f848(); } function _0x4eed65(_0x505d70) { const _0x46a9f0 = _0xbc3280; if ('yvxXr' === _0x46a9f0(0x337)) _0x54881d[_0x46a9f0(0x7a1)][_0x46a9f0(0x821)](_0x46a9f0(0x333)), _0x3986f1['classList'][_0x46a9f0(0x821)]('is-exiting-left'), _0x1a76f3[_0x46a9f0(0x7a1)][_0x46a9f0(0x821)]('is-visible'), _0x27f5b7(() => { const _0x915f58 = _0x46a9f0; _0x291f5d[_0x915f58(0x7a1)][_0x915f58(0x8a2)](_0x915f58(0x1fd), _0x915f58(0x780)), _0x38cb21['classList'][_0x915f58(0x8a2)](_0x915f58(0x333)), _0x52bf77[_0x915f58(0x4d9)] = _0x12d333, _0x430b61(), _0x4e0974[_0x915f58(0x7b2)] = ![]; }, 0x2bc); else { if (!_0x505d70 || !_0x5c6c54[_0x46a9f0(0x728)]) return; const _0xd114ff = { 'role': _0x46a9f0(0x845), 'content': '[用户发送了表情：' + _0x505d70[_0x46a9f0(0x82e)] + ']', 'displayUrl': _0x505d70['url'], 'timestamp': Date['now']() }; _0x5c6c54[_0x46a9f0(0x3b6)][_0x46a9f0(0x43f)](_0xd114ff), _0x51dbdd(_0xd114ff, _0x5c6c54[_0x46a9f0(0x3b6)][_0x46a9f0(0x794)] - 0x1), _0xcef02c(), _0x40f8f5['classList'][_0x46a9f0(0x8a2)](_0x46a9f0(0x274)); } } async function _0x5d8f5f(_0x47675a) { const _0x4ca234 = _0xbc3280; if (_0x4ca234(0x3f6) !== _0x4ca234(0x3f6)) { const _0x19ac26 = _0x5604c9[_0x4ca234(0x1ce)][_0x4ca234(0x659)](_0x2fe6d1 => _0x2fe6d1['id'] === _0x47c18c); if (!_0x19ac26 || _0x19ac26[_0x4ca234(0x443)] !== 'group') return; _0x3a4100[_0x4ca234(0x5d9)](_0x4ca234(0x8a4))['value'] = _0x19ac26[_0x4ca234(0x82e)] || '', _0x154fd8('group-settings-bind-user'), _0x520c07[_0x4ca234(0x5d9)](_0x4ca234(0x614))[_0x4ca234(0x5a5)] = _0x19ac26['boundUserProfileId'] || _0x4e146c[_0x4ca234(0x4f0)]; const _0x2ad926 = _0x3262f4[_0x4ca234(0x5d9)](_0x4ca234(0x7dd)); _0x2ad926[_0x4ca234(0x497)] = '', _0x484e56[_0x4ca234(0x6bd)][_0x4ca234(0x691)](_0x326b60 => { const _0x2c7aca = _0x4ca234, _0x2a74fc = _0x19ac26[_0x2c7aca(0x88d)]?.[_0x2c7aca(0x87c)](_0x326b60['id']), _0x23557b = _0x5434e5[_0x2c7aca(0x628)](_0x2c7aca(0x1d3)); _0x23557b[_0x2c7aca(0x497)] = _0x2c7aca(0x2c9) + _0x326b60['id'] + '\x22\x20' + (_0x2a74fc ? 'checked' : '') + '>\x20' + _0x326b60['name'], _0x2ad926[_0x2c7aca(0x2c8)](_0x23557b); }), _0x5a09c1(); const _0x283204 = _0x54a587[_0x4ca234(0x5d9)](_0x4ca234(0x779)), _0x56b132 = _0x3a32e6[_0x4ca234(0x5d9)](_0x4ca234(0x4fb)); _0x423fa1('group_avatar_' + _0x3adf45)[_0x4ca234(0x2b1)](_0x255624 => { const _0x186653 = _0x4ca234; _0x283204[_0x186653(0x161)] = _0x255624 ? _0x1bed9c['createObjectURL'](_0x255624) : _0x1fd1fa; }), _0x3f0634(_0x4ca234(0x3e8) + _0x57d6cc)[_0x4ca234(0x2b1)](_0x130695 => { const _0x591fca = _0x4ca234; _0x56b132[_0x591fca(0x161)] = _0x130695 ? _0x4f9f5c[_0x591fca(0x78a)](_0x130695) : ''; }), _0x5ae986('groupSettings', _0x4ca234(0x2da)); } else { const _0x37f4aa = _0x47675a['target'][_0x4ca234(0x3ad)][0x0]; if (!_0x37f4aa || !_0x5c6c54[_0x4ca234(0x728)]) return; _0x3168b5(!![], _0x4ca234(0x46f)); try { const _0xfb7b17 = await _0x5e770d(_0x37f4aa, 0x320, 0.8, !![]), _0x1457ab = _0x4ca234(0x8b1) + Date[_0x4ca234(0x7a5)](); await _0x1c943a(_0x1457ab, _0xfb7b17); const _0x246e3a = _0x488521['value'][_0x4ca234(0x42f)](); _0x488521['value'] = ''; const _0x101852 = { 'role': 'user', 'content': _0x246e3a, 'imageId': _0x1457ab, 'timestamp': Date[_0x4ca234(0x7a5)]() }; _0x5c6c54[_0x4ca234(0x3b6)]['push'](_0x101852), _0x51dbdd(_0x101852, _0x5c6c54[_0x4ca234(0x3b6)]['length'] - 0x1), _0xcef02c(); } catch (_0x3f53f9) { if ('OsCvB' === _0x4ca234(0x7aa)) _0x13197e('图片处理失败:\x20' + _0x3f53f9[_0x4ca234(0x1a4)]); else { const _0x25a8d8 = new _0x35a8b0(_0x3b9024['timestamp']), _0x4f46fb = _0x4a38bf[_0x4ca234(0x564)]((_0x2cb7a6 - _0x25a8d8) / (0x3e8 * 0x3c)); if (_0x4f46fb < 0x5) _0x50987b += '\x0a-\x20**对话状态**:\x20群里刚刚还在聊天。'; else { if (_0x4f46fb < 0x78) _0x385e91 += _0x4ca234(0x698) + _0x4f46fb + _0x4ca234(0x26b); else { const _0x11f0f3 = _0x1d816c['floor'](_0x4f46fb / 0x3c); if (_0x11f0f3 < 0x30) _0x216136 += _0x4ca234(0x698) + _0x11f0f3 + _0x4ca234(0x683); else _0x27e8ff += _0x4ca234(0x488) + _0x429ab5['floor'](_0x11f0f3 / 0x18) + '天没动静了。你的角色们应该发起新的问候或话题。'; } } } } finally { _0x3168b5(![]), _0x47675a[_0x4ca234(0x7da)][_0x4ca234(0x5a5)] = ''; } } } async function _0x13e443() { const _0x46db21 = _0xbc3280; if (!_0x5c6c54[_0x46db21(0x728)]) return; const _0x1aabc4 = await _0x2391b8(); if (!_0x1aabc4) return; _0x13197e('正在搜索音乐...'); try { if (_0x46db21(0x398) !== _0x46db21(0x398)) _0x460874[_0x46db21(0x161)] && (_0x4a314e[_0x46db21(0x258)] ? _0x2aa3de[_0x46db21(0x1b1)]() : _0x2c7ae5[_0x46db21(0x2cd)]()); else { const _0x1a4e8e = await _0x1bd57d(_0x1aabc4[_0x46db21(0x2ed)], _0x1aabc4[_0x46db21(0x381)]); let _0xc55523 = _0x1a4e8e['cover']; if (_0x1a4e8e['cover'] && _0x1a4e8e[_0x46db21(0x7d9)]['startsWith'](_0x46db21(0x610))) { if (_0x46db21(0x65f) !== _0x46db21(0x65f)) { if (!_0x71e84c[_0x46db21(0x48c)] || _0x4f0fe6[_0x46db21(0x48c)]['length'] === 0x0) { _0x53ef88[_0x46db21(0x863)](_0x46db21(0x538)); return; } const _0x5f458c = _0x513bea[_0x46db21(0x48c)][0x0]; if (_0x5f458c[_0x46db21(0x6b1)][_0x46db21(0x794)] < 0x2) { _0x2556e2[_0x46db21(0x863)](_0x46db21(0x8db) + _0x5f458c['name'] + _0x46db21(0x418)); return; } const _0x23f1c4 = { 'id': 'test_post_' + _0x4c002f[_0x46db21(0x7a5)](), 'authorType': _0x46db21(0x223), 'authorId': _0x5f458c[_0x46db21(0x6b1)][0x0], 'content': '这是一条由控制台添加的测试动态！样式看起来非常完美。', 'timestamp': _0x2fa481[_0x46db21(0x7a5)](), 'likes': [_0x5f458c[_0x46db21(0x6b1)][0x1]], 'comments': [{ 'commentId': 'c_' + _0xa57dd4[_0x46db21(0x7a5)](), 'authorId': _0x5f458c[_0x46db21(0x6b1)][0x1], 'content': _0x46db21(0x84d) }] }; _0x5f458c[_0x46db21(0x834)][_0x46db21(0x43f)](_0x23f1c4), _0x4e8cfd(), _0x5ca223[_0x46db21(0x384)]('成功向好友圈\x20\x22' + _0x5f458c[_0x46db21(0x82e)] + '\x22\x20添加了一条测试动态。请点击进入该好友圈查看效果。'), _0x379c4c(_0x46db21(0x6ef)); } else try { const _0x5af7ac = await fetch(_0x1a4e8e[_0x46db21(0x7d9)]), _0x2d72fe = await _0x5af7ac[_0x46db21(0x2b5)](); _0xc55523 = await _0x51083d(_0x2d72fe); } catch (_0x97764c) { console[_0x46db21(0x863)](_0x46db21(0x2f4), _0x97764c), _0xc55523 = _0x166d38; } } const _0x2a105a = { 'role': _0x46db21(0x845), 'type': _0x46db21(0x388), 'content': '[用户分享了音乐：' + _0x1aabc4[_0x46db21(0x2ed)] + _0x46db21(0x541) + _0x1aabc4['artist'] + ']', 'songName': _0x1aabc4[_0x46db21(0x2ed)], 'artist': _0x1aabc4[_0x46db21(0x381)], 'coverUrl': _0xc55523, 'playableUrl': _0x1a4e8e[_0x46db21(0x5e3)], 'timestamp': Date[_0x46db21(0x7a5)]() }; _0x5c6c54[_0x46db21(0x3b6)][_0x46db21(0x43f)](_0x2a105a), _0x51dbdd(_0x2a105a, _0x5c6c54[_0x46db21(0x3b6)][_0x46db21(0x794)] - 0x1), _0xcef02c(); } } catch (_0x2e4f0b) { if ('GzVAP' === 'GzVAP') console[_0x46db21(0x863)](_0x46db21(0x35d), _0x2e4f0b), _0x13197e('搜索失败:\x20' + _0x2e4f0b['message']); else { const _0x1a8f7c = _0x118958['friendCircles'][_0x46db21(0x659)](_0x2a140c => _0x2a140c['id'] === _0x5e3025[_0x46db21(0x266)]), _0x4a44e6 = _0x1a8f7c ? _0x1a8f7c[_0x46db21(0x834)] : []; if (!_0x4a44e6 || _0x4a44e6[_0x46db21(0x794)] === 0x0) return ''; const _0x4515d8 = _0x4a44e6[_0x46db21(0x60e)](0x0, 0x5), _0x2fe940 = _0x4515d8[_0x46db21(0x2ac)](_0x26368e => { const _0x18931f = _0x46db21, _0x302ab2 = _0x1fb8a8(_0x26368e[_0x18931f(0x54c)]) || { 'name': '未知' }; let _0x988ff1 = _0x18931f(0x6b2) + _0x302ab2[_0x18931f(0x82e)] + _0x18931f(0x740) + (_0x26368e[_0x18931f(0x82f)] || _0x26368e['content']) + '”'; return _0x26368e[_0x18931f(0x443)] === _0x18931f(0x388) && (_0x988ff1 += _0x18931f(0x6d1) + _0x26368e[_0x18931f(0x2ed)] + _0x18931f(0x541) + _0x26368e[_0x18931f(0x381)] + ')'), _0x988ff1; }); return _0x46db21(0x50f) + _0x2fe940[_0x46db21(0x5d2)]('\x0a'); } } } function _0x18d951(_0x3fc7f9, _0x5a716e = 0x78) { const _0x13ea67 = _0xbc3280, _0x5a718d = _0x30ac8b => { const _0xe9ae4b = _0x32ba; if (_0xe9ae4b(0x154) === _0xe9ae4b(0x615)) { const { omniText: _0x56455b } = _0x420e8d(_0x4d1a00['id'], null), _0x1c068c = _0x27381d(_0x46b55d['id']), _0x141912 = _0x337a5d[_0xe9ae4b(0x88d)] && _0x40de06[_0xe9ae4b(0x88d)][_0xe9ae4b(0x794)] > 0x0 ? _0xe9ae4b(0x856) + _0x5e94e5[_0xe9ae4b(0x82e)] + _0xe9ae4b(0x6fb) + _0x303330[_0xe9ae4b(0x88d)][_0xe9ae4b(0x2ac)](_0x47aa8a => _0x5b9060[_0xe9ae4b(0x6bd)]['find'](_0x46700e => _0x46700e['id'] === _0x47aa8a))[_0xe9ae4b(0x25b)](_0x2f0753)['map'](_0x1a9b24 => _0xe9ae4b(0x2e9) + _0x1a9b24[_0xe9ae4b(0x82e)] + '\x0a' + _0x1a9b24[_0xe9ae4b(0x283)])['join']('') : ''; return _0xe9ae4b(0x167) + _0x4f10c6[_0xe9ae4b(0x82e)] + _0xe9ae4b(0x8c8) + _0x959f0c['id'] + _0xe9ae4b(0x1bc) + _0x2a132a[_0xe9ae4b(0x854)] + _0xe9ae4b(0x857) + _0x56455b + '\x0a' + _0x1c068c + '\x0a' + _0x141912; } else { if (_0x30ac8b[_0xe9ae4b(0x5a8)] === _0xe9ae4b(0x845)) return _0x5c6c54[_0xe9ae4b(0x484)]?.[_0xe9ae4b(0x82e)] || _0xe9ae4b(0x71f); if (_0x30ac8b['senderId']) { if (_0xe9ae4b(0x536) !== _0xe9ae4b(0x75d)) { const _0x19492d = _0x5a8ee7(_0x30ac8b[_0xe9ae4b(0x2a6)]); return _0x19492d?.['name'] || _0xe9ae4b(0x3a7); } else _0x4c084c(_0xe9ae4b(0x347)); } if (_0x3fc7f9?.[_0xe9ae4b(0x443)] === 'private') { if ('fUScK' === _0xe9ae4b(0x1f4)) { const _0x5cc64c = _0x5a8ee7(_0x3fc7f9['participantIds'][0x0]); return _0x5cc64c?.[_0xe9ae4b(0x82e)] || 'AI'; } else { if (_0x394d09) _0x38a0f7(_0x112696); const _0x164c3e = _0x217942[_0xe9ae4b(0x7da)]['closest']('p[data-history-index]'); if (!_0x164c3e) return; const _0x174bf4 = _0x203067(_0x164c3e['dataset'][_0xe9ae4b(0x7a6)], 0xa); if (_0x59c5bb(_0x174bf4)) return; const _0x408d84 = () => { _0x2f3f8a = _0x36e227(() => { const _0x228ca1 = _0x32ba; if (_0x316aa6[_0x228ca1(0x443)] === _0x228ca1(0x16d)) _0x482762['preventDefault'](); _0x5a261c(_0x174bf4); }, 0x320); }, _0x1c731e = () => { if (_0x4321e2) _0xdbf424(_0x3e48cc); }; _0x561250[_0xe9ae4b(0x73c)](_0xe9ae4b(0x1ba), _0x1c731e, { 'once': !![] }), _0x1b1ff4['addEventListener'](_0xe9ae4b(0x1db), _0x1c731e, { 'once': !![] }), _0x17b80b[_0xe9ae4b(0x73c)]('touchend', _0x1c731e, { 'once': !![] }), _0x527463[_0xe9ae4b(0x73c)](_0xe9ae4b(0x356), _0x1c731e, { 'once': !![] }), _0x408d84(); } } return _0xe9ae4b(0x180); } }, _0x4a26a4 = _0x5c6c54['conversationHistory'][_0x13ea67(0x60e)](-_0x5a716e), _0x492454 = []; for (const _0x44532a of _0x4a26a4) { if ('ZFsdh' === 'ZFsdh') { if (_0x44532a['displayUrl']) _0x492454[_0x13ea67(0x43f)]('[' + _0x5a718d(_0x44532a) + _0x13ea67(0x720) + (_0x44532a[_0x13ea67(0x283)]?.[_0x13ea67(0x6a9)](/：(.+?)]/)?.[0x1] || '表情') + ']'); else { if (_0x44532a[_0x13ea67(0x4e0)]) { const _0x1a2b14 = _0x44532a[_0x13ea67(0x283)] ? '\x20' + _0x44532a['content'] : ''; _0x492454['push']('[' + _0x5a718d(_0x44532a) + _0x13ea67(0x584) + _0x1a2b14); } else _0x44532a[_0x13ea67(0x283)] && _0x492454[_0x13ea67(0x43f)]('[' + _0x5a718d(_0x44532a) + ']\x20' + _0x44532a[_0x13ea67(0x283)]); } } else { const _0x2b86d8 = _0x5d8651[_0x13ea67(0x628)](_0x13ea67(0x1d3)); _0x2b86d8[_0x13ea67(0x497)] = '<input\x20type=\x22checkbox\x22\x20value=\x22' + _0x14da48['id'] + _0x13ea67(0x46e) + _0xe5aa1a['name'], _0x4c1908['appendChild'](_0x2b86d8); } } return _0x492454[_0x13ea67(0x5d2)]('\x0a'); } function _0x252a7b(_0x98e64b, _0xf2c47d) { const _0xd043a9 = _0xbc3280; if ('giQac' !== _0xd043a9(0x1ed)) { if (!_0x98e64b || !_0xf2c47d) return null; const _0x1ee3ed = _0xf2c47d[_0xd043a9(0x6a9)](/@([^\s:：,，。!?]+)/); if (!_0x1ee3ed) return null; const _0x2e55fb = _0x1ee3ed[0x1][_0xd043a9(0x746)](); for (const _0x8c5f79 of _0x98e64b['participantIds']) { const _0x1ed9e6 = _0x5a8ee7(_0x8c5f79); if (!_0x1ed9e6?.[_0xd043a9(0x82e)]) continue; if (_0x1ed9e6[_0xd043a9(0x82e)][_0xd043a9(0x746)]() === _0x2e55fb) return _0x1ed9e6; if (_0x1ed9e6[_0xd043a9(0x82e)]['toLowerCase']()[_0xd043a9(0x380)](_0x2e55fb)) return _0x1ed9e6; } return null; } else _0x48abf5 = _0x370516; } function _0x2be734(_0x535bd1) { const _0x5ccde4 = _0xbc3280; if (_0x5ccde4(0x213) === _0x5ccde4(0x213)) { const _0x28832e = _0x535bd1['indexOf']('{'), _0x5c82ba = _0x535bd1[_0x5ccde4(0x24c)]('}'); if (_0x28832e >= 0x0 && _0x5c82ba > _0x28832e) return _0x535bd1[_0x5ccde4(0x60e)](_0x28832e, _0x5c82ba + 0x1); return _0x535bd1; } else { const _0x4321eb = _0x3feda0[_0x5ccde4(0x5b7)](_0x12ced3); _0x11925b['isArray'](_0x4321eb) ? _0x38d188 = [..._0x1cc351, ..._0x4321eb] : _0x5b2721 = _0x15660b; } } function _0x3e9426(_0x2b3e85, _0x4ed7f3, _0x99eefd) { const _0x297b73 = _0xbc3280; if (_0x297b73(0x6f9) === _0x297b73(0x6f9)) { const _0x5e42a7 = new Map(_0x4ed7f3['map'](_0xd4766 => [String(_0xd4766['id']), _0xd4766])), _0x3f8cf6 = _0x5ce3f6 => String(_0x5ce3f6 || '')[_0x297b73(0x746)]()[_0x297b73(0x41f)](/\s+/g, ''), _0x4aff8f = new Map(_0x4ed7f3[_0x297b73(0x2ac)](_0x96acd4 => [_0x3f8cf6(_0x96acd4[_0x297b73(0x82e)]), _0x96acd4])), _0x242aa7 = new Set(_0x99eefd), _0x48d467 = { 'events': [] }; for (const _0x4a1a0f of _0x2b3e85?.[_0x297b73(0x699)] || []) { if (_0x297b73(0x69e) !== _0x297b73(0x18a)) { const _0x50ae46 = _0x4a1a0f[_0x297b73(0x2a6)] ?? _0x4a1a0f[_0x297b73(0x259)] ?? _0x4a1a0f[_0x297b73(0x719)] ?? _0x4a1a0f[_0x297b73(0x28b)] ?? _0x4a1a0f[_0x297b73(0x5a8)] ?? _0x4a1a0f[_0x297b73(0x82e)]; if (!_0x50ae46) continue; let _0x12034c = _0x5e42a7[_0x297b73(0x5bc)](String(_0x50ae46)) || _0x4aff8f[_0x297b73(0x5bc)](_0x3f8cf6(_0x50ae46)); if (!_0x12034c) continue; const _0xb0f2f5 = (_0x4a1a0f[_0x297b73(0x63e)] || _0x4a1a0f[_0x297b73(0x443)] || _0x297b73(0x224))[_0x297b73(0x746)](); if (_0xb0f2f5 === _0x297b73(0x4b7)) { const _0x467f62 = (_0x4a1a0f[_0x297b73(0x4b7)] ?? _0x4a1a0f[_0x297b73(0x43b)] ?? _0x4a1a0f[_0x297b73(0x24d)] ?? _0x4a1a0f[_0x297b73(0x18c)])?.[_0x297b73(0x42f)](); if (_0x467f62 && _0x242aa7[_0x297b73(0x2c0)](_0x467f62)) _0x297b73(0x8c4) === _0x297b73(0x1b8) ? _0x644734(_0x5ca9d5, _0x297b73(0x63f)) : _0x48d467[_0x297b73(0x699)][_0x297b73(0x43f)]({ 'senderId': _0x12034c['id'], 'kind': _0x297b73(0x4b7), 'sticker': _0x467f62 }); else { if (_0x297b73(0x4c6) === _0x297b73(0x4c6)) { const _0x5900f5 = String(_0x4a1a0f[_0x297b73(0x283)] ?? _0x4a1a0f[_0x297b73(0x224)] ?? '')[_0x297b73(0x42f)]() || _0x297b73(0x45f) + (_0x467f62 || _0x297b73(0x450)) + ']'; if (_0x5900f5) _0x48d467[_0x297b73(0x699)][_0x297b73(0x43f)]({ 'senderId': _0x12034c['id'], 'kind': 'text', 'content': _0x5900f5 }); } else _0x992491('获取模型失败:\x20' + _0x423a71[_0x297b73(0x1a4)] + _0x297b73(0x52d)); } } else { const _0x2060c2 = String(_0x4a1a0f[_0x297b73(0x283)] ?? _0x4a1a0f[_0x297b73(0x224)] ?? _0x4a1a0f['message'] ?? '')[_0x297b73(0x42f)](); if (_0x2060c2) _0x48d467[_0x297b73(0x699)]['push']({ 'senderId': _0x12034c['id'], 'kind': _0x297b73(0x224), 'content': _0x2060c2 }); } } else _0x41ba40 = _0x32b1c2[_0x297b73(0x24e)](_0x297b73(0x555) + _0x4651e9[_0x297b73(0x728)]); } return _0x48d467; } else _0x366edc = _0x9a2c44[_0x297b73(0x5a5)]; } async function _0x4ec335(_0x3435b6) { const _0x551bd8 = _0xbc3280; if ('wonxW' === _0x551bd8(0x3ca)) { if (!_0x3435b6 || !Array['isArray'](_0x3435b6[_0x551bd8(0x699)]) || _0x3435b6[_0x551bd8(0x699)][_0x551bd8(0x794)] === 0x0) return; const _0x570c2c = _0x52f738 => _0x52f738 + Math[_0x551bd8(0x564)](Math[_0x551bd8(0x633)]() * 0x190); let _0x3194f7 = 0x1f4; for (const _0x378dc6 of _0x3435b6[_0x551bd8(0x699)]) { if ('tVVyk' === _0x551bd8(0x30b)) _0x43c7f3(![]), _0x5e1e55[_0x551bd8(0x863)](_0x551bd8(0x54d), _0x44d372), _0x39fa8a(_0x551bd8(0x7c5) + _0x921be1[_0x551bd8(0x1a4)]); else { await new Promise(_0x7e9fbd => setTimeout(_0x7e9fbd, _0x570c2c(_0x3194f7))), _0x3194f7 += 0x2bc; const _0x416b21 = _0x5c6c54['conversationHistory']['at'](-0x1)?.[_0x551bd8(0x730)] ?? ![]; if (_0x378dc6[_0x551bd8(0x63e)] === _0x551bd8(0x4b7)) { const _0x45bbcb = _0x24d29a[_0x551bd8(0x659)](_0x3fb537 => _0x3fb537[_0x551bd8(0x82e)] === _0x378dc6[_0x551bd8(0x4b7)]); if (_0x45bbcb) { if (_0x551bd8(0x788) === _0x551bd8(0x788)) { const _0x5c4679 = { 'role': _0x551bd8(0x535), 'content': _0x551bd8(0x66b) + _0x45bbcb[_0x551bd8(0x82e)] + ']', 'displayUrl': _0x45bbcb[_0x551bd8(0x5e3)], 'senderId': _0x378dc6[_0x551bd8(0x2a6)], 'timestamp': Date[_0x551bd8(0x7a5)](), 'isOffline': _0x416b21 }; _0x5c6c54[_0x551bd8(0x3b6)][_0x551bd8(0x43f)](_0x5c4679); } else _0x455f16[_0x551bd8(0x3cd)](_0x73403e, _0xfc97e6['stringify'](_0x5a1ddc)); } } else { if (_0x378dc6['kind'] === 'music' && _0x378dc6['songName'] && _0x378dc6[_0x551bd8(0x381)]) { const { songName: _0x437770, artist: _0x5aa395 } = _0x378dc6, _0x2e4e18 = { 'role': 'assistant', 'type': 'music', 'content': _0x551bd8(0x25d) + _0x437770 + _0x551bd8(0x541) + _0x5aa395 + ']', 'songName': _0x437770, 'artist': _0x5aa395, 'senderId': _0x378dc6['senderId'], 'timestamp': Date[_0x551bd8(0x7a5)](), 'isOffline': _0x416b21 }; try { const _0x278133 = await _0x1bd57d(_0x437770, _0x5aa395); _0x2e4e18['coverUrl'] = _0x278133['cover'], _0x2e4e18[_0x551bd8(0x62d)] = _0x278133['url']; } catch (_0x15c7f2) { if ('hJAwO' !== _0x551bd8(0x4ca)) console[_0x551bd8(0x863)]('群聊音乐搜索失败\x20(' + _0x437770 + _0x551bd8(0x541) + _0x5aa395 + '):', _0x15c7f2), _0x2e4e18['coverUrl'] = null, _0x2e4e18[_0x551bd8(0x62d)] = null; else { const _0x4e5ac1 = _0x23dbc2['find'](_0x545aa6 => _0x545aa6[_0x551bd8(0x82e)] === _0x13dfd6[_0x551bd8(0x82e)]); if (_0x4e5ac1) _0x257e7e['assign'](_0x369179, { 'content': _0x551bd8(0x66b) + _0x4e5ac1['name'] + ']', 'displayUrl': _0x4e5ac1[_0x551bd8(0x5e3)] }); else _0x35d32b['content'] = '[sticker:' + _0x2f72d2[_0x551bd8(0x82e)] + ']'; } } _0x5c6c54[_0x551bd8(0x3b6)]['push'](_0x2e4e18); } else { if (_0x378dc6['kind'] === _0x551bd8(0x224)) { const _0x47fda8 = _0x714da(_0x378dc6[_0x551bd8(0x283)])[_0x551bd8(0x60e)](0x0, 0x3); for (let _0x54301c = 0x0; _0x54301c < _0x47fda8['length']; _0x54301c++) { if ('SwIhI' !== _0x551bd8(0x3b0)) _0x258c5a[_0x551bd8(0x7a1)][_0x551bd8(0x8a2)](_0x551bd8(0x274)); else { if (_0x54301c > 0x0) await new Promise(_0x40f152 => setTimeout(_0x40f152, _0x570c2c(0x190))); const _0x45ce43 = { 'role': _0x551bd8(0x535), 'content': _0x47fda8[_0x54301c], 'senderId': _0x378dc6[_0x551bd8(0x2a6)], 'timestamp': Date[_0x551bd8(0x7a5)](), 'isOffline': _0x416b21 }; _0x5c6c54[_0x551bd8(0x3b6)][_0x551bd8(0x43f)](_0x45ce43); } } } } } } } _0xcef02c(), _0x3310d7(); } else _0x33642e['innerHTML'] = _0x551bd8(0x4dd) + _0x3ca655 + _0x551bd8(0x4f9) + _0x172809[_0x551bd8(0x2ed)] + _0x551bd8(0x82a) + _0x37ccd0[_0x551bd8(0x381)] + _0x551bd8(0x613); } async function _0xaf4592(_0x26dc7e, { force: force = ![], delayMs: delayMs = 0x0 } = {}) { const _0x434c38 = _0xbc3280; await new Promise(_0x1fb777 => setTimeout(_0x1fb777, 0xa)); if (!_0x5c6c54[_0x434c38(0x73a)][_0x434c38(0x3ba)] || !_0x5c6c54[_0x434c38(0x73a)][_0x434c38(0x4de)] || !_0x5c6c54[_0x434c38(0x73a)][_0x434c38(0x70d)]) { if (_0x434c38(0x6ff) !== 'xOKPZ') _0x4891d5++; else return _0x13197e('请先在\x22设置\x22中配置你的\x20API\x20信息。'), ![]; } const _0x549131 = _0x1e26a8(); if (!_0x549131 || !_0x26dc7e) return ![]; const _0x4d2df2 = _0x4771d7(_0x549131['id']), _0x37a930 = _0x5c6c54[_0x434c38(0x3b6)]['at'](-0x1)?.[_0x434c38(0x5a8)] === _0x434c38(0x845); if (!force && !_0x37a930) return ![]; const _0x524786 = _0x5c6c54[_0x434c38(0x3b6)]['at'](-0x1)?.['isOffline'] ?? ![]; if (delayMs) await new Promise(_0x378c7d => setTimeout(_0x378c7d, delayMs)); _0x524786 ? _0x434c38(0x214) !== 'AinKn' ? _0x48d4eb[_0x434c38(0x863)]('Error\x20fetching\x20from\x20' + _0x51bac3 + ':', _0xcda4f9) : document[_0x434c38(0x5d9)](_0x434c38(0x556))['textContent'] = _0x434c38(0x382) : 'QdeDZ' !== _0x434c38(0x285) ? _0x52098c[_0x54a474][_0x434c38(0x7a1)][_0x434c38(0x821)](_0x434c38(0x39d)) : _0x1caf99(!![]); let _0x23c9e3 = ''; const _0x3e510d = _0x1e26a8(); if (_0x3e510d?.[_0x434c38(0x49b)]?.[_0x434c38(0x3a5)]) { const _0x4f9cd2 = _0x3e510d[_0x434c38(0x49b)], _0xecded2 = await _0x39d202(_0x4f9cd2[_0x434c38(0x7a8)]); if (_0xecded2 && _0xecded2[_0x434c38(0x771)]) { const _0x4000fd = _0x1221cd(_0xecded2[_0x434c38(0x771)]); if (_0x4000fd[_0x434c38(0x794)] > 0x0) { const _0x28c0b0 = _0x50a4ab[_0x434c38(0x1ad)]; let _0xe18ed1 = -0x1; for (let _0x3279da = 0x0; _0x3279da < _0x4000fd[_0x434c38(0x794)]; _0x3279da++) { if (_0x434c38(0x8c1) === _0x434c38(0x7d3)) _0x15ab80[_0x434c38(0x7a1)][_0x434c38(0x821)](_0x434c38(0x364)); else { if (_0x28c0b0 >= _0x4000fd[_0x3279da][_0x434c38(0x2a4)]) _0xe18ed1 = _0x3279da; else break; } } const _0x2c9e3b = _0x4000fd[_0x434c38(0x2ac)]((_0x1715b0, _0x244e53) => { const _0x32aabf = _0x434c38, _0x37ff85 = _0x244e53 === _0xe18ed1 ? _0x32aabf(0x836) : ''; return '' + _0x37ff85 + _0x1715b0[_0x32aabf(0x224)]; })[_0x434c38(0x5d2)]('\x0a'); _0x23c9e3 = ('\x0a#\x20当前活动：一起听歌\x0a\x0a你们正在一起听\x20' + _0x4f9cd2[_0x434c38(0x381)] + '\x20的《' + _0x4f9cd2['songName'] + _0x434c38(0x233) + _0x2c9e3b + _0x434c38(0x819))[_0x434c38(0x42f)](); } } } let _0x1b2142 = '', _0x119124 = ''; const _0x2ce7a8 = _0x5c6c54['conversationHistory'][_0x434c38(0x794)]; if (_0x2ce7a8 > 0x1) { const _0x3567f2 = _0x5c6c54[_0x434c38(0x3b6)][_0x2ce7a8 - 0x2], _0xf53506 = _0x5c6c54[_0x434c38(0x3b6)][_0x2ce7a8 - 0x1]; if (_0x3567f2[_0x434c38(0x730)] === ![] && _0xf53506[_0x434c38(0x730)] === !![]) _0x119124 = _0x434c38(0x3af) + _0x4d2df2[_0x434c38(0x82e)] + _0x434c38(0x4c8); else _0x3567f2[_0x434c38(0x730)] === !![] && _0xf53506[_0x434c38(0x730)] === ![] && (_0x434c38(0x207) !== _0x434c38(0x207) ? (_0x2097fa(_0x4c7d92), _0x297b68()) : _0x119124 = '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“' + _0x4d2df2[_0x434c38(0x82e)] + '”面对面，Ta现在掏出手机给你发了这条消息。请根据这前后的时间差，判断Ta发送消息的合理性，你应该结合上下文对此发表评论（例如，根据上下文，Ta已经和你分开了，没用面对面了，那么发手机消息非常正常，自然接话就好，但是如果判断得出你们还在见面状态，那么，你可以适当吐槽为什么两个人见面还要发手机消息），现在，切换到【手机聊天】模式（纯文本气泡，不要有旁白）。'); } if (_0x524786) { if (_0x434c38(0x27b) === _0x434c38(0x27b)) { const _0x744ef5 = 'normal,\x20happy,\x20angry,\x20sad,\x20shy'; _0x1b2142 = '\x0a\x0a#\x20核心任务:\x20视觉小说剧本写作\x0a\x0a\x20\x20-\x20**当前场景**:\x20你正在与用户“' + _0x4d2df2[_0x434c38(0x82e)] + _0x434c38(0x715) + _0x744ef5 + ']中选择的情绪标签\x22,\x0a\x20\x20\x20\x20\x22line\x22:\x20\x22台词或旁白内容\x22\x0a\x20\x20\x20\x20}\x0a\x20\x20\x0a\x20\x20-\x20**规则**:\x0a\x20\x20\x20\x201.\x20\x20`speaker`字段：如果是角色说话，就用角色名“' + _0x26dc7e['name'] + _0x434c38(0x7e1) + _0x744ef5 + _0x434c38(0x578) + _0x744ef5 + _0x434c38(0x770); } else !_0x4e54ef[_0x434c38(0x7a1)][_0x434c38(0x153)]('load-more-btn') && _0x1ec0e7[_0x434c38(0x8a2)](); } else _0x434c38(0x59e) === 'iFjDW' ? (_0xe869a3[_0x434c38(0x863)](_0x434c38(0x2f4), _0x32bf74), _0x3d73d5 = _0x865cd7) : _0x434c38(0x33d); const { omniText: _0xff894c } = _0x5c86b3(_0x26dc7e['id'], _0x549131['id']), _0x285698 = _0x480fea(), _0x3a3647 = _0x13f7f9(_0x26dc7e['id']), _0x149d62 = typeof _0x2e9eff === _0x434c38(0x6a1) ? _0x2e9eff[_0x434c38(0x29e)](_0x434c38(0x26d), _0x26dc7e['name'])['replaceAll'](_0x434c38(0x876), _0x4d2df2[_0x434c38(0x82e)] || '用户') : '', _0x522a69 = _0x24d29a['map'](_0x4dd57e => _0x4dd57e['name'])['join'](',\x20'); let _0x2e76a3 = ''; if (_0x26dc7e[_0x434c38(0x88d)] && _0x26dc7e[_0x434c38(0x88d)][_0x434c38(0x794)] > 0x0) { const _0x156d3a = _0x26dc7e[_0x434c38(0x88d)][_0x434c38(0x2ac)](_0x6ab119 => _0x5c6c54[_0x434c38(0x6bd)][_0x434c38(0x659)](_0x1d1113 => _0x1d1113['id'] === _0x6ab119))[_0x434c38(0x25b)](Boolean)['map'](_0x2d5ac2 => _0x434c38(0x87e) + _0x2d5ac2[_0x434c38(0x82e)] + '\x0a' + _0x2d5ac2[_0x434c38(0x283)])['join'](''); if (_0x156d3a) _0x2e76a3 = _0x434c38(0x656) + _0x156d3a; } const _0x50a842 = _0x4d2df2[_0x434c38(0x854)] ? _0x434c38(0x862) + _0x4d2df2[_0x434c38(0x82e)] + _0x434c38(0x2cc) + _0x4d2df2[_0x434c38(0x854)] : ''; let _0x844a0c = ''; const _0x17c1ec = new Date(), _0x4b6bd5 = _0x5c6c54[_0x434c38(0x3b6)]['at'](-0x1), _0x48728a = _0x580176(_0x26dc7e['id']); _0x844a0c = '\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a', _0x844a0c += '-\x20**当前精确时间**:\x20' + _0x17c1ec[_0x434c38(0x787)](_0x434c38(0x4ea), { 'dateStyle': _0x434c38(0x604), 'timeStyle': _0x434c38(0x530) }) + '\x0a'; if (_0x48728a) { if (_0x434c38(0x8b3) === _0x434c38(0x528)) _0x5dfe8e[_0x434c38(0x497)] = '', _0x21e78c[_0x434c38(0x691)](_0x5d4c0b => { const _0xb4e4a3 = _0x434c38, _0x41115f = _0x580fc7['createElement'](_0xb4e4a3(0x172)); _0x41115f[_0xb4e4a3(0x41a)] = _0x5d4c0b, _0x41115f[_0xb4e4a3(0x73c)](_0xb4e4a3(0x36d), () => { const _0x3d6333 = _0xb4e4a3; _0x44ec25[_0x3d6333(0x5a5)] = _0x5d4c0b, _0x2a5fc4[_0x3d6333(0x7a1)]['remove'](_0x3d6333(0x274)); }), _0xff8a52[_0xb4e4a3(0x2c8)](_0x41115f); }), _0x10d7f0[_0x434c38(0x7a1)]['add'](_0x434c38(0x274)), _0x188798('成功获取\x20' + _0xc6ed2a['length'] + _0x434c38(0x726)); else { const _0x5bb428 = _0x111ade(new Date(_0x48728a[_0x434c38(0x5c5)])); _0x844a0c += _0x434c38(0x3db) + _0x5bb428 + '\x0a'; const _0x1dfe3a = (_0x17c1ec - new Date(_0x48728a[_0x434c38(0x5c5)])) / (0x3e8 * 0x3c * 0x3c); if (_0x1dfe3a > 0x30) { if ('bOHwS' !== _0x434c38(0x8bd)) { _0x1544cb('请先在\x22设置\x22中配置你的\x20API\x20信息。'); return; } else _0x844a0c += _0x434c38(0x5a6); } else { if (_0x1dfe3a > 0x14) _0x844a0c += '-\x20**对话状态提示**:\x20对话已经过了一天，你应该意识到之前的话题已是“昨天”的事，可以开启新话题或用“说起昨天...”来提及旧事。\x0a'; else _0x1dfe3a > 0x4 ? _0x844a0c += '-\x20**对话状态提示**:\x20你们有几个小时没聊了，可以简单问候一下对方现在的状态。\x0a' : _0x844a0c += _0x434c38(0x52e); } } } else _0x844a0c += '-\x20**对话状态提示**:\x20这是你们的第一次对话。\x0a'; const _0xc2b710 = ('\x0a' + _0x1b2142 + _0x434c38(0x796) + _0x26dc7e[_0x434c38(0x82e)] + _0x434c38(0x249) + _0x26dc7e['name'] + ':\x22\x20或\x22[' + _0x26dc7e['name'] + ']\x22\x20等前缀。\x0a如需发送表情，只发送一行：[sticker:表情名]。\x0a【重要】发送表情包时，表情名【必须】从以下列表中选择：[' + _0x522a69 + _0x434c38(0x840) + _0x149d62 + '\x0a')[_0x434c38(0x42f)](), _0xc52f0e = [{ 'role': _0x434c38(0x523), 'content': _0xc2b710 }], _0x1b3a76 = ('\x0a#\x20你的个性（节选）\x0a' + (_0x26dc7e[_0x434c38(0x854)] || '你是一个乐于助人的助手。') + '\x0a' + _0x50a842 + '\x20\x0a' + _0xff894c + '\x0a' + _0x285698 + '\x0a' + _0x3a3647 + _0x434c38(0x2df) + _0x23c9e3 + '\x0a' + _0x844a0c + '\x0a' + _0x2e76a3 + '\x0a')[_0x434c38(0x42f)](); if (_0x1b3a76['replace'](/#.*|\s/g, '')) { if (_0x434c38(0x25c) !== _0x434c38(0x4b1)) _0xc52f0e[_0x434c38(0x43f)]({ 'role': _0x434c38(0x845), 'content': _0x1b3a76 }), _0xc52f0e['push']({ 'role': 'assistant', 'content': '好的，我记住了这些人设和历史。现在我们开始对话。' }); else { const _0x1f27d4 = _0x58b60d['getElementById'](_0x434c38(0x6bb)); _0x1f27d4['innerHTML'] = ''; if (_0x184319[_0x434c38(0x160)][_0x434c38(0x794)] === 0x0) { _0x1f27d4[_0x434c38(0x497)] = _0x434c38(0x3dd); return; } _0x322e52[_0x434c38(0x160)][_0x434c38(0x691)](_0x91268e => { const _0x3b0246 = _0x434c38, _0x16b8d8 = _0xb1acb2[_0x3b0246(0x628)]('div'); _0x16b8d8[_0x3b0246(0x63a)] = _0x3b0246(0x88c), _0x16b8d8[_0x3b0246(0x17f)]['id'] = _0x91268e['id']; const _0x483cae = _0x91268e['id'] === _0x493b85[_0x3b0246(0x4f0)] ? _0x3b0246(0x1cf) : ''; _0x16b8d8['innerHTML'] = _0x3b0246(0x290) + (_0x91268e[_0x3b0246(0x41e)] || _0x2c54fd) + _0x3b0246(0x8b2) + _0x91268e[_0x3b0246(0x82e)] + _0x483cae + _0x3b0246(0x550) + _0x91268e[_0x3b0246(0x854)][_0x3b0246(0x35b)](0x0, 0x64) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x16b8d8[_0x3b0246(0x73c)]('click', () => _0xe2d1a5(_0x91268e['id'])), _0x1f27d4['appendChild'](_0x16b8d8); }); } } const _0xced09c = _0x5c6c54[_0x434c38(0x778)]?.[_0x434c38(0x51f)] ?? 0x64, _0x67d556 = _0x5c6c54[_0x434c38(0x3b6)][_0x434c38(0x60e)](-_0xced09c); for (const _0x40fe82 of _0x67d556) { const _0x57eebd = _0x40fe82[_0x434c38(0x5a8)] === 'ai' || _0x40fe82[_0x434c38(0x5a8)] === 'assistant' ? _0x434c38(0x535) : _0x434c38(0x845); let _0x4a895e = { 'role': _0x57eebd, 'content': _0x40fe82['content'] }, _0x271333 = !!_0x40fe82[_0x434c38(0x283)]; if (_0x40fe82[_0x434c38(0x306)] && _0x40fe82[_0x434c38(0x283)][_0x434c38(0x87c)]('表情')) { const _0x5b9947 = _0x40fe82[_0x434c38(0x283)][_0x434c38(0x6a9)](/：(.*?)]$/); _0x4a895e[_0x434c38(0x283)] = _0x434c38(0x45f) + (_0x5b9947 ? _0x5b9947[0x1] : _0x434c38(0x450)) + ']', _0xc52f0e[_0x434c38(0x43f)](_0x4a895e); } else { let _0x7d8746 = null; if (_0x40fe82[_0x434c38(0x4e0)]) _0x7d8746 = _0x40fe82[_0x434c38(0x4e0)]; else { if (_0x40fe82[_0x434c38(0x2f3)]) try { const _0x998f24 = await _0x2eb454(_0x40fe82[_0x434c38(0x2f3)]); _0x998f24 && (_0x7d8746 = await _0x51083d(_0x998f24)); } catch (_0x157ae3) { console['error'](_0x434c38(0x69b), _0x157ae3); } } _0x7d8746 && (_0x4a895e['image'] = _0x7d8746, _0x271333 = !![]), _0x271333 && _0xc52f0e[_0x434c38(0x43f)](_0x4a895e); } } try { if ('DSIGV' === _0x434c38(0x850)) { const _0x9f461a = _0x895186[_0x434c38(0x88d)][_0x434c38(0x2ac)](_0x11299b => _0x208f22['worldBooks'][_0x434c38(0x659)](_0x4f67d2 => _0x4f67d2['id'] === _0x11299b))[_0x434c38(0x25b)](_0x4402aa)['map'](_0x380914 => _0x434c38(0x87e) + _0x380914[_0x434c38(0x82e)] + '\x0a' + _0x380914[_0x434c38(0x283)])[_0x434c38(0x5d2)](''); if (_0x9f461a) _0x189ea5 = _0x434c38(0x656) + _0x9f461a; } else { const _0x4561b3 = await _0x5cca68(_0xc52f0e); if (!_0x4561b3) return ![]; if (_0x524786) try { let _0x1ce55b = _0x4561b3[_0x434c38(0x42f)](); const _0x488461 = _0x1ce55b[_0x434c38(0x6a9)](/(\[[\s\S]*\])/); _0x488461 && (_0x434c38(0x2ef) === _0x434c38(0x2ef) ? _0x1ce55b = _0x488461[0x1] : _0x45ded7['type'] = 'text'); const _0x17fe38 = JSON[_0x434c38(0x5b7)](_0x1ce55b); if (Array[_0x434c38(0x1ab)](_0x17fe38)) { _0x5c6c54[_0x434c38(0x462)] = _0x17fe38, _0x5c6c54['characterLastScripts'][_0x26dc7e['id']] = [..._0x17fe38], _0x549336(); const _0x1fadaf = _0x17fe38[_0x434c38(0x2ac)](_0x524fe1 => _0x524fe1[_0x434c38(0x28b)] === 'narrator' ? _0x524fe1[_0x434c38(0x475)] : _0x524fe1[_0x434c38(0x28b)] + ':\x20' + _0x524fe1[_0x434c38(0x475)])[_0x434c38(0x5d2)]('\x0a\x0a'); _0x5c6c54['conversationHistory'][_0x434c38(0x43f)]({ 'role': _0x434c38(0x535), 'senderId': _0x26dc7e['id'], 'timestamp': Date[_0x434c38(0x7a5)](), 'isOffline': !![], 'content': _0x1fadaf }); } } catch (_0x31ee2e) { console[_0x434c38(0x863)](_0x434c38(0x636), _0x31ee2e, '原始文本:', _0x4561b3), _0x5c6c54['conversationHistory'][_0x434c38(0x43f)]({ 'role': _0x434c38(0x535), 'senderId': _0x26dc7e['id'], 'timestamp': Date[_0x434c38(0x7a5)](), 'isOffline': !![], 'content': '[AI返回了无法解析的剧本:\x20' + _0x4561b3 + ']' }); } else { const _0x5bb16d = _0x3b869f(_0x4561b3), _0x559e1b = _0x5bb16d['map'](_0xf97e85 => { const _0x4a5956 = _0x434c38, _0x4deadc = _0xf97e85[_0x4a5956(0x42f)](), _0x221032 = _0x4deadc[_0x4a5956(0x6a9)](/^\[music:(.*?)\|(.*?)\]$/), _0x3901f6 = _0x4deadc['match'](/^\[sticker:(.*?)\]$/), _0x3dd143 = _0x4deadc[_0x4a5956(0x6a9)](/^\[transfer:([\d.]+)\|(.*?)\]$/); if (_0x221032) { if ('bEwdS' === _0x4a5956(0x1e6)) _0x213be3[_0x4a5956(0x43f)](_0x502982[_0x4a5956(0x60e)](_0x2b2c62, _0x1a705c + _0x2e987)); else return { 'type': _0x4a5956(0x388), 'songName': _0x221032[0x1]['trim'](), 'artist': _0x221032[0x2][_0x4a5956(0x42f)]() }; } else { if (_0x3901f6) { if ('WJXAR' !== _0x4a5956(0x871)) _0xfd527 = _0xc3d4df[_0x4a5956(0x628)](_0x4a5956(0x172)), _0x26586b[_0x4a5956(0x63a)] = _0x4a5956(0x643), _0x1f6dd8[_0x4a5956(0x41a)] = _0x4a5956(0x228), _0x56935a['appendChild'](_0x2c39a6); else return { 'type': _0x4a5956(0x4b7), 'name': _0x3901f6[0x1][_0x4a5956(0x42f)]() }; } else { if (_0x3dd143) { if (_0x4a5956(0x2c4) === _0x4a5956(0x2c4)) { const _0x5dd93e = parseFloat(_0x3dd143[0x1]), _0x3bb116 = _0x3dd143[0x2][_0x4a5956(0x42f)](), _0x4f42c0 = _0x4771d7(_0x5c6c54[_0x4a5956(0x728)]); let _0x32f2a6 = null; if (_0x3bb116 === _0x4f42c0[_0x4a5956(0x82e)]) { if ('EwSwn' === _0x4a5956(0x3d8)) { const _0x3141b3 = _0x119134[_0x4a5956(0x52f)](_0x4bd876, _0x4a5956(0x15d)), _0x311b14 = _0x3141b3[_0x4a5956(0x4ed)](_0xe4935e), _0x2c0289 = _0x311b14[_0x4a5956(0x6d7)](_0xf914c0); _0x2c0289['onsuccess'] = () => _0x48c5a4(_0x2c0289['result']), _0x2c0289['onerror'] = () => _0x1ca038(_0x2c0289[_0x4a5956(0x863)]); } else _0x32f2a6 = _0x4f42c0['id']; } else { const _0x85e3a6 = _0x1e26a8(); if (_0x85e3a6[_0x4a5956(0x443)] === _0x4a5956(0x441)) { const _0x542bdf = _0x5c6c54['characters'][_0x4a5956(0x659)](_0x3ac03f => _0x85e3a6[_0x4a5956(0x594)][_0x4a5956(0x87c)](_0x3ac03f['id']) && _0x3ac03f[_0x4a5956(0x82e)] === _0x3bb116); if (_0x542bdf) _0x32f2a6 = _0x542bdf['id']; } } if (_0x32f2a6) return { 'type': _0x4a5956(0x71b), 'amount': _0x5dd93e, 'recipientId': _0x32f2a6, 'senderId': _0x26dc7e['id'] }; else return { 'type': _0x4a5956(0x224), 'content': _0x4a5956(0x7b0) + _0x3bb116 + _0x4a5956(0x2b2) }; } else { const _0x2892bc = _0x27b176[_0x4a5956(0x746)](); if (_0x24e400[_0x4a5956(0x654)](_0x5e7b92 => _0x2892bc[_0x4a5956(0x380)](_0x5e7b92))) { const _0x2dee2a = _0x1347e6[_0x5a85c7]; if (typeof _0x2dee2a === _0x4a5956(0x6a1)) _0xc42a41[_0x4a5956(0x43f)](_0x2dee2a); if (_0x2227ab[_0x4a5956(0x1ab)](_0x2dee2a)) _0x2dee2a[_0x4a5956(0x691)](_0x256874 => { const _0x2b5d25 = _0x4a5956; if (typeof _0x256874 === _0x2b5d25(0x6a1)) _0x1cfc20[_0x2b5d25(0x43f)](_0x256874); }); } } } else { if (_0x4deadc) { if (_0x4a5956(0x676) === 'HxHwL') return { 'type': _0x4a5956(0x224), 'content': _0x4deadc }; else _0x26c437 = _0xe03c90, _0x66aa0d[_0x4a5956(0x7a1)]['add'](_0x4a5956(0x274)); } } } } return null; })[_0x434c38(0x25b)](Boolean), _0x2147cc = async _0x5dc7f8 => { const _0x2bfa70 = _0x434c38; if (_0x2bfa70(0x3b1) === 'kcEBA') { const _0x528923 = { 'role': 'assistant', 'senderId': _0x26dc7e['id'], 'timestamp': Date[_0x2bfa70(0x7a5)](), 'isOffline': _0x524786 }; if (_0x5dc7f8['type'] === _0x2bfa70(0x388)) { const { songName: _0x26ed1a, artist: _0x150c50 } = _0x5dc7f8; _0x528923[_0x2bfa70(0x443)] = _0x2bfa70(0x388), _0x528923[_0x2bfa70(0x283)] = _0x2bfa70(0x25d) + _0x26ed1a + _0x2bfa70(0x541) + _0x150c50 + ']'; try { if (_0x2bfa70(0x48a) === _0x2bfa70(0x48a)) { const _0x3bff46 = await _0x1bd57d(_0x26ed1a, _0x150c50); Object[_0x2bfa70(0x8cb)](_0x528923, { 'songName': _0x26ed1a, 'artist': _0x150c50, 'coverUrl': _0x3bff46[_0x2bfa70(0x7d9)], 'playableUrl': _0x3bff46[_0x2bfa70(0x5e3)] }); } else _0x587336[_0x2bfa70(0x3fc)][_0x2bfa70(0x74d)] = _0x2bfa70(0x860); } catch (_0x2a5497) { Object[_0x2bfa70(0x8cb)](_0x528923, { 'songName': _0x26ed1a, 'artist': _0x150c50, 'coverUrl': null, 'playableUrl': null }); } } else { if (_0x5dc7f8[_0x2bfa70(0x443)] === _0x2bfa70(0x4b7)) { if (_0x2bfa70(0x5c7) !== _0x2bfa70(0x5c7)) _0x80480e(_0x1bf9f0); else { const _0x154b15 = _0x24d29a[_0x2bfa70(0x659)](_0x1877af => _0x1877af['name'] === _0x5dc7f8[_0x2bfa70(0x82e)]); if (_0x154b15) Object[_0x2bfa70(0x8cb)](_0x528923, { 'content': _0x2bfa70(0x66b) + _0x154b15['name'] + ']', 'displayUrl': _0x154b15[_0x2bfa70(0x5e3)] }); else _0x528923[_0x2bfa70(0x283)] = '[sticker:' + _0x5dc7f8[_0x2bfa70(0x82e)] + ']'; } } else { if (_0x5dc7f8[_0x2bfa70(0x443)] === 'transfer') { const _0x207a3c = _0x5dc7f8[_0x2bfa70(0x767)] === _0x4771d7(_0x5c6c54['activeChatId'])['id'] ? _0x4771d7(_0x5c6c54['activeChatId']) : _0x5a8ee7(_0x5dc7f8['recipientId']); Object[_0x2bfa70(0x8cb)](_0x528923, { 'type': 'transfer', 'amount': _0x5dc7f8[_0x2bfa70(0x159)], 'recipientId': _0x5dc7f8[_0x2bfa70(0x767)], 'content': _0x2bfa70(0x4d7) + (_0x207a3c?.[_0x2bfa70(0x82e)] || '未知') + '\x20转账\x20' + _0x5dc7f8[_0x2bfa70(0x159)] + ']' }); } else { const _0x495606 = _0x277dfe(_0x5dc7f8[_0x2bfa70(0x283)]); Object[_0x2bfa70(0x8cb)](_0x528923, { 'content': _0x495606[_0x2bfa70(0x283)], 'quotedMessage': _0x495606[_0x2bfa70(0x19d)] }); } } } return _0x528923; } else { let _0x258432 = null; const _0x11c669 = _0x5bb06a[_0x2bfa70(0x1ce)][_0x2bfa70(0x25b)](_0xcfa3b6 => _0xcfa3b6[_0x2bfa70(0x594)]['includes'](_0xb64069)); for (const _0x10a6a4 of _0x11c669) { const _0x549d26 = _0x5df1e4(_0x10a6a4['id']); if (_0x549d26 && _0x549d26[_0x2bfa70(0x794)] > 0x0) { const _0x226527 = _0x549d26[_0x549d26['length'] - 0x1]; (!_0x258432 || _0x226527[_0x2bfa70(0x5c5)] > _0x258432['timestamp']) && (_0x258432 = _0x226527); } } return _0x258432; } }, _0x394bce = await Promise['all'](_0x559e1b['map'](_0x2147cc)); for (const _0x285149 of _0x394bce) { (_0x285149[_0x434c38(0x283)] || _0x285149[_0x434c38(0x306)] || _0x285149[_0x434c38(0x443)] === _0x434c38(0x388)) && (_0x434c38(0x409) !== _0x434c38(0x409) ? _0xd07335['style'][_0x434c38(0x74d)] = _0x434c38(0x38f) : (await new Promise(_0x58f09d => setTimeout(_0x58f09d, 0x12c + Math[_0x434c38(0x633)]() * 0x190)), _0x5c6c54[_0x434c38(0x3b6)][_0x434c38(0x43f)](_0x285149), _0x3310d7())); } } return _0xcef02c(), _0x3310d7(), !![]; } } catch (_0x323c95) { if (_0x323c95[_0x434c38(0x82e)] !== _0x434c38(0x79a)) { console[_0x434c38(0x863)](_0x434c38(0x765), _0x323c95); const _0x4212b7 = { 'role': _0x434c38(0x535), 'content': _0x434c38(0x61e) + _0x323c95[_0x434c38(0x1a4)], 'senderId': _0x26dc7e['id'], 'isOffline': _0x524786 }; _0x5c6c54[_0x434c38(0x3b6)][_0x434c38(0x43f)](_0x4212b7), _0x3310d7(); } return ![]; } finally { _0x434c38(0x260) !== _0x434c38(0x7ae) ? _0x1caf99(![]) : _0x58f267(_0x30589f[_0x434c38(0x8d8)](_0x3dd8e0, _0x23f33f)); } } async function _0xd7ff34() { const _0x5293a2 = _0xbc3280, _0x5c26e0 = _0x1e26a8(); if (!_0x5c26e0 || _0x5c26e0[_0x5293a2(0x443)] !== _0x5293a2(0x77d)) { if ('WrJLo' !== _0x5293a2(0x1b7)) { const _0x5bbafb = _0x1dcac2[_0x5293a2(0x160)][_0x5293a2(0x659)](_0xde106d => _0xde106d['id'] === _0x3706ae); if (_0x5bbafb) _0x48d745[_0x5293a2(0x8cb)](_0x5bbafb, _0x1c1450); } else { _0x13197e(_0x5293a2(0x83c)); return; } } if (_0x5c6c54[_0x5293a2(0x75c)]) { _0x13197e(_0x5293a2(0x195)); return; } const _0x45127d = await _0x458a99(_0x5293a2(0x888)); if (!_0x45127d) return; _0x3168b5(!![], '正在翻阅全部历史记录...'), _0xb9a74c[_0x5293a2(0x5a5)] = '', _0x332981[_0x5293a2(0x7a1)][_0x5293a2(0x821)](_0x5293a2(0x274)), _0x5c6c54['isGenerating'] = !![]; try { if (_0x5293a2(0x647) === _0x5293a2(0x6dd)) { const _0x569075 = _0x3f8e53(); _0x569075 && _0x569075[_0x5293a2(0x49b)] && _0x569075[_0x5293a2(0x49b)][_0x5293a2(0x3a5)] && (_0x549b07['style'][_0x5293a2(0x74d)] = _0x5293a2(0x1d8), _0x3a3e97(() => _0xbdace9[_0x5293a2(0x7a1)][_0x5293a2(0x821)](_0x5293a2(0x274)), 0xa)); } else { const _0x5eb6b6 = _0x5a8ee7(_0x5c26e0[_0x5293a2(0x594)][0x0]), _0x3cd06e = _0x4771d7(_0x5c26e0['id']), _0x258766 = _0x2b4946(_0x5c26e0['id']); if (_0x258766[_0x5293a2(0x794)] === 0x0) { _0xb9a74c[_0x5293a2(0x5a5)] = _0x5293a2(0x602); return; } const _0x20adbb = _0x258766[_0x5293a2(0x2ac)](_0x4890a0 => { const _0x4a1b5f = _0x5293a2; if (_0x4a1b5f(0x7c6) === _0x4a1b5f(0x7c6)) { const _0x419a1c = new Date(_0x4890a0[_0x4a1b5f(0x5c5)]), _0x12cce0 = _0x419a1c[_0x4a1b5f(0x58a)]() + '-' + String(_0x419a1c[_0x4a1b5f(0x3e3)]() + 0x1)[_0x4a1b5f(0x3c3)](0x2, '0') + '-' + String(_0x419a1c[_0x4a1b5f(0x425)]())[_0x4a1b5f(0x3c3)](0x2, '0'), _0x3a984e = String(_0x419a1c[_0x4a1b5f(0x200)]())['padStart'](0x2, '0') + ':' + String(_0x419a1c[_0x4a1b5f(0x31f)]())[_0x4a1b5f(0x3c3)](0x2, '0'); let _0x2c0b5c = '未知'; if (_0x4890a0[_0x4a1b5f(0x5a8)] === _0x4a1b5f(0x845)) { if (_0x4a1b5f(0x716) === _0x4a1b5f(0x3ab)) return { 'role': _0x4a1b5f(0x845), 'content': [{ 'type': _0x4a1b5f(0x224), 'text': _0x140d64[_0x4a1b5f(0x283)] || '\x20' }, { 'type': _0x4a1b5f(0x858), 'image_url': { 'url': _0x213601[_0x4a1b5f(0x4e0)], 'detail': 'high' } }] }; else _0x2c0b5c = _0x3cd06e[_0x4a1b5f(0x82e)]; } else _0x4a1b5f(0x490) !== _0x4a1b5f(0x69f) ? _0x2c0b5c = _0x5eb6b6['name'] : (_0xe3afee['src'] = _0x2d193c[_0x4a1b5f(0x78a)](_0xad6a03), _0x4bbb52[_0x4a1b5f(0x3fc)][_0x4a1b5f(0x74d)] = _0x4a1b5f(0x38f)); let _0x3b1ef3 = _0x4890a0['content']; if (_0x4890a0['displayUrl']) _0x3b1ef3 = _0x4a1b5f(0x631); if (_0x4890a0['imageId']) _0x3b1ef3 = _0x4a1b5f(0x595); return '[' + _0x12cce0 + '\x20' + _0x3a984e + ']\x20[' + _0x2c0b5c + _0x4a1b5f(0x3e1) + _0x3b1ef3; } else _0x4f3473[_0x4a1b5f(0x863)]('用户分享音乐失败:', _0x5687ae), _0x5c8546(_0x4a1b5f(0x6f6) + _0x55cbc7[_0x4a1b5f(0x1a4)]); })[_0x5293a2(0x5d2)]('\x0a'), _0x4f2d4a = _0x4ccd38[_0x5293a2(0x41f)](/{charName}/g, _0x5eb6b6[_0x5293a2(0x82e)])[_0x5293a2(0x41f)](/{userName}/g, _0x3cd06e[_0x5293a2(0x82e)]), _0x16a7b9 = [{ 'role': _0x5293a2(0x523), 'content': _0x4f2d4a }, { 'role': _0x5293a2(0x845), 'content': _0x20adbb }], _0xac75e9 = await _0x5cca68(_0x16a7b9); _0xb9a74c[_0x5293a2(0x5a5)] = _0xac75e9 || _0x5293a2(0x5b9), _0xb9a74c[_0x5293a2(0x354)] = 0x0; } } catch (_0x45c30f) { console[_0x5293a2(0x863)](_0x5293a2(0x7bc), _0x45c30f), _0xb9a74c[_0x5293a2(0x5a5)] = _0x5293a2(0x524) + _0x45c30f[_0x5293a2(0x1a4)]; } finally { _0x3168b5(![]), _0x5c6c54['isGenerating'] = ![]; } } async function _0x1271c6() { const _0x25a0c9 = _0xbc3280; if ('siCUV' !== _0x25a0c9(0x255)) { console[_0x25a0c9(0x384)]('---\x20开始AI回复流程\x20---'); if (!_0x5c6c54[_0x25a0c9(0x73a)]['endpoint'] || !_0x5c6c54['apiSettings']['key'] || !_0x5c6c54[_0x25a0c9(0x73a)][_0x25a0c9(0x70d)]) { _0x13197e(_0x25a0c9(0x5d4)); return; } const _0x5eeca6 = _0x5c6c54['conversationHistory']['at'](-0x1)?.['role'] === _0x25a0c9(0x845); if (!_0x5eeca6 || _0x5c6c54['isGenerating']) return; const _0x3aa22b = _0x1e26a8(); if (!_0x3aa22b) return; _0x5c6c54[_0x25a0c9(0x75c)] = !![], _0x1caf99(!![]); try { if (_0x3aa22b[_0x25a0c9(0x443)] === _0x25a0c9(0x77d)) { if (_0x25a0c9(0x378) === _0x25a0c9(0x829)) _0x4411dd(![]); else { const _0x2bcd38 = _0x5a8ee7(_0x3aa22b[_0x25a0c9(0x594)][0x0]); console[_0x25a0c9(0x384)](_0x25a0c9(0x804)); if (_0x2bcd38) await _0xaf4592(_0x2bcd38, { 'force': !![] }); } } else { const _0x2a2712 = await _0x4be880(); if (_0x2a2712 && _0x2a2712[_0x25a0c9(0x699)]?.[_0x25a0c9(0x794)]) await _0x4ec335(_0x2a2712); else { console[_0x25a0c9(0x229)](_0x25a0c9(0x685)); const _0x465861 = _0x3aa22b[_0x25a0c9(0x594)][_0x25a0c9(0x2ac)](_0x5a8ee7)[_0x25a0c9(0x25b)](Boolean); if (!_0x465861[_0x25a0c9(0x794)]) return; let _0x195295 = 0x0; for (const _0x214fc5 of _0x465861) { _0x25a0c9(0x1af) !== _0x25a0c9(0x8b0) ? (_0xaf4592(_0x214fc5, { 'force': !![], 'delayMs': _0x195295 }), _0x195295 += 0x1f4) : _0x580b33[_0x25a0c9(0x4e0)] = _0x560fee; } } } } catch (_0x551591) { 'ahgiz' !== _0x25a0c9(0x503) ? _0x4f8fa7[_0x25a0c9(0x863)](_0x25a0c9(0x632), _0x866fd9) : _0x551591['name'] !== 'AbortError' && (console['error']('获取AI响应失败:', _0x551591), _0x51dbdd({ 'role': 'assistant', 'content': _0x25a0c9(0x61e) + _0x551591[_0x25a0c9(0x1a4)] }, _0x5c6c54['conversationHistory'][_0x25a0c9(0x794)] - 0x1)); } finally { _0x5c6c54[_0x25a0c9(0x75c)] = ![], _0x1caf99(![]); } } else _0x2628b4[_0x25a0c9(0x49b)] = null, _0x1562af(), _0x5be49a('同步已断开。'), _0x29902c(), _0x2e030d['classList'][_0x25a0c9(0x8a2)](_0x25a0c9(0x274)), _0x53eaaf(() => _0x6b323d[_0x25a0c9(0x3fc)][_0x25a0c9(0x74d)] = _0x25a0c9(0x860), 0x12c); } function _0x58002a(_0x18981a, _0x33f715) { const _0x206fbc = _0xbc3280, _0x59325f = _0x33f715[_0x206fbc(0x746)](), _0x3b5452 = _0x18981a[_0x206fbc(0x746)](); if (_0x59325f['startsWith']('claude')) return _0x206fbc(0x7bb); if (_0x3b5452[_0x206fbc(0x87c)](_0x206fbc(0x832))) return 'anthropic'; if (_0x3b5452[_0x206fbc(0x87c)](_0x206fbc(0x386))) return _0x206fbc(0x77b); if (_0x59325f[_0x206fbc(0x380)]('gemini')) return 'gemini'; return _0x206fbc(0x252); } async function _0x5cca68(_0x2c82fc, _0x5116fb = {}) { const _0x169d30 = _0xbc3280; if ('HboRe' === _0x169d30(0x53e)) { _0x5c6c54[_0x169d30(0x493)] && (_0x169d30(0x6c7) === 'lIzfd' ? _0x5c6c54[_0x169d30(0x493)][_0x169d30(0x431)]('New\x20request\x20started') : _0x23b044()); _0x5c6c54[_0x169d30(0x493)] = new AbortController(); const _0x2bbcb0 = _0x5c6c54[_0x169d30(0x493)]['signal'], { endpoint: _0x48222a, key: _0x5efa53, model: _0xd61be4 } = _0x5c6c54[_0x169d30(0x73a)], _0xf5a38a = !!_0x5116fb[_0x169d30(0x21c)], _0x1c1473 = _0x58002a(_0x48222a, _0xd61be4); console['log'](_0x169d30(0x2e6) + _0x1c1473); let _0x14ffd0 = ''; try { switch (_0x1c1473) { case _0x169d30(0x7bb): { const _0x1e94e4 = _0xc3368b(_0x5efa53), _0x56c99b = _0x2c82fc[_0x169d30(0x659)](_0x4bd927 => _0x4bd927['role'] === _0x169d30(0x523))?.[_0x169d30(0x283)] || '', _0x2f874a = _0x2c82fc['filter'](_0x5adf9a => _0x5adf9a[_0x169d30(0x5a8)] !== _0x169d30(0x523)), _0x5ee81e = { 'model': _0xd61be4, 'system': _0x56c99b, 'messages': _0x2f874a[_0x169d30(0x2ac)](_0x2636b1 => ({ 'role': _0x2636b1[_0x169d30(0x5a8)], 'content': [{ 'type': _0x169d30(0x224), 'text': _0x2636b1[_0x169d30(0x283)] }] })), 'max_tokens': 0x1000 }, _0x577de9 = await fetch(_0x48222a, { 'method': _0x169d30(0x498), 'headers': { 'Content-Type': _0x169d30(0x312), 'x-api-key': _0x1e94e4, 'anthropic-version': _0x169d30(0x70c) }, 'body': JSON[_0x169d30(0x79c)](_0x5ee81e), 'signal': _0x2bbcb0 }); if (!_0x577de9['ok']) { if (_0x169d30(0x383) === 'rTbRo') _0x459629(); else { const _0x44f4c1 = await _0x577de9[_0x169d30(0x21c)]()[_0x169d30(0x48f)](() => ({})); throw new Error(_0x169d30(0x505) + _0x577de9[_0x169d30(0x1c0)] + _0x169d30(0x541) + (_0x44f4c1[_0x169d30(0x863)]?.['message'] || _0x577de9['statusText'])); } } const _0x5c2cb4 = await _0x577de9[_0x169d30(0x21c)](); _0x14ffd0 = _0x5c2cb4[_0x169d30(0x283)]?.[0x0]?.[_0x169d30(0x224)] || ''; break; } case _0x169d30(0x77b): { const _0x29b366 = _0xc3368b(_0x5efa53), _0x2ded21 = _0x48222a[_0x169d30(0x87c)]('generativelace.googleapis.com'), _0x25797b = _0x2d8692 => { const _0xf10b52 = _0x169d30, _0x20a487 = []; if (_0x2d8692[_0xf10b52(0x283)]) _0x20a487[_0xf10b52(0x43f)]({ 'text': _0x2d8692[_0xf10b52(0x283)] }); if (_0x2d8692['image']) { if (_0xf10b52(0x3fa) !== _0xf10b52(0x3fa)) _0x531049[_0xf10b52(0x43f)]('[' + _0x3a49e0(_0x38bd2a) + _0xf10b52(0x720) + (_0x206d7a[_0xf10b52(0x283)]?.[_0xf10b52(0x6a9)](/：(.+?)]/)?.[0x1] || '表情') + ']'); else { const _0x47248e = _0x2d8692['image']['split'](',')[0x1], _0x28e4f0 = _0x2d8692[_0xf10b52(0x4e0)][_0xf10b52(0x35b)](_0x2d8692[_0xf10b52(0x4e0)][_0xf10b52(0x64d)](':') + 0x1, _0x2d8692[_0xf10b52(0x4e0)][_0xf10b52(0x64d)](';')) || _0xf10b52(0x27a); _0x20a487[_0xf10b52(0x43f)]({ 'inline_data': { 'mime_type': _0x28e4f0, 'data': _0x47248e } }); } } return _0x20a487; }, _0x75bd37 = _0x2c82fc[_0x169d30(0x2ac)](_0x2dd06e => ({ 'role': _0x2dd06e[_0x169d30(0x5a8)] === _0x169d30(0x535) ? _0x169d30(0x70d) : _0x2dd06e['role'] === _0x169d30(0x523) ? _0x169d30(0x845) : _0x2dd06e[_0x169d30(0x5a8)], 'parts': _0x25797b(_0x2dd06e) }))[_0x169d30(0x25b)](_0x37a430 => _0x37a430[_0x169d30(0x389)][_0x169d30(0x794)] > 0x0), _0x204b18 = { 'contents': _0x75bd37 }; _0xf5a38a && _0x2ded21 && (_0x204b18[_0x169d30(0x5a3)] = { 'response_mime_type': _0x169d30(0x312) }); const _0x425880 = _0x48222a + _0x169d30(0x349) + _0xd61be4 + _0x169d30(0x7d7) + _0x29b366 + _0x169d30(0x375), _0x2f960f = await fetch(_0x425880, { 'method': _0x169d30(0x498), 'headers': { 'Content-Type': _0x169d30(0x312) }, 'body': JSON['stringify'](_0x204b18), 'signal': _0x2bbcb0 }); if (!_0x2f960f['ok']) throw new Error(_0x169d30(0x667) + _0x2f960f[_0x169d30(0x1c0)]); const _0x362158 = _0x2f960f[_0x169d30(0x4ec)][_0x169d30(0x5f3)](), _0x27c89a = new TextDecoder(); let _0x39a179 = ''; while (!![]) { if (_0x2bbcb0[_0x169d30(0x2ca)]) { console['log'](_0x169d30(0x178)), _0x362158[_0x169d30(0x6e4)](); break; } const { done: _0x2dc128, value: _0x512fda } = await _0x362158[_0x169d30(0x1eb)](); if (_0x2dc128) break; const _0x1e42b3 = _0x27c89a['decode'](_0x512fda, { 'stream': !![] }), _0x45b9a3 = _0x1e42b3[_0x169d30(0x8d5)]('\x0a')[_0x169d30(0x25b)](_0x195036 => _0x195036['trim']()[_0x169d30(0x380)](_0x169d30(0x58f))); for (const _0x56faa8 of _0x45b9a3) { if (_0x169d30(0x163) !== _0x169d30(0x163)) _0x3d3d52(_0x169d30(0x1f3), 'musicUploadAltar'); else { const _0x4bf528 = _0x56faa8['replace'](_0x169d30(0x30d), ''); if (_0x4bf528 === _0x169d30(0x508)) break; try { 'AlAgF' !== 'GOjyS' ? _0x39a179 += JSON[_0x169d30(0x5b7)](_0x4bf528)[_0x169d30(0x811)][0x0][_0x169d30(0x283)]['parts'][0x0]['text'] : (_0x10f557[_0x169d30(0x8a2)](), _0x31a308()); } catch { } } } } _0x14ffd0 = _0x39a179; break; } case _0x169d30(0x252): default: { const _0x112eba = _0xc3368b(_0x5efa53), _0x3ecf77 = _0x48222a[_0x169d30(0x41f)](/\/+$/, '') + _0x169d30(0x83d), _0x7067a8 = _0x2c82fc[_0x169d30(0x2ac)](_0x370ce6 => { const _0x515fb6 = _0x169d30; if ('sLnAN' !== _0x515fb6(0x7d0)) { const _0x2da905 = _0x3da056(_0x214c4d[_0x515fb6(0x594)][0x0]); _0x1efaa8[_0x515fb6(0x41a)] = _0x2da905 ? _0x2da905['name'] : _0x515fb6(0x4fc); } else { if (_0x370ce6[_0x515fb6(0x5a8)] === 'user' && _0x370ce6[_0x515fb6(0x4e0)]) return { 'role': 'user', 'content': [{ 'type': 'text', 'text': _0x370ce6[_0x515fb6(0x283)] || '\x20' }, { 'type': _0x515fb6(0x858), 'image_url': { 'url': _0x370ce6['image'], 'detail': _0x515fb6(0x79d) } }] }; return { 'role': _0x370ce6[_0x515fb6(0x5a8)], 'content': _0x370ce6['content'] }; } })[_0x169d30(0x25b)](_0x3ef3b8 => _0x3ef3b8['content']), _0x2612d1 = { 'model': _0xd61be4, 'messages': _0x7067a8, 'max_tokens': 0x1000, ..._0xf5a38a ? { 'response_format': { 'type': _0x169d30(0x551) } } : {} }, _0xf8bce6 = await fetch(_0x3ecf77, { 'method': 'POST', 'headers': { 'Content-Type': _0x169d30(0x312), 'Authorization': 'Bearer\x20' + _0x112eba }, 'body': JSON[_0x169d30(0x79c)](_0x2612d1), 'signal': _0x2bbcb0 }); if (!_0xf8bce6['ok']) { const _0x2b286c = await _0xf8bce6[_0x169d30(0x21c)]()[_0x169d30(0x48f)](() => ({})); throw new Error('OpenAI\x20API\x20错误:\x20' + _0xf8bce6['status'] + _0x169d30(0x541) + (_0x2b286c[_0x169d30(0x863)]?.[_0x169d30(0x1a4)] || _0xf8bce6[_0x169d30(0x5fd)])); } const _0x25cfa2 = await _0xf8bce6[_0x169d30(0x21c)](); _0x14ffd0 = _0x25cfa2[_0x169d30(0x6a2)]?.[0x0]?.['message']?.[_0x169d30(0x283)] || ''; break; } }return _0x14ffd0; } catch (_0x47dafc) { if (_0x47dafc[_0x169d30(0x82e)] === _0x169d30(0x79a)) return console[_0x169d30(0x384)](_0x169d30(0x54f)), ''; throw _0x47dafc; } finally { if ('LcUzA' !== _0x169d30(0x8a5)) { if (_0x5c6c54[_0x169d30(0x493)] && _0x5c6c54[_0x169d30(0x493)][_0x169d30(0x66f)] === _0x2bbcb0) { if (_0x169d30(0x4bd) !== 'XkqHS') _0x5c6c54[_0x169d30(0x493)] = null; else { const _0x1cbd79 = _0x252471[_0x169d30(0x2a6)] || _0x53829e?.[_0x169d30(0x594)][0x0], _0x304afb = _0x38ae57(_0x1cbd79); _0x186ee9 = _0x304afb ? _0x304afb[_0x169d30(0x82e)] : '角色'; } } } else { _0x5ac288(![]), _0x142f86(_0x169d30(0x791)); return; } } } else { const _0x3d6ecd = _0x19526b(_0x3d5e5d[_0x169d30(0x54c)])?.[_0x169d30(0x82e)] || '未知'; return _0x169d30(0x1bf) + _0x3d6ecd + '</span>:\x20' + _0x5cff55[_0x169d30(0x283)] + '</div>'; } } async function _0x188f5b() { const _0x3f896c = _0xbc3280, _0x24648d = _0x32a157[_0x3f896c(0x6b7)][_0x3f896c(0x7a1)][_0x3f896c(0x153)](_0x3f896c(0x39d)), _0x1f9bbe = _0x24648d ? _0x15b466[_0x3f896c(0x5a5)] : null; let _0x177e30 = null, _0x370374 = ''; if (_0x24648d && _0x1f9bbe) { _0x177e30 = _0x5c6c54[_0x3f896c(0x1ce)][_0x3f896c(0x659)](_0x594f14 => _0x594f14['type'] === _0x3f896c(0x77d) && _0x594f14[_0x3f896c(0x594)][_0x3f896c(0x87c)](_0x1f9bbe)); const _0x476d4f = _0x5a8ee7(_0x1f9bbe); _0x370374 = _0x476d4f ? _0x476d4f[_0x3f896c(0x82e)] : _0x3f896c(0x6e9); } else { if (_0x5c6c54[_0x3f896c(0x728)]) { if (_0x3f896c(0x6fe) === _0x3f896c(0x6fe)) { _0x177e30 = _0x1e26a8(); const _0x518f7a = document[_0x3f896c(0x5d9)]('char-name-header')[_0x3f896c(0x41a)]; _0x370374 = _0x518f7a || _0x3f896c(0x44a); } else { const _0x3b866f = _0x4950fd['parse'](_0x22f911['getItem']('cardWidgetState') || '{}'), _0x20bf69 = { ..._0x3b866f, ..._0x1940b1 }; _0x53ffaf[_0x3f896c(0x3cd)](_0x3f896c(0x5f7), _0xb1f3e8[_0x3f896c(0x79c)](_0x20bf69)); } } } if (!_0x177e30) { if (_0x3f896c(0x42b) === _0x3f896c(0x42b)) { _0x13197e('找不到要清空的聊天记录。'); return; } else { _0x134d46(_0x3f896c(0x60c)); return; } } const _0x158035 = await _0x458a99('确定要清空\x22' + _0x370374 + _0x3f896c(0x5d3)); if (!_0x158035) return; _0x177e30['id'] === _0x5c6c54['activeChatId'] && (_0x4d7ca9(), _0x5c6c54['conversationHistory'] = [], _0x1fa1ad()); try { _0x3f896c(0x565) !== 'RvDSW' ? _0x1e08a0[_0x3f896c(0x43f)](..._0x760455(_0x252df)) : localStorage['removeItem']('chatHistory_' + _0x177e30['id']); } catch (_0x132a05) { if ('cYKHv' !== _0x3f896c(0x810)) console[_0x3f896c(0x863)](_0x3f896c(0x8af) + _0x177e30['id'], _0x132a05); else return _0x2680ba['push'](_0x5424a9), _0x487e77; } _0x13197e('\x22' + _0x370374 + _0x3f896c(0x370)); } const _0x2997f0 = document[_0xbc3280(0x5d9)](_0xbc3280(0x4da)), _0x543c2b = document[_0xbc3280(0x5d9)](_0xbc3280(0x232)), _0x3376cf = document[_0xbc3280(0x5d9)](_0xbc3280(0x3de)); _0x2997f0[_0xbc3280(0x73c)](_0xbc3280(0x36d), async () => { const _0x1700e0 = _0xbc3280; _0x3168b5(!![], _0x1700e0(0x1be)); const _0x40db7a = []; try { const _0x1473eb = { 'localStorageData': {}, 'indexedDBData': {}, 'indexedDBMusicData': [] }; for (let _0x275c92 = 0x0; _0x275c92 < localStorage[_0x1700e0(0x794)]; _0x275c92++) { if (_0x1700e0(0x481) === _0x1700e0(0x481)) { const _0x4ccd89 = localStorage[_0x1700e0(0x4de)](_0x275c92); if (_0x4ccd89) _0x1473eb[_0x1700e0(0x311)][_0x4ccd89] = localStorage['getItem'](_0x4ccd89); } else _0x3180cf(_0x1700e0(0x402), _0x1700e0(0x4ab)); } const _0x5aade8 = await _0x3a23c1, _0x4aabb0 = _0x5aade8[_0x1700e0(0x52f)](_0x39b1d8, _0x1700e0(0x605)), _0x9eb8e6 = _0x4aabb0[_0x1700e0(0x4ed)](_0x39b1d8), _0x57bdda = await new Promise((_0x2b3412, _0x5e5344) => { const _0x5111ec = _0x1700e0, _0x54fa6c = _0x9eb8e6[_0x5111ec(0x394)](); _0x54fa6c['onsuccess'] = () => _0x2b3412(_0x54fa6c[_0x5111ec(0x6bf)]), _0x54fa6c['onerror'] = () => _0x5e5344(_0x54fa6c[_0x5111ec(0x863)]); }); for (const _0x36d403 of _0x57bdda) { if (_0x1700e0(0x8a8) !== 'pjXlB') { if (_0x36d403[_0x1700e0(0x2b5)] instanceof Blob) try { _0x1700e0(0x3bf) === 'SbZJR' ? (_0x2f5472[_0x1700e0(0x4e0)] = _0x34634c, _0x4664d5 = !![]) : _0x1473eb['indexedDBData'][_0x36d403['id']] = await _0x51083d(_0x36d403[_0x1700e0(0x2b5)]); } catch (_0x602bdc) { 'NrSoF' !== _0x1700e0(0x15e) ? (_0x43e3e7[_0x1700e0(0x863)](_0x1700e0(0x287) + _0xcf1f1 + _0x1700e0(0x541) + _0x417c79 + '):', _0x1425d4), _0x39aa0d[_0x1700e0(0x621)] = null, _0x173c52[_0x1700e0(0x62d)] = null) : _0x40db7a[_0x1700e0(0x43f)](_0x36d403['id']); } } else _0x187dae[_0x1700e0(0x863)](_0x1700e0(0x403) + _0x4d607e + ':', _0x320608), _0x4060a5[_0x1700e0(0x3fc)]['backgroundImage'] = 'none'; } const _0x338211 = _0x5aade8[_0x1700e0(0x52f)](_0x30a6d2, _0x1700e0(0x605)), _0xb225f4 = _0x338211[_0x1700e0(0x4ed)](_0x30a6d2), _0x1ad0fd = await new Promise((_0x180f30, _0x108163) => { const _0xee4568 = _0x1700e0, _0x63a0c2 = _0xb225f4['getAll'](); _0x63a0c2['onsuccess'] = () => _0x180f30(_0x63a0c2[_0xee4568(0x6bf)]), _0x63a0c2[_0xee4568(0x618)] = () => _0x108163(_0x63a0c2[_0xee4568(0x863)]); }); for (const _0xe24541 of _0x1ad0fd) { const _0x5cd901 = { ..._0xe24541 }; _0xe24541['audio'] instanceof Blob && (_0x1700e0(0x766) === _0x1700e0(0x766) ? _0x5cd901[_0x1700e0(0x5ee)] = await _0x51083d(_0xe24541[_0x1700e0(0x5ee)]) : _0x3e5c06[_0x1700e0(0x7d4)](_0x18dfdd, { 'keyPath': 'id' })), _0xe24541[_0x1700e0(0x7d9)] instanceof Blob && (_0x5cd901['cover'] = await _0x51083d(_0xe24541[_0x1700e0(0x7d9)])), _0x1473eb[_0x1700e0(0x735)][_0x1700e0(0x43f)](_0x5cd901); } const _0x4287da = new Blob([JSON['stringify'](_0x1473eb, null, 0x2)], { 'type': 'application/json' }), _0x1ff5f9 = URL[_0x1700e0(0x78a)](_0x4287da), _0x5c9df6 = document['createElement']('a'), _0x4c18b9 = new Date(), _0x3e86e8 = _0x4c18b9[_0x1700e0(0x58a)]() + '-' + String(_0x4c18b9[_0x1700e0(0x3e3)]() + 0x1)['padStart'](0x2, '0') + '-' + String(_0x4c18b9[_0x1700e0(0x425)]())[_0x1700e0(0x3c3)](0x2, '0'); _0x5c9df6['href'] = _0x1ff5f9, _0x5c9df6[_0x1700e0(0x72e)] = _0x1700e0(0x303) + _0x3e86e8 + '.json', document[_0x1700e0(0x4ec)]['appendChild'](_0x5c9df6), _0x5c9df6[_0x1700e0(0x36d)](), document[_0x1700e0(0x4ec)]['removeChild'](_0x5c9df6), URL[_0x1700e0(0x3d1)](_0x1ff5f9), _0x3168b5(![]); if (_0x40db7a[_0x1700e0(0x794)] > 0x0) { if (_0x1700e0(0x3ec) === _0x1700e0(0x355)) { const _0x39481e = _0x1a42b2[_0x1700e0(0x628)]('p'); _0x39481e[_0x1700e0(0x41a)] = _0x428ebc, _0x39481e[_0x1700e0(0x3fc)][_0x1700e0(0x396)] = '0', _0x54933f[_0x1700e0(0x2c8)](_0x39481e); } else _0x13197e(_0x1700e0(0x7c7) + _0x40db7a[_0x1700e0(0x5d2)]('\x0a')); } else _0x13197e('包含所有图片和音乐的全量数据已成功导出！'); } catch (_0x4b5531) { _0x3168b5(![]), console[_0x1700e0(0x863)]('全量导出失败:', _0x4b5531), _0x13197e(_0x1700e0(0x679) + _0x4b5531[_0x1700e0(0x1a4)]); } }), _0x543c2b[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0xff55d1 = _0xbc3280; 'bChBZ' !== 'bChBZ' ? (_0x59a35f[_0xff55d1(0x67a)] = _0x26895a, _0x2e105c['currentlyPlayingIndex'] = _0x289f8a, _0x12d476[_0xff55d1(0x21b)] = ![], _0x1f3cb7()) : _0x3376cf[_0xff55d1(0x36d)](); }), _0x52f05c[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x488f61), _0x3376cf[_0xbc3280(0x73c)](_0xbc3280(0x288), _0x1d484b => { const _0x395433 = _0xbc3280; if (_0x395433(0x781) !== 'FzZPo') _0x5b2e23[_0x395433(0x41a)] = _0x395433(0x7eb), _0x49f305['value'] = '', _0x178479[_0x395433(0x5a5)] = _0x395433(0x84c) + (_0x22da10[_0x395433(0x48c)][_0x395433(0x794)] + 0x1), _0x4cd8c4['value'] = _0x324941[_0x395433(0x4f0)], _0x4c22c7[_0x395433(0x3fc)][_0x395433(0x74d)] = _0x395433(0x860); else { const _0x3fc11f = _0x1d484b[_0x395433(0x7da)]['files'][0x0]; if (!_0x3fc11f) return; _0x458a99(_0x395433(0x2a0))[_0x395433(0x2b1)](_0x4f28f8 => { const _0x4e9022 = _0x395433; if (!_0x4f28f8) { if (_0x4e9022(0x27c) === _0x4e9022(0x27c)) { _0x3376cf['value'] = ''; return; } else _0x35676a[_0x4e9022(0x863)]('切，加载播放器状态的时候出错了。', _0x4c7086); } _0x3168b5(!![], _0x4e9022(0x2b4)); const _0x332f7c = new FileReader(); _0x332f7c['onload'] = async _0x226072 => { const _0x4b8a72 = _0x4e9022; try { const _0x5aa46b = JSON[_0x4b8a72(0x5b7)](_0x226072['target']['result']); if (!_0x5aa46b['localStorageData'] || !_0x5aa46b[_0x4b8a72(0x785)]) { if (_0x4b8a72(0x477) === _0x4b8a72(0x510)) return; else throw new Error(_0x4b8a72(0x446)); } _0x3168b5(!![], '正在准备图片数据...'); const _0x5560e0 = await Promise[_0x4b8a72(0x5a9)](Object[_0x4b8a72(0x332)](_0x5aa46b[_0x4b8a72(0x785)])['map'](async _0x473dbc => { const _0x545dae = _0x4b8a72, _0x1b9360 = _0x5aa46b['indexedDBData'][_0x473dbc]; if (typeof _0x1b9360 === _0x545dae(0x6a1) && _0x1b9360['startsWith'](_0x545dae(0x58f))) { const _0x296a33 = await _0x4ee7e6(_0x1b9360); return { 'id': _0x473dbc, 'blob': _0x296a33 }; } return null; }))[_0x4b8a72(0x2b1)](_0x27e85d => _0x27e85d[_0x4b8a72(0x25b)](Boolean)), _0x2b2601 = []; if (_0x5aa46b[_0x4b8a72(0x735)]) { _0x3168b5(!![], _0x4b8a72(0x4c4)); const _0x15c528 = _0x5aa46b[_0x4b8a72(0x735)]['map'](async _0x227784 => { const _0x567652 = _0x4b8a72, _0x5957d8 = { ..._0x227784 }; if (_0x227784['audio']) _0x5957d8['audio'] = await _0x4ee7e6(_0x227784[_0x567652(0x5ee)]); if (_0x227784[_0x567652(0x7d9)]) _0x5957d8[_0x567652(0x7d9)] = await _0x4ee7e6(_0x227784['cover']); return _0x5957d8; }); _0x2b2601[_0x4b8a72(0x43f)](...await Promise[_0x4b8a72(0x5a9)](_0x15c528)); } _0x3168b5(!![], _0x4b8a72(0x3a8)), localStorage[_0x4b8a72(0x795)](); for (const _0x61ce61 in _0x5aa46b[_0x4b8a72(0x311)]) { localStorage[_0x4b8a72(0x3cd)](_0x61ce61, _0x5aa46b[_0x4b8a72(0x311)][_0x61ce61]); } _0x3168b5(!![], _0x4b8a72(0x8be)); const _0x3c1f37 = await _0x3a23c1, _0x34196d = _0x3c1f37[_0x4b8a72(0x52f)]([_0x39b1d8, _0x30a6d2], _0x4b8a72(0x15d)), _0x2a3b0c = _0x34196d[_0x4b8a72(0x4ed)](_0x39b1d8), _0xf3f0cd = _0x34196d[_0x4b8a72(0x4ed)](_0x30a6d2); _0x2a3b0c[_0x4b8a72(0x795)](), _0xf3f0cd[_0x4b8a72(0x795)](), _0x5560e0[_0x4b8a72(0x691)](_0x568b75 => _0x2a3b0c[_0x4b8a72(0x6d7)](_0x568b75)), _0x2b2601[_0x4b8a72(0x691)](_0x1066b8 => _0xf3f0cd[_0x4b8a72(0x6d7)](_0x1066b8)), await new Promise((_0x41d998, _0x3d39ba) => { const _0x296001 = _0x4b8a72; _0x34196d['oncomplete'] = _0x41d998, _0x34196d['onerror'] = _0x434bfd => _0x3d39ba(_0x434bfd[_0x296001(0x7da)][_0x296001(0x863)]); }), _0x3168b5(![]), _0x13197e(_0x4b8a72(0x156)), setTimeout(() => location[_0x4b8a72(0x1f8)](), 0x640); } catch (_0x56f277) { _0x3168b5(![]), console[_0x4b8a72(0x863)](_0x4b8a72(0x593), _0x56f277), _0x13197e(_0x4b8a72(0x3ee) + _0x56f277['message']); } finally { _0x4b8a72(0x5ae) !== 'DlRdL' ? _0x3376cf['value'] = '' : _0x29688f[_0x4b8a72(0x699)][_0x4b8a72(0x43f)]({ 'senderId': _0x4f396b['id'], 'kind': _0x4b8a72(0x4b7), 'sticker': _0x416ebe }); } }, _0x332f7c['readAsText'](_0x3fc11f); }); } }); function _0x2d302d() { const _0x5815da = _0xbc3280; _0x39c6a0[_0x5815da(0x5a5)] = _0x5c6c54[_0x5815da(0x73a)][_0x5815da(0x3ba)] || '', _0x271023[_0x5815da(0x5a5)] = _0x5c6c54[_0x5815da(0x73a)]['key'] || '', _0x562bbd[_0x5815da(0x5a5)] = _0x5c6c54['apiSettings'][_0x5815da(0x70d)] || '', _0x165ae9[_0x5815da(0x5a5)] = String(_0x5c6c54[_0x5815da(0x778)]?.[_0x5815da(0x51f)] ?? 0x64), document[_0x5815da(0x5d9)](_0x5815da(0x179))['value'] = _0x5c6c54[_0x5815da(0x73a)][_0x5815da(0x472)] || _0x5815da(0x252); } function _0xb395bb() { const _0x2875bf = _0xbc3280; _0x5c6c54['apiSettings'][_0x2875bf(0x3ba)] = _0x39c6a0[_0x2875bf(0x5a5)][_0x2875bf(0x42f)](), _0x5c6c54[_0x2875bf(0x73a)]['key'] = _0x271023[_0x2875bf(0x5a5)][_0x2875bf(0x42f)](), _0x5c6c54[_0x2875bf(0x73a)][_0x2875bf(0x70d)] = _0x562bbd[_0x2875bf(0x5a5)][_0x2875bf(0x42f)](), _0x5c6c54[_0x2875bf(0x73a)][_0x2875bf(0x472)] = document[_0x2875bf(0x5d9)](_0x2875bf(0x179))[_0x2875bf(0x5a5)]; const _0x5bd119 = parseInt(_0x165ae9['value'], 0xa); _0x5c6c54[_0x2875bf(0x778)][_0x2875bf(0x51f)] = Number['isFinite'](_0x5bd119) && _0x5bd119 > 0x0 ? _0x5bd119 : 0x64, _0xbd25a6(), _0x13197e(_0x2875bf(0x2fa)); } function _0x5e4707() { const _0x12f863 = _0xbc3280; _0x149feb['value'] = _0x5c6c54['userProfile'][_0x12f863(0x82e)] || '', _0x5531e2['src'] = _0x5c6c54[_0x12f863(0x484)][_0x12f863(0x41e)] || _0x4e315e, _0x4313ab[_0x12f863(0x5a5)] = _0x5c6c54[_0x12f863(0x484)][_0x12f863(0x854)] || ''; } function _0x5e77c0() { const _0x3f43 = _0xbc3280; _0x3f43(0x4a1) === 'lXLyF' ? (_0x5c6c54[_0x3f43(0x484)][_0x3f43(0x82e)] = _0x149feb[_0x3f43(0x5a5)][_0x3f43(0x42f)](), _0x5c6c54[_0x3f43(0x484)][_0x3f43(0x854)] = _0x4313ab[_0x3f43(0x5a5)][_0x3f43(0x42f)](), _0xbd25a6(), _0x1fa1ad(), _0x13197e(_0x3f43(0x155)), _0x4ed1c4('settings', _0x3f43(0x484))) : _0x4fefb2 = { 'speaker': _0x16782b[_0x3f43(0x82e)], 'line': _0x385881[_0x3f43(0x283)], 'emotion': _0x3f43(0x63f) }; } async function _0x39e026(_0x49a929 = null) { const _0x4a0dd0 = _0xbc3280; if (_0x4a0dd0(0x3f7) === _0x4a0dd0(0x3f7)) { const _0x2de5f5 = _0x492e31; _0x4ed1c4(_0x4a0dd0(0x6b7), _0x2de5f5); const _0x34c6f3 = document[_0x4a0dd0(0x5d9)](_0x4a0dd0(0x877)); _0x34c6f3[_0x4a0dd0(0x497)] = '', _0x5c6c54['worldBooks']['forEach'](_0x522d31 => { const _0x498b56 = _0x4a0dd0, _0x2f55d4 = document[_0x498b56(0x628)]('label'); _0x2f55d4[_0x498b56(0x497)] = _0x498b56(0x2c9) + _0x522d31['id'] + '\x22>\x20' + _0x522d31[_0x498b56(0x82e)], _0x34c6f3['appendChild'](_0x2f55d4); }), _0xbb5832(_0x4a0dd0(0x55d)), _0x3ffd7b['src'] = '', _0xc0cad6['value'] = '', _0x23843f[_0x4a0dd0(0x161)] = '', _0x339664[_0x4a0dd0(0x5a5)] = '', _0x337ec6[_0x4a0dd0(0x161)] = '', _0x4af1fe['value'] = ''; const _0x586889 = [_0x4a0dd0(0x63f), _0x4a0dd0(0x3b5), _0x4a0dd0(0x2b8), 'sad', 'shy']; _0x586889[_0x4a0dd0(0x691)](_0x23fb49 => { const _0x50bdf5 = _0x4a0dd0; _0x50bdf5(0x1c4) === _0x50bdf5(0x2ee) ? _0x1c249a['alt'] = _0x50bdf5(0x254) : (document[_0x50bdf5(0x5d9)](_0x50bdf5(0x47f) + _0x23fb49 + '-preview')[_0x50bdf5(0x161)] = '', document[_0x50bdf5(0x5d9)]('char-edit-sprite-' + _0x23fb49 + _0x50bdf5(0x293))[_0x50bdf5(0x5a5)] = ''); }); if (_0x49a929) { if ('DvJtO' === _0x4a0dd0(0x64f)) { const _0x50d2cd = _0x5c6c54['characters'][_0x4a0dd0(0x659)](_0x21e61f => _0x21e61f['id'] === _0x49a929); if (!_0x50d2cd) return; _0x15b466[_0x4a0dd0(0x5a5)] = _0x50d2cd['id'], _0x4961e5[_0x4a0dd0(0x41a)] = '编辑角色', _0x4d739e[_0x4a0dd0(0x5a5)] = _0x50d2cd[_0x4a0dd0(0x82e)], _0x2f857c[_0x4a0dd0(0x5a5)] = _0x50d2cd[_0x4a0dd0(0x7f8)], _0x2ca778[_0x4a0dd0(0x5a5)] = _0x50d2cd[_0x4a0dd0(0x854)], document[_0x4a0dd0(0x5d9)](_0x4a0dd0(0x321))[_0x4a0dd0(0x5a5)] = _0x50d2cd[_0x4a0dd0(0x4fd)] || ''; const _0x383165 = _0x5c6c54[_0x4a0dd0(0x1ce)][_0x4a0dd0(0x659)](_0x31d4f3 => _0x31d4f3[_0x4a0dd0(0x443)] === _0x4a0dd0(0x77d) && _0x31d4f3[_0x4a0dd0(0x594)][_0x4a0dd0(0x87c)](_0x49a929)); document[_0x4a0dd0(0x5d9)]('char-edit-bind-user')['value'] = _0x383165?.[_0x4a0dd0(0x41c)] || _0x5c6c54[_0x4a0dd0(0x4f0)]; try { const _0xeaa514 = await _0x2eb454('char_avatar_' + _0x50d2cd['id']), _0x31b8af = await _0x2eb454(_0x4a0dd0(0x68d) + _0x50d2cd['id']), _0x5df57d = await _0x2eb454(_0x4a0dd0(0x429) + _0x50d2cd['id']); _0x3ffd7b[_0x4a0dd0(0x161)] = _0xeaa514 ? URL[_0x4a0dd0(0x78a)](_0xeaa514) : _0x50d2cd[_0x4a0dd0(0x41e)] || _0x166d38; if (_0x31b8af) _0x23843f[_0x4a0dd0(0x161)] = URL[_0x4a0dd0(0x78a)](_0x31b8af); if (_0x5df57d) _0x337ec6['src'] = URL[_0x4a0dd0(0x78a)](_0x5df57d); for (const _0x3238dc of _0x586889) { const _0x4d2720 = await _0x2eb454('char_sprite_' + _0x3238dc + '_' + _0x50d2cd['id']); _0x4d2720 && (document[_0x4a0dd0(0x5d9)](_0x4a0dd0(0x47f) + _0x3238dc + _0x4a0dd0(0x4bb))[_0x4a0dd0(0x161)] = URL[_0x4a0dd0(0x78a)](_0x4d2720)); } } catch (_0x35eabc) { console['error']('加载角色\x20' + _0x50d2cd['id'] + _0x4a0dd0(0x635), _0x35eabc), _0x3ffd7b[_0x4a0dd0(0x161)] = _0x50d2cd[_0x4a0dd0(0x41e)] || _0x166d38; } if (_0x50d2cd['linkedWorldBookIds']) { if (_0x4a0dd0(0x20b) !== _0x4a0dd0(0x20b)) { _0x19cd84[_0x4a0dd0(0x4dc)][_0x3aa55f] = null; if (_0x588f2e === _0x4a0dd0(0x4e0)) _0x1e9900['pendingPostAttachments'][_0x4a0dd0(0x2f3)] = null; _0x2e3ebf(); } else _0x34c6f3['querySelectorAll'](_0x4a0dd0(0x39f))['forEach'](_0x1fa017 => { const _0x5b888c = _0x4a0dd0; if (_0x5b888c(0x681) === _0x5b888c(0x681)) { if (_0x50d2cd['linkedWorldBookIds'][_0x5b888c(0x87c)](_0x1fa017['value'])) _0x1fa017[_0x5b888c(0x27f)] = !![]; } else _0x27e845[_0x5b888c(0x5a5)] = _0x9bcd42, _0x249a72[_0x5b888c(0x7a1)][_0x5b888c(0x8a2)](_0x5b888c(0x274)); }); } _0x4b0c7c(); } else _0x215643[_0x4a0dd0(0x7ac)](), _0x549b5e(); } else { if (_0x4a0dd0(0x57c) === _0x4a0dd0(0x80c)) { const _0x4eedd4 = _0x35d795[_0x4a0dd0(0x834)][_0x4a0dd0(0x25b)](_0x508a8f => _0x508a8f[_0x4a0dd0(0x443)] === _0x4a0dd0(0x388) && _0x508a8f[_0x4a0dd0(0x62d)])['map'](_0x2868a7 => ({ ..._0x2868a7, 'source': _0x4a0dd0(0x839) })); _0x280e54[_0x4a0dd0(0x43f)](..._0x4eedd4); } else _0x15b466[_0x4a0dd0(0x5a5)] = '', _0x4961e5['textContent'] = _0x4a0dd0(0x69c), _0x4d739e[_0x4a0dd0(0x5a5)] = _0x4a0dd0(0x174) + (_0x5c6c54[_0x4a0dd0(0x24a)][_0x4a0dd0(0x794)] + 0x1), _0x2f857c[_0x4a0dd0(0x5a5)] = '', _0x3ffd7b['src'] = _0x166d38, _0x2ca778[_0x4a0dd0(0x5a5)] = '你是一个乐于助人的AI助手。', document[_0x4a0dd0(0x5d9)](_0x4a0dd0(0x321))[_0x4a0dd0(0x5a5)] = '', _0x4b0c7c(); } const _0x38c0aa = document[_0x4a0dd0(0x5d9)](_0x4a0dd0(0x321)); let _0x1fe9fc = document[_0x4a0dd0(0x5d9)](_0x4a0dd0(0x7e5)); !_0x1fe9fc && (_0x1fe9fc = document['createElement'](_0x4a0dd0(0x3fc)), _0x1fe9fc['id'] = _0x4a0dd0(0x7e5), document[_0x4a0dd0(0x5e4)]['appendChild'](_0x1fe9fc)); const _0x50eb76 = () => { const _0x37a64c = _0x4a0dd0, _0x433881 = _0x38c0aa[_0x37a64c(0x5a5)]; let _0x3fc059 = _0x433881[_0x37a64c(0x41f)](/\.bubble\.sent/g, _0x37a64c(0x7ef))[_0x37a64c(0x41f)](/\.bubble\.received/g, _0x37a64c(0x1fe)); _0x1fe9fc[_0x37a64c(0x497)] = _0x3fc059; }; _0x38c0aa[_0x4a0dd0(0x2d3)](_0x4a0dd0(0x1fa), _0x50eb76), _0x38c0aa[_0x4a0dd0(0x73c)](_0x4a0dd0(0x1fa), _0x50eb76), _0x50eb76(); } else { _0x171dee[_0x4a0dd0(0x497)] = _0x4a0dd0(0x335); return; } } async function _0x20b21a() { const _0x3a5b89 = _0xbc3280; if (_0x3a5b89(0x6f7) !== _0x3a5b89(0x6f7)) { if (_0x48d2e7[_0x3a5b89(0x4de)] === _0x3a5b89(0x46b)) _0x57ab29(![]); if (_0x3ec9a1[_0x3a5b89(0x4de)] === _0x3a5b89(0x47d)) _0x8bf3fe(!![]); } else { const _0x406d3a = _0x15b466[_0x3a5b89(0x5a5)]; let _0x169a66 = null; const _0x40e0c1 = _0xc0cad6[_0x3a5b89(0x3ad)][0x0], _0x4f5bbd = _0x339664[_0x3a5b89(0x3ad)][0x0], _0x5a5246 = _0x4af1fe[_0x3a5b89(0x3ad)][0x0], _0x425253 = document[_0x3a5b89(0x81a)]('#world-book-checkboxes-container\x20input:checked'), _0x2d1261 = Array['from'](_0x425253)[_0x3a5b89(0x2ac)](_0x54af2f => _0x54af2f[_0x3a5b89(0x5a5)]), _0x3bf0e4 = { 'name': _0x4d739e[_0x3a5b89(0x5a5)][_0x3a5b89(0x42f)](), 'remark': _0x2f857c[_0x3a5b89(0x5a5)][_0x3a5b89(0x42f)](), 'persona': _0x2ca778[_0x3a5b89(0x5a5)]['trim'](), 'linkedWorldBookIds': _0x2d1261, 'boundUserProfileId': document[_0x3a5b89(0x5d9)](_0x3a5b89(0x55d))[_0x3a5b89(0x5a5)], 'bubbleCss': document[_0x3a5b89(0x5d9)]('char-edit-css')['value'][_0x3a5b89(0x42f)]() }; if (!_0x3bf0e4[_0x3a5b89(0x82e)]) { _0x13197e(_0x3a5b89(0x367)); return; } try { const _0x4dfb1c = [_0x3a5b89(0x63f), _0x3a5b89(0x3b5), _0x3a5b89(0x2b8), _0x3a5b89(0x644), _0x3a5b89(0x4b5)]; if (_0x406d3a) { if (_0x3a5b89(0x7df) === 'tnIij') { const _0x62457c = _0x5c6c54[_0x3a5b89(0x24a)][_0x3a5b89(0x659)](_0x20a791 => _0x20a791['id'] === _0x406d3a); if (_0x62457c) { Object[_0x3a5b89(0x8cb)](_0x62457c, _0x3bf0e4); if (_0x40e0c1) _0x62457c[_0x3a5b89(0x41e)] = await _0x2da880(_0x40e0c1); } if (_0x40e0c1) await _0x1c943a('char_avatar_' + _0x406d3a, _0x40e0c1); if (_0x4f5bbd) await _0x1c943a(_0x3a5b89(0x68d) + _0x406d3a, _0x4f5bbd); if (_0x5a5246) await _0x1c943a(_0x3a5b89(0x429) + _0x406d3a, _0x5a5246); for (const _0x272dda of _0x4dfb1c) { if ('iALIW' !== _0x3a5b89(0x711)) { const _0x2902a2 = _0x5ea81a[_0x3a5b89(0x64d)]('{'), _0x587367 = _0x512ba0['lastIndexOf']('}'); if (_0x2902a2 >= 0x0 && _0x587367 > _0x2902a2) return _0x204757['slice'](_0x2902a2, _0x587367 + 0x1); return _0x5d4e48; } else { const _0x3639b5 = document[_0x3a5b89(0x5d9)](_0x3a5b89(0x47f) + _0x272dda + '-input')[_0x3a5b89(0x3ad)][0x0]; if (_0x3639b5) await _0x1c943a(_0x3a5b89(0x657) + _0x272dda + '_' + _0x406d3a, _0x3639b5); } } } else _0xd662f7[_0x3a5b89(0x6ba)](_0x4dcd24 => { const _0x89c7a0 = _0x3a5b89; _0x4dcd24 ? _0x4880fc(_0x4dcd24) : _0x45d581(new _0x4f7a80(_0x89c7a0(0x75f))); }, _0x815ac0, _0x40722f); } else { _0x169a66 = _0x3a5b89(0x6c4) + Date[_0x3a5b89(0x7a5)](); const _0x55b2f7 = { 'id': _0x169a66, ..._0x3bf0e4 }; _0x55b2f7[_0x3a5b89(0x41e)] = _0x40e0c1 ? await _0x2da880(_0x40e0c1) : _0x166d38, _0x5c6c54[_0x3a5b89(0x24a)][_0x3a5b89(0x43f)](_0x55b2f7); const _0x4476d8 = { 'id': 'chat_' + _0x169a66, 'type': _0x3a5b89(0x77d), 'participantIds': [_0x169a66], 'boundUserProfileId': _0x3bf0e4[_0x3a5b89(0x41c)], 'listenTogetherSession': null }; _0x5c6c54['chats']['push'](_0x4476d8); if (_0x40e0c1) await _0x1c943a(_0x3a5b89(0x324) + _0x169a66, _0x40e0c1); if (_0x4f5bbd) await _0x1c943a(_0x3a5b89(0x68d) + _0x169a66, _0x4f5bbd); if (_0x5a5246) await _0x1c943a(_0x3a5b89(0x429) + _0x169a66, _0x5a5246); for (const _0x2b4e3b of _0x4dfb1c) { const _0x5c0c85 = document[_0x3a5b89(0x5d9)](_0x3a5b89(0x47f) + _0x2b4e3b + _0x3a5b89(0x293))[_0x3a5b89(0x3ad)][0x0]; if (_0x5c0c85) await _0x1c943a(_0x3a5b89(0x657) + _0x2b4e3b + '_' + _0x169a66, _0x5c0c85); } } _0xbd25a6(), _0x11cd8d(), _0x13197e(_0x3a5b89(0x708)), _0x4ed1c4(_0x3a5b89(0x2da), 'characterEdit'); if (!_0x406d3a) { const _0xf01ee1 = 'chat_' + _0x169a66; _0x5ef958(_0xf01ee1), _0x5a8240(!![]); } } catch (_0x1dd159) { console[_0x3a5b89(0x863)]('保存角色失败:', _0x1dd159), _0x13197e('保存失败:\x20' + _0x1dd159[_0x3a5b89(0x1a4)]); } } } function _0x1b3bbf() { const _0x253c78 = _0xbc3280; if (_0x253c78(0x241) !== _0x253c78(0x1d6)) { _0x2f0570[_0x253c78(0x5a5)] = '', _0x41f6b1[_0x253c78(0x497)] = ''; if (_0x5c6c54['characters'][_0x253c78(0x794)] < 0x2) { _0x13197e(_0x253c78(0x206)); return; } _0x5c6c54[_0x253c78(0x24a)][_0x253c78(0x691)](_0x5abfc5 => { const _0x50232e = _0x253c78, _0xc2db01 = document[_0x50232e(0x628)]('li'); _0xc2db01[_0x50232e(0x63a)] = _0x50232e(0x1e5), _0xc2db01[_0x50232e(0x497)] = _0x50232e(0x26f) + _0x5abfc5['id'] + _0x50232e(0x305) + _0x5abfc5['id'] + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x5abfc5[_0x50232e(0x41e)] || _0x166d38) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-' + _0x5abfc5['id'] + '\x22\x20class=\x22char-name\x22>' + _0x5abfc5[_0x50232e(0x82e)] + _0x50232e(0x585), _0x41f6b1[_0x50232e(0x2c8)](_0xc2db01); }), _0x4ed1c4(_0x253c78(0x4bc), 'charSelect'); } else _0x475893(_0x253c78(0x617)); } function _0x1a8074() { const _0x1a174d = _0xbc3280, _0x3e8f27 = _0x2f0570[_0x1a174d(0x5a5)]['trim'](); if (!_0x3e8f27) { if ('bUuit' !== _0x1a174d(0x4be)) { const _0x232270 = _0x2a962f[_0x1a174d(0x628)](_0x1a174d(0x5ca)); _0x232270['value'] = _0x1223d2['id'], _0x232270[_0x1a174d(0x41a)] = _0x4566ef[_0x1a174d(0x82e)], _0x2cc455['appendChild'](_0x232270); } else { _0x13197e(_0x1a174d(0x50c)); return; } } const _0x4cb763 = Array['from'](_0x41f6b1[_0x1a174d(0x81a)](_0x1a174d(0x2f6)))[_0x1a174d(0x2ac)](_0x1ec4f7 => _0x1ec4f7[_0x1a174d(0x17f)]['id']); if (_0x4cb763['length'] < 0x2) { _0x13197e(_0x1a174d(0x4ce)); return; } const _0x55efda = { 'id': _0x1a174d(0x3d7) + Date[_0x1a174d(0x7a5)](), 'type': _0x1a174d(0x441), 'name': _0x3e8f27, 'participantIds': _0x4cb763 }; _0x5c6c54['chats']['push'](_0x55efda), _0x5c6c54[_0x1a174d(0x728)] = _0x55efda['id'], _0xbd25a6(), _0x11cd8d(), _0x10d288(), _0x2ec9c2(), _0x13197e(_0x1a174d(0x3ae) + _0x3e8f27 + _0x1a174d(0x73f)), _0x4ed1c4(_0x1a174d(0x2da), _0x1a174d(0x4bc)); } _0x23d5ea[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0xd7ff34), _0x1d25ab[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => _0x332981['classList'][_0xbc3280(0x8a2)](_0xbc3280(0x274))), _0x2dac9c[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => _0x332981[_0xbc3280(0x7a1)][_0xbc3280(0x8a2)](_0xbc3280(0x274))), _0x2eb524[_0xbc3280(0x73c)]('click', () => { const _0x1dfea8 = _0xbc3280; _0xb9a74c[_0x1dfea8(0x428)](), navigator['clipboard']['writeText'](_0xb9a74c[_0x1dfea8(0x5a5)])['then'](() => { const _0x91642b = _0x1dfea8; if (_0x91642b(0x5e9) === 'zaoej') { const _0x164575 = new _0x9e26c9(), _0x258204 = _0x4f2512[_0x91642b(0x5d9)]('galgame-time'), _0x3b9c72 = _0x6a5e3c['getElementById']('galgame-date'); if (_0x258204 && _0x3b9c72) { const _0x344491 = _0x3fd8b5(_0x164575['getHours']())[_0x91642b(0x3c3)](0x2, '0'), _0x1c29cb = _0x4fec30(_0x164575['getMinutes']())[_0x91642b(0x3c3)](0x2, '0'); _0x258204['textContent'] = _0x344491 + ':' + _0x1c29cb; const _0x26cb55 = _0x164575[_0x91642b(0x3e3)]() + 0x1, _0x456043 = _0x164575[_0x91642b(0x425)](), _0x4a9a53 = [_0x91642b(0x4e5), '星期一', _0x91642b(0x3ef), '星期三', _0x91642b(0x7dc), '星期五', _0x91642b(0x208)][_0x164575[_0x91642b(0x838)]()]; _0x3b9c72[_0x91642b(0x41a)] = _0x26cb55 + '月' + _0x456043 + '日\x20' + _0x4a9a53; } } else _0x13197e(_0x91642b(0x617)); })['catch'](_0x2a479e => { const _0x28cfbe = _0x1dfea8; _0x13197e(_0x28cfbe(0x827)); }); }), _0x57c615[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x53a4df), _0x10094f['addEventListener']('click', _0xff6ba4), _0x43ac38[_0xbc3280(0x73c)]('click', () => _0x44c688[_0xbc3280(0x7a1)][_0xbc3280(0x8a2)](_0xbc3280(0x274))), _0x45dc15[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => _0x44c688[_0xbc3280(0x7a1)][_0xbc3280(0x8a2)]('show')), _0x23843f[_0xbc3280(0x73c)]('click', () => _0x339664['click']()), _0x337ec6[_0xbc3280(0x73c)]('click', () => _0x4af1fe['click']()), _0x339664[_0xbc3280(0x73c)](_0xbc3280(0x288), async _0x56f436 => { const _0x322886 = _0xbc3280, _0x56b6b5 = _0x56f436[_0x322886(0x7da)][_0x322886(0x3ad)][0x0]; if (!_0x56b6b5) return; try { _0x23843f['src'] = await _0x2da880(_0x56b6b5); } catch (_0x2ff71e) { _0x13197e(_0x322886(0x61e) + _0x2ff71e[_0x322886(0x1a4)]); } }), _0x4af1fe[_0xbc3280(0x73c)](_0xbc3280(0x288), async _0x2a90e5 => { const _0x3ef00e = _0xbc3280, _0x2e222d = _0x2a90e5[_0x3ef00e(0x7da)]['files'][0x0]; if (!_0x2e222d) return; try { if (_0x3ef00e(0x442) !== _0x3ef00e(0x442)) { const _0x53a241 = []; if (_0x21660d[_0x3ef00e(0x283)]) _0x53a241[_0x3ef00e(0x43f)]({ 'text': _0x20f742[_0x3ef00e(0x283)] }); if (_0x30a8cb[_0x3ef00e(0x4e0)]) { const _0x1613fc = _0x4eabba[_0x3ef00e(0x4e0)][_0x3ef00e(0x8d5)](',')[0x1], _0xb2f167 = _0x1001fe[_0x3ef00e(0x4e0)][_0x3ef00e(0x35b)](_0x3eaf31['image'][_0x3ef00e(0x64d)](':') + 0x1, _0x16b758[_0x3ef00e(0x4e0)][_0x3ef00e(0x64d)](';')) || 'image/jpeg'; _0x53a241['push']({ 'inline_data': { 'mime_type': _0xb2f167, 'data': _0x1613fc } }); } return _0x53a241; } else _0x337ec6['src'] = await _0x2da880(_0x2e222d); } catch (_0x1322fd) { _0x3ef00e(0x712) !== _0x3ef00e(0x712) ? _0x14cdd5(_0x28ca03, _0x17a5e2) : _0x13197e(_0x3ef00e(0x61e) + _0x1322fd[_0x3ef00e(0x1a4)]); } }), _0x345178[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => _0x32b892[_0xbc3280(0x36d)]()), _0x3007a8[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0x3b3492 = _0xbc3280; if (_0x3b3492(0x2e8) !== _0x3b3492(0x499)) localStorage[_0x3b3492(0x5b3)](_0x3b3492(0x22d)), _0x35fb03(), _0x13197e(_0x3b3492(0x66c)); else { _0x522415(_0x3b3492(0x625)); return; } }), _0x32b892['addEventListener'](_0xbc3280(0x288), async _0x2fe683 => { const _0xe77646 = _0xbc3280; if ('YJErS' === 'YJErS') { const _0x5bbca7 = _0x2fe683[_0xe77646(0x7da)]['files'][0x0]; if (!_0x5bbca7) return; try { const _0xa6f0d1 = await _0x2da880(_0x5bbca7); localStorage[_0xe77646(0x3cd)]('customFeedWallpaper', _0xa6f0d1), _0x35fb03(), _0x13197e(_0xe77646(0x8a6)); } catch (_0x1403e7) { if ('rNSnS' === 'rNSnS') _0x13197e('错误:\x20' + _0x1403e7[_0xe77646(0x1a4)]); else { _0x1d90f2[_0xe77646(0x497)] = _0xe77646(0x7f9); return; } } } else _0x3bd89[_0xe77646(0x5d9)]('char-edit-sprite-' + _0x46ebc2 + _0xe77646(0x4bb))[_0xe77646(0x161)] = _0x42a935[_0xe77646(0x78a)](_0x291d5a); }), document['getElementById'](_0xbc3280(0x84a))[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => _0x4ed1c4('chat', _0xbc3280(0x444))), document['getElementById'](_0xbc3280(0x424))[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x2d65d3); const _0x37ef48 = document[_0xbc3280(0x5d9)](_0xbc3280(0x779)), _0x19adf6 = document['getElementById'](_0xbc3280(0x701)); _0x37ef48['addEventListener'](_0xbc3280(0x36d), () => _0x19adf6['click']()), _0x19adf6['addEventListener']('change', _0xcd8a9a => { const _0x3699af = _0xbc3280, _0x20c553 = _0xcd8a9a[_0x3699af(0x7da)]['files'][0x0]; if (!_0x20c553) return; const _0x27e8a7 = URL[_0x3699af(0x78a)](_0x20c553); _0x37ef48[_0x3699af(0x161)] = _0x27e8a7, _0x37ef48[_0x3699af(0x792)] = () => { const _0x220d62 = _0x3699af; if (_0x220d62(0x865) === _0x220d62(0x1b2)) { if (_0x2521b1[_0x220d62(0x794)] === 0x0) return; _0x48398c = (_0x4a3475 + 0x1) % _0x4602b0[_0x220d62(0x794)], _0x3135d7(_0x3b1a07[_0x7ade4], _0x37423a); } else URL['revokeObjectURL'](_0x27e8a7); }; }); const _0x4e27a3 = document[_0xbc3280(0x5d9)]('group-bg-preview')['parentElement'], _0x6f4c5b = document[_0xbc3280(0x5d9)](_0xbc3280(0x86d)), _0x29da91 = document['getElementById']('group-bg-preview'); _0x4e27a3[_0xbc3280(0x73c)]('click', () => _0x6f4c5b['click']()), _0x6f4c5b[_0xbc3280(0x73c)](_0xbc3280(0x288), _0x1ad857 => { const _0x273773 = _0xbc3280, _0x27ccad = _0x1ad857[_0x273773(0x7da)][_0x273773(0x3ad)][0x0]; if (!_0x27ccad) return; const _0x2b07dd = URL[_0x273773(0x78a)](_0x27ccad); _0x29da91[_0x273773(0x161)] = _0x2b07dd, _0x29da91[_0x273773(0x792)] = () => { const _0xcca442 = _0x273773; _0xcca442(0x4c1) !== _0xcca442(0x4c1) ? _0x5b2395[_0xcca442(0x266)] && _0x4edf99(_0x26f607['activeFriendCircleId']) : URL['revokeObjectURL'](_0x2b07dd); }; }); const _0x1a4ddd = document[_0xbc3280(0x85e)](_0xbc3280(0x6e6)), _0x5930ba = document[_0xbc3280(0x5d9)](_0xbc3280(0x7dd)); _0x1a4ddd['addEventListener'](_0xbc3280(0x36d), _0x221b1c => { const _0x4f4c68 = _0xbc3280; 'LQyoZ' !== _0x4f4c68(0x282) ? (_0x221b1c[_0x4f4c68(0x855)](), _0x5930ba[_0x4f4c68(0x7a1)][_0x4f4c68(0x700)]('visible'), _0x1a4ddd[_0x4f4c68(0x7a1)][_0x4f4c68(0x700)]('expanded')) : (_0x52c2a1['error'](_0x4f4c68(0x3f5) + _0x1ed5c4['id'] + _0x4f4c68(0x635), _0x38dfb9), _0x613735[_0x4f4c68(0x161)] = _0x339587[_0x4f4c68(0x41e)] || _0x3152e3); }), _0x5930ba['addEventListener'](_0xbc3280(0x288), _0x13ed65), document[_0xbc3280(0x5d9)]('group-clear-history-button')[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x188f5b), document['getElementById'](_0xbc3280(0x2fc))[_0xbc3280(0x73c)](_0xbc3280(0x36d), async () => { const _0x480b14 = _0xbc3280, _0x2ad4ad = _0x1e26a8(); if (!_0x2ad4ad || _0x2ad4ad[_0x480b14(0x443)] !== _0x480b14(0x441)) return; const _0x34464b = await _0x458a99('确定要删除群聊“' + _0x2ad4ad[_0x480b14(0x82e)] + _0x480b14(0x732)); if (_0x34464b) { if (_0x480b14(0x253) === _0x480b14(0x59f)) { _0x157f7f(![]), _0x1dab64(_0x480b14(0x793)); return; } else _0x2cabe3(_0x2ad4ad['id']), _0x13197e(_0x480b14(0x50d)), _0x4ed1c4(_0x480b14(0x2da)), _0x5a8240(![]); } }); const _0x424da1 = document[_0xbc3280(0x85e)](_0xbc3280(0x6da)), _0x59cf30 = document[_0xbc3280(0x5d9)](_0xbc3280(0x877)); _0x424da1[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x3ef222 => { const _0x563f8d = _0xbc3280; 'yunWT' !== 'DhWpG' ? (_0x3ef222[_0x563f8d(0x855)](), _0x59cf30[_0x563f8d(0x7a1)][_0x563f8d(0x700)](_0x563f8d(0x2fd)), _0x424da1[_0x563f8d(0x7a1)][_0x563f8d(0x700)](_0x563f8d(0x422))) : _0x116c1c[_0x563f8d(0x3fc)][_0x563f8d(0x88e)] = _0x563f8d(0x5cd); }), _0x59cf30[_0xbc3280(0x73c)](_0xbc3280(0x288), _0x4b0c7c), document[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x1daf2c => { const _0x11e138 = _0xbc3280; !document[_0x11e138(0x85e)]('.custom-multiselect')[_0x11e138(0x153)](_0x1daf2c['target']) && (_0x11e138(0x7f1) === _0x11e138(0x1ac) ? _0x4e6222['isAnimatingDiary'] = ![] : (_0x59cf30['classList'][_0x11e138(0x8a2)](_0x11e138(0x2fd)), _0x424da1['classList'][_0x11e138(0x8a2)](_0x11e138(0x422)))); }), _0x1dc507['addEventListener']('click', () => { const _0x980292 = _0xbc3280; _0x980292(0x80a) === 'gmkZh' ? (_0x306d51[_0x980292(0x6bd)] = _0x22f391['worldBooks'][_0x980292(0x25b)](_0x306c30 => _0x306c30['id'] !== _0x441f40), _0x44dc03[_0x980292(0x24a)][_0x980292(0x691)](_0x2b075a => { const _0x583b30 = _0x980292; _0x2b075a[_0x583b30(0x88d)] && (_0x2b075a[_0x583b30(0x88d)] = _0x2b075a[_0x583b30(0x88d)][_0x583b30(0x25b)](_0x4e1606 => _0x4e1606 !== _0x376803)); }), _0x4db6ed(), _0x367ffa(_0x980292(0x315)), _0x48bd92(), _0x5958d5('worldBook', _0x980292(0x2a2))) : (_0x5cceef(), _0x4ed1c4(_0x980292(0x7cd), _0x980292(0x402))); }), document['getElementById'](_0xbc3280(0x763))[_0xbc3280(0x73c)]('click', () => _0x4ed1c4('home', _0xbc3280(0x7cd))), document[_0xbc3280(0x5d9)](_0xbc3280(0x5e1))[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => _0x47644d()), document['getElementById'](_0xbc3280(0x30e))[_0xbc3280(0x73c)]('click', () => { const _0x56f227 = _0xbc3280; _0x5cceef(), _0x4ed1c4(_0x56f227(0x7cd), _0x56f227(0x2a2)); }), document[_0xbc3280(0x5d9)]('save-world-book-button')['addEventListener'](_0xbc3280(0x36d), _0x55e432), document['getElementById'](_0xbc3280(0x435))[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x53dab4), _0x44ab77[_0xbc3280(0x73c)]('click', () => _0x4ed1c4(_0xbc3280(0x40c), _0xbc3280(0x402))), _0x428022[_0xbc3280(0x73c)]('click', () => _0x4ed1c4(_0xbc3280(0x402), _0xbc3280(0x40c))), _0x948f9b[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => _0x5340f8['click']()), _0x5340f8[_0xbc3280(0x73c)](_0xbc3280(0x288), async _0x560aa7 => { const _0x5d9902 = _0xbc3280, _0x4bed24 = _0x560aa7[_0x5d9902(0x7da)]['files'][0x0]; if (!_0x4bed24) return; await _0x5986ef(_0x4bed24); }), _0x28e07e[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0x234f5c = _0xbc3280; _0x11cd8d(), _0x4ed1c4(_0x234f5c(0x2da), _0x234f5c(0x402)); }), _0x380fb0['addEventListener'](_0xbc3280(0x36d), () => { const _0x6cc91e = _0xbc3280; if (_0x6cc91e(0x351) !== _0x6cc91e(0x351)) _0x463fd1['push'](_0x514c4b['id']); else { _0x2d302d(); const _0x395277 = (_0x5c6c54['apiSettings'][_0x6cc91e(0x3ba)] || '')[_0x6cc91e(0x87c)](_0x558ae1); _0x581dea['disabled'] = _0x395277, _0x4ed1c4('settings', 'home'); } }), _0x2d1cc4[_0xbc3280(0x73c)]('click', () => _0x4ed1c4('home', _0xbc3280(0x84b))), _0x520d1f[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0x51d61c = _0xbc3280; _0x4d7ca9(), _0x4ed1c4('home', _0x51d61c(0x2da)); }), _0x5d5ad0[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { _0x4d7ca9(), _0x5a8240(![]); }), _0xfb8c6[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0x3b0c96 = _0xbc3280; _0x4ed1c4('chat', _0x3b0c96(0x6b7)); }), _0x29dfdd[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0x3cdc6a = _0xbc3280; _0x447131[_0x3cdc6a(0x7a1)]['add'](_0x3cdc6a(0x274)); }), _0x8cd2df[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => _0x32bf83()), _0xf2372d[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x1271c6); function _0x5396f3(_0x1f6bb3) { const _0x460c68 = _0xbc3280; if (!_0x1f6bb3 || _0x1f6bb3['type'] !== _0x460c68(0x441)) return; const _0xd1ca97 = _0x460c68(0x26a); document[_0x460c68(0x4ec)][_0x460c68(0x559)](_0x460c68(0x371), _0xd1ca97); const _0x4e7ace = document[_0x460c68(0x5d9)](_0x460c68(0x7c8)), _0x416acd = _0x4e7ace['querySelector'](_0x460c68(0x1cc)), _0x4579c6 = document[_0x460c68(0x5d9)](_0x460c68(0x6c0)), _0x434683 = document['getElementById'](_0x460c68(0x39e)), _0x5f0fc5 = document[_0x460c68(0x5d9)]('group-edit-name'), _0x428fa4 = document[_0x460c68(0x5d9)]('group-delete'), _0x49dd6d = document[_0x460c68(0x5d9)](_0x460c68(0x4c9)), _0x482de3 = () => _0x4e7ace[_0x460c68(0x8a2)](); _0x4579c6[_0x460c68(0x73c)](_0x460c68(0x36d), async () => { const _0x2f9c75 = _0x460c68; if (_0x2f9c75(0x88b) === _0x2f9c75(0x88b)) { _0x482de3(); const _0x1e2f98 = await _0x458a99('确定要清空群聊\x22' + _0x1f6bb3[_0x2f9c75(0x82e)] + _0x2f9c75(0x5d3)); if (_0x1e2f98) { _0x1f6bb3['id'] === _0x5c6c54['activeChatId'] && (_0x4d7ca9(), _0x5c6c54[_0x2f9c75(0x3b6)] = [], _0x1fa1ad()); try { localStorage[_0x2f9c75(0x5b3)](_0x2f9c75(0x555) + _0x1f6bb3['id']), _0x13197e('群聊\x22' + _0x1f6bb3[_0x2f9c75(0x82e)] + _0x2f9c75(0x370)); } catch (_0x42060f) { console[_0x2f9c75(0x863)](_0x2f9c75(0x5ea) + _0x1f6bb3['id'], _0x42060f), _0x13197e('清空聊天记录失败。'); } } } else _0x5f0585[_0x2f9c75(0x3fc)][_0x2f9c75(0x6d5)] = ''; }), _0x434683[_0x460c68(0x73c)](_0x460c68(0x36d), () => { const _0x52abf7 = _0x460c68; 'yjgUh' === _0x52abf7(0x19b) ? (_0x482de3(), _0x13197e(_0x52abf7(0x1c9))) : (_0x362734('chat', _0x52abf7(0x402)), _0x521d7a(() => _0x3507e5(), 0x64)); }), _0x5f0fc5[_0x460c68(0x73c)](_0x460c68(0x36d), async () => { const _0x3afe16 = _0x460c68; _0x482de3(); const _0xb4611a = prompt('请输入新的群名称：', _0x1f6bb3[_0x3afe16(0x82e)]); if (_0xb4611a && _0xb4611a['trim']() && _0xb4611a !== _0x1f6bb3[_0x3afe16(0x82e)]) { if (_0x3afe16(0x310) !== 'oTUXE') _0x1f6bb3['name'] = _0xb4611a[_0x3afe16(0x42f)](), _0xbd25a6(), _0x11cd8d(), _0x10d288(), _0x13197e('群名称已更改为\x22' + _0x1f6bb3[_0x3afe16(0x82e)] + '\x22。'); else { const _0x369324 = _0x46ee6d[_0x4f8ca6['length'] - 0x1]; (!_0x186282 || _0x369324[_0x3afe16(0x5c5)] > _0x4e7f48[_0x3afe16(0x5c5)]) && (_0xbfc966 = _0x369324); } } }), _0x428fa4[_0x460c68(0x73c)](_0x460c68(0x36d), async () => { const _0x1edadc = _0x460c68; _0x482de3(); const _0xabae1e = await _0x458a99('确定要删除群聊\x22' + _0x1f6bb3[_0x1edadc(0x82e)] + _0x1edadc(0x3bb)); _0xabae1e && ('KEANG' === _0x1edadc(0x6b9) ? (_0x2cabe3(_0x1f6bb3['id']), _0x13197e('群聊\x22' + _0x1f6bb3['name'] + '\x22\x20已删除。'), _0x5a8240(![])) : _0x5afb89[_0x1edadc(0x41c)] === _0xa4cc45 && (_0x5f0927['boundUserProfileId'] = _0xe5e3e6['activeUserProfileId'])); }), _0x416acd['addEventListener'](_0x460c68(0x36d), _0x482de3), _0x49dd6d[_0x460c68(0x73c)](_0x460c68(0x36d), _0x482de3); } _0x135afb[_0xbc3280(0x73c)]('click', () => { const _0x494d57 = _0xbc3280; if (_0x494d57(0x757) === 'cnbJD') { const _0x62ede7 = _0x1e26a8(); if (_0x62ede7 && _0x62ede7['type'] === _0x494d57(0x77d)) _0x494d57(0x869) === _0x494d57(0x869) ? _0x39e026(_0x62ede7[_0x494d57(0x594)][0x0]) : (_0x2e3d62['activeChatId'] = _0x6ccc92[_0x494d57(0x1ce)][0x0]?.['id'] || null, _0x166e4e(_0x19e37c[_0x494d57(0x728)])); else _0x62ede7 && _0x62ede7[_0x494d57(0x443)] === 'group' && _0x48a390(_0x62ede7['id']); } else { _0x560136[_0x494d57(0x497)] = _0x494d57(0x562); return; } }), _0x488521[_0xbc3280(0x73c)](_0xbc3280(0x23e), _0x38a467 => { const _0x5cc3bc = _0xbc3280; if (_0x5cc3bc(0x76c) !== _0x5cc3bc(0x3c0)) { if (_0x38a467['key'] === _0x5cc3bc(0x47d) && !_0x38a467[_0x5cc3bc(0x4d6)]) { if ('gcgNy' === _0x5cc3bc(0x37d)) _0x38a467['preventDefault'](), _0x32bf83(); else { _0x5847cf[_0x5cc3bc(0x41a)] = '选择聊天'; return; } } } else _0x39a1ee['appendChild'](_0x1e1df3), _0x12ae9a[_0x5cc3bc(0x2c8)](_0x3fe839); }); const _0x54519a = () => _0x447131['classList']['remove'](_0xbc3280(0x274)); _0x31d3b2[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x54519a), _0x1256cd[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x54519a), _0x215167[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0x48d091 = _0xbc3280; _0x48d091(0x18d) !== 'IhsFz' ? (_0x54519a(), _0x39e026()) : (_0x4a0a4e(), _0x182c9f(_0x48d091(0x896), _0x48d091(0x388))); }), _0x39d4b9[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { _0x54519a(), _0x1b3bbf(); }), _0x3f17d1[_0xbc3280(0x73c)]('click', () => { const _0x22e21b = _0xbc3280; _0x22e21b(0x54a) === _0x22e21b(0x54a) ? (_0x4ed1c4('chat', 'groupChatCreate'), _0x5a8240(![])) : _0x2bafc6[_0x22e21b(0x43f)]({ 'name': _0x19c048[0x0][_0x22e21b(0x42f)](), 'url': _0x546d39[0x1][_0x22e21b(0x42f)]() }); }), _0x31d0a2[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x1a8074), _0x577ca2[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0x2dbe67 = _0xbc3280; if (_0x2dbe67(0x5e0) !== _0x2dbe67(0x209)) _0x40f8f5['classList'][_0x2dbe67(0x700)](_0x2dbe67(0x274)), _0x40f8f5[_0x2dbe67(0x7a1)][_0x2dbe67(0x153)](_0x2dbe67(0x274)) && (_0x4adec6[_0x2dbe67(0x354)] = _0x4adec6['scrollHeight']); else { const _0x481b1f = _0x34ad1a[_0x2dbe67(0x746)](), _0x4d5aeb = _0x1809a3[_0x2dbe67(0x746)](); if (_0x481b1f[_0x2dbe67(0x380)](_0x2dbe67(0x813))) return _0x2dbe67(0x7bb); if (_0x4d5aeb[_0x2dbe67(0x87c)](_0x2dbe67(0x832))) return _0x2dbe67(0x7bb); if (_0x4d5aeb['includes'](_0x2dbe67(0x386))) return _0x2dbe67(0x77b); if (_0x481b1f[_0x2dbe67(0x380)](_0x2dbe67(0x77b))) return _0x2dbe67(0x77b); return _0x2dbe67(0x252); } }), _0x168981[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => _0x21eaa5[_0xbc3280(0x36d)]()); const _0x1a3f2f = document['getElementById'](_0xbc3280(0x884)); _0x21eaa5[_0xbc3280(0x73c)]('change', _0x5d8f5f), _0x1a3f2f[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x13e443), _0x5c88a5[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0xb395bb), _0x2e0cb0[_0xbc3280(0x73c)]('click', _0x5e77c0), _0x2e508c[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x20b21a), _0x4b349a[_0xbc3280(0x73c)]('click', _0x188f5b), _0x2b741a[_0xbc3280(0x73c)](_0xbc3280(0x36d), async () => { const _0x567040 = _0xbc3280, _0xd4f3a0 = _0x15b466[_0x567040(0x5a5)]; if (!_0xd4f3a0) return; const _0x3dec5c = _0x5a8ee7(_0xd4f3a0); if (!_0x3dec5c) return; const _0x20ac30 = await _0x458a99(_0x567040(0x37a) + _0x3dec5c[_0x567040(0x82e)] + _0x567040(0x434)); _0x20ac30 && (_0x5ca57b(_0xd4f3a0), _0x13197e(_0x567040(0x6c6) + _0x3dec5c[_0x567040(0x82e)] + _0x567040(0x7bf)), _0x4ed1c4('chat', _0x567040(0x6b7)), _0x5a8240(![])); }), _0x39c6a0['addEventListener']('input', () => { const _0x4fc795 = _0xbc3280, _0x24f2d1 = _0x39c6a0['value'][_0x4fc795(0x42f)]()[_0x4fc795(0x87c)](_0x558ae1); _0x581dea[_0x4fc795(0x1d4)] = _0x24f2d1; }); async function _0x1d3d36() { const _0x4e9ccd = _0xbc3280, _0xc48b7a = _0x39c6a0[_0x4e9ccd(0x5a5)]['trim'](), _0x3a94f0 = _0x271023[_0x4e9ccd(0x5a5)][_0x4e9ccd(0x42f)](); if (!_0xc48b7a || !_0x3a94f0) { _0x13197e(_0x4e9ccd(0x19e)); return; } const _0x1984a5 = _0xc48b7a[_0x4e9ccd(0x41f)](/\/+$/, ''), _0x1623ab = _0x1984a5 + _0x4e9ccd(0x7ca); _0x581dea[_0x4e9ccd(0x1d4)] = !![], _0x581dea['textContent'] = _0x4e9ccd(0x3fe), _0xf46a1f[_0x4e9ccd(0x7a1)]['remove'](_0x4e9ccd(0x274)); try { if (_0x4e9ccd(0x6e2) === _0x4e9ccd(0x6e2)) { const _0x162e81 = await fetch(_0x1623ab, { 'headers': { 'Authorization': 'Bearer\x20' + _0xc3368b(_0x3a94f0) } }); if (!_0x162e81['ok']) throw new Error(_0x4e9ccd(0x47e) + _0x162e81[_0x4e9ccd(0x1c0)]); const _0x315335 = await _0x162e81[_0x4e9ccd(0x21c)](), _0x44e47d = (_0x315335[_0x4e9ccd(0x1b6)] || _0x315335)[_0x4e9ccd(0x2ac)](_0xdaaa5 => _0xdaaa5['id'])[_0x4e9ccd(0x357)](); _0x44e47d[_0x4e9ccd(0x794)] > 0x0 ? (_0xf46a1f[_0x4e9ccd(0x497)] = '', _0x44e47d['forEach'](_0xd3e78 => { const _0x5c9c69 = _0x4e9ccd, _0xb45fb = document[_0x5c9c69(0x628)](_0x5c9c69(0x172)); _0xb45fb[_0x5c9c69(0x41a)] = _0xd3e78, _0xb45fb[_0x5c9c69(0x73c)](_0x5c9c69(0x36d), () => { const _0x33a36b = _0x5c9c69; if (_0x33a36b(0x5ac) !== 'bVVJx') _0x562bbd[_0x33a36b(0x5a5)] = _0xd3e78, _0xf46a1f[_0x33a36b(0x7a1)][_0x33a36b(0x8a2)](_0x33a36b(0x274)); else { const _0x166f02 = _0x117e27['likes'][_0x33a36b(0x2ac)](_0x59034b => _0x31c2b8(_0x59034b)?.['name'] || '未知')['join']('、'); _0x4009d9 = _0x33a36b(0x2b6) + _0x166f02 + _0x33a36b(0x61f); } }), _0xf46a1f[_0x5c9c69(0x2c8)](_0xb45fb); }), _0xf46a1f['classList'][_0x4e9ccd(0x821)]('show'), _0x13197e(_0x4e9ccd(0x83e) + _0x44e47d[_0x4e9ccd(0x794)] + '\x20个模型。')) : _0x13197e(_0x4e9ccd(0x620)); } else { _0x3ac3e4['innerHTML'] = _0x4e9ccd(0x7fc); return; } } catch (_0x425d91) { if ('QGyMF' === _0x4e9ccd(0x8a9)) _0x13197e(_0x4e9ccd(0x6b3) + _0x425d91[_0x4e9ccd(0x1a4)] + _0x4e9ccd(0x52d)); else { const _0x47e720 = _0x1c28f5[_0x4e9ccd(0x52f)](_0x29dc72, _0x4e9ccd(0x605)), _0x3e3134 = _0x47e720['objectStore'](_0x16d843), _0x53475d = _0x3e3134['getAll'](); _0x53475d[_0x4e9ccd(0x21f)] = () => _0x106b9a(_0x53475d[_0x4e9ccd(0x6bf)]), _0x53475d[_0x4e9ccd(0x618)] = () => _0x33d034(_0x53475d[_0x4e9ccd(0x863)]); } } finally { 'QbjZP' === _0x4e9ccd(0x7ed) ? (_0x581dea['disabled'] = ![], _0x581dea['textContent'] = '获取') : _0x1bad84(_0xd35ad7, _0x54710d[_0x4e9ccd(0x7da)]['files'][0x0]); } } _0x581dea[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x17f783 => { const _0x4e9b22 = _0xbc3280; _0x17f783[_0x4e9b22(0x855)](), _0x1d3d36(); }), document['addEventListener'](_0xbc3280(0x36d), _0x1f38a1 => { const _0x3cdaab = _0xbc3280; if ('jwskf' === 'bIuez') { if (_0x4f1afc[_0x3cdaab(0x794)] === 0x0) return; _0x1d80d9 = (_0x1ad0e3 - 0x1 + _0xf5fe0e[_0x3cdaab(0x794)]) % _0x1225b4[_0x3cdaab(0x794)], _0x2b2b6d(_0x3b44be[_0x31b925], _0x3e29d2); } else !_0xf46a1f[_0x3cdaab(0x153)](_0x1f38a1['target']) && _0x1f38a1['target'] !== _0x562bbd && _0x1f38a1[_0x3cdaab(0x7da)] !== _0x581dea && _0xf46a1f[_0x3cdaab(0x7a1)][_0x3cdaab(0x8a2)](_0x3cdaab(0x274)); }); async function _0x2da880(_0x580f33) { const _0x105cc8 = _0xbc3280; if ('iAJaG' === _0x105cc8(0x612)) _0x553218[_0x105cc8(0x3fc)]['display'] = 'none'; else return await _0x5e770d(_0x580f33, 0x190, 0.85); } _0x5531e2[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => _0x386369[_0xbc3280(0x36d)]()), _0x386369['addEventListener'](_0xbc3280(0x288), async _0x88458a => { const _0x22029f = _0xbc3280, _0x58652d = _0x88458a['target'][_0x22029f(0x3ad)][0x0]; if (!_0x58652d) return; try { if (_0x22029f(0x4a5) !== 'uWVgC') { const _0x5881b9 = await _0x2da880(_0x58652d); _0x5531e2[_0x22029f(0x161)] = _0x5881b9; } else _0x38c783(), _0x349a5f(![]); } catch (_0x5bdc92) { _0x22029f(0x85a) !== _0x22029f(0x85a) ? _0x3ef1df[_0x22029f(0x3d1)](_0x2a500f) : _0x13197e('错误:\x20' + _0x5bdc92[_0x22029f(0x1a4)]); } }), _0x3ffd7b[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => _0xc0cad6[_0xbc3280(0x36d)]()), _0xc0cad6[_0xbc3280(0x73c)]('change', async _0x16ffc8 => { const _0x25b2fa = _0xbc3280; if (_0x25b2fa(0x4c5) !== 'VCccW') { _0x24f4b1 = _0x3f5d25; let _0x4da89f = null; if (_0x38c130?.[_0x25b2fa(0x443)] === _0x25b2fa(0x77d)) _0x4da89f = _0x2fda68(_0x162d56[_0x25b2fa(0x594)][0x0]); else _0x3ddf2f?.[_0x25b2fa(0x443)] === 'group' && _0x486d85 && (_0x4da89f = _0x432bb6(_0x459d5f)); _0x4da89f?.['avatar'] && (_0x431b9b = _0x4da89f['avatar']); } else { const _0x1ab15c = _0x16ffc8[_0x25b2fa(0x7da)][_0x25b2fa(0x3ad)][0x0]; if (!_0x1ab15c) return; try { 'CdXIz' !== _0x25b2fa(0x512) ? _0x3ffd7b[_0x25b2fa(0x161)] = await _0x2da880(_0x1ab15c) : (_0x34fa18['preferences'][_0x25b2fa(0x271)] = null, _0x1fefab(), _0x29f322(), _0x505ea5(_0x25b2fa(0x410))); } catch (_0x47178a) { _0x13197e(_0x25b2fa(0x61e) + _0x47178a[_0x25b2fa(0x1a4)]); } } }); function _0x1a4276() { const _0x2e55c7 = _0xbc3280; if (_0x2e55c7(0x3e9) !== 'ETDCE') { _0x2bf962(_0x2e55c7(0x298)); return; } else _0x40f8f5[_0x2e55c7(0x497)] = '', _0x24d29a['forEach'](_0x1992e8 => { const _0x2e0a4d = _0x2e55c7; if (_0x2e0a4d(0x478) === 'eehIq') { const _0xd6e0ff = document['createElement'](_0x2e0a4d(0x62a)); _0xd6e0ff[_0x2e0a4d(0x161)] = _0x1992e8[_0x2e0a4d(0x5e3)], _0xd6e0ff['loading'] = _0x2e0a4d(0x881), _0xd6e0ff[_0x2e0a4d(0x15c)] = _0x1992e8['name'], _0xd6e0ff[_0x2e0a4d(0x7a1)][_0x2e0a4d(0x821)]('sticker-item'), _0xd6e0ff[_0x2e0a4d(0x73c)]('click', () => _0x4eed65(_0x1992e8)), _0x40f8f5['appendChild'](_0xd6e0ff); } else _0x3f52e2[_0x2e0a4d(0x863)](_0x2e0a4d(0x630), _0x21b761), _0x23f9e9[_0x2e0a4d(0x443)] = 'text'; }); } function _0xd5c28a() { const _0x3f7003 = _0xbc3280, _0x3a661c = document[_0x3f7003(0x5d9)](_0x3f7003(0x6bb)); _0x3a661c[_0x3f7003(0x497)] = ''; if (_0x5c6c54[_0x3f7003(0x160)][_0x3f7003(0x794)] === 0x0) { if (_0x3f7003(0x7b8) === _0x3f7003(0x7b8)) { _0x3a661c['innerHTML'] = _0x3f7003(0x3dd); return; } else { _0x5e477e('好友圈名称不能为空！'); return; } } _0x5c6c54[_0x3f7003(0x160)][_0x3f7003(0x691)](_0x4020cd => { const _0x199db4 = _0x3f7003, _0x53df13 = document[_0x199db4(0x628)]('div'); _0x53df13[_0x199db4(0x63a)] = _0x199db4(0x88c), _0x53df13['dataset']['id'] = _0x4020cd['id']; const _0x33230f = _0x4020cd['id'] === _0x5c6c54[_0x199db4(0x4f0)] ? _0x199db4(0x1cf) : ''; _0x53df13[_0x199db4(0x497)] = _0x199db4(0x290) + (_0x4020cd[_0x199db4(0x41e)] || _0x4e315e) + '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x4020cd[_0x199db4(0x82e)] + _0x33230f + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>' + _0x4020cd[_0x199db4(0x854)][_0x199db4(0x35b)](0x0, 0x64) + _0x199db4(0x6d3), _0x53df13[_0x199db4(0x73c)](_0x199db4(0x36d), () => _0x3fec4f(_0x4020cd['id'])), _0x3a661c[_0x199db4(0x2c8)](_0x53df13); }); } function _0x3fec4f(_0x2bdd49 = null) { const _0x420429 = _0xbc3280; _0x4ed1c4(_0x420429(0x484), _0x420429(0x501)); const _0x35297c = document['getElementById'](_0x420429(0x64a)); if (_0x2bdd49) { const _0x216fc1 = _0x5c6c54['userProfiles'][_0x420429(0x659)](_0x298377 => _0x298377['id'] === _0x2bdd49); if (!_0x216fc1) return; document[_0x420429(0x5d9)](_0x420429(0x717))[_0x420429(0x5a5)] = _0x216fc1['id'], document[_0x420429(0x5d9)](_0x420429(0x23c))[_0x420429(0x41a)] = _0x420429(0x391), document[_0x420429(0x5d9)](_0x420429(0x706))[_0x420429(0x5a5)] = _0x216fc1[_0x420429(0x82e)], document['getElementById'](_0x420429(0x339))[_0x420429(0x161)] = _0x216fc1['avatar'], document[_0x420429(0x5d9)](_0x420429(0x88f))['value'] = _0x216fc1[_0x420429(0x854)], _0x35297c[_0x420429(0x3fc)][_0x420429(0x74d)] = _0x216fc1['id'] === _0x5c6c54[_0x420429(0x4f0)] ? _0x420429(0x860) : 'block'; } else { if (_0x420429(0x28e) !== _0x420429(0x28e)) { const _0x36b044 = _0x458818[_0x420429(0x43d)]; _0x236603[_0x420429(0x354)] = _0x2457fe + (_0x36b044 - _0x3c0a57); } else document[_0x420429(0x5d9)]('editing-user-id')['value'] = '', document[_0x420429(0x5d9)](_0x420429(0x23c))[_0x420429(0x41a)] = _0x420429(0x304), document[_0x420429(0x5d9)](_0x420429(0x706))[_0x420429(0x5a5)] = _0x420429(0x705) + (_0x5c6c54['userProfiles'][_0x420429(0x794)] + 0x1), document['getElementById'](_0x420429(0x339))[_0x420429(0x161)] = _0x4e315e, document[_0x420429(0x5d9)](_0x420429(0x88f))[_0x420429(0x5a5)] = '', _0x35297c[_0x420429(0x3fc)][_0x420429(0x74d)] = _0x420429(0x860); } } function _0x5e77c0() { const _0x468e05 = _0xbc3280; if ('nZcIJ' === _0x468e05(0x1c8)) { const _0x11f8df = document[_0x468e05(0x5d9)]('editing-user-id')['value'], _0x532460 = { 'name': document[_0x468e05(0x5d9)](_0x468e05(0x706))[_0x468e05(0x5a5)][_0x468e05(0x42f)](), 'persona': document[_0x468e05(0x5d9)]('user-persona')['value'][_0x468e05(0x42f)](), 'avatar': document[_0x468e05(0x5d9)](_0x468e05(0x339))['src'] }; if (!_0x532460[_0x468e05(0x82e)]) { _0x13197e(_0x468e05(0x367)); return; } if (_0x11f8df) { if (_0x468e05(0x3b8) !== _0x468e05(0x3b8)) { if (_0xc6eee9) _0x32fcb0[_0x468e05(0x36d)](); } else { const _0x318bd3 = _0x5c6c54[_0x468e05(0x160)][_0x468e05(0x659)](_0x4e6b33 => _0x4e6b33['id'] === _0x11f8df); if (_0x318bd3) Object[_0x468e05(0x8cb)](_0x318bd3, _0x532460); } } else { if (_0x468e05(0x234) === _0x468e05(0x7fa)) return _0x2ce4ba[_0x468e05(0x863)]('批量生成动态失败:\x20', _0x2484fe), _0x3ca807[_0x468e05(0x863)](_0x468e05(0x4ae), _0x2ccec6['rawResponse'] || _0xf56450), null; else { const _0x3a374e = { 'id': _0x468e05(0x8bb) + Date[_0x468e05(0x7a5)](), ..._0x532460 }; _0x5c6c54[_0x468e05(0x160)][_0x468e05(0x43f)](_0x3a374e); if (!_0x5c6c54[_0x468e05(0x4f0)]) { if ('EfMoC' === 'KAVcY') { const _0x169d33 = _0x468e05(0x8a7) + _0x2dcdb5; let _0x4c0884 = _0x406aa2[_0x468e05(0x5d9)](_0x169d33); if (_0x4c0884) return; const _0x5a6677 = _0x468e05(0x690) + _0x169d33 + _0x468e05(0x69d) + (_0x394d42 === 'ai' ? _0x468e05(0x751) : '') + _0x468e05(0x544); _0x5051c6[_0x468e05(0x4ec)][_0x468e05(0x559)](_0x468e05(0x371), _0x5a6677); const _0x44e0bc = _0xc041e6[_0x468e05(0x5d9)](_0x169d33), _0x3aebef = () => _0x44e0bc[_0x468e05(0x8a2)](); _0x44e0bc[_0x468e05(0x85e)](_0x468e05(0x1cc))[_0x468e05(0x878)] = _0x3aebef, _0x44e0bc[_0x468e05(0x85e)](_0x468e05(0x7fd))[_0x468e05(0x878)] = _0x3aebef, _0x44e0bc[_0x468e05(0x85e)](_0x468e05(0x734))['onclick'] = () => { _0x370659(_0x5a42c0), _0x3aebef(); }, _0x11fb44 === 'ai' && (_0x44e0bc[_0x468e05(0x85e)](_0x468e05(0x70a))[_0x468e05(0x878)] = () => { _0x2526ae(_0x3d04de), _0x3aebef(); }); } else _0x5c6c54[_0x468e05(0x4f0)] = _0x3a374e['id']; } } } _0xbd25a6(), _0x13197e('用户资料已保存！'), _0xd5c28a(), _0x4ed1c4('userProfileList', _0x468e05(0x484)); } else { if (_0x207877[_0x468e05(0x5a8)] === 'user') return _0x4d257f[_0x468e05(0x484)]?.[_0x468e05(0x82e)] || _0x468e05(0x71f); if (_0x271c6d[_0x468e05(0x443)] === 'group') { const _0xe7388a = _0x5d0193[_0x468e05(0x2a6)] ? _0x1b024c(_0x3a7c7e[_0x468e05(0x2a6)]) : null; return _0xe7388a?.[_0x468e05(0x82e)] || 'Unknown'; } else { const _0x2a694c = _0x25eeee(_0x5628a7['participantIds'][0x0]); return _0x2a694c?.[_0x468e05(0x82e)] || 'AI'; } } } async function _0x4ea9ae() { const _0x27ad4d = _0xbc3280, _0x47755c = document[_0x27ad4d(0x5d9)](_0x27ad4d(0x717))[_0x27ad4d(0x5a5)]; if (!_0x47755c) return; if (_0x5c6c54[_0x27ad4d(0x160)][_0x27ad4d(0x794)] <= 0x1) { if ('qxlgF' !== _0x27ad4d(0x1a9)) { _0x13197e(_0x27ad4d(0x738)); return; } else { const _0x330788 = _0x4093c2['id'], _0x33770c = _0x27ad4d(0x547) + _0x330788, _0x2fda2f = _0x26f3b6[_0x27ad4d(0x24e)](_0x33770c), _0x477a42 = _0x46c7ee['querySelector'](_0x27ad4d(0x2e5)); if (_0x2fda2f) _0x477a42[_0x27ad4d(0x497)] = '<img\x20src=\x22' + _0x2fda2f + '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>'; else { const _0x34aa50 = _0x5dabef['querySelector'](_0x27ad4d(0x15a) + _0x330788 + '\x20.app-icon-img,\x20#app-dock-top-right\x20#' + _0x330788 + _0x27ad4d(0x166))?.[_0x27ad4d(0x497)]; _0x34aa50 && (_0x477a42['innerHTML'] = _0x34aa50); } } } const _0x1e042f = await _0x458a99(_0x27ad4d(0x2f9)); _0x1e042f && (_0x27ad4d(0x749) !== 'gonis' ? _0x5213b4['scrollTop'] = _0x3d1a4a[_0x27ad4d(0x43d)] : (_0x5c6c54[_0x27ad4d(0x160)] = _0x5c6c54[_0x27ad4d(0x160)][_0x27ad4d(0x25b)](_0xb74e35 => _0xb74e35['id'] !== _0x47755c), _0x5c6c54[_0x27ad4d(0x4f0)] === _0x47755c && (_0x27ad4d(0x31b) === 'kfEgZ' ? _0x5c6c54[_0x27ad4d(0x4f0)] = _0x5c6c54['userProfiles'][0x0]['id'] : (_0x55608d(![]), _0x1dcdc4[_0x27ad4d(0x863)](_0x27ad4d(0x593), _0x391cd8), _0x55bcb4('导入失败:\x20' + _0x4a2d45['message']))), _0x5c6c54[_0x27ad4d(0x1ce)][_0x27ad4d(0x691)](_0x197303 => { const _0x3aef31 = _0x27ad4d; _0x3aef31(0x2bd) !== _0x3aef31(0x2bd) ? (_0x3ee9cd[_0x3aef31(0x5a5)] = _0x51ebaf[_0x3aef31(0x484)][_0x3aef31(0x82e)] || '', _0x447092[_0x3aef31(0x161)] = _0x1a4fc2[_0x3aef31(0x484)][_0x3aef31(0x41e)] || _0x500f64, _0x328e1d['value'] = _0x120fd9[_0x3aef31(0x484)][_0x3aef31(0x854)] || '') : _0x197303[_0x3aef31(0x41c)] === _0x47755c && (_0x197303[_0x3aef31(0x41c)] = _0x5c6c54[_0x3aef31(0x4f0)]); }), _0xbd25a6(), _0x13197e('用户已删除。'), _0xd5c28a(), _0x4ed1c4(_0x27ad4d(0x501), _0x27ad4d(0x484)))); } function _0x5cceef() { const _0xfa98a5 = _0xbc3280, _0x5103d9 = document[_0xfa98a5(0x5d9)](_0xfa98a5(0x589)); _0x5103d9[_0xfa98a5(0x497)] = ''; if (_0x5c6c54[_0xfa98a5(0x6bd)][_0xfa98a5(0x794)] === 0x0) { _0x5103d9[_0xfa98a5(0x497)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>'; return; } _0x5c6c54[_0xfa98a5(0x6bd)][_0xfa98a5(0x691)](_0x1263ab => { const _0x322226 = _0xfa98a5; if (_0x322226(0x64c) !== 'cKzco') return '今天\x20' + _0x5aa8d1; else { const _0x40fc12 = document[_0x322226(0x628)]('div'); _0x40fc12[_0x322226(0x63a)] = _0x322226(0x88c), _0x40fc12[_0x322226(0x17f)]['id'] = _0x1263ab['id'], _0x40fc12[_0x322226(0x497)] = _0x322226(0x560) + _0x1263ab['name'] + _0x322226(0x3e6) + _0x1263ab[_0x322226(0x283)][_0x322226(0x35b)](0x0, 0x64) + _0x322226(0x7d5), _0x40fc12['addEventListener'](_0x322226(0x36d), () => _0x47644d(_0x1263ab['id'])), _0x5103d9[_0x322226(0x2c8)](_0x40fc12); } }); } function _0x47644d(_0x4400a8 = null) { const _0x29fa88 = _0xbc3280; _0x4ed1c4(_0x29fa88(0x2a2), _0x29fa88(0x7cd)); if (_0x4400a8) { if (_0x29fa88(0x78d) !== 'nKXom') { const _0x5a38e2 = _0x5c6c54[_0x29fa88(0x6bd)][_0x29fa88(0x659)](_0x23ba44 => _0x23ba44['id'] === _0x4400a8); if (!_0x5a38e2) return; document[_0x29fa88(0x5d9)](_0x29fa88(0x8ae))[_0x29fa88(0x5a5)] = _0x5a38e2['id'], document[_0x29fa88(0x5d9)](_0x29fa88(0x733))[_0x29fa88(0x41a)] = _0x29fa88(0x3c7), document[_0x29fa88(0x5d9)]('world-book-edit-name')['value'] = _0x5a38e2[_0x29fa88(0x82e)], document[_0x29fa88(0x5d9)]('world-book-edit-content')['value'] = _0x5a38e2['content']; } else _0x5262e8 += _0x29fa88(0x5a6); } else _0x29fa88(0x164) !== 'AkxSQ' ? _0x36ee11[_0x29fa88(0x43f)](_0x383c4e) : (document[_0x29fa88(0x5d9)]('editing-world-book-id')['value'] = '', document[_0x29fa88(0x5d9)]('world-book-editor-title')['textContent'] = _0x29fa88(0x500), document[_0x29fa88(0x5d9)](_0x29fa88(0x3d4))['value'] = '', document[_0x29fa88(0x5d9)](_0x29fa88(0x1c2))[_0x29fa88(0x5a5)] = ''); } function _0x55e432() { const _0x3a3027 = _0xbc3280, _0x4d3e2a = document[_0x3a3027(0x5d9)](_0x3a3027(0x8ae))[_0x3a3027(0x5a5)], _0x3a2ca3 = document[_0x3a3027(0x5d9)](_0x3a3027(0x3d4))[_0x3a3027(0x5a5)][_0x3a3027(0x42f)](), _0x325479 = document['getElementById'](_0x3a3027(0x1c2))['value'][_0x3a3027(0x42f)](); if (!_0x3a2ca3 || !_0x325479) { _0x13197e(_0x3a3027(0x7ec)); return; } if (_0x4d3e2a) { if (_0x3a3027(0x8ac) !== _0x3a3027(0x19a)) { const _0xfb723d = _0x5c6c54[_0x3a3027(0x6bd)][_0x3a3027(0x659)](_0x5d2fed => _0x5d2fed['id'] === _0x4d3e2a); _0xfb723d && (_0xfb723d[_0x3a3027(0x82e)] = _0x3a2ca3, _0xfb723d[_0x3a3027(0x283)] = _0x325479); } else _0x588d87 = !![], _0x11657c['activeChatId'] = null; } else { if ('Wexwk' !== _0x3a3027(0x7c4)) { const _0x23b5cf = { 'id': 'wb_' + Date[_0x3a3027(0x7a5)](), 'name': _0x3a2ca3, 'content': _0x325479 }; _0x5c6c54[_0x3a3027(0x6bd)]['push'](_0x23b5cf); } else { const _0x1d2880 = _0x1b5415(_0x533b83[_0x3a3027(0x283)] ?? _0x448ecd[_0x3a3027(0x224)] ?? _0x3853b2[_0x3a3027(0x1a4)] ?? '')[_0x3a3027(0x42f)](); if (_0x1d2880) _0xc23cfb[_0x3a3027(0x699)][_0x3a3027(0x43f)]({ 'senderId': _0x40489f['id'], 'kind': 'text', 'content': _0x1d2880 }); } } _0xbd25a6(), _0x13197e(_0x3a3027(0x264)), _0x5cceef(), _0x4ed1c4('worldBook', _0x3a3027(0x2a2)); } async function _0x53dab4() { const _0x4a1235 = _0xbc3280, _0x35b4a6 = document[_0x4a1235(0x5d9)]('editing-world-book-id')[_0x4a1235(0x5a5)]; if (!_0x35b4a6) return; const _0xd3471f = await _0x458a99(_0x4a1235(0x29c)); _0xd3471f && ('auopt' !== _0x4a1235(0x7e7) ? _0xc7d0ba[_0x4a1235(0x7a1)][_0x4a1235(0x821)]('show-chat-view') : (_0x5c6c54[_0x4a1235(0x6bd)] = _0x5c6c54[_0x4a1235(0x6bd)][_0x4a1235(0x25b)](_0x34351c => _0x34351c['id'] !== _0x35b4a6), _0x5c6c54['characters']['forEach'](_0x5c1cef => { const _0x20c393 = _0x4a1235; if ('VzWiN' !== _0x20c393(0x2dc)) { _0x5d167c[_0x20c393(0x497)] = _0x20c393(0x28c), _0x11828c['innerHTML'] = _0x20c393(0x2e4), _0x5176a0['getElementById'](_0x20c393(0x1a0))[_0x20c393(0x73c)](_0x20c393(0x36d), _0x2e264f), _0x1e1a8a[_0x20c393(0x5d9)](_0x20c393(0x887))[_0x20c393(0x73c)](_0x20c393(0x36d), _0x5152ad); return; } else _0x5c1cef[_0x20c393(0x88d)] && (_0x5c1cef['linkedWorldBookIds'] = _0x5c1cef[_0x20c393(0x88d)]['filter'](_0x551c74 => _0x551c74 !== _0x35b4a6)); }), _0xbd25a6(), _0x13197e(_0x4a1235(0x315)), _0x5cceef(), _0x4ed1c4('worldBook', _0x4a1235(0x2a2)))); } function _0x4b0c7c() { const _0x29642e = _0xbc3280; if (_0x29642e(0x7d2) === _0x29642e(0x7d2)) { const _0x3b27d4 = document[_0x29642e(0x5d9)](_0x29642e(0x877)), _0x101e34 = _0x3b27d4[_0x29642e(0x81a)](_0x29642e(0x35a)), _0x551076 = document[_0x29642e(0x85e)](_0x29642e(0x457)); if (_0x101e34[_0x29642e(0x794)] === 0x0) _0x551076['textContent'] = _0x29642e(0x445); else _0x101e34[_0x29642e(0x794)] > 0x2 ? 'NJzrn' === _0x29642e(0x42a) ? _0xa07714[_0x29642e(0x41c)] = _0x2b11b6[_0x29642e(0x4f0)] : _0x551076[_0x29642e(0x41a)] = '已选择\x20' + _0x101e34[_0x29642e(0x794)] + '\x20项' : _0x551076[_0x29642e(0x41a)] = Array[_0x29642e(0x485)](_0x101e34)[_0x29642e(0x2ac)](_0x4f1862 => _0x4f1862['parentElement'][_0x29642e(0x41a)][_0x29642e(0x42f)]())[_0x29642e(0x5d2)]('、'); } else _0x105eef = _0x115381[_0x29642e(0x628)]('style'), _0x903fdf['id'] = _0x29642e(0x69a) + _0x51433e['id'], _0x5bbc8f[_0x29642e(0x5e4)][_0x29642e(0x2c8)](_0xbd5f1d); } function _0x48a390(_0x2b04bc) { const _0x35a024 = _0xbc3280; if ('vfZFI' === _0x35a024(0x33c)) _0x349034[_0x35a024(0x88d)] = _0x100e4e[_0x35a024(0x88d)][_0x35a024(0x25b)](_0x34fe67 => _0x34fe67 !== _0x205d67); else { const _0x3441af = _0x5c6c54[_0x35a024(0x1ce)]['find'](_0x13f772 => _0x13f772['id'] === _0x2b04bc); if (!_0x3441af || _0x3441af[_0x35a024(0x443)] !== 'group') return; document[_0x35a024(0x5d9)](_0x35a024(0x8a4))[_0x35a024(0x5a5)] = _0x3441af[_0x35a024(0x82e)] || '', _0xbb5832('group-settings-bind-user'), document['getElementById'](_0x35a024(0x614))['value'] = _0x3441af[_0x35a024(0x41c)] || _0x5c6c54['activeUserProfileId']; const _0x97c6d6 = document['getElementById'](_0x35a024(0x7dd)); _0x97c6d6[_0x35a024(0x497)] = '', _0x5c6c54['worldBooks'][_0x35a024(0x691)](_0x2ca557 => { const _0x1ce7ca = _0x35a024, _0x370824 = _0x3441af[_0x1ce7ca(0x88d)]?.[_0x1ce7ca(0x87c)](_0x2ca557['id']), _0x25e36c = document[_0x1ce7ca(0x628)](_0x1ce7ca(0x1d3)); _0x25e36c['innerHTML'] = _0x1ce7ca(0x2c9) + _0x2ca557['id'] + '\x22\x20' + (_0x370824 ? _0x1ce7ca(0x27f) : '') + '>\x20' + _0x2ca557[_0x1ce7ca(0x82e)], _0x97c6d6[_0x1ce7ca(0x2c8)](_0x25e36c); }), _0x13ed65(); const _0x268f07 = document[_0x35a024(0x5d9)]('group-avatar-preview'), _0x50c737 = document[_0x35a024(0x5d9)](_0x35a024(0x4fb)); _0x2eb454(_0x35a024(0x529) + _0x2b04bc)['then'](_0x34cab6 => { const _0x4f13ef = _0x35a024; _0x268f07[_0x4f13ef(0x161)] = _0x34cab6 ? URL[_0x4f13ef(0x78a)](_0x34cab6) : _0x166d38; }), _0x2eb454('group_bg_' + _0x2b04bc)['then'](_0x4b27c7 => { const _0x17d77b = _0x35a024; _0x17d77b(0x55f) === 'nWJuC' ? _0x50c737[_0x17d77b(0x161)] = _0x4b27c7 ? URL[_0x17d77b(0x78a)](_0x4b27c7) : '' : _0x3eb815[_0x17d77b(0x7d4)]('music_library', { 'keyPath': 'id' }); }), _0x4ed1c4('groupSettings', _0x35a024(0x2da)); } } async function _0x2d65d3() { const _0x4048a2 = _0xbc3280; if (_0x4048a2(0x641) === _0x4048a2(0x641)) { const _0x40f95b = _0x1e26a8(); if (!_0x40f95b || _0x40f95b['type'] !== _0x4048a2(0x441)) return; const _0x19def3 = document[_0x4048a2(0x5d9)](_0x4048a2(0x8a4))[_0x4048a2(0x5a5)]['trim'](); if (!_0x19def3) { _0x13197e(_0x4048a2(0x298)); return; } _0x40f95b[_0x4048a2(0x82e)] = _0x19def3; const _0x487c9a = document[_0x4048a2(0x81a)](_0x4048a2(0x1e2)); _0x40f95b[_0x4048a2(0x88d)] = Array['from'](_0x487c9a)['map'](_0x36097e => _0x36097e[_0x4048a2(0x5a5)]), _0x40f95b[_0x4048a2(0x41c)] = document[_0x4048a2(0x5d9)](_0x4048a2(0x614))[_0x4048a2(0x5a5)]; const _0x3abe02 = document['getElementById']('group-avatar-input')[_0x4048a2(0x3ad)][0x0], _0xe18649 = document[_0x4048a2(0x5d9)](_0x4048a2(0x86d))['files'][0x0]; if (_0x3abe02) await _0x1c943a('group_avatar_' + _0x40f95b['id'], _0x3abe02); if (_0xe18649) await _0x1c943a(_0x4048a2(0x3e8) + _0x40f95b['id'], _0xe18649); _0xbd25a6(), _0x10d288(), await _0x11cd8d(), _0x13197e(_0x4048a2(0x22c)), _0x4ed1c4(_0x4048a2(0x2da), _0x4048a2(0x444)); } else _0x20a844['src'] = _0x1e1d02 ? _0x2f72ec[_0x4048a2(0x78a)](_0x3542c3) : ''; } function _0x13ed65() { const _0x1a7e98 = _0xbc3280, _0x43c85d = document[_0x1a7e98(0x5d9)](_0x1a7e98(0x7dd)), _0x5951fc = _0x43c85d['querySelectorAll'](_0x1a7e98(0x35a)), _0x369e5f = document[_0x1a7e98(0x85e)](_0x1a7e98(0x5c4)); if (_0x5951fc[_0x1a7e98(0x794)] === 0x0) { if (_0x1a7e98(0x609) !== _0x1a7e98(0x609)) { const _0x40deaa = _0x31ed0c[_0x1a7e98(0x85e)]('#member-select-' + _0x12ce16); if (_0x40deaa) _0x40deaa[_0x1a7e98(0x27f)] = !![]; } else _0x369e5f[_0x1a7e98(0x41a)] = '--\x20点击选择\x20--'; } else _0x5951fc[_0x1a7e98(0x794)] > 0x2 ? _0x369e5f[_0x1a7e98(0x41a)] = _0x1a7e98(0x2b7) + _0x5951fc[_0x1a7e98(0x794)] + '\x20项' : _0x369e5f[_0x1a7e98(0x41a)] = Array[_0x1a7e98(0x485)](_0x5951fc)[_0x1a7e98(0x2ac)](_0x2a2af1 => _0x2a2af1['parentElement'][_0x1a7e98(0x41a)][_0x1a7e98(0x42f)]())[_0x1a7e98(0x5d2)]('、'); } async function _0x4be880() { const _0x7d2666 = _0xbc3280, _0x19950a = _0x1e26a8(), _0x752b7f = (_0x19950a?.[_0x7d2666(0x594)] || [])[_0x7d2666(0x2ac)](_0x5a8ee7)[_0x7d2666(0x25b)](Boolean), _0x1a1ce0 = _0x4771d7(_0x19950a['id']); if (!_0x19950a || _0x19950a[_0x7d2666(0x443)] !== _0x7d2666(0x441) || _0x752b7f[_0x7d2666(0x794)] < 0x2) return null; const _0x4b85c4 = _0x19950a['linkedWorldBookIds'] && _0x19950a[_0x7d2666(0x88d)]['length'] > 0x0 ? _0x7d2666(0x666) + _0x19950a['linkedWorldBookIds'][_0x7d2666(0x2ac)](_0x49c810 => _0x5c6c54['worldBooks'][_0x7d2666(0x659)](_0x205fcd => _0x205fcd['id'] === _0x49c810))[_0x7d2666(0x25b)](Boolean)[_0x7d2666(0x2ac)](_0xce6847 => _0x7d2666(0x55b) + _0xce6847[_0x7d2666(0x82e)] + '\x0a' + _0xce6847[_0x7d2666(0x283)])[_0x7d2666(0x5d2)]('') : '', _0x1672b1 = _0x1a1ce0[_0x7d2666(0x854)] ? _0x7d2666(0x692) + _0x1a1ce0[_0x7d2666(0x82e)] + _0x7d2666(0x2cc) + _0x1a1ce0[_0x7d2666(0x854)] : ''; let _0x8f120e = ''; const _0x197f54 = new Date(), _0x1979af = _0x5c6c54[_0x7d2666(0x3b6)]['at'](-0x1); _0x8f120e += _0x7d2666(0x32d) + _0x197f54[_0x7d2666(0x787)](_0x7d2666(0x4ea), { 'dateStyle': _0x7d2666(0x604), 'timeStyle': _0x7d2666(0x530) }); if (_0x1979af) { if (_0x7d2666(0x7de) === _0x7d2666(0x34d)) { const _0x7477d1 = _0x13faea[_0x7d2666(0x7da)][_0x7d2666(0x3ad)][0x0]; if (!_0x7477d1) return; try { _0x5246c3[_0x7d2666(0x161)] = _0x3f00f6[_0x7d2666(0x78a)](_0x7477d1); } catch (_0x1f126d) { _0x358052(_0x7d2666(0x61d) + _0x1f126d[_0x7d2666(0x1a4)]); } } else { const _0x3002e5 = new Date(_0x1979af[_0x7d2666(0x5c5)]), _0x3ce915 = Math['floor']((_0x197f54 - _0x3002e5) / (0x3e8 * 0x3c)); if (_0x3ce915 < 0x5) _0x8f120e += _0x7d2666(0x16c); else { if (_0x3ce915 < 0x78) _0x8f120e += _0x7d2666(0x698) + _0x3ce915 + _0x7d2666(0x26b); else { if (_0x7d2666(0x677) === _0x7d2666(0x456)) _0x1e75e2 *= _0x149ef4 / _0xf7fd83, _0x283572 = _0x1f79c5; else { const _0x12852a = Math[_0x7d2666(0x564)](_0x3ce915 / 0x3c); if (_0x12852a < 0x30) _0x8f120e += '\x0a-\x20**对话状态**:\x20群里在' + _0x12852a + _0x7d2666(0x683); else _0x8f120e += '\x0a-\x20**对话状态**:\x20群里已经有' + Math['floor'](_0x12852a / 0x18) + '天没动静了。你的角色们应该发起新的问候或话题。'; } } } } } else _0x8f120e += _0x7d2666(0x2b3); const _0x41fdcb = [..._0x5c6c54[_0x7d2666(0x3b6)]][_0x7d2666(0x4ee)]()[_0x7d2666(0x659)](_0x25d91b => _0x25d91b['role'] === _0x7d2666(0x845))?.[_0x7d2666(0x283)] || '', _0x1dae67 = _0x252a7b(_0x19950a, _0x41fdcb), _0x44ed22 = _0x5c6c54[_0x7d2666(0x3b6)]['slice'](-0x78), _0x2c48dd = _0x24d29a[_0x7d2666(0x2ac)](_0x292975 => _0x292975[_0x7d2666(0x82e)]), _0x385c58 = _0x480fea(), _0x5e5424 = _0x752b7f['map'](_0x20240e => { const _0x25cb7e = _0x7d2666, { omniText: _0x515fa7 } = _0x5c86b3(_0x20240e['id'], _0x19950a['id']), _0x20745f = _0x13f7f9(_0x20240e['id']), _0x2966c8 = _0x20240e[_0x25cb7e(0x88d)] && _0x20240e['linkedWorldBookIds'][_0x25cb7e(0x794)] > 0x0 ? _0x25cb7e(0x856) + _0x20240e[_0x25cb7e(0x82e)] + _0x25cb7e(0x6fb) + _0x20240e[_0x25cb7e(0x88d)][_0x25cb7e(0x2ac)](_0x3dfc4c => _0x5c6c54['worldBooks'][_0x25cb7e(0x659)](_0x354c52 => _0x354c52['id'] === _0x3dfc4c))['filter'](Boolean)[_0x25cb7e(0x2ac)](_0x37e99b => _0x25cb7e(0x2e9) + _0x37e99b[_0x25cb7e(0x82e)] + '\x0a' + _0x37e99b[_0x25cb7e(0x283)])[_0x25cb7e(0x5d2)]('') : ''; return { 'id': _0x20240e['id'], 'name': _0x20240e[_0x25cb7e(0x82e)], 'persona': _0x20240e[_0x25cb7e(0x854)] || _0x25cb7e(0x48b), 'memory': _0x515fa7 + _0x20745f + _0x2966c8 }; }), _0x5c8954 = 0x5, _0x2cfdbb = 0xc, _0x4a283d = _0x7d2666(0x31e)[_0x7d2666(0x42f)](), _0x3a9dae = { 'instruction': (_0x7d2666(0x57b) + (_0x1a1ce0[_0x7d2666(0x82e)] || '用户') + _0x7d2666(0x4b9) + (_0x1a1ce0[_0x7d2666(0x82e)] || '用户') + _0x7d2666(0x49f) + _0x5c8954 + _0x7d2666(0x423) + _0x2cfdbb + '\x20之间。\x0a-\x20所有表情包名称【必须】从\x20`stickerList`\x20列表中选择，严禁使用列表之外的名称。\x0a-\x20角色之间需要有适当的互动,话题不应当完全围绕' + (_0x1a1ce0[_0x7d2666(0x82e)] || '用户') + _0x7d2666(0x4ba) + _0x8f120e + '\x20\x0a' + _0x1672b1 + '\x0a' + _0x4b85c4 + _0x7d2666(0x58b) + _0x385c58 + '\x0a')['trim'](), 'personas': _0x5e5424, 'mentioned': _0x1dae67 ? { 'id': _0x1dae67['id'], 'name': _0x1dae67[_0x7d2666(0x82e)] } : null, 'stickerList': _0x2c48dd }, _0x311fbc = { 'type': _0x7d2666(0x193), 'properties': { 'events': { 'type': _0x7d2666(0x3ff), 'items': { 'type': _0x7d2666(0x193), 'required': [_0x7d2666(0x2a6), _0x7d2666(0x63e)], 'properties': { 'senderId': { 'type': _0x7d2666(0x6a1) }, 'kind': { 'type': _0x7d2666(0x6a1), 'enum': ['text', _0x7d2666(0x4b7), _0x7d2666(0x388)] }, 'content': { 'type': _0x7d2666(0x6a1) }, 'sticker': { 'type': 'string' }, 'songName': { 'type': _0x7d2666(0x6a1) }, 'artist': { 'type': _0x7d2666(0x6a1) } } } } }, 'required': [_0x7d2666(0x699)] }, _0x582113 = []; _0x582113[_0x7d2666(0x43f)]({ 'role': 'system', 'content': _0x4a283d }); for (const _0x2ca223 of _0x44ed22) { if (_0x7d2666(0x187) !== _0x7d2666(0x151)) { const _0x229854 = _0x2ca223[_0x7d2666(0x5a8)] === 'ai' || _0x2ca223['role'] === _0x7d2666(0x535) ? _0x7d2666(0x535) : _0x7d2666(0x845); let _0x42730e = { 'role': _0x229854, 'content': _0x2ca223['content'] }, _0x4c38e8 = !!_0x2ca223[_0x7d2666(0x283)], _0x824fa6 = null; if (_0x2ca223['image']) _0x7d2666(0x583) === 'tFRHC' ? _0x139642[_0x7d2666(0x296)] && _0x46d7e4['listenTogetherSession'][_0x7d2666(0x3a5)] && (_0x4a6e9b[_0x7d2666(0x3fc)][_0x7d2666(0x74d)] = _0x7d2666(0x1d8), _0x24f4a3(() => _0x3eb9a7['classList']['add'](_0x7d2666(0x274)), 0xa)) : _0x824fa6 = _0x2ca223['image']; else { if (_0x2ca223[_0x7d2666(0x2f3)]) { if ('Evocw' === _0x7d2666(0x599)) _0x368cee[_0x7d2666(0x3cd)](_0x5d2030, _0x224833[_0x7d2666(0x311)][_0x11ad74]); else try { if (_0x7d2666(0x3f3) === _0x7d2666(0x3f3)) { const _0x409014 = await _0x2eb454(_0x2ca223['imageId']); _0x409014 && (_0x824fa6 = await _0x51083d(_0x409014)); } else _0x4a5309 > _0x247366 && (_0x4575b5 *= _0x89f17a / _0x2b5b35, _0x36ed73 = _0x21102b); } catch (_0x1a98c1) { console[_0x7d2666(0x863)](_0x7d2666(0x624), _0x1a98c1); } } } _0x824fa6 && (_0x42730e['image'] = _0x824fa6, _0x4c38e8 = !![]), _0x4c38e8 && _0x582113['push'](_0x42730e); } else { const _0x3b8e3e = _0x3eb428['open'](_0x2a7033, 0x2); _0x3b8e3e[_0x7d2666(0x618)] = () => _0x1dc9e6(_0x7d2666(0x4f7)), _0x3b8e3e[_0x7d2666(0x21f)] = () => _0xd1f468(_0x3b8e3e[_0x7d2666(0x6bf)]); } } _0x582113['push']({ 'role': _0x7d2666(0x845), 'content': _0x7d2666(0x6e7) + JSON[_0x7d2666(0x79c)](_0x311fbc) + _0x7d2666(0x8c3) + JSON['stringify'](_0x3a9dae) }); try { if (_0x7d2666(0x5a4) === _0x7d2666(0x5a4)) { const _0x19b9de = await _0x5cca68(_0x582113, { 'json': !![] }); if (!_0x19b9de) return null; let _0x591302 = _0x19b9de[_0x7d2666(0x42f)](); const _0x9f722c = _0x591302['match'](/```json([\s\S]*?)```/i); if (_0x9f722c) _0x591302 = _0x9f722c[0x1]['trim'](); _0x591302 = _0x2be734(_0x591302); let _0x27497f = null; try { _0x27497f = JSON[_0x7d2666(0x5b7)](_0x591302); } catch (_0x5be0be) { if (_0x7d2666(0x8da) === _0x7d2666(0x8cf)) { const _0x2ab782 = _0x766102[_0x7d2666(0x5b7)](_0x759032); _0x315891[_0x7d2666(0x1ab)](_0x2ab782) && (_0x31a3f4[_0x7d2666(0x5a5)] = _0x2ab782['map'](_0x42d0cc => _0x42d0cc[_0x7d2666(0x82e)] + '--' + _0x42d0cc['url'])[_0x7d2666(0x5d2)]('\x0a')); } else console[_0x7d2666(0x863)]('JSON\x20解析失败!\x20错误原因:', _0x5be0be), console[_0x7d2666(0x863)]('收到的原始、有问题的文本:', _0x591302); } if (!_0x27497f || !Array[_0x7d2666(0x1ab)](_0x27497f[_0x7d2666(0x699)])) return null; return _0x27497f = _0x3e9426(_0x27497f, _0x752b7f, _0x2c48dd), _0x27497f[_0x7d2666(0x699)] = _0x27497f[_0x7d2666(0x699)][_0x7d2666(0x60e)](0x0, _0x2cfdbb), _0x27497f[_0x7d2666(0x699)]['length'] ? _0x27497f : null; } else { if (_0x5b123d) { const _0x540e95 = _0x19f999[_0x7d2666(0x628)]('p'); _0x540e95['textContent'] = _0x2e1387, _0x540e95['style'][_0x7d2666(0x396)] = '0', _0x53ea46['appendChild'](_0x540e95); } } } catch (_0x2711f2) { return _0x2711f2['name'] !== 'AbortError' && console['error'](_0x7d2666(0x889), _0x2711f2), null; } } function _0x1767b7() { const _0x447d7c = _0xbc3280; if (_0x447d7c(0x56c) === 'UWGHG') _0x544923['log'](_0x447d7c(0x808)), _0x1987ef[_0x447d7c(0x3cd)](_0x447d7c(0x21e), _0x262988[_0x447d7c(0x79c)](_0x3a9dfa)); else { const _0x54539a = document[_0x447d7c(0x5d9)]('friend-circle-list-container'); _0x54539a['innerHTML'] = ''; if (_0x5c6c54['friendCircles'][_0x447d7c(0x794)] === 0x0) { _0x54539a[_0x447d7c(0x497)] = _0x447d7c(0x2bf); return; } _0x5c6c54[_0x447d7c(0x48c)]['forEach'](_0x2d1e36 => { const _0x20b642 = _0x447d7c, _0x572c0d = _0x5c6c54[_0x20b642(0x160)][_0x20b642(0x659)](_0x5e91c6 => _0x5e91c6['id'] === _0x2d1e36[_0x20b642(0x41c)]) || { 'name': _0x20b642(0x1df) }, _0x867ec6 = document[_0x20b642(0x628)](_0x20b642(0x172)); _0x867ec6[_0x20b642(0x63a)] = 'world-book-item', _0x867ec6[_0x20b642(0x17f)]['id'] = _0x2d1e36['id'], _0x867ec6[_0x20b642(0x497)] = _0x20b642(0x560) + _0x2d1e36[_0x20b642(0x82e)] + _0x20b642(0x276) + _0x572c0d['name'] + _0x20b642(0x79f) + _0x2d1e36[_0x20b642(0x6b1)][_0x20b642(0x794)] + _0x20b642(0x27d), _0x867ec6[_0x20b642(0x73c)]('click', () => _0x5df0c7(_0x2d1e36['id'])), _0x54539a[_0x20b642(0x2c8)](_0x867ec6); }); } } function _0xec58bb(_0x9fd04d = null) { const _0x17854d = _0xbc3280, _0x3a2df4 = document[_0x17854d(0x5d9)](_0x17854d(0x6a8)), _0x306551 = document['getElementById'](_0x17854d(0x60d)), _0x7824a5 = document[_0x17854d(0x5d9)](_0x17854d(0x346)), _0xde1155 = document[_0x17854d(0x5d9)](_0x17854d(0x5cb)), _0x3cfa19 = document[_0x17854d(0x5d9)](_0x17854d(0x6c1)), _0x3735ad = document['getElementById'](_0x17854d(0x8b9)); _0xbb5832(_0x17854d(0x60d)), _0x7824a5[_0x17854d(0x497)] = '', _0x5c6c54[_0x17854d(0x24a)]['forEach'](_0xb70ee6 => { const _0x2cc8eb = _0x17854d, _0x1e8cb0 = document[_0x2cc8eb(0x628)](_0x2cc8eb(0x172)); _0x1e8cb0[_0x2cc8eb(0x63a)] = _0x2cc8eb(0x1e5), _0x1e8cb0[_0x2cc8eb(0x497)] = _0x2cc8eb(0x4b4) + _0xb70ee6['id'] + _0x2cc8eb(0x305) + _0xb70ee6['id'] + _0x2cc8eb(0x1f0) + (_0xb70ee6['avatar'] || _0x166d38) + _0x2cc8eb(0x277) + _0xb70ee6['id'] + _0x2cc8eb(0x62b) + _0xb70ee6[_0x2cc8eb(0x82e)] + '</label>\x0a\x20\x20\x20\x20', _0x7824a5[_0x2cc8eb(0x2c8)](_0x1e8cb0); }); if (_0x9fd04d) { const _0x230d40 = _0x5c6c54[_0x17854d(0x48c)][_0x17854d(0x659)](_0x14fc76 => _0x14fc76['id'] === _0x9fd04d); if (!_0x230d40) return; _0xde1155[_0x17854d(0x41a)] = _0x17854d(0x86e), _0x3cfa19[_0x17854d(0x5a5)] = _0x230d40['id'], _0x3a2df4['value'] = _0x230d40[_0x17854d(0x82e)], _0x306551[_0x17854d(0x5a5)] = _0x230d40[_0x17854d(0x41c)], _0x3735ad[_0x17854d(0x3fc)]['display'] = _0x17854d(0x38f), _0x230d40[_0x17854d(0x6b1)]['forEach'](_0x558f2d => { const _0x3b408d = _0x17854d; if (_0x3b408d(0x68a) !== _0x3b408d(0x68a)) _0x5c549d[_0x3b408d(0x81a)](_0x3b408d(0x39f))[_0x3b408d(0x691)](_0x2a283a => { const _0x5e2a6d = _0x3b408d; if (_0x512c9f['linkedWorldBookIds'][_0x5e2a6d(0x87c)](_0x2a283a[_0x5e2a6d(0x5a5)])) _0x2a283a[_0x5e2a6d(0x27f)] = !![]; }); else { const _0x55b23 = _0x7824a5['querySelector'](_0x3b408d(0x7f7) + _0x558f2d); if (_0x55b23) _0x55b23[_0x3b408d(0x27f)] = !![]; } }); } else _0xde1155[_0x17854d(0x41a)] = _0x17854d(0x7eb), _0x3cfa19[_0x17854d(0x5a5)] = '', _0x3a2df4[_0x17854d(0x5a5)] = '好友圈\x20' + (_0x5c6c54[_0x17854d(0x48c)]['length'] + 0x1), _0x306551[_0x17854d(0x5a5)] = _0x5c6c54[_0x17854d(0x4f0)], _0x3735ad[_0x17854d(0x3fc)][_0x17854d(0x74d)] = _0x17854d(0x860); _0x4ed1c4(_0x17854d(0x587), _0x17854d(0x896)); } function _0x415e9c() { const _0x2e6ea7 = _0xbc3280; if (_0x2e6ea7(0x263) === _0x2e6ea7(0x7ce)) _0x3bb1c9['log']('用户操作中断了\x20AI\x20响应。'), _0x5ef03b[_0x2e6ea7(0x493)][_0x2e6ea7(0x431)]('User\x20cancelled'), _0x35f0ce[_0x2e6ea7(0x493)] = null; else { const _0x37a1a3 = document[_0x2e6ea7(0x5d9)](_0x2e6ea7(0x6c1))['value'], _0x239234 = document[_0x2e6ea7(0x5d9)](_0x2e6ea7(0x6a8))[_0x2e6ea7(0x5a5)][_0x2e6ea7(0x42f)](), _0x4fedc3 = document[_0x2e6ea7(0x5d9)]('friend-circle-edit-bind-user')[_0x2e6ea7(0x5a5)], _0x1f2d62 = Array[_0x2e6ea7(0x485)](document[_0x2e6ea7(0x81a)](_0x2e6ea7(0x5d0)))[_0x2e6ea7(0x2ac)](_0x2ff349 => _0x2ff349[_0x2e6ea7(0x17f)]['id']); if (!_0x239234) { _0x13197e(_0x2e6ea7(0x895)); return; } if (_0x1f2d62[_0x2e6ea7(0x794)] === 0x0) { if ('BPexB' === _0x2e6ea7(0x548)) _0x52859a('这个也是摆设，别点了。'); else { _0x13197e('至少要选择一个圈内成员！'); return; } } if (_0x37a1a3) { if ('DBJzy' === _0x2e6ea7(0x55e)) { const _0x54017a = _0x5c6c54[_0x2e6ea7(0x48c)][_0x2e6ea7(0x659)](_0x4ce5c3 => _0x4ce5c3['id'] === _0x37a1a3); _0x54017a && (_0x54017a[_0x2e6ea7(0x82e)] = _0x239234, _0x54017a[_0x2e6ea7(0x41c)] = _0x4fedc3, _0x54017a['memberCharacterIds'] = _0x1f2d62); } else _0x184ca7 = _0xda0b67[_0x2e6ea7(0x4e0)]; } else { const _0x2076b2 = { 'id': _0x2e6ea7(0x18f) + Date[_0x2e6ea7(0x7a5)](), 'name': _0x239234, 'boundUserProfileId': _0x4fedc3, 'memberCharacterIds': _0x1f2d62, 'posts': [] }; _0x5c6c54['friendCircles'][_0x2e6ea7(0x43f)](_0x2076b2); } _0xbd25a6(), _0x13197e(_0x2e6ea7(0x859)), _0x1767b7(), _0x4ed1c4(_0x2e6ea7(0x896), 'friendCircleEdit'); } } async function _0x1202d1() { const _0x5bea89 = _0xbc3280; if ('RnoXJ' === 'iTBJf') return _0xa45f3e[_0x5bea89(0x1ce)][_0x5bea89(0x659)](_0x39536e => _0x39536e['id'] === _0x55f8a5[_0x5bea89(0x728)]); else { const _0x5753a4 = document['getElementById']('editing-friend-circle-id')[_0x5bea89(0x5a5)]; if (!_0x5753a4) return; const _0x37e586 = await _0x458a99(_0x5bea89(0x5d6)); if (_0x37e586) { _0x5c6c54[_0x5bea89(0x48c)] = _0x5c6c54['friendCircles'][_0x5bea89(0x25b)](_0x21ea33 => _0x21ea33['id'] !== _0x5753a4); if (_0x5c6c54[_0x5bea89(0x266)] === _0x5753a4) { if ('ekLHn' === 'OxjhG') { const _0x5b56ff = _0x1b131f[_0x5bea89(0x798)](_0x1d598d, 0x2); _0x5b56ff[_0x5bea89(0x618)] = () => _0x22a1bf(_0x5bea89(0x4f7)), _0x5b56ff['onsuccess'] = () => _0x9e1961(_0x5b56ff['result']), _0x5b56ff[_0x5bea89(0x7af)] = _0x298932 => { const _0x2daa1a = _0x5bea89, _0x5e67d4 = _0x298932['target'][_0x2daa1a(0x6bf)]; !_0x5e67d4[_0x2daa1a(0x5ab)][_0x2daa1a(0x153)](_0xfcfd99) && _0x5e67d4['createObjectStore'](_0x5aec3c, { 'keyPath': 'id' }); const _0xd2f7ce = 'music_library'; !_0x5e67d4[_0x2daa1a(0x5ab)][_0x2daa1a(0x153)](_0xd2f7ce) && _0x5e67d4['createObjectStore'](_0xd2f7ce, { 'keyPath': 'id' }); }; } else _0x5c6c54[_0x5bea89(0x266)] = null; } _0xbd25a6(), _0x13197e(_0x5bea89(0x438)), _0x1767b7(), _0x4ed1c4(_0x5bea89(0x896), _0x5bea89(0x587)); } } } function _0x5df0c7(_0x214558) { const _0x324c03 = _0xbc3280; _0x3edf3a(); const _0x37d720 = _0x5c6c54[_0x324c03(0x48c)][_0x324c03(0x659)](_0x881583 => _0x881583['id'] === _0x214558); if (!_0x37d720) return; _0x5c6c54['activeFriendCircleId'] = _0x214558, _0xbd25a6(), document[_0x324c03(0x5d9)](_0x324c03(0x8c0))['textContent'] = _0x37d720[_0x324c03(0x82e)], _0x1f440d(), _0x4ed1c4(_0x324c03(0x388), _0x324c03(0x896)), _0x5a3ebb(); } function _0x329dd7() { const _0x4133da = _0xbc3280; if (_0x4133da(0x36f) !== _0x4133da(0x826)) { if (!_0x5c6c54[_0x4133da(0x48c)] || _0x5c6c54[_0x4133da(0x48c)]['length'] === 0x0) { console[_0x4133da(0x863)](_0x4133da(0x538)); return; } const _0x4703d8 = _0x5c6c54[_0x4133da(0x48c)][0x0]; if (_0x4703d8[_0x4133da(0x6b1)]['length'] < 0x2) { console[_0x4133da(0x863)](_0x4133da(0x8db) + _0x4703d8[_0x4133da(0x82e)] + _0x4133da(0x418)); return; } const _0x17bfca = { 'id': 'test_post_' + Date['now'](), 'authorType': _0x4133da(0x223), 'authorId': _0x4703d8[_0x4133da(0x6b1)][0x0], 'content': _0x4133da(0x8dc), 'timestamp': Date[_0x4133da(0x7a5)](), 'likes': [_0x4703d8[_0x4133da(0x6b1)][0x1]], 'comments': [{ 'commentId': 'c_' + Date[_0x4133da(0x7a5)](), 'authorId': _0x4703d8[_0x4133da(0x6b1)][0x1], 'content': _0x4133da(0x84d) }] }; _0x4703d8[_0x4133da(0x834)][_0x4133da(0x43f)](_0x17bfca), _0xbd25a6(), console['log'](_0x4133da(0x509) + _0x4703d8[_0x4133da(0x82e)] + _0x4133da(0x5ba)), _0x13197e(_0x4133da(0x6ef)); } else { const _0x276517 = _0x1504bc[_0x4133da(0x48c)][_0x4133da(0x659)](_0x222be5 => _0x222be5['id'] === _0x537212[_0x4133da(0x266)]), _0x2cdbc7 = _0x276517?.[_0x4133da(0x41c)]; let _0x327ca8 = _0x36c587[_0x4133da(0x160)]['find'](_0x1e5746 => _0x1e5746['id'] === _0x2cdbc7); !_0x327ca8 && (_0x327ca8 = _0x225a49['userProfiles']['find'](_0x413b8a => _0x413b8a['id'] === _0x540b14[_0x4133da(0x4f0)])), !_0x327ca8 && (_0x327ca8 = _0x153bfd[_0x4133da(0x160)][0x0]), _0x327ca8 && (_0x483740['getElementById'](_0x4133da(0x816))[_0x4133da(0x161)] = _0x327ca8[_0x4133da(0x41e)] || _0x3e45d4); } } window[_0xbc3280(0x543)] = _0x329dd7; function _0x5de4aa(_0x3d6cec) { const _0x3153bd = _0xbc3280; return _0x5c6c54[_0x3153bd(0x160)][_0x3153bd(0x659)](_0x51ce63 => _0x51ce63['id'] === _0x3d6cec); } function _0x3168b5(_0xaf35c2, _0x2174a1 = '正在处理...') { const _0x42721e = _0xbc3280, _0x10df79 = document[_0x42721e(0x5d9)](_0x42721e(0x6d2)); let _0x10e6a6 = document['getElementById'](_0x42721e(0x5e6)); if (_0xaf35c2) !_0x10e6a6 && (_0x10e6a6 = document[_0x42721e(0x628)](_0x42721e(0x172)), _0x10e6a6['id'] = _0x42721e(0x5e6), _0x10df79[_0x42721e(0x2c8)](_0x10e6a6)), _0x10e6a6['innerHTML'] = _0x42721e(0x6fa) + _0x2174a1 + _0x42721e(0x597), _0x10e6a6[_0x42721e(0x3fc)][_0x42721e(0x74d)] = 'flex'; else { if (_0x42721e(0x46a) === _0x42721e(0x46a)) _0x10e6a6 && (_0x10e6a6[_0x42721e(0x3fc)][_0x42721e(0x74d)] = _0x42721e(0x860)); else { const _0x3d12fc = _0x3c7580['querySelectorAll'](_0x42721e(0x2ec)); _0x3d12fc[_0x42721e(0x691)](_0x284f7c => _0x284f7c[_0x42721e(0x8a2)]()); } } } async function _0x1a0504() { const _0x1143d5 = _0xbc3280, _0x48f3d4 = _0x5c6c54[_0x1143d5(0x48c)][_0x1143d5(0x659)](_0x4210c4 => _0x4210c4['id'] === _0x5c6c54[_0x1143d5(0x266)]); if (!_0x48f3d4 || _0x5c6c54[_0x1143d5(0x75c)]) return; _0x3168b5(!![], '好像有动态了...'), _0x5c6c54['isGenerating'] = !![]; try { let _0x44b48d = Date['now'](); _0x48f3d4[_0x1143d5(0x834)] && _0x48f3d4[_0x1143d5(0x834)][_0x1143d5(0x794)] > 0x0 && (_0x44b48d = Math['max'](..._0x48f3d4[_0x1143d5(0x834)][_0x1143d5(0x2ac)](_0xf8746a => _0xf8746a[_0x1143d5(0x5c5)]))); const _0x3ab5d3 = await _0x3a0da3(_0x48f3d4); if (!_0x3ab5d3 || _0x3ab5d3[_0x1143d5(0x794)] === 0x0) { if (_0x1143d5(0x5b5) === _0x1143d5(0x3e0)) _0x2905f8[_0x1143d5(0x493)] = null; else { _0x13197e(_0x1143d5(0x625)); return; } } const _0x4a2e1b = _0x3ab5d3['map'](async (_0x2bfa72, _0x394a44) => { const _0x528a03 = _0x1143d5; _0x3168b5(!![], '刷新了\x20' + (_0x394a44 + 0x1) + '\x20/\x20' + _0x3ab5d3[_0x528a03(0x794)] + _0x528a03(0x74f)); const _0x479bc3 = _0x44b48d + (_0x394a44 + 0x1) * 0x3c * 0x3e8, _0xdf764e = { 'id': _0x528a03(0x697) + _0x2bfa72[_0x528a03(0x54c)] + '_' + _0x479bc3, 'authorType': _0x528a03(0x223), 'authorId': _0x2bfa72[_0x528a03(0x54c)], 'content': _0x2bfa72[_0x528a03(0x227)], 'timestamp': _0x479bc3, 'likes': _0x2bfa72[_0x528a03(0x725)] || [], 'comments': (_0x2bfa72['comments'] || [])[_0x528a03(0x2ac)]((_0x3a1a9d, _0x27f7d4) => ({ 'commentId': 'c_' + _0x479bc3 + '_' + _0x27f7d4, 'authorId': _0x3a1a9d[_0x528a03(0x54c)], 'content': _0x3a1a9d['content'] })) }; if (_0x2bfa72[_0x528a03(0x3b3)] === _0x528a03(0x388) && _0x2bfa72[_0x528a03(0x2ed)] && _0x2bfa72[_0x528a03(0x381)]) { if (_0x528a03(0x17d) === _0x528a03(0x17d)) try { if (_0x528a03(0x68c) !== _0x528a03(0x68c)) _0x144494('错误:\x20' + _0x451edb[_0x528a03(0x1a4)]); else { const _0x4dff99 = await _0x1bd57d(_0x2bfa72[_0x528a03(0x2ed)], _0x2bfa72['artist']); _0xdf764e['type'] = _0x528a03(0x388), _0xdf764e[_0x528a03(0x2ed)] = _0x2bfa72['songName'], _0xdf764e[_0x528a03(0x381)] = _0x2bfa72['artist'], _0xdf764e['coverUrl'] = _0x4dff99['cover'], _0xdf764e[_0x528a03(0x62d)] = _0x4dff99[_0x528a03(0x5e3)]; } } catch (_0x40607a) { console[_0x528a03(0x863)](_0x528a03(0x630), _0x40607a), _0xdf764e[_0x528a03(0x443)] = 'text'; } else _0x3712c8 += _0x528a03(0x3c6); } else _0xdf764e[_0x528a03(0x443)] = _0x528a03(0x224); return _0xdf764e; }), _0xf86856 = await Promise[_0x1143d5(0x5a9)](_0x4a2e1b); _0x48f3d4[_0x1143d5(0x834)][_0x1143d5(0x43f)](..._0xf86856), _0xbd25a6(); } catch (_0x2c0116) { console[_0x1143d5(0x863)](_0x1143d5(0x212), _0x2c0116), _0x13197e(_0x1143d5(0x663) + _0x2c0116[_0x1143d5(0x1a4)]); } finally { _0x1f440d(), _0x3168b5(![]), _0x5c6c54[_0x1143d5(0x75c)] = ![]; } } async function _0x3a0da3(_0x755b6c) { const _0x60dabe = _0xbc3280; if (_0x60dabe(0x57e) === _0x60dabe(0x57e)) { const _0x46f066 = _0x755b6c[_0x60dabe(0x6b1)][_0x60dabe(0x2ac)](_0x4f1b4f => _0x5a8ee7(_0x4f1b4f))[_0x60dabe(0x25b)](Boolean); if (_0x46f066[_0x60dabe(0x794)] === 0x0) return null; const _0x33ca9d = _0x480fea(), _0x39f23d = _0x5de4aa(_0x755b6c[_0x60dabe(0x41c)]) || _0x5c6c54[_0x60dabe(0x160)][0x0], _0xa82079 = _0x39f23d ? '\x0a#\x20好友圈的主人\x20(“我”)\x0a-\x20姓名:\x20' + _0x39f23d['name'] + _0x60dabe(0x3b9) + (_0x39f23d[_0x60dabe(0x854)] || '无') + '\x0a' : '', _0x12fb69 = _0x46f066[_0x60dabe(0x2ac)](_0xb1ada3 => { const _0x325c8b = _0x60dabe, { omniText: _0x530c7d } = _0x5c86b3(_0xb1ada3['id'], null), _0x509a4e = _0x13f7f9(_0xb1ada3['id']), _0x4ebaa3 = _0xb1ada3[_0x325c8b(0x88d)] && _0xb1ada3[_0x325c8b(0x88d)][_0x325c8b(0x794)] > 0x0 ? _0x325c8b(0x856) + _0xb1ada3[_0x325c8b(0x82e)] + _0x325c8b(0x6fb) + _0xb1ada3[_0x325c8b(0x88d)][_0x325c8b(0x2ac)](_0x2a03b6 => _0x5c6c54['worldBooks'][_0x325c8b(0x659)](_0x3ec58d => _0x3ec58d['id'] === _0x2a03b6))[_0x325c8b(0x25b)](Boolean)[_0x325c8b(0x2ac)](_0xc47823 => '\x0a##\x20条目:\x20' + _0xc47823[_0x325c8b(0x82e)] + '\x0a' + _0xc47823[_0x325c8b(0x283)])[_0x325c8b(0x5d2)]('') : ''; return _0x325c8b(0x167) + _0xb1ada3[_0x325c8b(0x82e)] + _0x325c8b(0x8c8) + _0xb1ada3['id'] + _0x325c8b(0x1bc) + _0xb1ada3[_0x325c8b(0x854)] + _0x325c8b(0x447) + _0x530c7d + '\x0a' + _0x509a4e + '\x0a' + _0x4ebaa3; })['join']('\x0a\x0a'), _0x503063 = Math[_0x60dabe(0x564)](Math[_0x60dabe(0x633)]() * 0x3) + 0x2, _0x1b58bb = '\x0a#\x20核心任务\x0a你是一个顶级多角色社交模拟引擎。你的任务是模拟一个好友圈的动态更新，一次性生成【' + _0x503063 + _0x60dabe(0x58e) + _0x12fb69 + '\x0a' + _0xa82079 + _0x60dabe(0x8d1) + _0x33ca9d + _0x60dabe(0x197) + _0x503063 + _0x60dabe(0x327) + _0x503063 + '个帖子对象。\x0a-\x20**【ID规则】**:\x20所有\x20\x22authorId\x22,\x20\x22likes\x22,\x20\x22comments\x22\x20中的作者标识，【必须】使用上面提供的角色\x20**ID**，绝对不能使用角色名字。\x0a-\x20**【JSON结构】**:\x20每个帖子对象必须遵循以下结构：\x0a\x20\x20```json\x0a\x20\x20{\x0a\x20\x20\x20\x20\x22authorId\x22:\x20\x22发布者的ID\x22,\x0a\x20\x20\x20\x20\x22postType\x22:\x20\x22text\x20or\x20music\x22,\x0a\x20\x20\x20\x20\x22postContent\x22:\x20\x22动态的文字内容\x22,\x0a\x20\x20\x20\x20\x22songName\x22:\x20\x22如果是music类型，则必须有歌名\x22,\x0a\x20\x20\x20\x20\x22artist\x22:\x20\x22如果是music类型，则必须有歌手名\x22,\x0a\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20}\x0a\x20\x20```\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a', _0x3eb854 = [{ 'role': _0x60dabe(0x523), 'content': _0x1b58bb }]; _0x3eb854[_0x60dabe(0x43f)]({ 'role': _0x60dabe(0x845), 'content': '请根据以上所有规则，生成\x20' + _0x503063 + '\x20条新动态。' }); try { const _0x32dc30 = await _0x5cca68(_0x3eb854, { 'json': !![] }), _0x9af469 = _0x32dc30[_0x60dabe(0x6a9)](/(\[[\s\S]*\])/); if (!_0x9af469) throw new Error('AI未能返回有效的JSON数组格式。'); const _0x1b93c9 = _0x9af469[0x1], _0x386f97 = JSON['parse'](_0x1b93c9); if (!Array[_0x60dabe(0x1ab)](_0x386f97)) throw new Error(_0x60dabe(0x71a)); return _0x386f97; } catch (_0x4d6d42) { return console[_0x60dabe(0x863)]('批量生成动态失败:\x20', _0x4d6d42), console['error'](_0x60dabe(0x4ae), _0x4d6d42[_0x60dabe(0x646)] || response), null; } } else _0x57344a[_0x60dabe(0x41a)] = _0x2c90d7[_0x60dabe(0x485)](_0x564c46)['map'](_0x3aa993 => _0x3aa993[_0x60dabe(0x59c)][_0x60dabe(0x41a)][_0x60dabe(0x42f)]())[_0x60dabe(0x5d2)]('、'); } async function _0x186750() { const _0x18184c = _0xbc3280; if (_0x18184c(0x880) !== _0x18184c(0x880)) _0x2de8c8[_0x18184c(0x73c)](_0x18184c(0x36d), () => { const _0x542329 = _0x18184c; if (_0x3c61f6[_0x542329(0x794)] === 0x0) return; _0x6f4c4 = (_0x55201d + 0x1) % _0x9d81de[_0x542329(0x794)], _0x4ad450(_0x4f11c8[_0x36bfcf], _0x1403cd); }); else { const _0x1478f6 = _0x5c6c54[_0x18184c(0x48c)][_0x18184c(0x659)](_0x2f61d7 => _0x2f61d7['id'] === _0x5c6c54[_0x18184c(0x266)]); if (!_0x1478f6) return; const _0x2409a4 = await _0x458a99(_0x18184c(0x7a7) + _0x1478f6['name'] + _0x18184c(0x82c)); _0x2409a4 && (_0x1478f6[_0x18184c(0x834)] = [], _0xbd25a6(), _0x1f440d(), _0x13197e(_0x18184c(0x598))); } } function _0x1f440d() { const _0x313e0d = _0xbc3280, _0x198ecb = document['getElementById'](_0x313e0d(0x4d3)), _0x1a6e25 = _0x5c6c54[_0x313e0d(0x48c)][_0x313e0d(0x659)](_0x4e9d96 => _0x4e9d96['id'] === _0x5c6c54[_0x313e0d(0x266)]); if (!_0x1a6e25) { _0x198ecb[_0x313e0d(0x497)] = _0x313e0d(0x2cb); return; } if (_0x1a6e25[_0x313e0d(0x834)][_0x313e0d(0x794)] === 0x0) { if (_0x313e0d(0x86b) === 'txsTa') { const _0xd905c = _0x59fd10(_0x245b1f['content']); _0x13d813[_0x313e0d(0x8cb)](_0x1729ed, { 'content': _0xd905c[_0x313e0d(0x283)], 'quotedMessage': _0xd905c[_0x313e0d(0x19d)] }); } else { _0x198ecb[_0x313e0d(0x497)] = _0x313e0d(0x335); return; } } _0x198ecb[_0x313e0d(0x497)] = ''; const _0x50ca15 = [..._0x1a6e25[_0x313e0d(0x834)]][_0x313e0d(0x357)]((_0x1bd25b, _0x3bdc10) => _0x3bdc10[_0x313e0d(0x5c5)] - _0x1bd25b[_0x313e0d(0x5c5)]); _0x50ca15['forEach'](_0x5a2b25 => { const _0x4ffa04 = _0x313e0d, _0x58220b = document['createElement']('div'); _0x58220b[_0x4ffa04(0x63a)] = _0x4ffa04(0x6ca); let _0x5d4320 = '未知', _0x498130 = _0x166d38; if (_0x5a2b25[_0x4ffa04(0x1ec)] === 'user') { const _0x3c487c = _0x5de4aa(_0x5a2b25['authorId']); _0x3c487c && (_0x5d4320 = _0x3c487c[_0x4ffa04(0x82e)], _0x498130 = _0x3c487c['avatar']); } else { if (_0x4ffa04(0x815) !== _0x4ffa04(0x815)) { const _0x31bbac = _0x41c406[_0x4ffa04(0x6f2)](_0x4ffa04(0x342)), _0x29785d = _0x4d0218['dataset'][_0x4ffa04(0x7a8)], _0x4c9333 = _0x97b79e(_0x31bbac[_0x4ffa04(0x17f)][_0x4ffa04(0x7a6)], 0xa); _0x500163(_0x29785d, _0x4c9333, _0x25b0e9); } else { const _0x43804d = _0x5a8ee7(_0x5a2b25[_0x4ffa04(0x54c)]); _0x43804d && (_0x5d4320 = _0x43804d[_0x4ffa04(0x82e)], _0x498130 = _0x43804d[_0x4ffa04(0x41e)]); } } const _0x13c958 = _0x4ffa04(0x348) + _0x498130 + _0x4ffa04(0x522) + _0x5d4320 + _0x4ffa04(0x411), _0x4e44a1 = _0x4ffa04(0x1b9) + _0x5a2b25[_0x4ffa04(0x283)] + _0x4ffa04(0x361); let _0x4dd4e0 = ''; if (_0x5a2b25[_0x4ffa04(0x4e0)] || _0x5a2b25[_0x4ffa04(0x2f3)]) { const _0x4c86b5 = _0x4ffa04(0x2aa) + _0x5a2b25['id']; _0x4dd4e0 = '<div\x20class=\x22post-image-container\x22><img\x20id=\x22' + _0x4c86b5 + _0x4ffa04(0x4b3), setTimeout(() => { const _0x301ebd = _0x4ffa04; if (_0x301ebd(0x553) !== _0x301ebd(0x6a3)) { const _0x5d7348 = document[_0x301ebd(0x5d9)](_0x4c86b5); if (!_0x5d7348) return; if (_0x5a2b25[_0x301ebd(0x4e0)]) { if (_0x301ebd(0x395) !== _0x301ebd(0x76a)) _0x5d7348[_0x301ebd(0x161)] = _0x5a2b25[_0x301ebd(0x4e0)]; else { const _0x2cccd3 = _0x46d1a7(_0x191138['id']); if (_0x2cccd3 && _0x2cccd3[_0x301ebd(0x794)] > 0x0) { const _0x399016 = _0x2cccd3[_0x2cccd3[_0x301ebd(0x794)] - 0x1]; (!_0x3a0a79 || _0x399016['timestamp'] > _0x4961d8[_0x301ebd(0x5c5)]) && (_0xf5a015 = _0x399016); } } } else { if (_0x5a2b25[_0x301ebd(0x2f3)]) { if (_0x301ebd(0x222) !== 'cNYWh') _0x2eb454(_0x5a2b25[_0x301ebd(0x2f3)])[_0x301ebd(0x2b1)](_0x375344 => { const _0x44c699 = _0x301ebd; if (_0x375344) { if (_0x44c699(0x27e) !== _0x44c699(0x27e)) { const _0x4d3f02 = _0x431f4a[_0x44c699(0x773)][_0xf7a9a3[_0x44c699(0x251)]]; if (_0x4d3f02 && _0x4d3f02[_0x44c699(0x794)] > 0x0) { _0x78c490[_0x44c699(0x462)] = [..._0x4d3f02]; const _0xafd3e9 = _0x420f3b[_0x44c699(0x462)][_0x44c699(0x1b5)](); _0x57d75f[_0x44c699(0x41a)] = _0xafd3e9[_0x44c699(0x28b)] === _0x44c699(0x494) ? '旁白' : _0xafd3e9[_0x44c699(0x28b)], _0x371fff[_0x44c699(0x41a)] = _0xafd3e9[_0x44c699(0x475)], _0xafd3e9[_0x44c699(0x28b)] !== _0x44c699(0x494) && _0x2952b2(_0x207c83[_0x44c699(0x251)], _0xafd3e9['emotion']); } else _0x1be2fe[_0x44c699(0x41a)] = '旁白', _0x2eecb6[_0x44c699(0x41a)] = _0x44c699(0x496); } else { const _0x1ef6a3 = URL[_0x44c699(0x78a)](_0x375344); _0x5d7348[_0x44c699(0x161)] = _0x1ef6a3, _0x5d7348[_0x44c699(0x792)] = () => URL[_0x44c699(0x3d1)](_0x1ef6a3); } } else _0x5d7348[_0x44c699(0x2d2)] = _0x44c699(0x254); }); else { const _0xb60506 = _0x129d45(_0xe9e788[_0x301ebd(0x594)][0x0]); _0xb60506 ? (_0x926fe2 = _0xb60506[_0x301ebd(0x41e)] || _0x592300, _0x35dc0c = _0xb60506[_0x301ebd(0x82e)] || _0x301ebd(0x5de), _0x292fb7 = _0xb60506['remark'] || '私聊') : (_0x2b1326 = _0x301ebd(0x4fc), _0x8a9e30 = _0x301ebd(0x2e1)); } } } } else _0x5c9db8[_0x301ebd(0x41a)] = _0x14f1f7['title'], _0x3a0fd0['textContent'] = _0x3b5ce8['artist'], _0x10b43e[_0x301ebd(0x3fc)][_0x301ebd(0x6d5)] = 'url(' + _0xbf71cc['cover'] + ')', _0xc5f842[_0x301ebd(0x41a)] = _0x483657['paused'] ? '▶' : '❚❚', _0x465dd1[_0x301ebd(0x258)] ? _0x262253[_0x301ebd(0x7a1)][_0x301ebd(0x8a2)](_0x301ebd(0x364)) : _0x5d7e38[_0x301ebd(0x7a1)][_0x301ebd(0x821)](_0x301ebd(0x364)); }, 0x0); } let _0xffe1d6 = ''; _0x5a2b25[_0x4ffa04(0x443)] === _0x4ffa04(0x388) && _0x5a2b25['songName'] && (_0xffe1d6 = _0x4ffa04(0x7e0) + _0x5a2b25['id'] + _0x4ffa04(0x467) + (_0x5a2b25[_0x4ffa04(0x621)] || _0x166d38) + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-song-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x5a2b25[_0x4ffa04(0x2ed)] + _0x4ffa04(0x82a) + _0x5a2b25[_0x4ffa04(0x381)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-play-icon\x22>' + (_0x5a2b25[_0x4ffa04(0x62d)] ? '▶' : '⚠') + _0x4ffa04(0x1a1)); const _0x5a9e10 = '<div\x20class=\x22post-timestamp\x22>' + new Date(_0x5a2b25[_0x4ffa04(0x5c5)])[_0x4ffa04(0x787)](_0x4ffa04(0x4ea)) + _0x4ffa04(0x61f); let _0x277f16 = ''; if (_0x5a2b25['likes'] && _0x5a2b25['likes'][_0x4ffa04(0x794)] > 0x0 || _0x5a2b25[_0x4ffa04(0x286)] && _0x5a2b25[_0x4ffa04(0x286)]['length'] > 0x0) { let _0x34ed61 = ''; if (_0x5a2b25[_0x4ffa04(0x725)] && _0x5a2b25[_0x4ffa04(0x725)][_0x4ffa04(0x794)] > 0x0) { const _0x497142 = _0x5a2b25[_0x4ffa04(0x725)][_0x4ffa04(0x2ac)](_0x5906a7 => _0x5a8ee7(_0x5906a7)?.[_0x4ffa04(0x82e)] || '未知')['join']('、'); _0x34ed61 = _0x4ffa04(0x2b6) + _0x497142 + _0x4ffa04(0x61f); } let _0x85c8ae = ''; if (_0x5a2b25['comments'] && _0x5a2b25[_0x4ffa04(0x286)]['length'] > 0x0) { const _0x2c7237 = _0x5a2b25['comments']['map'](_0x36afde => { const _0x1c832a = _0x4ffa04, _0x218d58 = _0x5a8ee7(_0x36afde[_0x1c832a(0x54c)])?.[_0x1c832a(0x82e)] || '未知'; return _0x1c832a(0x1bf) + _0x218d58 + _0x1c832a(0x693) + _0x36afde[_0x1c832a(0x283)] + _0x1c832a(0x61f); })[_0x4ffa04(0x5d2)](''); _0x85c8ae = _0x4ffa04(0x7c3) + _0x2c7237 + _0x4ffa04(0x61f); } _0x277f16 = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-interactions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x34ed61 + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x85c8ae + _0x4ffa04(0x433); } _0x58220b['innerHTML'] = _0x13c958 + _0x4e44a1 + _0x4dd4e0 + _0xffe1d6 + _0x5a9e10 + _0x277f16, _0x198ecb[_0x4ffa04(0x2c8)](_0x58220b); if (_0x5a2b25[_0x4ffa04(0x443)] === _0x4ffa04(0x388) && _0x5a2b25[_0x4ffa04(0x62d)]) { const _0x2edc8d = _0x58220b[_0x4ffa04(0x85e)](_0x4ffa04(0x3da)); _0x2edc8d && (_0x4ffa04(0x3f1) === _0x4ffa04(0x3f1) ? _0x2edc8d[_0x4ffa04(0x73c)](_0x4ffa04(0x36d), function () { const _0x1a8c7d = { 'id': _0x5a2b25['id'], 'url': _0x5a2b25['playableUrl'] }; _0x216cfd(this, _0x1a8c7d); }) : _0x96afb9[_0x4ffa04(0x41a)] = _0x4ffa04(0x2b7) + _0xea06e4[_0x4ffa04(0x794)] + '\x20项'); } }); } document[_0xbc3280(0x5d9)](_0xbc3280(0x419))[_0xbc3280(0x73c)]('click', _0x186750), document[_0xbc3280(0x5d9)](_0xbc3280(0x341))[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x1a0504), document[_0xbc3280(0x5d9)](_0xbc3280(0x7e9))['addEventListener'](_0xbc3280(0x36d), () => _0x4ed1c4('home', _0xbc3280(0x896))), document[_0xbc3280(0x5d9)](_0xbc3280(0x70f))[_0xbc3280(0x73c)]('click', () => _0xec58bb()), document[_0xbc3280(0x5d9)](_0xbc3280(0x2e3))['addEventListener']('click', () => _0x4ed1c4(_0xbc3280(0x896), 'friendCircleEdit')), document['getElementById'](_0xbc3280(0x463))['addEventListener'](_0xbc3280(0x36d), _0x415e9c), document[_0xbc3280(0x5d9)](_0xbc3280(0x8b9))[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x1202d1), document[_0xbc3280(0x5d9)](_0xbc3280(0x754))['addEventListener'](_0xbc3280(0x36d), () => { const _0x253329 = _0xbc3280; _0x1767b7(), _0x4ed1c4('friendCircleList', _0x253329(0x388)); }), document[_0xbc3280(0x5d9)](_0xbc3280(0x552))[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0x27519d = _0xbc3280; if ('bKQNk' !== _0x27519d(0x825)) { if (_0x5c6c54[_0x27519d(0x266)]) { if (_0x27519d(0x168) !== _0x27519d(0x5d8)) _0xec58bb(_0x5c6c54[_0x27519d(0x266)]); else { const _0x232981 = _0x46e1f1['getElementById'](_0x27519d(0x162)); _0x23ac94[_0x27519d(0x5ee)] && _0xeeacb3[_0x27519d(0x29d)] ? _0x232981[_0x27519d(0x1d4)] = ![] : _0x232981[_0x27519d(0x1d4)] = !![]; } } } else { _0x429535[_0x27519d(0x7a1)]['add'](_0x27519d(0x388)); const _0x40db9e = _0x528d27[_0x27519d(0x628)](_0x27519d(0x172)); _0x40db9e[_0x27519d(0x63a)] = _0x27519d(0x5d5), _0x40db9e['dataset'][_0x27519d(0x314)] = _0x27519d(0x3ed) + _0x5b4ec1['timestamp'], _0x40db9e[_0x27519d(0x497)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x541321[_0x27519d(0x621)] || _0x5cc80e) + _0x27519d(0x7e8) + _0x1a0586['songName'] + _0x27519d(0x6cd) + _0x3dc29d[_0x27519d(0x381)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-play-icon\x22>' + (_0x54a698['playableUrl'] ? '▶' : '⚠') + '</div>', _0x23a3b8[_0x27519d(0x62d)] && _0x40db9e['addEventListener'](_0x27519d(0x36d), function () { const _0x21da3d = _0x27519d, _0x594dfc = { 'id': _0x21da3d(0x3ed) + _0x13d79f[_0x21da3d(0x5c5)], 'url': _0x1acfda[_0x21da3d(0x62d)] }; _0xd0a136(this, _0x594dfc); }), _0x4f9ba1[_0x27519d(0x2c8)](_0x40db9e); } }), document['getElementById'](_0xbc3280(0x5b6))[_0xbc3280(0x73c)](_0xbc3280(0x36d), async () => { const _0x3bfe3e = _0xbc3280, _0x3e83a4 = _0x5c6c54[_0x3bfe3e(0x48c)][_0x3bfe3e(0x659)](_0x2a13db => _0x2a13db['id'] === _0x5c6c54[_0x3bfe3e(0x266)]); if (!_0x3e83a4 || _0x5c6c54[_0x3bfe3e(0x75c)]) return; const _0x1a38c5 = _0x3e83a4[_0x3bfe3e(0x41c)], _0x13a27d = _0x5c6c54[_0x3bfe3e(0x160)][_0x3bfe3e(0x659)](_0x233482 => _0x233482['id'] === _0x1a38c5); if (!_0x13a27d) { _0x13197e(_0x3bfe3e(0x225)); return; } const _0x240280 = document[_0x3bfe3e(0x5d9)]('user-post-textarea')[_0x3bfe3e(0x5a5)][_0x3bfe3e(0x42f)](), _0x4e9d75 = _0x5c6c54['pendingPostAttachments'][_0x3bfe3e(0x4e0)], _0x5d21f7 = _0x5c6c54[_0x3bfe3e(0x4dc)][_0x3bfe3e(0x388)], _0x2650ce = _0x5c6c54[_0x3bfe3e(0x4dc)]['imageId']; if (!_0x240280 && !_0x4e9d75 && !_0x5d21f7) { if ('VPWPU' === _0x3bfe3e(0x8d3)) return new _0x26b437((_0x11d3ce, _0x12fed8) => { const _0x15f033 = _0x3bfe3e, _0x569ccf = new _0x4a2476(); _0x569ccf[_0x15f033(0x739)] = () => _0x11d3ce(_0x569ccf[_0x15f033(0x6bf)]), _0x569ccf[_0x15f033(0x618)] = _0x12fed8, _0x569ccf[_0x15f033(0x26c)](_0x3aa618); }); else { _0x13197e('总得说点什么吧？'); return; } } const _0xeb66ca = { 'id': _0x3bfe3e(0x2d1) + Date[_0x3bfe3e(0x7a5)](), 'authorType': _0x3bfe3e(0x845), 'authorId': _0x13a27d['id'], 'content': _0x240280, 'timestamp': Date[_0x3bfe3e(0x7a5)](), 'likes': [], 'comments': [] }; if (_0x2650ce) _0xeb66ca[_0x3bfe3e(0x2f3)] = _0x2650ce; else _0x4e9d75 && (_0xeb66ca[_0x3bfe3e(0x4e0)] = _0x4e9d75); _0x5d21f7 ? _0x3bfe3e(0x542) !== _0x3bfe3e(0x542) ? _0x7d2d86['error'](_0x3bfe3e(0x291), _0x55e7af) : (_0xeb66ca[_0x3bfe3e(0x443)] = _0x3bfe3e(0x388), Object[_0x3bfe3e(0x8cb)](_0xeb66ca, _0x5d21f7)) : 'KxYwr' === _0x3bfe3e(0x842) ? (_0x22a190[_0x3bfe3e(0x5a5)] = _0x525d28['apiSettings'][_0x3bfe3e(0x3ba)] || '', _0x51b07f['value'] = _0x4b06ef[_0x3bfe3e(0x73a)][_0x3bfe3e(0x4de)] || '', _0x44f2a6[_0x3bfe3e(0x5a5)] = _0x306275['apiSettings'][_0x3bfe3e(0x70d)] || '', _0x3592b8[_0x3bfe3e(0x5a5)] = _0x1b57db(_0x471817[_0x3bfe3e(0x778)]?.[_0x3bfe3e(0x51f)] ?? 0x64), _0x5688f3[_0x3bfe3e(0x5d9)](_0x3bfe3e(0x179))[_0x3bfe3e(0x5a5)] = _0xac9669[_0x3bfe3e(0x73a)][_0x3bfe3e(0x472)] || _0x3bfe3e(0x252)) : _0xeb66ca[_0x3bfe3e(0x443)] = _0x3bfe3e(0x224), _0x3e83a4[_0x3bfe3e(0x834)]['push'](_0xeb66ca), _0xbd25a6(), _0x1f440d(), document[_0x3bfe3e(0x5d9)](_0x3bfe3e(0x237))[_0x3bfe3e(0x5a5)] = '', _0x5c6c54['pendingPostAttachments'][_0x3bfe3e(0x4e0)] = null, _0x5c6c54[_0x3bfe3e(0x4dc)][_0x3bfe3e(0x388)] = null, _0x5c6c54[_0x3bfe3e(0x4dc)][_0x3bfe3e(0x2f3)] = null, _0x5db365(), _0x47df2d(_0xeb66ca); }), document['getElementById'](_0xbc3280(0x85c))[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0x13603d = _0xbc3280; _0x13603d(0x192) === 'KsuiH' ? (_0x2c33b3(), _0x4331e0(_0x13603d(0x501), 'home')) : document[_0x13603d(0x5d9)](_0x13603d(0x537))[_0x13603d(0x36d)](); }), document[_0xbc3280(0x5d9)](_0xbc3280(0x537))[_0xbc3280(0x73c)](_0xbc3280(0x288), async _0x2e9851 => { const _0x1d5cb4 = _0xbc3280, _0x477629 = _0x2e9851['target'][_0x1d5cb4(0x3ad)][0x0]; if (!_0x477629) return; try { const _0x3c6cb0 = await _0x5e770d(_0x477629, 0x320, 0.8, !![]), _0x543433 = _0x1d5cb4(0x190) + Date[_0x1d5cb4(0x7a5)](); await _0x1c943a(_0x543433, _0x3c6cb0), _0x5c6c54['pendingPostAttachments'][_0x1d5cb4(0x2f3)] = _0x543433, _0x5c6c54['pendingPostAttachments']['image'] = null, _0x5c6c54[_0x1d5cb4(0x4dc)][_0x1d5cb4(0x388)] = null, _0x5db365(); } catch (_0x373a37) { 'WLVzB' === _0x1d5cb4(0x549) ? (_0x84b667(), _0x3c1b79('friendCircleList', _0x1d5cb4(0x402))) : _0x13197e(_0x1d5cb4(0x843) + _0x373a37[_0x1d5cb4(0x1a4)]); } _0x2e9851['target']['value'] = ''; }), document['getElementById'](_0xbc3280(0x639))['addEventListener'](_0xbc3280(0x36d), async () => { const _0x2f78e2 = _0xbc3280, _0x35f3c5 = await _0x2391b8(); if (!_0x35f3c5) return; _0x13197e('正在搜索音乐...'); try { const _0x322aae = await _0x1bd57d(_0x35f3c5[_0x2f78e2(0x2ed)], _0x35f3c5[_0x2f78e2(0x381)]); _0x5c6c54['pendingPostAttachments'][_0x2f78e2(0x388)] = { 'songName': _0x35f3c5[_0x2f78e2(0x2ed)], 'artist': _0x35f3c5[_0x2f78e2(0x381)], 'coverUrl': _0x322aae[_0x2f78e2(0x7d9)], 'playableUrl': _0x322aae['url'] }, _0x5c6c54['pendingPostAttachments']['image'] = null, _0x5db365(); } catch (_0x512fd8) { _0x13197e(_0x2f78e2(0x61c) + _0x512fd8[_0x2f78e2(0x1a4)]); } }); function _0x30a0fb() { const _0x2bb502 = _0xbc3280, _0x9b22bc = new Date(), _0x770135 = document['getElementById'](_0x2bb502(0x5f0)), _0x3bde98 = document[_0x2bb502(0x5d9)](_0x2bb502(0x6bc)); if (_0x770135 && _0x3bde98) { if ('VLdqx' === 'lsnRG') { if (!_0x45494e) return []; const _0x9a5ba5 = _0x3608be['split']('\x0a'), _0x30257f = [], _0x5ca62b = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x330c78 of _0x9a5ba5) { const _0x12d0f3 = _0x330c78[_0x2bb502(0x6a9)](_0x5ca62b); if (_0x12d0f3) { const _0x166ff8 = _0x52f93a(_0x12d0f3[0x1], 0xa), _0x3a13be = _0x1437e2(_0x12d0f3[0x2], 0xa), _0x3f451a = _0x24a636(_0x12d0f3[0x3], 0xa) * (_0x12d0f3[0x3][_0x2bb502(0x794)] === 0x2 ? 0xa : 0x1), _0x28615f = _0x166ff8 * 0x3c + _0x3a13be + _0x3f451a / 0x3e8, _0xb5d8da = _0x330c78[_0x2bb502(0x41f)](_0x5ca62b, '')[_0x2bb502(0x42f)](); _0xb5d8da && _0x30257f[_0x2bb502(0x43f)]({ 'time': _0x28615f, 'text': _0xb5d8da }); } } return _0x30257f; } else { const _0x44232a = String(_0x9b22bc['getHours']())[_0x2bb502(0x3c3)](0x2, '0'), _0xd524f9 = String(_0x9b22bc[_0x2bb502(0x31f)]())[_0x2bb502(0x3c3)](0x2, '0'); _0x770135[_0x2bb502(0x41a)] = _0x44232a + ':' + _0xd524f9; const _0x58b648 = _0x9b22bc[_0x2bb502(0x3e3)]() + 0x1, _0x2efc81 = _0x9b22bc[_0x2bb502(0x425)](), _0x4329b9 = ['星期日', _0x2bb502(0x2dd), '星期二', _0x2bb502(0x75a), _0x2bb502(0x7dc), _0x2bb502(0x265), _0x2bb502(0x208)][_0x9b22bc['getDay']()]; _0x3bde98[_0x2bb502(0x41a)] = _0x58b648 + '月' + _0x2efc81 + '日\x20' + _0x4329b9; } } } function _0x747441(_0x23617e) { const _0x18cdd0 = _0xbc3280; if (_0x18cdd0(0x6b4) === _0x18cdd0(0x6b4)) { if (!_0x23617e) return ''; const _0x2b34c4 = new Date(_0x23617e), _0x4e0a3a = String(_0x2b34c4[_0x18cdd0(0x200)]())['padStart'](0x2, '0'), _0x54ddd2 = String(_0x2b34c4[_0x18cdd0(0x31f)]())[_0x18cdd0(0x3c3)](0x2, '0'); return _0x4e0a3a + ':' + _0x54ddd2; } else { _0x5c2d9b(_0x18cdd0(0x206)); return; } } function _0x480fea() { const _0x2d5b30 = _0xbc3280; if (_0x2d5b30(0x5fa) === _0x2d5b30(0x5fa)) { const _0x5d1060 = _0x5c6c54[_0x2d5b30(0x48c)]['find'](_0xe17371 => _0xe17371['id'] === _0x5c6c54[_0x2d5b30(0x266)]), _0x337e52 = _0x5d1060 ? _0x5d1060[_0x2d5b30(0x834)] : []; if (!_0x337e52 || _0x337e52[_0x2d5b30(0x794)] === 0x0) return ''; const _0x4dedbe = _0x337e52[_0x2d5b30(0x60e)](0x0, 0x5), _0x48e02a = _0x4dedbe[_0x2d5b30(0x2ac)](_0x20cc0f => { const _0x52d84a = _0x2d5b30; if ('KgnLc' !== _0x52d84a(0x184)) { const _0x554839 = _0x5a8ee7(_0x20cc0f[_0x52d84a(0x54c)]) || { 'name': '未知' }; let _0x497a0e = '-\x20[动态]\x20' + _0x554839[_0x52d84a(0x82e)] + '\x20说：“' + (_0x20cc0f['thought'] || _0x20cc0f[_0x52d84a(0x283)]) + '”'; if (_0x20cc0f[_0x52d84a(0x443)] === _0x52d84a(0x388)) { if ('WEJaK' === _0x52d84a(0x2a3)) { const _0x17de6c = _0x4e2698[_0x52d84a(0x52f)](_0x2a2a43, 'readwrite'), _0xcca91 = _0x17de6c[_0x52d84a(0x4ed)](_0x198221), _0x37a555 = _0xcca91['delete'](_0x1bcea2); _0x37a555['onsuccess'] = () => _0x540f3c(), _0x37a555[_0x52d84a(0x618)] = () => _0x29a7e4(_0x37a555[_0x52d84a(0x863)]); } else _0x497a0e += _0x52d84a(0x6d1) + _0x20cc0f[_0x52d84a(0x2ed)] + _0x52d84a(0x541) + _0x20cc0f[_0x52d84a(0x381)] + ')'; } return _0x497a0e; } else { const { omniText: _0x2734a5 } = _0x45fec4(_0x46b752['id'], _0x317ca8['id']), _0x3ba380 = _0x141b6b(_0x339b56['id']), _0x52b2c9 = _0x1ff90b['linkedWorldBookIds'] && _0x1f003f['linkedWorldBookIds'][_0x52d84a(0x794)] > 0x0 ? _0x52d84a(0x856) + _0x4899e4['name'] + '的个人专属世界观设定\x0a' + _0x15716e[_0x52d84a(0x88d)][_0x52d84a(0x2ac)](_0x5ca4f1 => _0x16d238['worldBooks']['find'](_0x4a9fd0 => _0x4a9fd0['id'] === _0x5ca4f1))[_0x52d84a(0x25b)](_0x31769f)[_0x52d84a(0x2ac)](_0x23904c => _0x52d84a(0x2e9) + _0x23904c[_0x52d84a(0x82e)] + '\x0a' + _0x23904c[_0x52d84a(0x283)])[_0x52d84a(0x5d2)]('') : ''; return { 'id': _0xb797d5['id'], 'name': _0x6a7233[_0x52d84a(0x82e)], 'persona': _0x4d0590[_0x52d84a(0x854)] || _0x52d84a(0x48b), 'memory': _0x2734a5 + _0x3ba380 + _0x52b2c9 }; } }); return _0x2d5b30(0x50f) + _0x48e02a[_0x2d5b30(0x5d2)]('\x0a'); } else _0x267d66(), _0x12cc49(_0x2d5b30(0x487), _0x2d5b30(0x1f3)); } function _0x13f7f9(_0x5cdaa3) { const _0x4f956a = _0xbc3280; if ('wCZUf' === _0x4f956a(0x2d9)) { const _0x3e0573 = _0x5c6c54['userProfiles']['find'](_0x32306f => _0x32306f['id'] === _0x5c6c54[_0x4f956a(0x4f0)]) || { 'name': '你' }, _0x1cbfeb = _0x5c6c54[_0x4f956a(0x592)][_0x4f956a(0x659)](_0x4bcbe5 => _0x4bcbe5[_0x4f956a(0x8d9)] === _0x5cdaa3); if (!_0x1cbfeb || !_0x1cbfeb[_0x4f956a(0x806)] || _0x1cbfeb['entries'][_0x4f956a(0x794)] === 0x0) return ''; const _0x449787 = _0x1cbfeb['entries'][_0x4f956a(0x60e)](-0x8), _0x18d6ad = _0x449787[_0x4f956a(0x2ac)](_0x1d3b62 => { const _0x5345a4 = _0x4f956a; if (_0x5345a4(0x7b5) === _0x5345a4(0x62e)) _0x3f0f9d['push'](_0x4088e6); else { const _0x5e0204 = _0x1d3b62[_0x5345a4(0x532)] === _0x5345a4(0x845) ? _0x3e0573[_0x5345a4(0x82e)] : _0x5a8ee7(_0x1d3b62['author'])[_0x5345a4(0x82e)]; return '-\x20[' + new Date(_0x1d3b62[_0x5345a4(0x5c5)])[_0x5345a4(0x4b6)]() + ']\x20' + _0x5e0204 + _0x5345a4(0x1a3) + _0x1d3b62[_0x5345a4(0x283)]; } })[_0x4f956a(0x5d2)]('\x0a'); return _0x4f956a(0x846) + _0x3e0573[_0x4f956a(0x82e)] + _0x4f956a(0x1dc) + _0x18d6ad; } else _0x249101[_0x4f956a(0x82e)] !== _0x4f956a(0x79a) && (_0x563e94[_0x4f956a(0x863)](_0x4f956a(0x73b), _0x3424ab), _0x2959d3({ 'role': 'assistant', 'content': '错误:\x20' + _0x234197[_0x4f956a(0x1a4)] }, _0x733934['conversationHistory'][_0x4f956a(0x794)] - 0x1)); } function _0x193e71() { const _0x49124e = _0xbc3280; if ('QUkBI' === _0x49124e(0x18b)) { const _0x5ab409 = document['getElementById'](_0x49124e(0x82d)), _0x278e79 = _0x5c6c54[_0x49124e(0x778)][_0x49124e(0x271)]; _0x278e79 ? _0x49124e(0x32b) === 'kAZET' ? (_0x34f05c[_0x49124e(0x3fc)][_0x49124e(0x279)] = _0x49124e(0x2b9), _0x18d5c0['style'][_0x49124e(0x88e)] = _0x49124e(0x3aa)) : (_0x5ab409[_0x49124e(0x3fc)]['backgroundImage'] = 'url(' + _0x278e79 + ')', _0x5ab409[_0x49124e(0x3fc)]['backgroundSize'] = _0x49124e(0x7d9), _0x5ab409[_0x49124e(0x3fc)]['backgroundPosition'] = _0x49124e(0x750), _0x5ab409['style'][_0x49124e(0x279)] = _0x49124e(0x8a1), _0x5ab409[_0x49124e(0x81a)](_0x49124e(0x246))[_0x49124e(0x691)](_0x56819c => { const _0x43f8a7 = _0x49124e; _0x43f8a7(0x662) === _0x43f8a7(0x662) ? _0x56819c[_0x43f8a7(0x3fc)][_0x43f8a7(0x88e)] = _0x43f8a7(0x5cd) : (_0xcc63ba[_0x43f8a7(0x82e)] = _0x216ea1, _0xc869c0[_0x43f8a7(0x283)] = _0x2ef927); })) : (_0x5ab409[_0x49124e(0x3fc)][_0x49124e(0x6d5)] = '', _0x5ab409[_0x49124e(0x3fc)]['color'] = '', _0x5ab409[_0x49124e(0x81a)](_0x49124e(0x246))[_0x49124e(0x691)](_0x14f0e5 => { const _0xfa297e = _0x49124e; _0xfa297e(0x7bd) !== _0xfa297e(0x665) ? _0x14f0e5[_0xfa297e(0x3fc)]['textShadow'] = '' : _0x3264fd[_0xfa297e(0x6bd)] = _0x4f0757[_0xfa297e(0x6bd)]; })); } else return; } const _0x3599e4 = document[_0xbc3280(0x5d9)](_0xbc3280(0x6f1)), _0x320287 = document[_0xbc3280(0x5d9)]('app-meeting'); _0x3599e4[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { _0x1767b7(), _0x4ed1c4('friendCircleList', 'home'); }), _0x320287[_0xbc3280(0x73c)]('click', () => { _0xbafe7c(), _0x4ed1c4('meetingList', 'home'); }), document[_0xbc3280(0x5d9)](_0xbc3280(0x334))[_0xbc3280(0x73c)]('click', () => { _0x4ed1c4('home', 'meetingList'); }), document[_0xbc3280(0x5d9)](_0xbc3280(0x39c))[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0x472b2b = _0xbc3280; if (_0x19f531) clearInterval(_0x19f531); _0x19f531 = null, _0x5c6c54[_0x472b2b(0x462)] = [], _0x5c6c54[_0x472b2b(0x251)] = null, _0x5c6c54[_0x472b2b(0x728)] = null, _0xbd25a6(), _0x4ed1c4(_0x472b2b(0x4ab), _0x472b2b(0x453)); }); const _0x2da90d = document['getElementById'](_0xbc3280(0x752)), _0xd6536f = document[_0xbc3280(0x5d9)](_0xbc3280(0x629)); _0xd6536f[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0xc68146 = _0xbc3280; if (_0xc68146(0x2ba) !== _0xc68146(0x19c)) { const _0x2c65e4 = _0x2da90d[_0xc68146(0x5a5)]['trim'](); _0x2c65e4 && (_0x32bf83(_0x2c65e4), _0x2da90d['value'] = '', setTimeout(_0x1271c6, 0x64)); } else _0x37bdc9['removeItem'](_0xc68146(0x22d)), _0x3b6bcf(), _0x3fbfe6(_0xc68146(0x66c)); }); function _0x216cfd(_0x593476, _0x4327f9) { const _0x416e52 = _0xbc3280, _0xa955e6 = document[_0x416e52(0x5d9)](_0x416e52(0x6a5)), _0x5a3161 = document[_0x416e52(0x81a)](_0x416e52(0x1b4)); _0x5a3161['forEach'](_0x3caff6 => { const _0x483e44 = _0x416e52; if (_0x3caff6 !== _0x593476[_0x483e44(0x85e)](_0x483e44(0x1b4))) { if ('zfkEJ' !== _0x483e44(0x1c1)) { _0x383cb3(_0x483e44(0x367)); return; } else _0x3caff6['textContent'] = '▶'; } }), _0xa955e6[_0x416e52(0x161)] === _0x4327f9['url'] && !_0xa955e6['paused'] ? 'GDVuF' !== _0x416e52(0x56e) ? (_0xa955e6[_0x416e52(0x2cd)](), _0x593476['querySelector'](_0x416e52(0x1b4))[_0x416e52(0x41a)] = '▶') : _0xf58b35 = _0x5f46ab[_0x416e52(0x65a)](..._0xc4d7e5[_0x416e52(0x834)][_0x416e52(0x2ac)](_0x1c0ba8 => _0x1c0ba8[_0x416e52(0x5c5)])) : (_0xa955e6['src'] = _0x4327f9[_0x416e52(0x5e3)], _0xa955e6['play'](), _0x593476[_0x416e52(0x85e)]('.music-post-play-icon,\x20.music-share-play-icon')[_0x416e52(0x41a)] = '❚❚'); } const _0x368418 = document[_0xbc3280(0x5d9)](_0xbc3280(0x2d8)); async function _0x586e3f(_0x576a99) { if (!_0x576a99 || !_0x576a99['startsWith']('http')) return ![]; return new Promise(_0x549966 => { const _0x29b65d = _0x32ba, _0x5d5e68 = document[_0x29b65d(0x628)](_0x29b65d(0x5ee)); _0x5d5e68[_0x29b65d(0x161)] = _0x576a99; const _0x4697ed = setTimeout(() => { _0x79b73c(), _0x549966(![]); }, 0xbb8), _0x79b73c = () => { const _0x303fef = _0x29b65d; clearTimeout(_0x4697ed), _0x5d5e68['removeEventListener'](_0x303fef(0x7db), _0x4c515d), _0x5d5e68[_0x303fef(0x2d3)](_0x303fef(0x863), _0x40056f), _0x5d5e68[_0x303fef(0x161)] = '', _0x5d5e68['remove'](); }, _0x4c515d = () => { const _0x5e3b3b = _0x29b65d; if (_0x5e3b3b(0x743) !== _0x5e3b3b(0x5ad)) _0x79b73c(), _0x549966(!![]); else { if (_0x2f7b5a) _0xb33495(_0xcffa42); } }, _0x40056f = () => { _0x79b73c(), _0x549966(![]); }; _0x5d5e68[_0x29b65d(0x73c)](_0x29b65d(0x7db), _0x4c515d), _0x5d5e68[_0x29b65d(0x73c)]('error', _0x40056f); }); } async function _0x1bd57d(_0x5eb8bf, _0x5c32b2) { const _0x1fa368 = _0xbc3280; if (_0x1fa368(0x784) !== _0x1fa368(0x784)) _0x1aedcf('错误:\x20' + _0x185f10[_0x1fa368(0x1a4)]); else { const _0xefa9b9 = [_0x1fa368(0x448), 'tencent']; for (const _0x46bdc3 of _0xefa9b9) { try { const _0x4bbf28 = _0x1fa368(0x744) + _0x46bdc3 + '?word=' + encodeURIComponent(_0x5eb8bf) + '-' + encodeURIComponent(_0x5c32b2), _0x189f89 = await fetch(_0x4bbf28), _0x1a0cc9 = await _0x189f89[_0x1fa368(0x21c)](); if (_0x1a0cc9[_0x1fa368(0x7f3)] !== 0xc8 || !_0x1a0cc9['data'] || _0x1a0cc9['data']['length'] === 0x0) continue; const _0xca3984 = _0x1a0cc9[_0x1fa368(0x1b6)]['slice'](0x0, 0x5); for (const _0x1a8e4c of _0xca3984) { const _0x10dbc9 = 'https://api.vkeys.cn/v2/music/' + _0x46bdc3 + _0x1fa368(0x3a0) + _0x1a8e4c['id'], _0x19f329 = await fetch(_0x10dbc9), _0x586f76 = await _0x19f329[_0x1fa368(0x21c)](), _0x4650bc = _0x586f76[_0x1fa368(0x1b6)]?.[_0x1fa368(0x5e3)]; if (await _0x586e3f(_0x4650bc)) { if ('xJuUa' !== _0x1fa368(0x3c2)) return { 'url': _0x4650bc, 'cover': _0x1a8e4c[_0x1fa368(0x7d9)], 'source': _0x46bdc3 }; else _0x43c04f['getElementById'](_0x1fa368(0x8ae))[_0x1fa368(0x5a5)] = '', _0x5a4ed5['getElementById'](_0x1fa368(0x733))[_0x1fa368(0x41a)] = '新建条目', _0xf810f0[_0x1fa368(0x5d9)]('world-book-edit-name')['value'] = '', _0x473108[_0x1fa368(0x5d9)]('world-book-edit-content')[_0x1fa368(0x5a5)] = ''; } } } catch (_0x171643) { 'YlNAf' !== _0x1fa368(0x22f) ? (_0x38d8ac[_0x1fa368(0x863)](_0x1fa368(0x239), _0x1fd3c8), _0x27b1a1 = _0x4a7f99) : console['error'](_0x1fa368(0x7d8) + _0x46bdc3 + ':', _0x171643); } } return { 'url': null, 'cover': null, 'source': null }; } } function _0x9ecc96(_0x336319) { const _0x180a95 = _0xbc3280; if (_0x180a95(0x14b) !== _0x180a95(0x268)) try { const _0xedade4 = JSON[_0x180a95(0x5b7)](localStorage[_0x180a95(0x24e)](_0x180a95(0x352)) || '{}'), _0x25d009 = { ..._0xedade4, ..._0x336319 }; localStorage['setItem']('badgeState', JSON[_0x180a95(0x79c)](_0x25d009)); } catch (_0x5a62ca) { if (_0x180a95(0x320) !== 'CiBvG') { const _0x1ce2df = _0x3a2136[_0x180a95(0x5d9)]('clock-color-toggle'); if (!_0x1ce2df) return; _0x1ce2df[_0x180a95(0x27f)] = _0x54a712[_0x180a95(0x778)][_0x180a95(0x8d0)] || ![], _0x1ce2df[_0x180a95(0x73c)](_0x180a95(0x288), () => { const _0x4c963a = _0x180a95; _0x18a035[_0x4c963a(0x778)][_0x4c963a(0x8d0)] = _0x1ce2df[_0x4c963a(0x27f)], _0x2600be(), _0x171d3b(); }); } else console[_0x180a95(0x863)](_0x180a95(0x78c), _0x5a62ca); } else { let _0x57bf34 = _0x3f5362[_0x180a95(0x5d9)](_0x180a95(0x69a) + _0x505051['id']); !_0x57bf34 && (_0x57bf34 = _0x127bad['createElement'](_0x180a95(0x3fc)), _0x57bf34['id'] = _0x180a95(0x69a) + _0x4de841['id'], _0x60c23['head']['appendChild'](_0x57bf34)); const _0x44479a = _0x295fd0[_0x180a95(0x4fd)], _0x41cbee = _0x44479a[_0x180a95(0x41f)](/\.bubble\.sent/g, _0x180a95(0x6eb) + _0x2ec26b['id'] + _0x180a95(0x6ee))[_0x180a95(0x41f)](/\.bubble\.received/g, '.bubble-' + _0x21e65b['id'] + _0x180a95(0x60a)); _0x57bf34[_0x180a95(0x497)] = _0x41cbee; } } async function _0x264c49() { const _0x42288f = _0xbc3280, _0x3e6894 = document[_0x42288f(0x5d9)]('decorative-badge'), _0x2d90eb = document[_0x42288f(0x5d9)](_0x42288f(0x4e4)); try { let _0x1dafa2 = await _0x2eb454(_0x42288f(0x5e5)); if (!_0x1dafa2) { if (_0x42288f(0x188) === _0x42288f(0x4a3)) { if (_0x361488) _0x4ff8c2(_0x43020a); _0x3ecc1b = null, _0x5daeab['activeMeetingScriptQueue'] = [], _0x199769[_0x42288f(0x251)] = null, _0x571c65[_0x42288f(0x728)] = null, _0x2d6e78(), _0x4a284a(_0x42288f(0x4ab), _0x42288f(0x453)); } else { const _0x59dc07 = JSON['parse'](localStorage['getItem']('badgeState') || '{}'); _0x59dc07['image'] && (console[_0x42288f(0x384)](_0x42288f(0x642)), _0x1dafa2 = await _0x4ee7e6(_0x59dc07[_0x42288f(0x4e0)]), await _0x1c943a('widget_badge', _0x1dafa2)); } } _0x1dafa2 ? (_0x2d90eb['src'] = URL[_0x42288f(0x78a)](_0x1dafa2), _0x3e6894[_0x42288f(0x3fc)]['display'] = _0x42288f(0x38f)) : _0x3e6894['style']['display'] = _0x42288f(0x38f); } catch (_0x40b5fa) { _0x42288f(0x40e) === _0x42288f(0x40e) ? console[_0x42288f(0x863)](_0x42288f(0x14a), _0x40b5fa) : _0x3f84d6[_0x42288f(0x728)] = _0x2e6092[_0x42288f(0x1ce)][0x0]?.['id'] || null; } } function _0x1851e8(_0x457dd8) { const _0x463525 = _0xbc3280; try { const _0x316777 = JSON[_0x463525(0x5b7)](localStorage['getItem']('cardWidgetState') || '{}'), _0x4d185f = { ..._0x316777, ..._0x457dd8 }; localStorage[_0x463525(0x3cd)](_0x463525(0x5f7), JSON[_0x463525(0x79c)](_0x4d185f)); } catch (_0x4ac68d) { if (_0x463525(0x16a) === _0x463525(0x16a)) console[_0x463525(0x863)](_0x463525(0x3dc), _0x4ac68d); else { if (_0x1a7794 < 0x0 || _0x49928b >= _0xb4476d[_0x463525(0x794)]) return; _0x3ad7c9 = _0x5280b3; const _0x4481ee = _0x5d7dff[_0x40efbe]; _0xc49544[_0x463525(0x161)] = _0x4481ee[_0x463525(0x62d)] || _0x4481ee[_0x463525(0x5e3)], _0x1d0de4['play'](), _0x351575(), _0x4b5e11(); } } } async function _0x3eb75e() { const _0xf0c47c = _0xbc3280; if ('NcjFd' !== _0xf0c47c(0x5ec)) { _0x46120d[_0xf0c47c(0x497)] = _0xf0c47c(0x2cb); return; } else { const _0x41e3e1 = document[_0xf0c47c(0x5d9)](_0xf0c47c(0x786)), _0x751bcf = document[_0xf0c47c(0x5d9)]('card-image'); try { let _0x489148 = await _0x2eb454(_0xf0c47c(0x1ca)); if (!_0x489148) { if (_0xf0c47c(0x5b8) === _0xf0c47c(0x5b8)) { const _0x4e3732 = JSON['parse'](localStorage[_0xf0c47c(0x24e)](_0xf0c47c(0x5f7)) || '{}'); if (_0x4e3732['image']) { if (_0xf0c47c(0x554) !== _0xf0c47c(0x79e)) console['log']('正在搬运旧卡片...'), _0x489148 = await _0x4ee7e6(_0x4e3732[_0xf0c47c(0x4e0)]), await _0x1c943a(_0xf0c47c(0x1ca), _0x489148); else { const _0x1fe0c4 = _0x504a04(_0x3cd5b0['activeChatId']); _0x11cf8e = _0x1fe0c4[_0xf0c47c(0x41e)] || _0x43947c; } } } else { const _0x5b5316 = _0x26385b[_0xf0c47c(0x5d9)]('toast'); _0x5b5316[_0xf0c47c(0x41a)] = _0x233da9, _0x5b5316[_0xf0c47c(0x3fc)]['display'] = _0xf0c47c(0x38f); if (_0x179e20['_t']) _0xabf96a(_0x346079['_t']); _0x2c4411['_t'] = _0x4d34e8(() => { const _0xa30239 = _0xf0c47c; _0x5b5316[_0xa30239(0x3fc)][_0xa30239(0x74d)] = _0xa30239(0x860); }, 0x640); } } _0x489148 ? (_0x751bcf['src'] = URL[_0xf0c47c(0x78a)](_0x489148), _0x41e3e1[_0xf0c47c(0x3fc)]['display'] = _0xf0c47c(0x38f)) : _0xf0c47c(0x2e2) !== _0xf0c47c(0x526) ? _0x41e3e1[_0xf0c47c(0x3fc)][_0xf0c47c(0x74d)] = 'block' : (_0x37ccf5 = _0x33ba62[_0xf0c47c(0x82e)], _0x149bf2 = _0x197545[_0xf0c47c(0x41e)]); } catch (_0x54e5c7) { if (_0xf0c47c(0x3a6) !== 'GgXge') { const _0x3ee890 = _0x456574(_0x343883[_0xf0c47c(0x17f)]['historyIndex'], 0xa); !_0x3763e6(_0x3ee890) && _0x2a102b(_0x3ee890); } else console[_0xf0c47c(0x863)]('加载卡片图片失败', _0x54e5c7); } } } _0x2a27e1['addEventListener'](_0xbc3280(0x36d), () => { const _0x44afca = _0xbc3280; _0xd5c28a(), _0x4ed1c4(_0x44afca(0x501), 'home'); }), document[_0xbc3280(0x5d9)](_0xbc3280(0x23f))[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => _0x4ed1c4(_0xbc3280(0x402), 'userProfileList')), document[_0xbc3280(0x5d9)](_0xbc3280(0x8c6))[_0xbc3280(0x73c)]('click', () => _0x3fec4f()), document[_0xbc3280(0x5d9)](_0xbc3280(0x2af))[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0x5908a8 = _0xbc3280; _0xd5c28a(), _0x4ed1c4(_0x5908a8(0x501), _0x5908a8(0x484)); }), document[_0xbc3280(0x5d9)](_0xbc3280(0x520))[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x5e77c0), document['getElementById'](_0xbc3280(0x713))['addEventListener']('click', _0x4ea9ae), document[_0xbc3280(0x5d9)](_0xbc3280(0x64a))['addEventListener'](_0xbc3280(0x36d), () => { const _0x101ffd = _0xbc3280, _0x2cbc40 = document[_0x101ffd(0x5d9)](_0x101ffd(0x717))['value']; _0x2cbc40 && (_0x5c6c54[_0x101ffd(0x4f0)] = _0x2cbc40, _0xbd25a6(), _0x13197e(_0x101ffd(0x755)), _0xd5c28a(), document[_0x101ffd(0x5d9)](_0x101ffd(0x64a))[_0x101ffd(0x3fc)][_0x101ffd(0x74d)] = 'none'); }); function _0x4771d7(_0x7ebfdd) { const _0x4fb8d9 = _0xbc3280, _0x392e05 = _0x5c6c54[_0x4fb8d9(0x1ce)][_0x4fb8d9(0x659)](_0x32a3c7 => _0x32a3c7['id'] === _0x7ebfdd), _0x53bcea = _0x392e05?.[_0x4fb8d9(0x41c)]; let _0x33293b = _0x5c6c54[_0x4fb8d9(0x160)]['find'](_0x49002d => _0x49002d['id'] === _0x53bcea); return !_0x33293b && (_0x33293b = _0x5c6c54[_0x4fb8d9(0x160)]['find'](_0x254ddd => _0x254ddd['id'] === _0x5c6c54[_0x4fb8d9(0x4f0)]) || _0x5c6c54[_0x4fb8d9(0x160)][0x0]), _0x33293b || { 'name': '用户', 'avatar': _0x4e315e, 'persona': '' }; } function _0xbb5832(_0x311161) { const _0x5c8ba5 = _0xbc3280, _0x49dd90 = document[_0x5c8ba5(0x5d9)](_0x311161); _0x49dd90['innerHTML'] = '', _0x5c6c54[_0x5c8ba5(0x160)][_0x5c8ba5(0x691)](_0x471710 => { const _0x2d98cc = _0x5c8ba5; if (_0x2d98cc(0x76b) === _0x2d98cc(0x76b)) { const _0x1bfde7 = document[_0x2d98cc(0x628)](_0x2d98cc(0x5ca)); _0x1bfde7[_0x2d98cc(0x5a5)] = _0x471710['id'], _0x1bfde7[_0x2d98cc(0x41a)] = _0x471710['name'], _0x49dd90[_0x2d98cc(0x2c8)](_0x1bfde7); } else _0x43fb68 = _0x48d3bb['image']; }); } function _0x5a9b3c(_0x34e3f3) { const _0x1e6f39 = _0xbc3280, _0x36e93a = _0x5a8ee7(_0x34e3f3), _0x1733ec = document[_0x1e6f39(0x5d9)](_0x1e6f39(0x540)); _0x1733ec[_0x1e6f39(0x3fc)][_0x1e6f39(0x6d5)] = ''; let _0x270ebf = document[_0x1e6f39(0x5d9)](_0x1e6f39(0x69a) + _0x34e3f3); if (_0x270ebf) _0x270ebf['innerHTML'] = ''; if (!_0x36e93a) return; _0x36e93a[_0x1e6f39(0x61a)] && (_0x1e6f39(0x87a) === _0x1e6f39(0x87a) ? (_0x1733ec[_0x1e6f39(0x3fc)]['backgroundImage'] = _0x1e6f39(0x6c9) + _0x36e93a['chatWallpaper'] + '\x27)', _0x1733ec[_0x1e6f39(0x3fc)][_0x1e6f39(0x66d)] = _0x1e6f39(0x7d9), _0x1733ec[_0x1e6f39(0x3fc)][_0x1e6f39(0x186)] = _0x1e6f39(0x750)) : (_0x5cb0b5(_0x18df32['id']), _0x10c93b(!![]))); if (_0x36e93a[_0x1e6f39(0x4fd)]) { let _0x578fc2 = document[_0x1e6f39(0x5d9)](_0x1e6f39(0x69a) + _0x36e93a['id']); !_0x578fc2 && (_0x578fc2 = document['createElement'](_0x1e6f39(0x3fc)), _0x578fc2['id'] = _0x1e6f39(0x69a) + _0x36e93a['id'], document[_0x1e6f39(0x5e4)][_0x1e6f39(0x2c8)](_0x578fc2)); const _0x241702 = _0x36e93a[_0x1e6f39(0x4fd)], _0x11ea3b = _0x241702[_0x1e6f39(0x41f)](/\.bubble\.sent/g, _0x1e6f39(0x6eb) + _0x36e93a['id'] + _0x1e6f39(0x6ee))[_0x1e6f39(0x41f)](/\.bubble\.received/g, _0x1e6f39(0x6eb) + _0x36e93a['id'] + '.message.ai'); _0x578fc2[_0x1e6f39(0x497)] = _0x11ea3b; } } function _0x5db365() { const _0x2bdee4 = _0xbc3280; if (_0x2bdee4(0x14c) !== _0x2bdee4(0x14c)) _0x1e2817[_0x2bdee4(0x5d9)](_0x2bdee4(0x556))['textContent'] = _0x2bdee4(0x382); else { const _0x1141ab = document['getElementById'](_0x2bdee4(0x2ab)); _0x1141ab[_0x2bdee4(0x497)] = ''; const _0x376baf = _0x34bb9 => { const _0x412c3b = _0x2bdee4; _0x5c6c54[_0x412c3b(0x4dc)][_0x34bb9] = null; if (_0x34bb9 === _0x412c3b(0x4e0)) _0x5c6c54[_0x412c3b(0x4dc)][_0x412c3b(0x2f3)] = null; _0x5db365(); }, _0x1ae3d0 = _0x5c6c54[_0x2bdee4(0x4dc)][_0x2bdee4(0x2f3)], _0x10569f = _0x5c6c54[_0x2bdee4(0x4dc)][_0x2bdee4(0x388)]; if (_0x1ae3d0) { if ('gShCo' === _0x2bdee4(0x65d)) { const _0x561e95 = document['createElement'](_0x2bdee4(0x172)); _0x561e95['className'] = _0x2bdee4(0x17c), _0x561e95['innerHTML'] = _0x2bdee4(0x240), _0x561e95[_0x2bdee4(0x85e)](_0x2bdee4(0x458))[_0x2bdee4(0x878)] = () => _0x376baf('image'), _0x1141ab[_0x2bdee4(0x2c8)](_0x561e95), _0x2eb454(_0x1ae3d0)[_0x2bdee4(0x2b1)](_0x934840 => { const _0x2ac31b = _0x2bdee4, _0x2d5850 = document[_0x2ac31b(0x5d9)](_0x2ac31b(0x5c2)); _0x2d5850 && _0x934840 && (_0x2d5850[_0x2ac31b(0x161)] = URL['createObjectURL'](_0x934840)); }); } else _0x1ae4cf[_0x2bdee4(0x5a3)] = { 'response_mime_type': 'application/json' }; } if (_0x10569f) { if (_0x2bdee4(0x6ec) === _0x2bdee4(0x6ec)) { const _0x3f5703 = document[_0x2bdee4(0x628)](_0x2bdee4(0x172)); _0x3f5703[_0x2bdee4(0x63a)] = _0x2bdee4(0x17c), _0x3f5703['innerHTML'] = _0x2bdee4(0x4df) + (_0x10569f[_0x2bdee4(0x621)] || _0x166d38) + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>' + _0x10569f[_0x2bdee4(0x2ed)] + _0x2bdee4(0x1a2) + _0x10569f[_0x2bdee4(0x381)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x3f5703[_0x2bdee4(0x85e)](_0x2bdee4(0x458))[_0x2bdee4(0x878)] = () => _0x376baf('music'), _0x1141ab[_0x2bdee4(0x2c8)](_0x3f5703); } else _0x580543[_0x2bdee4(0x3d1)](_0x5e25fe); } } } async function _0x47df2d(_0x382cb9) { const _0x2b8299 = _0xbc3280, _0x4543b0 = _0x5c6c54[_0x2b8299(0x48c)][_0x2b8299(0x659)](_0x3f5815 => _0x3f5815['id'] === _0x5c6c54['activeFriendCircleId']); if (!_0x4543b0) return; _0x3168b5(!![], '大家正在赶来回复...'), _0x5c6c54[_0x2b8299(0x75c)] = !![]; try { const _0x51d85a = _0x4543b0[_0x2b8299(0x6b1)][_0x2b8299(0x2ac)](_0x3590d1 => _0x5a8ee7(_0x3590d1))[_0x2b8299(0x25b)](Boolean), _0x465344 = _0x480fea(), _0x44dbb2 = _0x51d85a['map'](_0x40f3e8 => { const _0x479c3b = _0x2b8299, { omniText: _0x51f661 } = _0x5c86b3(_0x40f3e8['id'], null), _0x75b064 = _0x13f7f9(_0x40f3e8['id']), _0x458ca1 = _0x40f3e8[_0x479c3b(0x88d)] && _0x40f3e8[_0x479c3b(0x88d)][_0x479c3b(0x794)] > 0x0 ? '\x0a\x0a#\x20' + _0x40f3e8[_0x479c3b(0x82e)] + '的个人专属世界观设定\x0a' + _0x40f3e8['linkedWorldBookIds'][_0x479c3b(0x2ac)](_0x17703a => _0x5c6c54[_0x479c3b(0x6bd)][_0x479c3b(0x659)](_0x133a13 => _0x133a13['id'] === _0x17703a))[_0x479c3b(0x25b)](Boolean)[_0x479c3b(0x2ac)](_0x510c9d => _0x479c3b(0x2e9) + _0x510c9d[_0x479c3b(0x82e)] + '\x0a' + _0x510c9d['content'])[_0x479c3b(0x5d2)]('') : ''; return _0x479c3b(0x167) + _0x40f3e8[_0x479c3b(0x82e)] + ',\x20ID:\x20' + _0x40f3e8['id'] + '\x0a\x20\x20人设:\x20' + _0x40f3e8[_0x479c3b(0x854)] + '\x0a\x20\x20相关记忆:\x0a' + _0x51f661 + '\x0a' + _0x75b064 + '\x0a' + _0x458ca1; })['join']('\x0a\x0a'), _0x565d4f = _0x5de4aa(_0x382cb9[_0x2b8299(0x54c)]) || { 'name': '用户' }, _0x216897 = _0x565d4f['persona'] ? '\x0a#\x20发布动态的用户信息\x0a-\x20姓名:\x20' + _0x565d4f[_0x2b8299(0x82e)] + '\x0a-\x20人设:\x20' + _0x565d4f[_0x2b8299(0x854)] + '\x0a' : ''; let _0x410774 = null; if (_0x382cb9[_0x2b8299(0x4e0)]) _0x410774 = _0x382cb9[_0x2b8299(0x4e0)]; else { if (_0x382cb9[_0x2b8299(0x2f3)]) try { if ('IgVSa' === _0x2b8299(0x236)) _0x4cfd73(_0x3f98c1[_0x2b8299(0x5a5)]), _0x5afe53(); else { const _0x5d13e6 = await _0x2eb454(_0x382cb9[_0x2b8299(0x2f3)]); _0x5d13e6 && (_0x410774 = await _0x51083d(_0x5d13e6)); } } catch (_0x49c6cf) { if (_0x2b8299(0x513) === _0x2b8299(0x513)) console[_0x2b8299(0x863)](_0x2b8299(0x291), _0x49c6cf); else { if (_0x5a0565[_0x2b8299(0x5a8)] === _0x2b8299(0x845)) return _0x548f3f[_0x2b8299(0x484)]?.[_0x2b8299(0x82e)] || 'User'; if (_0x3d7e8c['senderId']) { const _0xf16a4c = _0x5e5a2d(_0x1240ed['senderId']); return _0xf16a4c?.[_0x2b8299(0x82e)] || _0x2b8299(0x3a7); } if (_0xf3368?.[_0x2b8299(0x443)] === _0x2b8299(0x77d)) { const _0x2e209c = _0x5ec037(_0x23642b['participantIds'][0x0]); return _0x2e209c?.[_0x2b8299(0x82e)] || 'AI'; } return _0x2b8299(0x180); } } } let _0xf6c665 = _0x565d4f['name'] + _0x2b8299(0x4a6) + _0x382cb9['content'] + '”'; if (_0x410774) { if (_0x2b8299(0x837) !== _0x2b8299(0x837)) { const _0x34f7d5 = _0x5c645e(_0x1a7b73[_0x2b8299(0x594)][0x0]); return _0x34f7d5?.[_0x2b8299(0x82e)] || 'AI'; } else _0xf6c665 += _0x2b8299(0x16b); } _0x382cb9[_0x2b8299(0x443)] === _0x2b8299(0x388) && ('Fpyty' !== _0x2b8299(0x577) ? (_0x1abff1(_0x2b8299(0x72c)), _0x1657e7(() => { _0x1b93b2('chat', 'home'), _0x1a094b(() => _0x24f6dd(), 0x64); }, 0x6a4)) : _0xf6c665 += _0x2b8299(0x5dc) + _0x382cb9[_0x2b8299(0x2ed)] + '\x20-\x20' + _0x382cb9[_0x2b8299(0x381)] + ']'); const _0x3a0060 = _0x2b8299(0x8b7) + _0x44dbb2 + '\x0a\x0a' + _0x216897 + _0x2b8299(0x2c2) + _0x465344 + _0x2b8299(0x6a6) + _0xf6c665 + _0x2b8299(0x250), _0x50f33e = [{ 'role': 'system', 'content': _0x3a0060 }], _0x73645c = { 'role': _0x2b8299(0x845), 'content': _0x2b8299(0x707) }; _0x410774 && (_0x73645c[_0x2b8299(0x4e0)] = _0x410774); _0x50f33e[_0x2b8299(0x43f)](_0x73645c); const _0xca3954 = await _0x5cca68(_0x50f33e, { 'json': !![] }), _0x402621 = _0xca3954['match'](/({[\s\S]*})/); if (!_0x402621) throw new Error(_0x2b8299(0x55a)); const _0x3a74cd = JSON[_0x2b8299(0x5b7)](_0x402621[0x1]), _0x102eee = _0x4543b0['posts'][_0x2b8299(0x659)](_0x11bb5e => _0x11bb5e['id'] === _0x382cb9['id']); _0x102eee && (_0x102eee[_0x2b8299(0x725)] = _0x3a74cd[_0x2b8299(0x725)] || [], _0x102eee[_0x2b8299(0x286)] = (_0x3a74cd['comments'] || [])[_0x2b8299(0x2ac)]((_0x345251, _0x275308) => ({ ..._0x345251, 'commentId': 'c_' + _0x382cb9['timestamp'] + '_' + _0x275308 })), _0xbd25a6(), _0x1f440d()); } catch (_0x3eefc2) { console[_0x2b8299(0x863)](_0x2b8299(0x77f), _0x3eefc2), _0x13197e('大家好像不知道该怎么回复...'); } finally { _0x3168b5(![]), _0x5c6c54[_0x2b8299(0x75c)] = ![]; } } function _0x5a3ebb() { const _0x2d6f35 = _0xbc3280, _0x5aef2c = _0x5c6c54['friendCircles'][_0x2d6f35(0x659)](_0x46fe66 => _0x46fe66['id'] === _0x5c6c54['activeFriendCircleId']), _0x4e1e24 = _0x5aef2c?.[_0x2d6f35(0x41c)]; let _0x4c7826 = _0x5c6c54[_0x2d6f35(0x160)][_0x2d6f35(0x659)](_0x16cbf7 => _0x16cbf7['id'] === _0x4e1e24); !_0x4c7826 && (_0x4c7826 = _0x5c6c54[_0x2d6f35(0x160)][_0x2d6f35(0x659)](_0x369b72 => _0x369b72['id'] === _0x5c6c54[_0x2d6f35(0x4f0)])); !_0x4c7826 && (_0x4c7826 = _0x5c6c54[_0x2d6f35(0x160)][0x0]); if (_0x4c7826) { if (_0x2d6f35(0x44d) === _0x2d6f35(0x3f8)) { const _0xbe16b3 = [_0x2d6f35(0x4e5), _0x2d6f35(0x2dd), _0x2d6f35(0x3ef), _0x2d6f35(0x75a), '星期四', _0x2d6f35(0x265), _0x2d6f35(0x208)]; return _0xbe16b3[_0x4ab79c[_0x2d6f35(0x838)]()] + '\x20' + _0x5b6c34; } else document[_0x2d6f35(0x5d9)](_0x2d6f35(0x816))[_0x2d6f35(0x161)] = _0x4c7826[_0x2d6f35(0x41e)] || _0x4e315e; } } function _0x5ca1ad(_0x53a4cb) { const _0x58750a = _0xbc3280; if ('uNmYd' !== _0x58750a(0x401)) _0x35def5 = _0x44e03a['getItem'](_0x58750a(0x21e)); else { let _0x2d4e57 = 0x0, _0x5cd202 = 0x0, _0x466631 = 0x0; if (_0x53a4cb[_0x58750a(0x794)] == 0x4) _0x58750a(0x1cb) === _0x58750a(0x1cb) ? (_0x2d4e57 = '0x' + _0x53a4cb[0x1] + _0x53a4cb[0x1], _0x5cd202 = '0x' + _0x53a4cb[0x2] + _0x53a4cb[0x2], _0x466631 = '0x' + _0x53a4cb[0x3] + _0x53a4cb[0x3]) : _0x2d0466[_0x58750a(0x3fc)]['display'] = _0x58750a(0x8d7); else _0x53a4cb[_0x58750a(0x794)] == 0x7 && (_0x58750a(0x75b) !== _0x58750a(0x684) ? (_0x2d4e57 = '0x' + _0x53a4cb[0x1] + _0x53a4cb[0x2], _0x5cd202 = '0x' + _0x53a4cb[0x3] + _0x53a4cb[0x4], _0x466631 = '0x' + _0x53a4cb[0x5] + _0x53a4cb[0x6]) : (_0x323669['error'](_0x58750a(0x77f), _0x340521), _0x223c22('大家好像不知道该怎么回复...'))); _0x2d4e57 /= 0xff, _0x5cd202 /= 0xff, _0x466631 /= 0xff; let _0x38a21a = Math[_0x58750a(0x3ac)](_0x2d4e57, _0x5cd202, _0x466631), _0x39462a = Math['max'](_0x2d4e57, _0x5cd202, _0x466631), _0x497834 = _0x39462a - _0x38a21a, _0x295056 = 0x0, _0x4a0e6 = 0x0, _0x23bc17 = 0x0; if (_0x497834 == 0x0) _0x295056 = 0x0; else { if (_0x39462a == _0x2d4e57) _0x295056 = (_0x5cd202 - _0x466631) / _0x497834 % 0x6; else { if (_0x39462a == _0x5cd202) _0x295056 = (_0x466631 - _0x2d4e57) / _0x497834 + 0x2; else _0x295056 = (_0x2d4e57 - _0x5cd202) / _0x497834 + 0x4; } } _0x295056 = Math[_0x58750a(0x2be)](_0x295056 * 0x3c); if (_0x295056 < 0x0) _0x295056 += 0x168; return _0x23bc17 = (_0x39462a + _0x38a21a) / 0x2, _0x4a0e6 = _0x497834 == 0x0 ? 0x0 : _0x497834 / (0x1 - Math[_0x58750a(0x55c)](0x2 * _0x23bc17 - 0x1)), _0x4a0e6 = +(_0x4a0e6 * 0x64)[_0x58750a(0x873)](0x1), _0x23bc17 = +(_0x23bc17 * 0x64)[_0x58750a(0x873)](0x1), { 'h': _0x295056, 's': _0x4a0e6, 'l': _0x23bc17 }; } } function _0x5b21c3() { const _0x2d4b7f = _0xbc3280, _0x2c6677 = (_0x5d5337, _0x451c1c, _0x4cf925) => { const _0x281e49 = _0x32ba, _0x4b04ee = document[_0x281e49(0x5d9)](_0x5d5337); if (!_0x4b04ee) return; let _0x41a296 = null; try { _0x281e49(0x262) === _0x281e49(0x262) ? _0x41a296 = JSON[_0x281e49(0x5b7)](localStorage[_0x281e49(0x24e)](_0x451c1c) || '{}') : _0x3b5330[_0x281e49(0x73a)] = { ..._0x44041b[_0x281e49(0x73a)], ..._0x3a5d7e[_0x281e49(0x73a)] }; } catch { _0x41a296 = {}; } _0x4b04ee[_0x281e49(0x3fc)][_0x281e49(0x318)] = _0x281e49(0x7cb), _0x4b04ee[_0x281e49(0x3fc)][_0x281e49(0x14e)] = '', _0x4b04ee[_0x281e49(0x3fc)][_0x281e49(0x6be)] = '', _0x4b04ee['style'][_0x281e49(0x5ff)] = '', _0x4b04ee[_0x281e49(0x3fc)]['bottom'] = '', _0x4b04ee[_0x281e49(0x3fc)][_0x281e49(0x81f)] = ''; if (typeof _0x41a296[_0x281e49(0x14e)] === _0x281e49(0x3e5) && typeof _0x41a296['left'] === _0x281e49(0x3e5)) _0x281e49(0x727) !== _0x281e49(0x721) ? (_0x4b04ee[_0x281e49(0x3fc)]['top'] = _0x41a296['top'] + '%', _0x4b04ee[_0x281e49(0x3fc)][_0x281e49(0x6be)] = _0x41a296['left'] + '%') : _0x1b6b94[_0x281e49(0x7a1)]['remove'](_0x281e49(0x274)); else { if ('JzKoa' === _0x281e49(0x417)) for (const _0x373136 in _0x4cf925) { _0x281e49(0x59d) === _0x281e49(0x59d) ? _0x4b04ee['style'][_0x373136] = _0x4cf925[_0x373136] : (_0xa83e9d[_0x281e49(0x43f)](_0x373dd9[_0x51a816]['trim']()), _0x2e596e++); } else return _0x4ac6a9[_0x281e49(0x160)][_0x281e49(0x659)](_0x5f2187 => _0x5f2187['id'] === _0x459dc3[_0x281e49(0x4f0)]) || _0x260ed1['userProfiles'][0x0]; } }; _0x2c6677('home-clock-container', _0x2d4b7f(0x762), { 'top': '5%', 'left': _0x2d4b7f(0x45e), 'transform': _0x2d4b7f(0x4d2) }), _0x2c6677(_0x2d4b7f(0x22e), _0x2d4b7f(0x221), { 'top': '38%', 'right': '4%' }), _0x2c6677(_0x2d4b7f(0x820), _0x2d4b7f(0x1dd), { 'top': _0x2d4b7f(0x468), 'right': _0x2d4b7f(0x32f) }), _0x2c6677('app-settings', _0x2d4b7f(0x777), { 'top': _0x2d4b7f(0x32f), 'right': _0x2d4b7f(0x32f) }), _0x2c6677(_0x2d4b7f(0x6d0), _0x2d4b7f(0x376), { 'top': _0x2d4b7f(0x32f), 'right': '4%' }), _0x2c6677(_0x2d4b7f(0x297), _0x2d4b7f(0x5e2), { 'top': '70%', 'left': _0x2d4b7f(0x814) }), _0x2c6677(_0x2d4b7f(0x561), _0x2d4b7f(0x149), { 'top': _0x2d4b7f(0x29f), 'left': _0x2d4b7f(0x4f6) }), _0x2c6677(_0x2d4b7f(0x2f2), _0x2d4b7f(0x352), { 'top': _0x2d4b7f(0x29f), 'left': '35%' }), _0x2c6677(_0x2d4b7f(0x786), _0x2d4b7f(0x2ae), { 'top': _0x2d4b7f(0x289), 'left': '6%' }), _0x2c6677('music-widget', _0x2d4b7f(0x710), { 'top': _0x2d4b7f(0x32f), 'left': '5%' }); } function _0x4459d2() { const _0x5e71d0 = _0xbc3280, _0x17a30b = document[_0x5e71d0(0x5d9)]('custom-icon-list-container'); _0x17a30b[_0x5e71d0(0x497)] = ''; const _0x41e4bb = document['querySelectorAll']('.app-icon'); _0x41e4bb[_0x5e71d0(0x691)](_0x40c23d => { const _0x59ade4 = _0x5e71d0, _0x34f27b = _0x40c23d['id'], _0x56eccb = _0x40c23d[_0x59ade4(0x85e)](_0x59ade4(0x2a7))[_0x59ade4(0x41a)], _0x5c0fff = _0x59ade4(0x547) + _0x34f27b, _0x52a4ac = localStorage[_0x59ade4(0x24e)](_0x5c0fff), _0x2682f8 = document[_0x59ade4(0x628)]('div'); _0x2682f8['className'] = _0x59ade4(0x1e5), _0x2682f8[_0x59ade4(0x3fc)][_0x59ade4(0x6a4)] = _0x59ade4(0x275), _0x2682f8[_0x59ade4(0x497)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22preview_' + _0x34f27b + '\x22\x20src=\x22' + (_0x52a4ac || 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7') + _0x59ade4(0x586) + _0x56eccb + _0x59ade4(0x822) + _0x34f27b + _0x59ade4(0x753) + _0x34f27b + '\x27).click()\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x20background-color:\x20#777;\x22\x20onclick=\x22localStorage.removeItem(\x27' + _0x5c0fff + _0x59ade4(0x183), _0x17a30b[_0x59ade4(0x2c8)](_0x2682f8); const _0x2acae3 = document[_0x59ade4(0x5d9)](_0x59ade4(0x64b) + _0x34f27b); _0x2acae3[_0x59ade4(0x73c)]('change', async _0x5ca7f4 => { const _0x5c02fe = _0x59ade4, _0x5a89d1 = _0x5ca7f4[_0x5c02fe(0x7da)][_0x5c02fe(0x3ad)][0x0]; if (!_0x5a89d1) return; try { if (_0x5c02fe(0x25f) !== _0x5c02fe(0x2c6)) { const _0x30b035 = await _0x2da880(_0x5a89d1); localStorage[_0x5c02fe(0x3cd)](_0x5c0fff, _0x30b035), document[_0x5c02fe(0x5d9)]('preview_' + _0x34f27b)[_0x5c02fe(0x161)] = _0x30b035, _0x2492ae(); } else { _0x28e082 = _0x5268a5(_0x18628f[_0x5c02fe(0x771)]), _0x1f5461['innerHTML'] = ''; if (_0x24184f[_0x5c02fe(0x794)] === 0x0) { _0x27c1cd[_0x5c02fe(0x497)] = _0x5c02fe(0x7fc); return; } _0x3dc417[_0x5c02fe(0x691)]((_0x1083a8, _0x3f8813) => { const _0x290cd7 = _0x5c02fe, _0x38a30e = _0x1e8fed[_0x290cd7(0x628)]('p'); _0x38a30e['textContent'] = _0x1083a8[_0x290cd7(0x224)], _0x38a30e['id'] = 'lyric-line-' + _0x3f8813, _0x3faf9c[_0x290cd7(0x2c8)](_0x38a30e); }); } } catch (_0x10d405) { if (_0x5c02fe(0x4eb) !== 'LdMpf') { const _0x12cac0 = _0x1750f1[_0x5c02fe(0x5d9)]('modal-root'), _0x347cc3 = _0x10044d[_0x5c02fe(0x5d9)]('modal-text'), _0x6bc987 = _0x46586a[_0x5c02fe(0x5d9)](_0x5c02fe(0x8b6)), _0x5ab80d = _0x52f9c8[_0x5c02fe(0x5d9)](_0x5c02fe(0x420)), _0x1c42ad = _0x551e95[_0x5c02fe(0x5d9)]('modal-mask'); _0x347cc3[_0x5c02fe(0x41a)] = _0xc46a87, _0x12cac0[_0x5c02fe(0x3fc)]['display'] = _0x5c02fe(0x1d8); const _0x150218 = _0x88a65a => { const _0x196097 = _0x5c02fe; _0x12cac0[_0x196097(0x3fc)][_0x196097(0x74d)] = _0x196097(0x860), _0x6bc987['onclick'] = _0x5ab80d[_0x196097(0x878)] = _0x1c42ad[_0x196097(0x878)] = null, _0x3267e7['removeEventListener'](_0x196097(0x23e), _0x30f558), _0x14654d(_0x88a65a); }, _0x30f558 = _0x2e1e61 => { const _0x3f3b12 = _0x5c02fe; if (_0x2e1e61['key'] === _0x3f3b12(0x46b)) _0x150218(![]); if (_0x2e1e61[_0x3f3b12(0x4de)] === _0x3f3b12(0x47d)) _0x150218(!![]); }; _0x6bc987[_0x5c02fe(0x878)] = () => _0x150218(!![]), _0x5ab80d['onclick'] = () => _0x150218(![]), _0x1c42ad[_0x5c02fe(0x878)] = () => _0x150218(![]), _0x2d032c['addEventListener'](_0x5c02fe(0x23e), _0x30f558); } else _0x13197e(_0x5c02fe(0x3fb) + _0x10d405['message']); } }); }); } function _0x2492ae() { const _0x385faa = _0xbc3280; if (_0x385faa(0x8aa) === _0x385faa(0x1cd)) _0x5b77e8 += _0x385faa(0x2b3); else { const _0x4f1ea4 = document[_0x385faa(0x81a)]('.app-icon'); _0x4f1ea4[_0x385faa(0x691)](_0x3cc195 => { const _0x1ce3b3 = _0x385faa; if (_0x1ce3b3(0x2f0) !== _0x1ce3b3(0x623)) { const _0xf71cde = _0x3cc195['id'], _0x9e863c = _0x1ce3b3(0x547) + _0xf71cde, _0x4f3ca7 = localStorage[_0x1ce3b3(0x24e)](_0x9e863c), _0x107c99 = _0x3cc195['querySelector'](_0x1ce3b3(0x2e5)); if (_0x4f3ca7) _0x107c99['innerHTML'] = '<img\x20src=\x22' + _0x4f3ca7 + '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>'; else { const _0x35044b = document[_0x1ce3b3(0x85e)](_0x1ce3b3(0x15a) + _0xf71cde + _0x1ce3b3(0x377) + _0xf71cde + _0x1ce3b3(0x166))?.[_0x1ce3b3(0x497)]; _0x35044b && (_0x107c99[_0x1ce3b3(0x497)] = _0x35044b); } } else { const _0xa753f7 = _0x360098[_0x1ce3b3(0x628)](_0x1ce3b3(0x172)); _0xa753f7[_0x1ce3b3(0x63a)] = 'member-selection-item', _0xa753f7['innerHTML'] = _0x1ce3b3(0x4b4) + _0xe11f11['id'] + _0x1ce3b3(0x305) + _0x36f003['id'] + _0x1ce3b3(0x1f0) + (_0x25a4a8[_0x1ce3b3(0x41e)] || _0xb03595) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-select-' + _0x59fc5a['id'] + _0x1ce3b3(0x62b) + _0x50648c[_0x1ce3b3(0x82e)] + _0x1ce3b3(0x171), _0x697b36[_0x1ce3b3(0x2c8)](_0xa753f7); } }); } } function _0x3edf3a() { const _0x2df852 = _0xbc3280, _0x302f9f = _0x5c6c54[_0x2df852(0x48c)]['find'](_0x708bdd => _0x708bdd['id'] === _0x5c6c54[_0x2df852(0x266)]), _0x4c253e = _0x1e26a8(); let _0x41c76e = []; if (_0x302f9f && _0x302f9f[_0x2df852(0x834)]) { if ('cGnGh' !== _0x2df852(0x653)) { const _0x1d5654 = _0x302f9f[_0x2df852(0x834)]['filter'](_0x35db87 => _0x35db87['type'] === _0x2df852(0x388) && _0x35db87[_0x2df852(0x62d)])[_0x2df852(0x2ac)](_0x5506d4 => ({ ..._0x5506d4, 'source': _0x2df852(0x839) })); _0x41c76e[_0x2df852(0x43f)](..._0x1d5654); } else _0x4cb2cf ? _0x8ff228(_0xc1bb8a) : _0x2cb995(new _0x5411b7('Canvas\x20to\x20Blob\x20conversion\x20failed.')); } if (_0x4c253e && _0x5c6c54[_0x2df852(0x3b6)]) { if (_0x2df852(0x3ce) !== 'Ukhlz') _0x5ae2f6(![]), _0x1397de[_0x2df852(0x7da)][_0x2df852(0x5a5)] = ''; else { const _0x2ee4d9 = _0x5c6c54[_0x2df852(0x3b6)][_0x2df852(0x25b)](_0x293d63 => _0x293d63['type'] === _0x2df852(0x388) && _0x293d63[_0x2df852(0x62d)])[_0x2df852(0x2ac)](_0x3ca3b7 => ({ ..._0x3ca3b7, 'source': _0x2df852(0x2da) })); _0x41c76e[_0x2df852(0x43f)](..._0x2ee4d9); } } const _0x589148 = Array['from'](new Map(_0x41c76e[_0x2df852(0x2ac)](_0x5333f2 => [_0x5333f2[_0x2df852(0x62d)], _0x5333f2]))[_0x2df852(0x6ce)]()); _0x5c6c54['musicPlaylist'] = _0x589148[_0x2df852(0x357)]((_0x1249c8, _0x12ba64) => _0x12ba64['timestamp'] - _0x1249c8[_0x2df852(0x5c5)]); } function _0x20dbd9(_0x13f135) { const _0x218985 = _0xbc3280; if (_0x218985(0x247) !== _0x218985(0x52b)) { if (_0x13f135 < 0x0 || _0x13f135 >= _0x324501['length']) return; _0x3b54c7 = _0x13f135; const _0xe08367 = _0x324501[_0x13f135]; _0x50a4ab['src'] = _0xe08367[_0x218985(0x62d)] || _0xe08367[_0x218985(0x5e3)], _0x50a4ab['play'](), _0x46dba6(), _0x2bc541(); } else { const _0x179cc5 = _0x4a1e5b[_0x218985(0x628)](_0x218985(0x172)); _0x179cc5['className'] = _0x218985(0x366); const _0x56c40b = _0x520b65['cover'] ? _0x34d80f[_0x218985(0x78a)](_0x4ab69f[_0x218985(0x7d9)]) : _0x1415cf; _0x179cc5[_0x218985(0x497)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + _0x56c40b + '\x22\x20class=\x22music-library-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-title\x22>' + (_0xdf17ff[_0x218985(0x29d)]['歌曲名称'] || _0x218985(0x533)) + _0x218985(0x3eb) + (_0xdbcdd1[_0x218985(0x29d)]['歌手'] || _0x218985(0x3f9)) + _0x218985(0x14d), _0x179cc5[_0x218985(0x73c)](_0x218985(0x36d), () => { _0x3ade2d(_0x57c2e8); }), _0x2405fb['appendChild'](_0x179cc5); } } function _0x46dba6() { const _0x1e3558 = _0x324501[_0x3b54c7]; _0x3715b6(_0x1e3558); } function _0x2bc541() { const _0x47c1e7 = _0xbc3280; try { localStorage['setItem'](_0x47c1e7(0x3e4), JSON[_0x47c1e7(0x79c)]({ 'playlist': _0x5c6c54[_0x47c1e7(0x67a)], 'currentIndex': _0x5c6c54[_0x47c1e7(0x5c1)] })); } catch (_0x51dab2) { console[_0x47c1e7(0x863)](_0x47c1e7(0x632), _0x51dab2); } } function _0x593d66() { const _0x547f9a = _0xbc3280; if (_0x547f9a(0x76f) === _0x547f9a(0x76f)) try { const _0x4f19b6 = localStorage[_0x547f9a(0x24e)](_0x547f9a(0x3e4)); if (_0x4f19b6) { if (_0x547f9a(0x809) !== _0x547f9a(0x809)) _0x1c84ec(_0x25139b['id']); else { const { playlist: _0x5ed063, currentIndex: _0x285a61 } = JSON[_0x547f9a(0x5b7)](_0x4f19b6); Array['isArray'](_0x5ed063) && _0x5ed063[_0x547f9a(0x794)] > 0x0 && _0x285a61 > -0x1 && (_0x5c6c54[_0x547f9a(0x67a)] = _0x5ed063, _0x5c6c54['currentlyPlayingIndex'] = _0x285a61, _0x5c6c54['isPlaying'] = ![], _0x46dba6()); } } } catch (_0x507207) { console['error'](_0x547f9a(0x5be), _0x507207); } else _0x41ead8[_0x547f9a(0x5a5)] = ''; } function _0x2271d4(_0x29ef37) { const _0x59923b = _0xbc3280; if (window[_0x59923b(0x531)]) clearTimeout(window['diaryPressTimer']); const _0x139e55 = _0x29ef37[_0x59923b(0x7da)]['closest'](_0x59923b(0x36c)); if (!_0x139e55) return; const _0x2af4a4 = _0x139e55[_0x59923b(0x17f)]['timestamp'], _0x4658f4 = _0x139e55[_0x59923b(0x7a1)][_0x59923b(0x153)](_0x59923b(0x845)) ? 'user' : 'ai'; if (!_0x2af4a4) return; const _0x3fbaa4 = () => { window['diaryPressTimer'] = setTimeout(() => { const _0x38a733 = _0x32ba; if (_0x29ef37[_0x38a733(0x443)] === _0x38a733(0x16d)) _0x29ef37[_0x38a733(0x7ac)](); _0x161445(parseInt(_0x2af4a4, 0xa), _0x4658f4); }, 0x320); }, _0x649a4c = () => { const _0x668cce = _0x59923b; if (_0x668cce(0x5ce) !== _0x668cce(0x670)) { if (window[_0x668cce(0x531)]) clearTimeout(window[_0x668cce(0x531)]); } else { const _0x3017ae = _0x131145['createElement'](_0x668cce(0x172)); _0x3017ae['textContent'] = _0x93e175, _0x3017ae[_0x668cce(0x73c)](_0x668cce(0x36d), () => { const _0x4ef076 = _0x668cce; _0x2f7061['value'] = _0x53a64a, _0x251124['classList']['remove'](_0x4ef076(0x274)); }), _0x2c1725[_0x668cce(0x2c8)](_0x3017ae); } }; document[_0x59923b(0x73c)](_0x59923b(0x1ba), _0x649a4c, { 'once': !![] }), document[_0x59923b(0x73c)](_0x59923b(0x3c8), _0x649a4c, { 'once': !![] }), document['addEventListener'](_0x59923b(0x356), _0x649a4c, { 'once': !![] }), _0x3fbaa4(); } function _0x161445(_0x4c4e80, _0x58dc79) { const _0x4cb2e4 = _0xbc3280, _0x246c34 = _0x4cb2e4(0x8a7) + _0x4c4e80; let _0x6b0ab1 = document[_0x4cb2e4(0x5d9)](_0x246c34); if (_0x6b0ab1) return; const _0x48120d = '\x0a\x20\x20\x20\x20<div\x20id=\x22' + _0x246c34 + _0x4cb2e4(0x69d) + (_0x58dc79 === 'ai' ? _0x4cb2e4(0x751) : '') + _0x4cb2e4(0x544); document[_0x4cb2e4(0x4ec)][_0x4cb2e4(0x559)](_0x4cb2e4(0x371), _0x48120d); const _0x11a0a2 = document[_0x4cb2e4(0x5d9)](_0x246c34), _0x4c93cf = () => _0x11a0a2['remove'](); _0x11a0a2[_0x4cb2e4(0x85e)](_0x4cb2e4(0x1cc))['onclick'] = _0x4c93cf, _0x11a0a2[_0x4cb2e4(0x85e)]('#diary-action-cancel')[_0x4cb2e4(0x878)] = _0x4c93cf, _0x11a0a2[_0x4cb2e4(0x85e)](_0x4cb2e4(0x734))[_0x4cb2e4(0x878)] = () => { _0x1cff1b(_0x4c4e80), _0x4c93cf(); }, _0x58dc79 === 'ai' && (_0x11a0a2[_0x4cb2e4(0x85e)]('#diary-action-reroll')['onclick'] = () => { const _0x2d37ca = _0x4cb2e4; _0x2d37ca(0x688) === _0x2d37ca(0x2e0) ? (_0xd177a5[_0x2d37ca(0x75c)] && _0x1d3f6a['currentAbortController'] && (_0x123d9a[_0x2d37ca(0x384)](_0x2d37ca(0x198)), _0x41da80['currentAbortController'][_0x2d37ca(0x431)](_0x2d37ca(0x668)), _0x46ea08[_0x2d37ca(0x493)] = null), _0x4b31fa[_0x2d37ca(0x75c)] = ![], _0x1e358b(![])) : (_0x23aeca(_0x4c4e80), _0x4c93cf()); }); } async function _0x1cff1b(_0x5623b4) { const _0x1ed901 = _0xbc3280, _0x49ddb2 = await _0x458a99(_0x1ed901(0x1d2)); if (!_0x49ddb2) return; const _0x2fae45 = _0x5c6c54['diaries'][_0x1ed901(0x659)](_0x195a7b => _0x195a7b['characterId'] === _0x5c6c54[_0x1ed901(0x6c5)]); if (!_0x2fae45) return; const _0x34caf6 = _0x2fae45['entries'][_0x1ed901(0x489)](_0x1b63bd => _0x1b63bd['timestamp'] === _0x5623b4); _0x34caf6 > -0x1 && (_0x1ed901(0x205) === _0x1ed901(0x205) ? (_0x2fae45['entries'][_0x1ed901(0x7ee)](_0x34caf6, 0x1), _0xbd25a6(), _0x32eaf8(), _0x13197e(_0x1ed901(0x363))) : _0x2c4c34[_0x1ed901(0x5a5)] = ''); } async function _0x23aeca(_0x4ab259) { const _0x4f8b95 = _0xbc3280; if (_0x4f8b95(0x53f) !== _0x4f8b95(0x53f)) { const _0x520cff = _0x8f3b1d[_0x4f8b95(0x5a5)]; let _0x1b41ac = _0x520cff['replace'](/\.bubble\.sent/g, '#bubble-preview-user')[_0x4f8b95(0x41f)](/\.bubble\.received/g, '#bubble-preview-ai'); _0x39e805[_0x4f8b95(0x497)] = _0x1b41ac; } else { const _0x16233c = _0x5c6c54['diaries'][_0x4f8b95(0x659)](_0x54d8aa => _0x54d8aa[_0x4f8b95(0x8d9)] === _0x5c6c54[_0x4f8b95(0x6c5)]); if (!_0x16233c) return; const _0x2860eb = _0x16233c[_0x4f8b95(0x806)][_0x4f8b95(0x489)](_0x43ef42 => _0x43ef42[_0x4f8b95(0x5c5)] === _0x4ab259); _0x2860eb > -0x1 && (_0x16233c[_0x4f8b95(0x806)][_0x4f8b95(0x7ee)](_0x2860eb, 0x1), _0xbd25a6(), _0x32eaf8(), await _0x5b1e46()); } } function _0x4be5de() { const _0x3fe9bc = _0xbc3280; if (_0x3fe9bc(0x3cf) !== _0x3fe9bc(0x3cf)) _0x41e314['src'] = _0x54d320[_0x3fe9bc(0x78a)](_0x361844); else { const _0xea2a1a = document['getElementById']('diary-list-container'); _0xea2a1a[_0x3fe9bc(0x497)] = ''; const _0x1f7d10 = _0x5c6c54[_0x3fe9bc(0x24a)][_0x3fe9bc(0x25b)](_0x55a528 => _0x5c6c54[_0x3fe9bc(0x1ce)]['some'](_0xdb1d3b => _0xdb1d3b[_0x3fe9bc(0x443)] === _0x3fe9bc(0x77d) && _0xdb1d3b['participantIds'][_0x3fe9bc(0x87c)](_0x55a528['id']))); if (_0x1f7d10['length'] === 0x0) { _0xea2a1a[_0x3fe9bc(0x497)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以交换日记的对象。</p>'; return; } _0x1f7d10[_0x3fe9bc(0x691)](_0x29011a => { const _0x3e2958 = _0x3fe9bc, _0x22d5ef = document['createElement']('li'); _0x22d5ef[_0x3e2958(0x63a)] = _0x3e2958(0x362), _0x22d5ef[_0x3e2958(0x17f)]['charId'] = _0x29011a['id'], _0x22d5ef[_0x3e2958(0x497)] = _0x3e2958(0x476) + (_0x29011a[_0x3e2958(0x41e)] || _0x166d38) + _0x3e2958(0x87b) + _0x29011a['name'] + _0x3e2958(0x1b3), _0x22d5ef[_0x3e2958(0x73c)](_0x3e2958(0x36d), () => { _0x15169c(_0x29011a['id']); }), _0xea2a1a[_0x3e2958(0x2c8)](_0x22d5ef); }); } } function _0x15169c(_0x4cb85a) { const _0x451166 = _0xbc3280, _0x3dbb2b = _0x5a8ee7(_0x4cb85a); if (!_0x3dbb2b) return; _0x5c6c54[_0x451166(0x6c5)] = _0x4cb85a; const _0x16676f = _0x5c6c54[_0x451166(0x592)]['find'](_0x35c2ee => _0x35c2ee[_0x451166(0x8d9)] === _0x4cb85a), _0x559c53 = _0x16676f ? _0x16676f[_0x451166(0x806)][_0x451166(0x794)] : 0x0, _0x1035b9 = 0x2; _0x5c6c54[_0x451166(0x4d9)] = Math[_0x451166(0x65a)](0x0, Math[_0x451166(0x506)](_0x559c53 / _0x1035b9) - 0x1), document[_0x451166(0x5d9)](_0x451166(0x8ca))[_0x451166(0x41a)] = _0x3dbb2b['name'] + _0x451166(0x515), _0x32eaf8(), _0x4ed1c4(_0x451166(0x8c2), _0x451166(0x61b)); } function _0x32eaf8() { const _0x1367b7 = _0xbc3280; if ('MXUjm' === 'bdIpW') _0x577992[_0x1367b7(0x3fc)]['backgroundImage'] = 'url(' + _0x33ea24[_0x1367b7(0x78a)](_0x4d33c7) + ')', _0x551c49[_0x1367b7(0x3fc)][_0x1367b7(0x66d)] = _0x1367b7(0x7d9), _0x30145c[_0x1367b7(0x3fc)][_0x1367b7(0x186)] = 'center'; else { const _0x3d5658 = document[_0x1367b7(0x5d9)](_0x1367b7(0x24b)), _0x256f26 = document[_0x1367b7(0x5d9)](_0x1367b7(0x29b)); _0x3d5658[_0x1367b7(0x497)] = '', _0x256f26[_0x1367b7(0x497)] = ''; const _0x34893b = _0x2774c4() || { 'name': '我' }, _0x2be094 = _0x5c6c54[_0x1367b7(0x592)][_0x1367b7(0x659)](_0x59aff5 => _0x59aff5[_0x1367b7(0x8d9)] === _0x5c6c54[_0x1367b7(0x6c5)]); if (!_0x2be094 || !_0x2be094[_0x1367b7(0x806)] || _0x2be094[_0x1367b7(0x806)][_0x1367b7(0x794)] === 0x0) { if (_0x1367b7(0x316) === _0x1367b7(0x760)) { const _0x95c615 = _0x28134b['createElement']('li'); _0x95c615[_0x1367b7(0x63a)] = _0x1367b7(0x1e5), _0x95c615['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-' + _0x506d78['id'] + _0x1367b7(0x305) + _0x3cecea['id'] + _0x1367b7(0x439) + (_0x19f540[_0x1367b7(0x41e)] || _0x317bf9) + _0x1367b7(0x71e) + _0x476acd['id'] + _0x1367b7(0x62b) + _0x10f3d1[_0x1367b7(0x82e)] + _0x1367b7(0x585), _0x1bfc61[_0x1367b7(0x2c8)](_0x95c615); } else { _0x3d5658[_0x1367b7(0x497)] = _0x1367b7(0x28c), _0x256f26['innerHTML'] = _0x1367b7(0x2e4), document[_0x1367b7(0x5d9)](_0x1367b7(0x1a0))[_0x1367b7(0x73c)]('click', _0x41ce19), document[_0x1367b7(0x5d9)]('diary-get-reply-button')[_0x1367b7(0x73c)](_0x1367b7(0x36d), _0x5b1e46); return; } } const _0x1752c5 = 0x2, _0x1551b9 = [..._0x2be094[_0x1367b7(0x806)]][_0x1367b7(0x357)]((_0x3e35e2, _0x1642e5) => _0x3e35e2[_0x1367b7(0x5c5)] - _0x1642e5['timestamp']), _0x54a55d = []; for (let _0x15608b = 0x0; _0x15608b < _0x1551b9[_0x1367b7(0x794)]; _0x15608b += _0x1752c5) { _0x1367b7(0x269) === _0x1367b7(0x680) ? _0x2539a8['assign'](_0xe065e7, { 'songName': _0x2500b1, 'artist': _0x11d65f, 'coverUrl': null, 'playableUrl': null }) : _0x54a55d['push'](_0x1551b9[_0x1367b7(0x60e)](_0x15608b, _0x15608b + _0x1752c5)); } const _0x3bb315 = _0x54a55d[_0x1367b7(0x794)]; _0x54a55d[_0x1367b7(0x691)]((_0x2883af, _0x29d593) => { const _0x3bdc7f = _0x1367b7; if (_0x3bdc7f(0x278) === _0x3bdc7f(0x415)) { _0x1716ca[_0x3bdc7f(0x7a1)][_0x3bdc7f(0x821)](_0x3bdc7f(0x4b7)); const _0x65c3bf = _0x435eee[_0x3bdc7f(0x628)](_0x3bdc7f(0x62a)); _0x65c3bf[_0x3bdc7f(0x161)] = _0x30e857, _0x65c3bf[_0x3bdc7f(0x7a1)][_0x3bdc7f(0x821)](_0x3bdc7f(0x6c8)), _0x22d4e1['appendChild'](_0x65c3bf); } else { const _0x492601 = document['createElement'](_0x3bdc7f(0x172)); _0x492601['className'] = _0x3bdc7f(0x51a), _0x492601['id'] = _0x3bdc7f(0x319) + _0x29d593, _0x29d593 === _0x5c6c54[_0x3bdc7f(0x4d9)] && _0x492601[_0x3bdc7f(0x7a1)][_0x3bdc7f(0x821)]('is-visible'), _0x2883af[_0x3bdc7f(0x691)](_0x28764f => { const _0x7d8f71 = _0x3bdc7f, _0x34d16c = _0x28764f['author'] === _0x7d8f71(0x845) ? _0x7d8f71(0x845) : 'ai', _0x4f1321 = _0x28764f['author'] === _0x7d8f71(0x845) ? _0x34893b['name'] : _0x5a8ee7(_0x28764f[_0x7d8f71(0x532)])['name'], _0x2a66d1 = document['createElement']('div'); _0x2a66d1[_0x7d8f71(0x63a)] = 'diary-entry\x20' + _0x34d16c, _0x2a66d1[_0x7d8f71(0x17f)][_0x7d8f71(0x5c5)] = _0x28764f[_0x7d8f71(0x5c5)], _0x2a66d1[_0x7d8f71(0x3fc)]['borderBottom'] = _0x7d8f71(0x860), _0x2a66d1[_0x7d8f71(0x3fc)]['paddingBottom'] = '0', _0x2a66d1[_0x7d8f71(0x497)] = _0x7d8f71(0x330) + _0x4f1321 + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>' + new Date(_0x28764f[_0x7d8f71(0x5c5)])[_0x7d8f71(0x787)](_0x7d8f71(0x4ea)) + _0x7d8f71(0x28f) + _0x28764f[_0x7d8f71(0x283)][_0x7d8f71(0x41f)](/\n/g, _0x7d8f71(0x31d)) + _0x7d8f71(0x57a), _0x492601['appendChild'](_0x2a66d1); }), _0x3d5658['appendChild'](_0x492601); } }), _0x256f26[_0x1367b7(0x497)] = _0x1367b7(0x8c7) + (_0x5c6c54[_0x1367b7(0x4d9)] + 0x1) + _0x1367b7(0x664) + _0x3bb315 + _0x1367b7(0x782), document[_0x1367b7(0x5d9)](_0x1367b7(0x4d5))['disabled'] = _0x5c6c54[_0x1367b7(0x4d9)] === 0x0, document['getElementById']('diary-next-button')[_0x1367b7(0x1d4)] = _0x5c6c54[_0x1367b7(0x4d9)] === _0x3bb315 - 0x1, document['getElementById']('diary-prev-button')[_0x1367b7(0x73c)](_0x1367b7(0x36d), _0x3919ba), document['getElementById'](_0x1367b7(0x8d6))[_0x1367b7(0x73c)](_0x1367b7(0x36d), _0x460cbc), document['getElementById']('diary-write-button')[_0x1367b7(0x73c)](_0x1367b7(0x36d), _0x41ce19), document[_0x1367b7(0x5d9)]('diary-get-reply-button')[_0x1367b7(0x73c)]('click', _0x5b1e46); } } function _0x460cbc() { const _0x21aa0a = _0xbc3280; if ('Lmcbw' !== _0x21aa0a(0x39a)) { if (_0x5c6c54['isAnimatingDiary']) return; const _0x293a2c = _0x5c6c54[_0x21aa0a(0x4d9)], _0x2c723f = Math[_0x21aa0a(0x506)](_0x5c6c54[_0x21aa0a(0x592)]['find'](_0x167819 => _0x167819[_0x21aa0a(0x8d9)] === _0x5c6c54[_0x21aa0a(0x6c5)])['entries'][_0x21aa0a(0x794)] / 0x2); if (_0x293a2c >= _0x2c723f - 0x1) return; _0x5c6c54[_0x21aa0a(0x7b2)] = !![]; const _0x4496f2 = _0x293a2c + 0x1, _0x38ed81 = document[_0x21aa0a(0x5d9)](_0x21aa0a(0x319) + _0x293a2c), _0x47e418 = document['getElementById'](_0x21aa0a(0x319) + _0x4496f2); if (_0x38ed81 && _0x47e418) { if (_0x21aa0a(0x21d) !== _0x21aa0a(0x21d)) { const _0x51442b = _0xa07241[_0x21aa0a(0x628)]('p'); _0x51442b[_0x21aa0a(0x3fc)][_0x21aa0a(0x24f)] = _0x21aa0a(0x759), _0x51442b['textContent'] = _0x4fc42e, _0x43a1b8[_0x21aa0a(0x2c8)](_0x51442b); } else _0x47e418[_0x21aa0a(0x7a1)][_0x21aa0a(0x821)](_0x21aa0a(0x333)), _0x38ed81[_0x21aa0a(0x7a1)]['add'](_0x21aa0a(0x780)), _0x47e418[_0x21aa0a(0x7a1)]['add']('is-visible'), setTimeout(() => { const _0x4d486e = _0x21aa0a; _0x4d486e(0x5eb) !== 'axOtN' ? (_0x38ed81[_0x4d486e(0x7a1)]['remove'](_0x4d486e(0x1fd), _0x4d486e(0x780)), _0x47e418[_0x4d486e(0x7a1)][_0x4d486e(0x8a2)](_0x4d486e(0x333)), _0x5c6c54['diaryCurrentPage'] = _0x4496f2, _0x32eaf8(), _0x5c6c54[_0x4d486e(0x7b2)] = ![]) : (_0x2d3d6e[_0x4d486e(0x3fc)]['backgroundImage'] = '', _0x24526f[_0x4d486e(0x3fc)][_0x4d486e(0x279)] = '', _0x3dddc7[_0x4d486e(0x81a)](_0x4d486e(0x246))['forEach'](_0x5d200f => { const _0x4f94b4 = _0x4d486e; _0x5d200f[_0x4f94b4(0x3fc)][_0x4f94b4(0x88e)] = ''; })); }, 0x2bc); } else _0x5c6c54['isAnimatingDiary'] = ![]; } else { if (_0x2ef89a) _0x47ec9b[_0x21aa0a(0x41a)] = '❚❚'; } } function _0x3919ba() { const _0x5cbb7d = _0xbc3280; if (_0x5cbb7d(0x307) === 'OfxoR') _0x48da04(), _0x1ae3e1(_0x5cbb7d(0x61b), _0x5cbb7d(0x402)); else { if (_0x5c6c54[_0x5cbb7d(0x7b2)]) return; const _0x52db2d = _0x5c6c54[_0x5cbb7d(0x4d9)]; if (_0x52db2d <= 0x0) return; _0x5c6c54[_0x5cbb7d(0x7b2)] = !![]; const _0x347d7f = _0x52db2d - 0x1, _0xbf73d6 = document[_0x5cbb7d(0x5d9)](_0x5cbb7d(0x319) + _0x52db2d), _0xd8fd0b = document[_0x5cbb7d(0x5d9)](_0x5cbb7d(0x319) + _0x347d7f); _0xbf73d6 && _0xd8fd0b ? (_0xd8fd0b[_0x5cbb7d(0x7a1)][_0x5cbb7d(0x821)](_0x5cbb7d(0x49e)), _0xbf73d6[_0x5cbb7d(0x7a1)][_0x5cbb7d(0x821)](_0x5cbb7d(0x4cc)), _0xd8fd0b[_0x5cbb7d(0x7a1)]['add'](_0x5cbb7d(0x1fd)), setTimeout(() => { const _0x27f7e1 = _0x5cbb7d; if (_0x27f7e1(0x469) !== _0x27f7e1(0x185)) _0xbf73d6[_0x27f7e1(0x7a1)][_0x27f7e1(0x8a2)](_0x27f7e1(0x1fd), _0x27f7e1(0x4cc)), _0xd8fd0b['classList']['remove'](_0x27f7e1(0x49e)), _0x5c6c54[_0x27f7e1(0x4d9)] = _0x347d7f, _0x32eaf8(), _0x5c6c54[_0x27f7e1(0x7b2)] = ![]; else { _0x27fa76['warn']('Group\x20plan\x20failed,\x20falling\x20back\x20to\x20individual\x20generation\x20for\x20each\x20character.'); const _0x54a7f5 = _0x623f6b[_0x27f7e1(0x594)][_0x27f7e1(0x2ac)](_0x551484)[_0x27f7e1(0x25b)](_0x597a4c); if (!_0x54a7f5['length']) return; let _0x1918b6 = 0x0; for (const _0x1575fe of _0x54a7f5) { _0x45b741(_0x1575fe, { 'force': !![], 'delayMs': _0x1918b6 }), _0x1918b6 += 0x1f4; } } }, 0x2bc)) : _0x5cbb7d(0x3be) !== _0x5cbb7d(0x823) ? _0x5c6c54['isAnimatingDiary'] = ![] : (_0x5c6684['classList'][_0x5cbb7d(0x8a2)](_0x5cbb7d(0x1fd), 'is-exiting-right'), _0x187616[_0x5cbb7d(0x7a1)][_0x5cbb7d(0x8a2)]('is-entering-from-left'), _0x43c5aa[_0x5cbb7d(0x4d9)] = _0x1276b0, _0x43456f(), _0x2d79dc[_0x5cbb7d(0x7b2)] = ![]); } } function _0x41ce19() { return new Promise(_0x4a334b => { const _0x5bfcc0 = _0x32ba, _0x4fdf3f = _0x5bfcc0(0x674); document[_0x5bfcc0(0x4ec)][_0x5bfcc0(0x559)](_0x5bfcc0(0x371), _0x4fdf3f); const _0x34dbba = document[_0x5bfcc0(0x5d9)](_0x5bfcc0(0x427)), _0x61137 = document[_0x5bfcc0(0x5d9)](_0x5bfcc0(0x40b)), _0x186a8c = document[_0x5bfcc0(0x5d9)](_0x5bfcc0(0x5fb)), _0x1831de = document[_0x5bfcc0(0x5d9)](_0x5bfcc0(0x866)), _0x2799ab = _0x34dbba[_0x5bfcc0(0x85e)](_0x5bfcc0(0x1cc)), _0x1d59c9 = () => { const _0x4bd182 = _0x5bfcc0; _0x34dbba[_0x4bd182(0x8a2)](), _0x4a334b(); }; _0x186a8c['onclick'] = () => { const _0x49ef67 = _0x5bfcc0; _0x55d50e(_0x61137[_0x49ef67(0x5a5)]), _0x1d59c9(); }, _0x1831de[_0x5bfcc0(0x878)] = _0x1d59c9, _0x2799ab[_0x5bfcc0(0x878)] = _0x1d59c9; }); } function _0x55d50e(_0x3639b3) { const _0x37fb0c = _0xbc3280, _0x54dd9d = _0x3639b3[_0x37fb0c(0x42f)](); if (!_0x54dd9d || !_0x5c6c54[_0x37fb0c(0x6c5)]) return; let _0xb556dc = _0x5c6c54[_0x37fb0c(0x592)][_0x37fb0c(0x659)](_0xce62c6 => _0xce62c6[_0x37fb0c(0x8d9)] === _0x5c6c54[_0x37fb0c(0x6c5)]); !_0xb556dc && (_0xb556dc = { 'characterId': _0x5c6c54[_0x37fb0c(0x6c5)], 'entries': [] }, _0x5c6c54[_0x37fb0c(0x592)][_0x37fb0c(0x43f)](_0xb556dc)); _0xb556dc['entries']['push']({ 'timestamp': Date['now'](), 'author': _0x37fb0c(0x845), 'content': _0x54dd9d }), _0xbd25a6(); const _0x3607a7 = _0xb556dc[_0x37fb0c(0x806)][_0x37fb0c(0x794)]; _0x5c6c54[_0x37fb0c(0x4d9)] = Math[_0x37fb0c(0x506)](_0x3607a7 / 0x2) - 0x1, _0x32eaf8(); } async function _0x5b1e46() { const _0x216942 = _0xbc3280, _0x4b69d8 = _0x5c6c54['activeDiaryCharacterId'], _0xf445d4 = _0x5a8ee7(_0x4b69d8); if (!_0xf445d4 || _0x5c6c54[_0x216942(0x75c)]) return; _0x3168b5(!![], _0x216942(0x452)), _0x5c6c54[_0x216942(0x75c)] = !![]; let _0x47c6b8 = []; try { if ('JNNNT' === _0x216942(0x413)) _0x22d6e8[_0x216942(0x7a1)][_0x216942(0x8a2)](_0x216942(0x2fd)), _0x5e9d55['classList'][_0x216942(0x8a2)](_0x216942(0x422)); else { const _0x3cc9bf = _0x2774c4() || { 'name': '你' }, _0x503307 = _0x13f7f9(_0x4b69d8), { omniText: _0x4f25d9 } = _0x5c86b3(_0x4b69d8, _0x5c6c54[_0x216942(0x728)]); let _0x240d14 = ''; if (_0xf445d4[_0x216942(0x88d)] && _0xf445d4[_0x216942(0x88d)][_0x216942(0x794)] > 0x0) { const _0x29a220 = _0xf445d4['linkedWorldBookIds']['map'](_0x3239b1 => _0x5c6c54[_0x216942(0x6bd)][_0x216942(0x659)](_0x1a576d => _0x1a576d['id'] === _0x3239b1))['filter'](Boolean)[_0x216942(0x2ac)](_0x24f921 => '\x0a\x0a##\x20世界书条目:\x20' + _0x24f921['name'] + '\x0a' + _0x24f921[_0x216942(0x283)])[_0x216942(0x5d2)](''); if (_0x29a220) _0x240d14 = _0x216942(0x656) + _0x29a220; } const _0x1500c0 = _0x3cc9bf[_0x216942(0x854)] ? _0x216942(0x369) + _0x3cc9bf[_0x216942(0x82e)] + _0x216942(0x2cc) + _0x3cc9bf[_0x216942(0x854)] : '', _0x3fe8b1 = _0x480fea(), _0x235ba8 = _0x216942(0x216) + _0xf445d4['name'] + '”的角色，现在需要写一篇交换日记。\x0a-\x20**你的读者**:\x20' + _0x3cc9bf[_0x216942(0x82e)] + '。\x0a-\x20**核心人设**:\x20' + _0xf445d4['persona'] + '\x0a' + _0x1500c0 + '\x0a' + _0x240d14 + _0x216942(0x1e0) + (_0x4f25d9 || _0x216942(0x34b)) + _0x216942(0x165) + (_0x3fe8b1 || _0x216942(0x63b)) + _0x216942(0x71c) + (_0x503307 || _0x216942(0x40a)) + _0x216942(0x689); _0x47c6b8 = [{ 'role': 'system', 'content': _0x235ba8 }, { 'role': _0x216942(0x845), 'content': _0x216942(0x84e) }]; const _0x638889 = await _0x5cca68(_0x47c6b8); if (_0x638889) { if (_0x216942(0x34a) === 'Lwuzw') { let _0x3d4e87 = _0x5c6c54[_0x216942(0x592)][_0x216942(0x659)](_0x42abe2 => _0x42abe2['characterId'] === _0x4b69d8); !_0x3d4e87 && (_0x3d4e87 = { 'characterId': _0x4b69d8, 'entries': [] }, _0x5c6c54[_0x216942(0x592)][_0x216942(0x43f)](_0x3d4e87)); _0x3d4e87[_0x216942(0x806)][_0x216942(0x43f)]({ 'timestamp': Date['now'](), 'author': _0x4b69d8, 'content': _0x638889 }), _0xbd25a6(); const _0x1008a7 = _0x3d4e87['entries']['length']; _0x5c6c54['diaryCurrentPage'] = Math[_0x216942(0x506)](_0x1008a7 / 0x2) - 0x1, _0x32eaf8(); } else _0x16ea93['textContent'] = _0x216942(0x445); } } } catch (_0x588e19) { if (_0x216942(0x85b) === _0x216942(0x50b)) { const _0x2b48be = { 'characters': _0x5421a4[_0x216942(0x24a)], 'worldBooks': _0xda15fb[_0x216942(0x6bd)], 'chats': _0x5db686['chats'], 'userProfile': _0x1f9396[_0x216942(0x484)], 'apiSettings': _0x28f9af[_0x216942(0x73a)], 'preferences': _0x2bebf3[_0x216942(0x778)], 'activeChatId': _0x3f1ef5[_0x216942(0x728)], 'diaries': _0x5e2f89['diaries'], 'friendCircles': _0x4a2e13['friendCircles'], 'activeFriendCircleId': _0x510b3a['activeFriendCircleId'], 'userProfiles': _0x3e0119[_0x216942(0x160)], 'activeUserProfileId': _0x5e0bbc[_0x216942(0x4f0)] }; _0x11a9e6[_0x216942(0x3cd)](_0x216942(0x21e), _0x5baa8c['stringify'](_0x2b48be)); } else _0x13197e(_0x216942(0x5c3) + _0x588e19['message']); } finally { _0x3168b5(![]), _0x5c6c54[_0x216942(0x75c)] = ![]; } } function _0x102d5d() { const _0x3d5e80 = _0xbc3280; if (_0x3d5e80(0x4aa) === _0x3d5e80(0x4aa)) { const _0x5bc3de = document[_0x3d5e80(0x5d9)](_0x3d5e80(0x2f7)), _0x319f82 = document[_0x3d5e80(0x5d9)](_0x3d5e80(0x1e9)), _0x50b887 = document[_0x3d5e80(0x85e)](_0x3d5e80(0x709)); _0x5c6c54[_0x3d5e80(0x471)] === _0x3d5e80(0x1f1) ? _0x3d5e80(0x40d) === _0x3d5e80(0x579) ? (_0x33bda8[_0x3d5e80(0x73c)]('click', () => _0x486433['click']()), _0x1c4a29[_0x3d5e80(0x73c)](_0x3d5e80(0x288), async _0x53a15a => { const _0x17181f = _0x3d5e80, _0x34d221 = _0x53a15a[_0x17181f(0x7da)][_0x17181f(0x3ad)][0x0]; if (!_0x34d221) return; try { _0x2e0724[_0x17181f(0x161)] = _0x490366[_0x17181f(0x78a)](_0x34d221); } catch (_0x36df96) { _0x5a4abe('图片预览失败:\x20' + _0x36df96[_0x17181f(0x1a4)]); } })) : (_0x5bc3de[_0x3d5e80(0x3fc)]['display'] = _0x3d5e80(0x860), _0x319f82[_0x3d5e80(0x3fc)][_0x3d5e80(0x74d)] = 'block') : (_0x5bc3de[_0x3d5e80(0x3fc)][_0x3d5e80(0x74d)] = _0x3d5e80(0x38f), _0x319f82[_0x3d5e80(0x3fc)][_0x3d5e80(0x74d)] = _0x3d5e80(0x860)), _0x50b887[_0x3d5e80(0x3fc)][_0x3d5e80(0x74d)] = _0x3d5e80(0x38f); } else _0x365cc9 = _0x59248c['name'] || '我', _0x5dc87b = _0x3d5e80(0x828); } function _0x549336() { const _0x298a48 = _0xbc3280; if (_0x298a48(0x421) !== _0x298a48(0x215)) { const _0x125a6c = document[_0x298a48(0x5d9)]('galgame-speaker'), _0x3fa5da = document[_0x298a48(0x5d9)](_0x298a48(0x556)); if (_0x5c6c54[_0x298a48(0x462)][_0x298a48(0x794)] > 0x0) { if ('wyAWi' === 'wyAWi') { const _0x563993 = _0x5c6c54[_0x298a48(0x462)][_0x298a48(0x1b5)](); _0x125a6c[_0x298a48(0x41a)] = _0x563993[_0x298a48(0x28b)] === _0x298a48(0x494) ? '旁白' : _0x563993['speaker'], _0x3fa5da[_0x298a48(0x41a)] = _0x563993[_0x298a48(0x475)], _0x563993['speaker'] !== 'narrator' && _0x448953(_0x5c6c54[_0x298a48(0x251)], _0x563993[_0x298a48(0x203)]); } else { const _0x2c3965 = _0x2a63e8[_0x298a48(0x24e)](_0x298a48(0x555) + _0xb457b7), _0x21c5f = _0x5a9d6a[_0x298a48(0x5b7)](_0x2c3965 || '[]'); return _0x38d4d3[_0x298a48(0x1ab)](_0x21c5f) ? _0x21c5f : []; } } else { if (_0x298a48(0x16f) === _0x298a48(0x16f)) { const _0xf26d7f = _0x5c6c54['characterLastScripts'][_0x5c6c54[_0x298a48(0x251)]]; if (_0xf26d7f && _0xf26d7f[_0x298a48(0x794)] > 0x0) { if (_0x298a48(0x248) !== 'BzrSB') { _0x5c6c54['activeMeetingScriptQueue'] = [..._0xf26d7f]; const _0x491435 = _0x5c6c54[_0x298a48(0x462)][_0x298a48(0x1b5)](); _0x125a6c[_0x298a48(0x41a)] = _0x491435[_0x298a48(0x28b)] === _0x298a48(0x494) ? '旁白' : _0x491435[_0x298a48(0x28b)], _0x3fa5da[_0x298a48(0x41a)] = _0x491435['line'], _0x491435[_0x298a48(0x28b)] !== 'narrator' && _0x448953(_0x5c6c54[_0x298a48(0x251)], _0x491435[_0x298a48(0x203)]); } else _0xf37e29[_0x298a48(0x863)](_0x298a48(0x14a), _0xfaa057); } else { if (_0x298a48(0x768) !== _0x298a48(0x6e0)) _0x125a6c['textContent'] = '旁白', _0x3fa5da['textContent'] = _0x298a48(0x496); else return new _0x7e07fa(_0x2416a0 => { const _0x317bce = _0x298a48, _0x3f9c8a = _0x272c3c[_0x317bce(0x5d9)]('modal-root'), _0xc6f33e = _0x4d489c[_0x317bce(0x5d9)](_0x317bce(0x2c7)), _0x355002 = _0x8d3af4[_0x317bce(0x5d9)]('modal-ok'), _0x57c582 = _0x51af60[_0x317bce(0x5d9)](_0x317bce(0x420)), _0x3124a5 = _0x1a8484[_0x317bce(0x5d9)](_0x317bce(0x414)); _0xc6f33e['textContent'] = _0x53ded3, _0x3f9c8a[_0x317bce(0x3fc)][_0x317bce(0x74d)] = _0x317bce(0x1d8); const _0x19aa3d = _0x5036e5 => { const _0x3d1e5f = _0x317bce; _0x3f9c8a['style']['display'] = _0x3d1e5f(0x860), _0x355002[_0x3d1e5f(0x878)] = _0x57c582['onclick'] = _0x3124a5[_0x3d1e5f(0x878)] = null, _0x296cae[_0x3d1e5f(0x2d3)]('keydown', _0x502c04), _0x2416a0(_0x5036e5); }, _0x502c04 = _0x3faead => { const _0x4d098e = _0x317bce; if (_0x3faead[_0x4d098e(0x4de)] === 'Escape') _0x19aa3d(![]); if (_0x3faead[_0x4d098e(0x4de)] === _0x4d098e(0x47d)) _0x19aa3d(!![]); }; _0x355002['onclick'] = () => _0x19aa3d(!![]), _0x57c582['onclick'] = () => _0x19aa3d(![]), _0x3124a5[_0x317bce(0x878)] = () => _0x19aa3d(![]), _0x3aa3aa[_0x317bce(0x73c)](_0x317bce(0x23e), _0x502c04); }); } } else _0x1af6ef *= _0x1f30bb / _0x5a165e, _0x1f5633 = _0x14fff8; } } else { const _0x38b360 = _0x56d9ad['recipientId'] === _0x4eb781(_0x5b558b[_0x298a48(0x728)])['id'] ? _0x3cd0bd(_0x501c82[_0x298a48(0x728)]) : _0x45835b(_0xa13801[_0x298a48(0x767)]); _0x22d78f[_0x298a48(0x8cb)](_0x37e1c7, { 'type': _0x298a48(0x71b), 'amount': _0x1f818e['amount'], 'recipientId': _0x2a4885[_0x298a48(0x767)], 'content': _0x298a48(0x4d7) + (_0x38b360?.[_0x298a48(0x82e)] || '未知') + _0x298a48(0x885) + _0x5c1ff0[_0x298a48(0x159)] + ']' }); } } async function _0x448953(_0x2db1c6, _0xcf4436) { const _0x35ca0a = _0xbc3280, _0x7114f8 = document[_0x35ca0a(0x5d9)](_0x35ca0a(0x85d)), _0x54e0c5 = ['normal', _0x35ca0a(0x3b5), 'angry', _0x35ca0a(0x644), _0x35ca0a(0x4b5)], _0x487b68 = _0x54e0c5['includes'](_0xcf4436) ? _0xcf4436 : _0x35ca0a(0x63f); try { if (_0x35ca0a(0x5f2) !== _0x35ca0a(0x5f2)) { if (_0x26259c === null) return; const _0x33a21d = _0x131a87[_0x35ca0a(0x5a5)][_0x35ca0a(0x42f)](); if (_0x33a21d === '') { _0x2e1cb1(); return; } const _0x2eef6b = _0x3a9ab9[_0x35ca0a(0x3b6)][_0x5961a3]; _0x2eef6b && (_0x2eef6b[_0x35ca0a(0x283)] = _0x33a21d, _0x2c1c3b(), _0x4471cd()), _0x10c275[_0x35ca0a(0x7a1)]['remove']('show'), _0x124a65 = null; } else { const _0x9544f7 = await _0x2eb454(_0x35ca0a(0x657) + _0x487b68 + '_' + _0x2db1c6); if (_0x9544f7) _0x7114f8[_0x35ca0a(0x3fc)]['opacity'] = 0x0, setTimeout(() => { const _0x1cde6c = _0x35ca0a; _0x1cde6c(0x4a7) === _0x1cde6c(0x4a7) ? (_0x7114f8[_0x1cde6c(0x161)] = URL[_0x1cde6c(0x78a)](_0x9544f7), _0x7114f8['style']['opacity'] = 0x1) : _0x2c2fe8[_0x1cde6c(0x41a)] = '▶'; }, 0x12c); else { if (_0x35ca0a(0x817) === _0x35ca0a(0x817)) { const _0x591890 = await _0x2eb454('char_sprite_normal_' + _0x2db1c6); _0x591890 ? 'moTPz' !== _0x35ca0a(0x459) ? _0x7114f8['src'] = URL[_0x35ca0a(0x78a)](_0x591890) : (_0x15df80[_0x35ca0a(0x3fc)][_0x35ca0a(0x74d)] = _0x35ca0a(0x860), _0x3edddb[_0x35ca0a(0x878)] = _0x10e920[_0x35ca0a(0x878)] = _0x22d162['onclick'] = null, _0x5dd17f[_0x35ca0a(0x2d3)](_0x35ca0a(0x23e), _0x37dae1), _0x1343fd(_0x3a2bb7)) : _0x7114f8[_0x35ca0a(0x161)] = ''; } else { _0x239ca1['value'] = '', _0x11816b['innerHTML'] = ''; if (_0x36b3b2['characters']['length'] < 0x2) { _0x51bca8(_0x35ca0a(0x206)); return; } _0x4e10ef['characters'][_0x35ca0a(0x691)](_0x204c2d => { const _0x2603fe = _0x35ca0a, _0x4739b4 = _0xde21dc['createElement']('li'); _0x4739b4[_0x2603fe(0x63a)] = _0x2603fe(0x1e5), _0x4739b4[_0x2603fe(0x497)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-' + _0x204c2d['id'] + '\x22\x20data-id=\x22' + _0x204c2d['id'] + _0x2603fe(0x439) + (_0x204c2d[_0x2603fe(0x41e)] || _0x2d011d) + _0x2603fe(0x71e) + _0x204c2d['id'] + _0x2603fe(0x62b) + _0x204c2d[_0x2603fe(0x82e)] + _0x2603fe(0x585), _0x2b5756[_0x2603fe(0x2c8)](_0x4739b4); }), _0x305f48(_0x35ca0a(0x4bc), _0x35ca0a(0x7b6)); } } } } catch (_0x7acf8) { console[_0x35ca0a(0x863)](_0x35ca0a(0x18e), _0x7acf8), _0x7114f8[_0x35ca0a(0x161)] = ''; } } function _0x149c12(_0x6894e6) { const _0x15169b = _0xbc3280, _0x36c904 = _0x5a8ee7(_0x6894e6); if (!_0x36c904) return; const _0x233d35 = _0x5c6c54['chats']['find'](_0x289863 => _0x289863[_0x15169b(0x443)] === _0x15169b(0x77d) && _0x289863[_0x15169b(0x594)][_0x15169b(0x87c)](_0x6894e6)), _0x363f31 = _0x4771d7(_0x233d35['id']), _0x4dda92 = _0x5c6c54[_0x15169b(0x3b6)][_0x15169b(0x25b)](_0x37d77a => _0x37d77a['isOffline'])[_0x15169b(0x210)](), _0x2a46c1 = document[_0x15169b(0x5d9)](_0x15169b(0x8c9)), _0xd14049 = document[_0x15169b(0x5d9)](_0x15169b(0x556)); let _0x369153 = null; if (_0x4dda92) { if (_0x4dda92[_0x15169b(0x5a8)] === _0x15169b(0x535)) { const _0x1ff352 = _0x5c6c54[_0x15169b(0x773)][_0x6894e6]; _0x1ff352 && _0x1ff352[_0x15169b(0x794)] > 0x0 && (_0x369153 = _0x1ff352['at'](-0x1)); } else { if (_0x15169b(0x182) !== 'rsUKk') _0x369153 = { 'speaker': _0x363f31[_0x15169b(0x82e)], 'line': _0x4dda92[_0x15169b(0x283)], 'emotion': _0x15169b(0x63f) }; else { _0x36d673[_0x15169b(0x863)]('错误：第一个好友圈\x20\x22' + _0x4eb919[_0x15169b(0x82e)] + _0x15169b(0x418)); return; } } } _0x369153 ? 'gPtHe' !== _0x15169b(0x4b2) ? (_0x2a46c1['textContent'] = _0x369153[_0x15169b(0x28b)] === _0x15169b(0x494) ? '旁白' : _0x369153['speaker'], _0xd14049[_0x15169b(0x41a)] = _0x369153[_0x15169b(0x475)], _0x369153[_0x15169b(0x28b)] === _0x36c904['name'] ? _0x15169b(0x1a8) === _0x15169b(0x2de) ? _0x3d5aa9 = _0x489285(() => { const _0x55b898 = _0x15169b; if (_0x1cf301[_0x55b898(0x443)] === _0x55b898(0x16d)) _0x82ff3d[_0x55b898(0x7ac)](); _0xa298e3(_0x35d70a); }, 0x320) : _0x448953(_0x6894e6, _0x369153[_0x15169b(0x203)]) : _0x448953(_0x6894e6, _0x15169b(0x63f))) : (_0x104d3a[_0x15169b(0x3fc)]['color'] = _0x15169b(0x201), _0x26c0c3['style'][_0x15169b(0x88e)] = _0x15169b(0x860)) : _0x15169b(0x461) !== _0x15169b(0x461) ? _0x3c9b55(_0x2c9ee4['id'], _0x144754['map'](_0x4c2da8 => _0x4c2da8['id'])) : (_0x2a46c1[_0x15169b(0x41a)] = _0x36c904[_0x15169b(0x82e)], _0xd14049[_0x15169b(0x41a)] = '（开始一段新的对话...）', _0x448953(_0x6894e6, 'normal')); } function _0x10409c() { const _0x102a41 = _0xbc3280, _0x386116 = new Date(), _0x187f07 = document[_0x102a41(0x5d9)]('galgame-time'), _0x3ed2af = document[_0x102a41(0x5d9)](_0x102a41(0x38a)); if (_0x187f07 && _0x3ed2af) { const _0x34c6e4 = String(_0x386116[_0x102a41(0x200)]())[_0x102a41(0x3c3)](0x2, '0'), _0x208b89 = String(_0x386116[_0x102a41(0x31f)]())[_0x102a41(0x3c3)](0x2, '0'); _0x187f07['textContent'] = _0x34c6e4 + ':' + _0x208b89; const _0x557679 = _0x386116['getMonth']() + 0x1, _0x1bd423 = _0x386116[_0x102a41(0x425)](), _0x23657a = [_0x102a41(0x4e5), _0x102a41(0x2dd), _0x102a41(0x3ef), _0x102a41(0x75a), '星期四', _0x102a41(0x265), '星期六'][_0x386116[_0x102a41(0x838)]()]; _0x3ed2af['textContent'] = _0x557679 + '月' + _0x1bd423 + '日\x20' + _0x23657a; } } const _0x156648 = document[_0xbc3280(0x5d9)](_0xbc3280(0x790)), _0x547081 = document[_0xbc3280(0x5d9)](_0xbc3280(0x861)), _0x181dd8 = document[_0xbc3280(0x5d9)](_0xbc3280(0x6c3)), _0x349af0 = document['getElementById'](_0xbc3280(0x2ce)), _0x56d563 = document[_0xbc3280(0x5d9)](_0xbc3280(0x882)), _0x50a4ab = document['getElementById'](_0xbc3280(0x3f2)), _0x2f4ce1 = document['getElementById']('listen-together-ui'), _0x2b3433 = document[_0xbc3280(0x5d9)](_0xbc3280(0x20a)), _0x50775c = document[_0xbc3280(0x5d9)](_0xbc3280(0x4d4)); let _0x2309fc = []; async function _0x5caa2c() { const _0x511dc8 = _0xbc3280; if (!_0x5c6c54['activeChatId']) return; _0x56d563[_0x511dc8(0x497)] = _0x511dc8(0x2ad), _0x156648['classList'][_0x511dc8(0x821)]('show'); const _0x3e6ac0 = await _0x5de717(); if (_0x3e6ac0[_0x511dc8(0x794)] === 0x0) { _0x56d563['innerHTML'] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的音乐库还是空的，没法邀请别人一起听。</p>'; return; } _0x56d563[_0x511dc8(0x497)] = '', _0x3e6ac0[_0x511dc8(0x691)](_0x3e6c2f => { const _0x282bb3 = _0x511dc8; if (_0x282bb3(0x6d8) !== _0x282bb3(0x6d8)) { if (_0x5e7574[_0x282bb3(0x7da)][_0x282bb3(0x6f2)](_0x282bb3(0x5d1))) return; const _0x4f5886 = _0x1ae053[_0x282bb3(0x5d9)]('widget-play-pause-btn'); _0x4f5886 && _0x4f5886['click'](); } else { const _0x9610a9 = document[_0x282bb3(0x628)](_0x282bb3(0x172)); _0x9610a9[_0x282bb3(0x63a)] = _0x282bb3(0x366); const _0x4b35a4 = _0x3e6c2f[_0x282bb3(0x7d9)] ? URL[_0x282bb3(0x78a)](_0x3e6c2f['cover']) : _0x166d38; _0x9610a9[_0x282bb3(0x497)] = _0x282bb3(0x53a) + _0x4b35a4 + '\x22\x20class=\x22music-library-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-title\x22>' + (_0x3e6c2f[_0x282bb3(0x29d)][_0x282bb3(0x6b8)] || _0x282bb3(0x533)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-artist\x22>' + (_0x3e6c2f['info']['歌手'] || _0x282bb3(0x3f9)) + _0x282bb3(0x14d), _0x9610a9['addEventListener']('click', () => { _0x3f63d3(_0x3e6c2f); }), _0x56d563[_0x282bb3(0x2c8)](_0x9610a9); } }); } function _0x2c277e() { const _0x5df129 = _0xbc3280; if (_0x5df129(0x46d) === 'uxsps') { const _0x2486a0 = _0x3d0377['content'] ? '\x20' + _0x2f0c11[_0x5df129(0x283)] : ''; _0x1400e5['push']('[' + _0x5bd65e(_0x3d7aba) + _0x5df129(0x584) + _0x2486a0); } else _0x156648[_0x5df129(0x7a1)][_0x5df129(0x8a2)](_0x5df129(0x274)); } async function _0x3f63d3(_0x2a5818) { const _0x1c46ef = _0xbc3280; if (!_0x5c6c54[_0x1c46ef(0x728)] || !_0x2a5818) return; let _0x4cd4ef = null; if (_0x2a5818['cover']) try { _0x4cd4ef = await _0x51083d(_0x2a5818[_0x1c46ef(0x7d9)]); } catch (_0x327135) { _0x1c46ef(0x7f5) === _0x1c46ef(0x7f5) ? (console[_0x1c46ef(0x863)](_0x1c46ef(0x3b7), _0x327135), _0x4cd4ef = _0x166d38) : _0x4daac4[_0x1c46ef(0x863)](_0x1c46ef(0x889), _0x3c3dc7); } const _0xa4d638 = { 'role': _0x1c46ef(0x845), 'type': _0x1c46ef(0x3f0), 'content': _0x1c46ef(0x2cf) + _0x2a5818['info'][_0x1c46ef(0x6b8)] + ']', 'songId': _0x2a5818['id'], 'songName': _0x2a5818['info'][_0x1c46ef(0x6b8)], 'artist': _0x2a5818[_0x1c46ef(0x29d)]['歌手'], 'coverUrl': _0x4cd4ef, 'timestamp': Date[_0x1c46ef(0x7a5)]() }; _0x5c6c54['conversationHistory'][_0x1c46ef(0x43f)](_0xa4d638), _0xcef02c(), _0x1fa1ad(), _0x2c277e(), setTimeout(_0x1271c6, 0x64); } _0x547081['addEventListener'](_0xbc3280(0x36d), _0x5caa2c), _0x181dd8[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x2c277e), _0x349af0[_0xbc3280(0x73c)](_0xbc3280(0x36d), _0x2c277e); async function _0xadfe01(_0x5756ef, _0x3ef419, _0x5b8b7b) { const _0x10e9eb = _0xbc3280; if (_0x10e9eb(0x34e) === _0x10e9eb(0x34e)) { const _0x5b0b3b = _0x5c6c54['chats'][_0x10e9eb(0x659)](_0x511dd1 => _0x511dd1['activeListenSession'] && _0x511dd1[_0x10e9eb(0x49b)][_0x10e9eb(0x3a5)]); if (_0x5b0b3b && _0x5b0b3b['id'] !== _0x5c6c54[_0x10e9eb(0x728)]) _0x10e9eb(0x89a) !== _0x10e9eb(0x89a) ? _0x509a74[_0x10e9eb(0x3cd)](_0x10e9eb(0x3e4), _0x10dcc1[_0x10e9eb(0x79c)]({ 'playlist': _0x4f724c['musicPlaylist'], 'currentIndex': _0x101e37[_0x10e9eb(0x5c1)] })) : (_0x5b0b3b[_0x10e9eb(0x49b)] = null, _0x13197e(_0x10e9eb(0x465)), _0xbd25a6()); else { if (_0x5b0b3b && _0x5b0b3b['id'] === _0x5c6c54[_0x10e9eb(0x728)]) { if (_0x10e9eb(0x86a) !== _0x10e9eb(0x879)) { _0x13197e(_0x10e9eb(0x7fe)); return; } else _0x1b108a[_0x10e9eb(0x863)]('保存徽章状态失败', _0xa66740); } } _0x3168b5(!![], _0x10e9eb(0x574)); const _0x22493a = _0x1e26a8(); if (!_0x22493a) { if (_0x10e9eb(0x800) === _0x10e9eb(0x800)) { _0x3168b5(![]), _0x13197e(_0x10e9eb(0x793)); return; } else _0x118442(_0x12ef3e['imageId'])[_0x10e9eb(0x2b1)](_0x4763d8 => { const _0x1a45be = _0x10e9eb; if (_0x4763d8) { const _0x2e6151 = _0x74de10[_0x1a45be(0x78a)](_0x4763d8); _0x585231[_0x1a45be(0x161)] = _0x2e6151, _0x53d8bd['onload'] = () => _0x21a5fa[_0x1a45be(0x3d1)](_0x2e6151); } else _0x1f5828[_0x1a45be(0x2d2)] = _0x1a45be(0x254); }); } const _0x48ad77 = await _0x39d202(_0x5756ef); if (!_0x48ad77) { _0x3168b5(![]), _0x13197e(_0x10e9eb(0x791)); return; } _0x22493a[_0x10e9eb(0x49b)] = { 'isActive': !![], 'songId': _0x5756ef, 'leaderId': _0x10e9eb(0x845), 'songName': _0x48ad77[_0x10e9eb(0x29d)]['歌曲名称'], 'artist': _0x48ad77[_0x10e9eb(0x29d)]['歌手'], 'cover': _0x48ad77['cover'] }, _0xbd25a6(), document[_0x10e9eb(0x5d9)](_0x10e9eb(0x897))[_0x10e9eb(0x161)] = _0x48ad77[_0x10e9eb(0x7d9)] ? URL[_0x10e9eb(0x78a)](_0x48ad77['cover']) : _0x166d38, document[_0x10e9eb(0x5d9)](_0x10e9eb(0x67f))[_0x10e9eb(0x41a)] = _0x48ad77[_0x10e9eb(0x29d)]['歌曲名称'], document[_0x10e9eb(0x5d9)](_0x10e9eb(0x43e))[_0x10e9eb(0x41a)] = _0x48ad77[_0x10e9eb(0x29d)]['歌手'], _0x3a415b(_0x48ad77), _0x2f4ce1[_0x10e9eb(0x3fc)]['display'] = _0x10e9eb(0x1d8), setTimeout(() => _0x2f4ce1[_0x10e9eb(0x7a1)][_0x10e9eb(0x821)]('show'), 0xa), _0x5b8b7b['innerHTML'] = _0x10e9eb(0x59b) + _0x5b8b7b[_0x10e9eb(0x85e)](_0x10e9eb(0x507))['outerHTML'], _0x5c6c54[_0x10e9eb(0x3b6)][_0x3ef419] && (_0x5c6c54[_0x10e9eb(0x3b6)][_0x3ef419][_0x10e9eb(0x545)] = !![], _0xcef02c()), _0x3168b5(![]), _0xa81322(_0x5756ef, [_0x5756ef]), _0x3715b6(_0x48ad77, !![]); } else { const _0x364438 = _0x1fafd5[_0x44f272]; if (typeof _0x364438 === _0x10e9eb(0x6a1)) _0x39f7c2[_0x10e9eb(0x43f)](_0x364438); if (_0x23b464[_0x10e9eb(0x1ab)](_0x364438)) _0x364438[_0x10e9eb(0x691)](_0x5c1659 => { const _0x525f64 = _0x10e9eb; if (typeof _0x5c1659 === _0x525f64(0x6a1)) _0x2a03b2['push'](_0x5c1659); }); } } function _0x33a590() { const _0x47567f = _0xbc3280, _0x2a7fc0 = _0x5c6c54[_0x47567f(0x1ce)][_0x47567f(0x659)](_0x36cc5c => _0x36cc5c['activeListenSession'] && _0x36cc5c[_0x47567f(0x49b)][_0x47567f(0x3a5)]); _0x2a7fc0 && (_0x2a7fc0['activeListenSession'] = null, _0xbd25a6(), _0x13197e('同步已断开。'), _0x3715b6(), _0x2f4ce1['classList'][_0x47567f(0x8a2)](_0x47567f(0x274)), setTimeout(() => _0x2f4ce1[_0x47567f(0x3fc)][_0x47567f(0x74d)] = _0x47567f(0x860), 0x12c)); } function _0x1221cd(_0x40ee47) { const _0x484b09 = _0xbc3280; if (!_0x40ee47) return []; const _0x3ed059 = _0x40ee47[_0x484b09(0x8d5)]('\x0a'), _0x2050d8 = [], _0x52dd3f = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x4cfb40 of _0x3ed059) { const _0x3ed94b = _0x4cfb40['match'](_0x52dd3f); if (_0x3ed94b) { if (_0x484b09(0x42e) === _0x484b09(0x74c)) _0x5c2c8e[_0x484b09(0x7a1)][_0x484b09(0x8a2)]('playing'); else { const _0x4be75b = parseInt(_0x3ed94b[0x1], 0xa), _0x3e7f87 = parseInt(_0x3ed94b[0x2], 0xa), _0xdcaccd = parseInt(_0x3ed94b[0x3], 0xa) * (_0x3ed94b[0x3][_0x484b09(0x794)] === 0x2 ? 0xa : 0x1), _0x19462e = _0x4be75b * 0x3c + _0x3e7f87 + _0xdcaccd / 0x3e8, _0x34a0ca = _0x4cfb40[_0x484b09(0x41f)](_0x52dd3f, '')[_0x484b09(0x42f)](); if (_0x34a0ca) { if (_0x484b09(0x1d0) !== _0x484b09(0x2f8)) _0x2050d8[_0x484b09(0x43f)]({ 'time': _0x19462e, 'text': _0x34a0ca }); else { _0x432847[_0x484b09(0x497)] = _0x484b09(0x7c0); return; } } } } } return _0x2050d8; } function _0x3a415b(_0xac5533) { const _0x3932be = _0xbc3280; _0x2309fc = _0x1221cd(_0xac5533['lyrics']), _0x50775c[_0x3932be(0x497)] = ''; if (_0x2309fc[_0x3932be(0x794)] === 0x0) { _0x50775c[_0x3932be(0x497)] = '<p\x20class=\x22no-lyrics-placeholder\x22\x20style=\x22opacity:\x201;\x22>暂无歌词</p>'; return; } _0x2309fc[_0x3932be(0x691)]((_0x5d8763, _0x536d03) => { const _0xb7b69c = _0x3932be, _0x1cdb36 = document['createElement']('p'); _0x1cdb36['textContent'] = _0x5d8763['text'], _0x1cdb36['id'] = _0xb7b69c(0x8b5) + _0x536d03, _0x50775c[_0xb7b69c(0x2c8)](_0x1cdb36); }); } function _0x1bf3ce() { const _0x4f46bc = _0xbc3280; if (_0x2309fc['length'] === 0x0) return; const _0x4db78e = _0x50a4ab[_0x4f46bc(0x1ad)]; let _0x354762 = -0x1; for (let _0x32b0e5 = 0x0; _0x32b0e5 < _0x2309fc[_0x4f46bc(0x794)]; _0x32b0e5++) { if (_0x4db78e >= _0x2309fc[_0x32b0e5][_0x4f46bc(0x2a4)]) _0x354762 = _0x32b0e5; else { if (_0x4f46bc(0x26e) !== _0x4f46bc(0x1d1)) break; else return ''; } } if (_0x354762 !== -0x1) { const _0x7636c8 = _0x50775c['querySelectorAll']('p'); _0x7636c8[_0x4f46bc(0x691)](_0x361c70 => _0x361c70[_0x4f46bc(0x7a1)]['remove'](_0x4f46bc(0x39d))); const _0x44b907 = document['getElementById'](_0x4f46bc(0x8b5) + _0x354762); _0x44b907 && (_0x44b907[_0x4f46bc(0x7a1)][_0x4f46bc(0x821)](_0x4f46bc(0x39d)), _0x44b907[_0x4f46bc(0x437)]({ 'behavior': _0x4f46bc(0x3c9), 'block': _0x4f46bc(0x750) })); } } _0x2b3433['addEventListener']('click', () => { const _0xd2ac05 = _0xbc3280; _0xd2ac05(0x412) === _0xd2ac05(0x412) ? (_0x2f4ce1[_0xd2ac05(0x7a1)]['remove'](_0xd2ac05(0x274)), setTimeout(() => _0x2f4ce1[_0xd2ac05(0x3fc)][_0xd2ac05(0x74d)] = _0xd2ac05(0x860), 0x12c)) : (_0x296caa(_0x51ae47), _0x5df57e[_0xd2ac05(0x2d3)](_0xd2ac05(0x7db), _0x3051ff), _0xfdea6c[_0xd2ac05(0x2d3)]('error', _0x4f9db8), _0x3ee29b[_0xd2ac05(0x161)] = '', _0x479277[_0xd2ac05(0x8a2)]()); }), document[_0xbc3280(0x5d9)]('music-widget-card')[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0x3e7827 = _0xbc3280; _0x5c6c54[_0x3e7827(0x296)] && _0x5c6c54[_0x3e7827(0x296)][_0x3e7827(0x3a5)] && (_0x2f4ce1[_0x3e7827(0x3fc)][_0x3e7827(0x74d)] = _0x3e7827(0x1d8), setTimeout(() => _0x2f4ce1[_0x3e7827(0x7a1)]['add'](_0x3e7827(0x274)), 0xa)); }), _0x50a4ab[_0xbc3280(0x73c)](_0xbc3280(0x89f), _0x1bf3ce); const _0x43d993 = document[_0xbc3280(0x5d9)](_0xbc3280(0x353)), _0x855b56 = document[_0xbc3280(0x5d9)](_0xbc3280(0x51b)), _0x478936 = document[_0xbc3280(0x5d9)]('widget-prev-btn'); _0x43d993[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0x2c4533 = _0xbc3280; _0x50a4ab[_0x2c4533(0x161)] && (_0x50a4ab[_0x2c4533(0x258)] ? 'veRlT' === _0x2c4533(0x6d4) ? (_0x63971f[_0x2c4533(0x863)](_0x2c4533(0x23b), _0x3fe556), _0x6f7874(_0x2c4533(0x42c))) : _0x50a4ab[_0x2c4533(0x1b1)]() : _0x50a4ab['pause']()); }), _0x855b56[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0x1baab9 = _0xbc3280; if (_0x324501['length'] === 0x0) return; _0x3b54c7 = (_0x3b54c7 + 0x1) % _0x324501[_0x1baab9(0x794)], _0xa81322(_0x324501[_0x3b54c7], _0x324501); }), _0x478936[_0xbc3280(0x73c)]('click', () => { const _0xadb6ac = _0xbc3280; if (_0xadb6ac(0x325) === _0xadb6ac(0x325)) { if (_0x324501[_0xadb6ac(0x794)] === 0x0) return; _0x3b54c7 = (_0x3b54c7 - 0x1 + _0x324501[_0xadb6ac(0x794)]) % _0x324501[_0xadb6ac(0x794)], _0xa81322(_0x324501[_0x3b54c7], _0x324501); } else return _0xa7e096[_0xadb6ac(0x24a)][_0xadb6ac(0x659)](_0x42e952 => _0x42e952['id'] === _0x26d9b8); }), _0x50a4ab[_0xbc3280(0x73c)](_0xbc3280(0x1b1), () => { const _0x583a25 = _0xbc3280; _0x43d993[_0x583a25(0x41a)] = '❚❚'; }), _0x50a4ab[_0xbc3280(0x73c)](_0xbc3280(0x2cd), () => { const _0x17aa24 = _0xbc3280; if (_0x17aa24(0x52c) !== 'qydtW') { const _0x403fb9 = _0x3f501a[_0x17aa24(0x628)](_0x17aa24(0x62a)); _0x403fb9['src'] = _0x382300[_0x17aa24(0x5e3)], _0x403fb9['loading'] = _0x17aa24(0x881), _0x403fb9[_0x17aa24(0x15c)] = _0x2fc81e[_0x17aa24(0x82e)], _0x403fb9[_0x17aa24(0x7a1)][_0x17aa24(0x821)](_0x17aa24(0x67e)), _0x403fb9[_0x17aa24(0x73c)](_0x17aa24(0x36d), () => _0x40e124(_0x5268f1)), _0x169955['appendChild'](_0x403fb9); } else _0x43d993[_0x17aa24(0x41a)] = '▶'; }), _0x50a4ab[_0xbc3280(0x73c)](_0xbc3280(0x211), () => { const _0x39dc06 = _0xbc3280; _0x855b56[_0x39dc06(0x36d)](); }), _0x50a4ab[_0xbc3280(0x73c)](_0xbc3280(0x1b1), () => { const _0x4f5889 = _0xbc3280; if (_0x4f5889(0x4f4) === _0x4f5889(0x4f4)) { const _0x4b7c24 = document[_0x4f5889(0x5d9)](_0x4f5889(0x7a4)); if (_0x4b7c24) _0x4b7c24[_0x4f5889(0x41a)] = '❚❚'; } else { if (!_0x5a343d[_0x4f5889(0x295)]) return; _0x2b2536[_0x4f5889(0x41a)] = _0x4f5889(0x723) + _0x187dd6[_0x4f5889(0x295)][_0x4f5889(0x259)], _0x13aa66[_0x4f5889(0x41a)] = _0x1471e7[_0x4f5889(0x295)][_0x4f5889(0x283)], _0x24ed1f[_0x4f5889(0x3fc)][_0x4f5889(0x74d)] = _0x4f5889(0x38f); } }), _0x50a4ab[_0xbc3280(0x73c)]('pause', () => { const _0x155cbe = _0xbc3280, _0x53bcb5 = document[_0x155cbe(0x5d9)](_0x155cbe(0x7a4)); if (_0x53bcb5) _0x53bcb5['textContent'] = '▶'; }), _0x50a4ab['addEventListener'](_0xbc3280(0x211), () => { const _0x1b4c79 = _0xbc3280, _0x34e2ca = document[_0x1b4c79(0x5d9)](_0x1b4c79(0x875)); _0x34e2ca && _0x34e2ca[_0x1b4c79(0x36d)](); }); async function _0xf60ab2() { const _0x25226b = _0xbc3280, _0xa29af3 = [..._0x4025a8]; try { const _0x154b3a = localStorage['getItem'](_0x25226b(0x88a)); if (_0x154b3a) { if (_0x25226b(0x31a) === _0x25226b(0x6f5)) { const _0x293b34 = _0x1470ab['senderId'] ? _0x4762bd(_0x486480[_0x25226b(0x2a6)]) : null; return _0x293b34?.['name'] || _0x25226b(0x3a7); } else { const _0x4c3677 = JSON[_0x25226b(0x5b7)](_0x154b3a); if (Array[_0x25226b(0x1ab)](_0x4c3677)) _0x24d29a = [..._0xa29af3, ..._0x4c3677]; else { if (_0x25226b(0x870) !== _0x25226b(0x870)) { const { playlist: _0x2a08c3, currentIndex: _0x1d5389 } = _0x477d5c[_0x25226b(0x5b7)](_0x43adff); _0xe24e34[_0x25226b(0x1ab)](_0x2a08c3) && _0x2a08c3['length'] > 0x0 && _0x1d5389 > -0x1 && (_0x49fa5c[_0x25226b(0x67a)] = _0x2a08c3, _0x30535b[_0x25226b(0x5c1)] = _0x1d5389, _0xc87660[_0x25226b(0x21b)] = ![], _0x501408()); } else _0x24d29a = _0xa29af3; } } } else _0x25226b(0x695) === _0x25226b(0x1aa) ? (_0x30890d[_0x25226b(0x3fc)][_0x25226b(0x74d)] = _0x25226b(0x860), _0x573632[_0x25226b(0x3fc)][_0x25226b(0x74d)] = 'block') : _0x24d29a = _0xa29af3; } catch (_0x46de5b) { console[_0x25226b(0x863)](_0x25226b(0x239), _0x46de5b), _0x24d29a = _0xa29af3; } if (!localStorage[_0x25226b(0x24e)](_0x25226b(0x5c8))) { _0x458a99(_0x25226b(0x72b))[_0x25226b(0x2b1)](async _0x5c7c2f => { const _0x211be0 = _0x25226b; _0x5c7c2f ? (_0x3168b5(!![], _0x211be0(0x238)), await _0x5127f7(), localStorage['setItem']('noir_data_migration_v1_complete', _0x211be0(0x893)), _0x3168b5(![]), _0x13197e(_0x211be0(0x20f)), setTimeout(() => location['reload'](), 0x5dc)) : _0x13197e('升级已取消。旧版图片数据可能导致应用卡顿或出错。'); }); return; } if (!localStorage[_0x25226b(0x24e)](_0x25226b(0x892))) { if (_0x25226b(0x563) !== _0x25226b(0x563)) { const _0x24da47 = _0x594fc1[_0x25226b(0x48c)][_0x25226b(0x659)](_0x131c56 => _0x131c56['id'] === _0x2414cf); _0x24da47 && (_0x24da47['name'] = _0x5c231c, _0x24da47[_0x25226b(0x41c)] = _0x2fc991, _0x24da47[_0x25226b(0x6b1)] = _0x25d921); } else { console[_0x25226b(0x384)]('执行好友圈数据净化...'), _0x3168b5(!![], _0x25226b(0x483)); const _0x29e63a = await _0x47cc25(); localStorage[_0x25226b(0x3cd)](_0x25226b(0x892), _0x25226b(0x893)), _0x3168b5(![]); if (_0x29e63a > 0x0) { if ('iEYZL' === _0x25226b(0x4e7)) { const _0x597703 = _0x50b424[_0x25226b(0x283)]['match'](/：(.*?)]$/); _0x1b3cf7[_0x25226b(0x283)] = _0x25226b(0x45f) + (_0x597703 ? _0x597703[0x1] : _0x25226b(0x450)) + ']', _0x5946b7[_0x25226b(0x43f)](_0x12b0e4); } else { _0x13197e(_0x25226b(0x302) + _0x29e63a + _0x25226b(0x436)), setTimeout(() => location[_0x25226b(0x1f8)](), 0x5dc); return; } } } } const _0x1e779a = _0x4056b9(); _0x187633(), _0x40cb8f(), _0x26a3c6(), _0x44d037(), _0x4459d2(), _0x2492ae(), _0x3e5637(), _0x593d66(), _0x35fb03(), _0x5b21c3(), _0x3715b6(), _0x30a0fb(), setInterval(_0x30a0fb, 0x7530), _0x193e71(), _0x11cd8d(), _0x1a4276(); const _0x105f2b = document['getElementById'](_0x25226b(0x6a5)); document[_0x25226b(0x5d9)](_0x25226b(0x82d))[_0x25226b(0x73c)](_0x25226b(0x36d), function (_0x40161d) { const _0x93f492 = _0x25226b; if (_0x40161d[_0x93f492(0x7da)][_0x93f492(0x6f2)](_0x93f492(0x5d1))) { if (_0x93f492(0x404) === 'HaFnw') return; else return; } const _0x165d8b = document[_0x93f492(0x5d9)](_0x93f492(0x353)); _0x165d8b && _0x165d8b[_0x93f492(0x36d)](); }), _0x4ed1c4('home', _0x25226b(0x6f3)); if (_0x1e779a || _0x5c6c54[_0x25226b(0x24a)][_0x25226b(0x794)] === 0x0) { if (_0x25226b(0x581) !== _0x25226b(0x580)) _0x13197e(_0x25226b(0x72c)), setTimeout(() => { const _0x276ce9 = _0x25226b; _0x4ed1c4(_0x276ce9(0x2da), _0x276ce9(0x402)), setTimeout(() => _0x39e026(), 0x64); }, 0x6a4); else return _0x335497(_0x5c63ac)[_0x25226b(0x2b1)](_0x129909 => _0x129909[_0x25226b(0x2b5)]()); } const _0xe150dd = document['getElementById'](_0x25226b(0x3a9)); document[_0x25226b(0x5d9)]('upload-widget-bg-button')['addEventListener'](_0x25226b(0x36d), () => _0xe150dd[_0x25226b(0x36d)]()), document[_0x25226b(0x5d9)](_0x25226b(0x745))['addEventListener']('click', () => { const _0x462412 = _0x25226b; _0x5c6c54[_0x462412(0x778)]['widgetBgImage'] = null, _0xbd25a6(), _0x193e71(), _0x13197e(_0x462412(0x410)); }), _0xe150dd['addEventListener'](_0x25226b(0x288), async _0x3b4675 => { const _0x1eee51 = _0x25226b, _0x1bbfa5 = _0x3b4675[_0x1eee51(0x7da)][_0x1eee51(0x3ad)][0x0]; if (!_0x1bbfa5) return; try { if (_0x1eee51(0x53d) !== _0x1eee51(0x53d)) _0x514345 = _0x1eee51(0x4fc), _0xbc855 = _0x1eee51(0x2e1); else { const _0x535e83 = await _0x2da880(_0x1bbfa5); _0x5c6c54[_0x1eee51(0x778)][_0x1eee51(0x271)] = _0x535e83, _0xbd25a6(), _0x193e71(), _0x13197e(_0x1eee51(0x883)); } } catch (_0x221822) { if (_0x1eee51(0x4c3) !== 'WDrkU') { let _0x22dceb = _0x30ec05['querySelector'](_0x1eee51(0x2ec)); !_0x22dceb && (_0x22dceb = _0x226492[_0x1eee51(0x628)](_0x1eee51(0x172)), _0x22dceb[_0x1eee51(0x63a)] = _0x1eee51(0x643), _0x22dceb[_0x1eee51(0x41a)] = '对方正在输入...', _0xa9c983[_0x1eee51(0x2c8)](_0x22dceb)); } else _0x13197e('错误:\x20' + _0x221822['message']); } }), _0x264c49(), document[_0x25226b(0x5d9)](_0x25226b(0x573))[_0x25226b(0x73c)](_0x25226b(0x36d), () => document[_0x25226b(0x5d9)](_0x25226b(0x74a))[_0x25226b(0x36d)]()), document['getElementById']('reset-badge-button')[_0x25226b(0x73c)](_0x25226b(0x36d), async () => { const _0x289ac6 = _0x25226b; await _0x402038(_0x289ac6(0x5e5)), localStorage[_0x289ac6(0x5b3)](_0x289ac6(0x352)), _0x264c49(), _0x13197e(_0x289ac6(0x175)); }), document[_0x25226b(0x5d9)](_0x25226b(0x74a))['addEventListener'](_0x25226b(0x288), async _0x315694 => { const _0x310f64 = _0x25226b, _0xc97a93 = _0x315694[_0x310f64(0x7da)][_0x310f64(0x3ad)][0x0]; if (!_0xc97a93) return; try { if (_0x310f64(0x78e) !== _0x310f64(0x694)) await _0x1c943a(_0x310f64(0x5e5), _0xc97a93), await _0x264c49(), _0x13197e(_0x310f64(0x202)); else { const _0x519905 = _0x5d06ed(_0x51e011[_0x310f64(0x54c)]); _0x519905 && (_0x3de43d = _0x519905[_0x310f64(0x82e)], _0x5d7684 = _0x519905[_0x310f64(0x41e)]); } } catch (_0x37e2d9) { _0x13197e(_0x310f64(0x61e) + _0x37e2d9[_0x310f64(0x1a4)]); } }), _0x3eb75e(), document[_0x25226b(0x5d9)](_0x25226b(0x24b))[_0x25226b(0x73c)](_0x25226b(0x34c), _0x2271d4), document['getElementById'](_0x25226b(0x24b))[_0x25226b(0x73c)]('touchstart', _0x2271d4, { 'passive': ![] }), document['getElementById'](_0x25226b(0x220))[_0x25226b(0x73c)](_0x25226b(0x36d), () => document[_0x25226b(0x5d9)]('card-input')[_0x25226b(0x36d)]()), document[_0x25226b(0x5d9)]('reset-card-button')['addEventListener'](_0x25226b(0x36d), async () => { const _0x59ff66 = _0x25226b; await _0x402038('widget_card'), localStorage[_0x59ff66(0x5b3)](_0x59ff66(0x2ae)), _0x3eb75e(), _0x13197e('卡片已移除。'); }), document[_0x25226b(0x5d9)](_0x25226b(0x5f1))[_0x25226b(0x73c)](_0x25226b(0x288), async _0x5f5b50 => { const _0xf0198b = _0x25226b; if (_0xf0198b(0x799) === 'mJgMX') { const _0x40b6a0 = _0x4678ea[_0xf0198b(0x628)](_0xf0198b(0x172)); _0x40b6a0[_0xf0198b(0x63a)] = _0xf0198b(0x480); const _0x55b23a = _0xc48cf9['createElement'](_0xf0198b(0x172)); _0x55b23a[_0xf0198b(0x63a)] = _0xf0198b(0x5fc), _0x55b23a[_0xf0198b(0x41a)] = _0x4e171f[_0xf0198b(0x19d)]['sender']; const _0x11cf4d = _0x48b999[_0xf0198b(0x628)](_0xf0198b(0x172)); _0x11cf4d[_0xf0198b(0x63a)] = 'quoted-content', _0x11cf4d[_0xf0198b(0x41a)] = _0x356af6[_0xf0198b(0x19d)]['content'], _0x40b6a0[_0xf0198b(0x2c8)](_0x55b23a), _0x40b6a0[_0xf0198b(0x2c8)](_0x11cf4d), _0x225476['appendChild'](_0x40b6a0); } else { const _0x564836 = _0x5f5b50[_0xf0198b(0x7da)][_0xf0198b(0x3ad)][0x0]; if (!_0x564836) return; try { await _0x1c943a(_0xf0198b(0x1ca), _0x564836), await _0x3eb75e(), _0x13197e('卡片已更换！'); } catch (_0x440588) { _0x13197e(_0xf0198b(0x61e) + _0x440588[_0xf0198b(0x1a4)]); } } }), document[_0x25226b(0x5d9)](_0x25226b(0x3e2))[_0x25226b(0x73c)](_0x25226b(0x36d), async () => { const _0x39760d = _0x25226b, _0x12efc7 = await _0x458a99(_0x39760d(0x33b)); _0x12efc7 && (localStorage['removeItem'](_0x39760d(0x352)), localStorage[_0x39760d(0x5b3)](_0x39760d(0x5f7)), _0x13197e(_0x39760d(0x5b1)), setTimeout(() => location[_0x39760d(0x1f8)](), 0x3e8)); }); const _0x628ca3 = document[_0x25226b(0x5d9)]('app-diary'); _0x628ca3[_0x25226b(0x73c)](_0x25226b(0x36d), () => { const _0x1c3aa6 = _0x25226b; _0x4be5de(), _0x4ed1c4(_0x1c3aa6(0x61b), _0x1c3aa6(0x402)); }); const _0x140017 = document[_0x25226b(0x5d9)](_0x25226b(0x297)); _0x140017[_0x25226b(0x73c)](_0x25226b(0x36d), () => { const _0x2463fe = _0x25226b; _0x5674d6(), _0x4ed1c4(_0x2463fe(0x1f3), _0x2463fe(0x402)); }), document[_0x25226b(0x5d9)](_0x25226b(0x313))[_0x25226b(0x73c)](_0x25226b(0x36d), () => _0x4ed1c4('home', _0x25226b(0x1f3))), document[_0x25226b(0x5d9)](_0x25226b(0x4cf))[_0x25226b(0x73c)](_0x25226b(0x36d), () => _0x4ed1c4(_0x25226b(0x402), _0x25226b(0x61b))), document[_0x25226b(0x5d9)](_0x25226b(0x797))[_0x25226b(0x73c)](_0x25226b(0x36d), () => { const _0x2f8480 = _0x25226b; _0x5c6c54[_0x2f8480(0x6c5)] = null, _0x4ed1c4(_0x2f8480(0x61b), _0x2f8480(0x8c2)); }), document[_0x25226b(0x5d9)](_0x25226b(0x374))[_0x25226b(0x73c)]('click', _0x55d50e), document[_0x25226b(0x5d9)](_0x25226b(0x887))[_0x25226b(0x73c)](_0x25226b(0x36d), _0x5b1e46), document[_0x25226b(0x5d9)](_0x25226b(0x622))['addEventListener'](_0x25226b(0x23e), _0xef06cc => { const _0x52df96 = _0x25226b; if (_0x52df96(0x7ff) !== _0x52df96(0x596)) _0xef06cc['key'] === 'Enter' && !_0xef06cc['shiftKey'] && (_0xef06cc[_0x52df96(0x7ac)](), _0x55d50e()); else { _0x33eb7c[_0x52df96(0x863)](_0x52df96(0x538)); return; } }); const _0x52606b = ['normal', 'happy', _0x25226b(0x2b8), 'sad', _0x25226b(0x4b5)]; _0x52606b[_0x25226b(0x691)](_0x31ea70 => { const _0x51012b = _0x25226b, _0x3a6f8b = document[_0x51012b(0x5d9)](_0x51012b(0x47f) + _0x31ea70 + '-preview'), _0x392e23 = document['getElementById'](_0x51012b(0x47f) + _0x31ea70 + _0x51012b(0x293)); _0x3a6f8b && _0x392e23 && (_0x3a6f8b['addEventListener'](_0x51012b(0x36d), () => _0x392e23[_0x51012b(0x36d)]()), _0x392e23[_0x51012b(0x73c)](_0x51012b(0x288), async _0x41892e => { const _0x1196ab = _0x51012b; if (_0x1196ab(0x4d1) === _0x1196ab(0x3d5)) { const _0xd280e5 = _0x2a279a[_0x1196ab(0x5d9)](_0x1196ab(0x300)); if (!_0xd280e5) return; const _0x191737 = _0x4a1509['getItem'](_0x1196ab(0x7a9)) || '35'; _0x4182f5[_0x1196ab(0x5bf)][_0x1196ab(0x3fc)][_0x1196ab(0x41b)](_0x1196ab(0x3a1), _0x191737), _0xd280e5[_0x1196ab(0x5a5)] = _0x191737, _0xd280e5['addEventListener']('input', () => { const _0x4a31d5 = _0x1196ab, _0x3c9b6c = _0xd280e5[_0x4a31d5(0x5a5)]; _0x5915fe['documentElement'][_0x4a31d5(0x3fc)]['setProperty'](_0x4a31d5(0x3a1), _0x3c9b6c), _0x380152[_0x4a31d5(0x3cd)](_0x4a31d5(0x7a9), _0x3c9b6c), _0x95c852(); }); } else { const _0x238332 = _0x41892e[_0x1196ab(0x7da)]['files'][0x0]; if (!_0x238332) return; try { _0x3a6f8b[_0x1196ab(0x161)] = URL[_0x1196ab(0x78a)](_0x238332); } catch (_0x2f7939) { _0x13197e('图片预览失败:\x20' + _0x2f7939[_0x1196ab(0x1a4)]); } } })); }), document[_0x25226b(0x5d9)](_0x25226b(0x1e4))[_0x25226b(0x73c)](_0x25226b(0x36d), _0x549336), document['getElementById'](_0x25226b(0x748))['addEventListener'](_0x25226b(0x36d), () => { const _0x499443 = _0x25226b; _0x5c6c54['meetingViewMode'] = _0x5c6c54[_0x499443(0x471)] === _0x499443(0x38c) ? _0x499443(0x1f1) : 'novel', _0x102d5d(); }), document[_0x25226b(0x5d9)]('meeting-scene-view')[_0x25226b(0x73c)](_0x25226b(0x34c), _0x14453b), document[_0x25226b(0x5d9)](_0x25226b(0x2f7))[_0x25226b(0x73c)]('touchstart', _0x14453b, { 'passive': ![] }); let _0xb31583 = null; function _0x14453b(_0x2f3057) { const _0x2657c4 = _0x25226b; if (_0xb31583) clearTimeout(_0xb31583); const _0x1ca136 = _0x2f3057[_0x2657c4(0x7da)][_0x2657c4(0x6f2)](_0x2657c4(0x405)); if (!_0x1ca136) return; const _0x2045e1 = parseInt(_0x1ca136[_0x2657c4(0x17f)][_0x2657c4(0x7a6)], 0xa); if (isNaN(_0x2045e1)) return; const _0x25ba82 = () => { _0xb31583 = setTimeout(() => { const _0x251c98 = _0x32ba; if (_0x2f3057[_0x251c98(0x443)] === _0x251c98(0x16d)) _0x2f3057['preventDefault'](); _0x1a2096(_0x2045e1); }, 0x320); }, _0x594b16 = () => { const _0x34588b = _0x2657c4; if (_0x34588b(0x1e1) !== 'CCaRc') _0x448628[_0x34588b(0x43f)]({ 'time': _0x2b4c89, 'text': _0x3a864d }); else { if (_0xb31583) clearTimeout(_0xb31583); } }; document[_0x2657c4(0x73c)]('mouseup', _0x594b16, { 'once': !![] }), document[_0x2657c4(0x73c)]('mouseleave', _0x594b16, { 'once': !![] }), document[_0x2657c4(0x73c)](_0x2657c4(0x3c8), _0x594b16, { 'once': !![] }), document[_0x2657c4(0x73c)](_0x2657c4(0x356), _0x594b16, { 'once': !![] }), _0x25ba82(); } document['body']['addEventListener'](_0x25226b(0x36d), _0x2bf9c8 => { const _0xbb6708 = _0x25226b, _0x5b2359 = _0x2bf9c8[_0xbb6708(0x7da)][_0xbb6708(0x6f2)](_0xbb6708(0x28a)); if (_0x5b2359) { const _0x5bd94b = _0x2bf9c8[_0xbb6708(0x7da)][_0xbb6708(0x6f2)](_0xbb6708(0x328)), _0x1709c6 = _0x2bf9c8[_0xbb6708(0x7da)]['closest'](_0xbb6708(0x243)); if (_0x5bd94b) _0x33a590(); else { if (_0x1709c6) { if (_0xbb6708(0x2c3) === _0xbb6708(0x8bc)) _0x531a1d['activeChatId'] = _0x18782c['id'], _0x571d4b(), _0x15c05e(), _0x47de7f(_0x808a57); else { const _0x5eabae = _0x1709c6[_0xbb6708(0x6f2)](_0xbb6708(0x342)), _0x36604d = _0x1709c6['dataset'][_0xbb6708(0x7a8)], _0xf2ac27 = parseInt(_0x5eabae[_0xbb6708(0x17f)]['historyIndex'], 0xa); _0xadfe01(_0x36604d, _0xf2ac27, _0x5b2359); } } else { if ('tiREu' !== _0xbb6708(0x80e)) { const _0x4cc3f1 = _0x1e26a8(); _0x4cc3f1 && _0x4cc3f1[_0xbb6708(0x49b)] && _0x4cc3f1[_0xbb6708(0x49b)][_0xbb6708(0x3a5)] && ('SOdAY' === _0xbb6708(0x67b) ? _0x44ae0c[_0xbb6708(0x41a)] = '❚❚' : (_0x2f4ce1[_0xbb6708(0x3fc)][_0xbb6708(0x74d)] = 'flex', setTimeout(() => _0x2f4ce1[_0xbb6708(0x7a1)][_0xbb6708(0x821)]('show'), 0xa))); } else _0x5b7363[_0xbb6708(0x7a1)][_0xbb6708(0x8a2)]('show'), _0x4ca93f[_0xbb6708(0x878)] = null, _0xa30f54[_0xbb6708(0x878)] = null, _0x2bd510[_0xbb6708(0x878)] = null, _0x5e1855['removeEventListener'](_0xbb6708(0x23e), _0x4d56c6), _0x2d6f36(_0x19db34); } } return; } if (window['getSelection']()['toString']()) return; const _0x1c7652 = _0x2bf9c8['target'][_0xbb6708(0x6f2)](_0xbb6708(0x342)); if (_0x1c7652 && !_0x2bf9c8[_0xbb6708(0x7da)][_0xbb6708(0x6f2)](_0xbb6708(0x1c6))) { if (_0xbb6708(0x464) !== 'XlHSR') { const _0xd32a2c = _0x5fdafe['getElementById'](_0xbb6708(0x589)); _0xd32a2c[_0xbb6708(0x497)] = ''; if (_0x284610[_0xbb6708(0x6bd)][_0xbb6708(0x794)] === 0x0) { _0xd32a2c['innerHTML'] = _0xbb6708(0x7f9); return; } _0x1accd3[_0xbb6708(0x6bd)][_0xbb6708(0x691)](_0x591c93 => { const _0xf52178 = _0xbb6708, _0x490f24 = _0x1c551f[_0xf52178(0x628)](_0xf52178(0x172)); _0x490f24[_0xf52178(0x63a)] = _0xf52178(0x88c), _0x490f24[_0xf52178(0x17f)]['id'] = _0x591c93['id'], _0x490f24[_0xf52178(0x497)] = _0xf52178(0x560) + _0x591c93[_0xf52178(0x82e)] + _0xf52178(0x3e6) + _0x591c93[_0xf52178(0x283)][_0xf52178(0x35b)](0x0, 0x64) + _0xf52178(0x7d5), _0x490f24['addEventListener'](_0xf52178(0x36d), () => _0x4ae4cc(_0x591c93['id'])), _0xd32a2c['appendChild'](_0x490f24); }); } else { const _0x56b431 = parseInt(_0x1c7652['dataset']['historyIndex'], 0xa); !isNaN(_0x56b431) && _0x1a2096(_0x56b431); } } }); const _0x11a1fe = document[_0x25226b(0x5d9)](_0x25226b(0x774)); _0x11a1fe && _0x11a1fe[_0x25226b(0x73c)](_0x25226b(0x36d), () => { const _0x3b1b89 = _0x25226b; _0x13197e(_0x3b1b89(0x56f)); }); const _0xe7bf = document[_0x25226b(0x5d9)](_0x25226b(0x3a2)), _0x2424d2 = localStorage[_0x25226b(0x24e)](_0x25226b(0x88a)); if (_0x2424d2) try { if (_0x25226b(0x645) === _0x25226b(0x645)) { const _0x27d069 = JSON[_0x25226b(0x5b7)](_0x2424d2); Array[_0x25226b(0x1ab)](_0x27d069) && (_0xe7bf[_0x25226b(0x5a5)] = _0x27d069[_0x25226b(0x2ac)](_0x5383e5 => _0x5383e5['name'] + '--' + _0x5383e5[_0x25226b(0x5e3)])[_0x25226b(0x5d2)]('\x0a')); } else return { 'type': _0x25226b(0x388), 'songName': _0x5b1e06[0x1][_0x25226b(0x42f)](), 'artist': _0x114f44[0x2][_0x25226b(0x42f)]() }; } catch (_0x3dc180) { } document[_0x25226b(0x5d9)](_0x25226b(0x272))[_0x25226b(0x73c)](_0x25226b(0x36d), () => { const _0x4b99f5 = _0x25226b, _0x5e07f3 = _0xe7bf[_0x4b99f5(0x5a5)], _0x1a2fbe = _0x5e07f3['split']('\x0a')[_0x4b99f5(0x25b)](_0x132b16 => _0x132b16[_0x4b99f5(0x42f)]() !== ''), _0x1818ed = []; let _0x13d4b3 = 0x0; for (const _0x2b4431 of _0x1a2fbe) { const _0x131b62 = _0x2b4431[_0x4b99f5(0x8d5)]('--'); _0x131b62[_0x4b99f5(0x794)] === 0x2 && _0x131b62[0x0][_0x4b99f5(0x42f)]() && _0x131b62[0x1][_0x4b99f5(0x42f)]()[_0x4b99f5(0x380)](_0x4b99f5(0x610)) ? _0x1818ed[_0x4b99f5(0x43f)]({ 'name': _0x131b62[0x0]['trim'](), 'url': _0x131b62[0x1][_0x4b99f5(0x42f)]() }) : _0x4b99f5(0x7e4) === _0x4b99f5(0x71d) ? _0x981333[_0x4b99f5(0x41a)] = _0x2870a9['from'](_0x4d28f2)[_0x4b99f5(0x2ac)](_0x590109 => _0x590109[_0x4b99f5(0x59c)][_0x4b99f5(0x41a)][_0x4b99f5(0x42f)]())[_0x4b99f5(0x5d2)]('、') : _0x13d4b3++; } _0x13d4b3 > 0x0 && _0x13197e('有\x20' + _0x13d4b3 + _0x4b99f5(0x6b6)); try { localStorage[_0x4b99f5(0x3cd)](_0x4b99f5(0x88a), JSON[_0x4b99f5(0x79c)](_0x1818ed)), _0x13197e(_0x4b99f5(0x49a)), setTimeout(() => location[_0x4b99f5(0x1f8)](), 0x5dc); } catch (_0x380405) { if (_0x4b99f5(0x57f) === 'PbZHA') _0x13197e(_0x4b99f5(0x39b)); else { const _0x319f53 = _0x294d50[_0x4b99f5(0x3b6)][_0x4b99f5(0x64d)](_0x120ebf); _0x319f53 > -0x1 && _0x4380a9(_0x4d7e79, _0x319f53); } } }); } const _0x567f27 = new Promise((_0x1a5804, _0x2b734f) => { const _0x26e65d = _0xbc3280, _0x29516b = indexedDB[_0x26e65d(0x798)](_0x47cd61, 0x2); _0x29516b[_0x26e65d(0x618)] = () => _0x2b734f('IndexedDB\x20failed\x20to\x20open'), _0x29516b[_0x26e65d(0x21f)] = () => _0x1a5804(_0x29516b[_0x26e65d(0x6bf)]); }), _0x30a6d2 = _0xbc3280(0x486); async function _0x39d202(_0x5154ab) { const _0x51e4ca = await _0x567f27; return new Promise((_0x329ae2, _0x21eb4b) => { const _0x14297 = _0x32ba, _0x2da209 = _0x51e4ca[_0x14297(0x52f)](_0x30a6d2, _0x14297(0x605)), _0x3a7b7f = _0x2da209[_0x14297(0x4ed)](_0x30a6d2), _0x5bd818 = _0x3a7b7f[_0x14297(0x5bc)](_0x5154ab); _0x5bd818['onsuccess'] = () => _0x329ae2(_0x5bd818[_0x14297(0x6bf)]), _0x5bd818[_0x14297(0x618)] = () => _0x21eb4b(_0x5bd818[_0x14297(0x863)]); }); } async function _0x5de717() { const _0x35c97e = _0xbc3280; if (_0x35c97e(0x572) !== _0x35c97e(0x572)) { _0x435d35[_0x35c97e(0x497)] = _0x35c97e(0x32e); return; } else { const _0x393ffc = await _0x567f27; return new Promise((_0x11414d, _0x350649) => { const _0x1d7e73 = _0x35c97e; if ('AsGKl' === _0x1d7e73(0x177)) { const _0x4e819d = _0x393ffc['transaction'](_0x30a6d2, _0x1d7e73(0x605)), _0x1f32c3 = _0x4e819d[_0x1d7e73(0x4ed)](_0x30a6d2), _0x449e84 = _0x1f32c3[_0x1d7e73(0x394)](); _0x449e84[_0x1d7e73(0x21f)] = () => _0x11414d(_0x449e84[_0x1d7e73(0x6bf)]), _0x449e84['onerror'] = () => _0x350649(_0x449e84[_0x1d7e73(0x863)]); } else _0x584033[_0x1d7e73(0x48c)] = _0x58492a[_0x1d7e73(0x48c)], _0x41e723['activeFriendCircleId'] = _0x53467e[_0x1d7e73(0x266)]; }); } } async function _0x36ddfd(_0x2b12e9) { const _0x22a3a0 = _0xbc3280; if (_0x22a3a0(0x4e1) !== _0x22a3a0(0x4ad)) { const _0x58e9bc = await _0x567f27; return new Promise((_0x3ef64b, _0x511072) => { const _0x4a796c = _0x22a3a0, _0xe4bd02 = _0x58e9bc['transaction'](_0x30a6d2, 'readwrite'), _0xe0112a = _0xe4bd02[_0x4a796c(0x4ed)](_0x30a6d2), _0x4367bc = _0xe0112a['put'](_0x2b12e9); _0x4367bc[_0x4a796c(0x21f)] = () => _0x3ef64b(_0x4367bc[_0x4a796c(0x6bf)]), _0x4367bc[_0x4a796c(0x618)] = () => _0x511072(_0x4367bc[_0x4a796c(0x863)]); }); } else _0x497de7 = '0x' + _0x339c1d[0x1] + _0x243833[0x1], _0x2d3f24 = '0x' + _0x400f22[0x2] + _0x2066a8[0x2], _0x4b8ed5 = '0x' + _0x3114b5[0x3] + _0x5f5888[0x3]; } async function _0x2b95c3(_0x23e4da) { const _0x4ba443 = await _0x567f27; return new Promise((_0x513320, _0x1f79b5) => { const _0x952ec9 = _0x32ba, _0x17f6e3 = _0x4ba443[_0x952ec9(0x52f)](_0x30a6d2, _0x952ec9(0x15d)), _0x136a3b = _0x17f6e3[_0x952ec9(0x4ed)](_0x30a6d2), _0x414add = _0x136a3b['delete'](_0x23e4da); _0x414add['onsuccess'] = () => _0x513320(), _0x414add[_0x952ec9(0x618)] = () => _0x1f79b5(_0x414add[_0x952ec9(0x863)]); }); } let _0xc11dfa = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; const _0x1bb7cf = { 'audio': document[_0xbc3280(0x5d9)]('altar-slot-audio'), 'cover': document[_0xbc3280(0x5d9)](_0xbc3280(0x603)), 'info': document[_0xbc3280(0x5d9)](_0xbc3280(0x257)), 'lyrics': document[_0xbc3280(0x5d9)]('altar-slot-lyrics') }, _0x4c95a3 = { 'audio': document['getElementById'](_0xbc3280(0x65b)), 'cover': document[_0xbc3280(0x5d9)](_0xbc3280(0x5a0)), 'info': document['getElementById'](_0xbc3280(0x44e)), 'lyrics': document['getElementById'](_0xbc3280(0x331)) }; for (const _0x2941f1 in _0x1bb7cf) { _0x1bb7cf[_0x2941f1][_0xbc3280(0x73c)](_0xbc3280(0x36d), () => _0x4c95a3[_0x2941f1][_0xbc3280(0x36d)]()), _0x4c95a3[_0x2941f1]['addEventListener'](_0xbc3280(0x288), _0x52dd00 => { const _0x31baa7 = _0xbc3280; _0x20a453(_0x2941f1, _0x52dd00[_0x31baa7(0x7da)]['files'][0x0]); }); } function _0x20a453(_0x3ca6a3, _0x27a998) { const _0x4621e0 = _0xbc3280; if (_0x4621e0(0x867) === _0x4621e0(0x867)) { if (!_0x27a998) return; _0xc11dfa[_0x3ca6a3] = _0x27a998, _0x1bb7cf[_0x3ca6a3]['querySelector'](_0x4621e0(0x568))[_0x4621e0(0x41a)] = _0x27a998[_0x4621e0(0x82e)], _0x1bb7cf[_0x3ca6a3]['classList'][_0x4621e0(0x821)](_0x4621e0(0x460)), _0x4ccec4(); } else _0x20cc05[_0x4621e0(0x161)] = _0x1fc55d[_0x4621e0(0x78a)](_0x48c752), _0x30ece5[_0x4621e0(0x3fc)][_0x4621e0(0x74d)] = 'block'; } function _0x4ccec4() { const _0x125571 = _0xbc3280; if (_0x125571(0x6f4) !== _0x125571(0x6f4)) { _0x5f32c1(_0x125571(0x6a7)); return; } else { const _0x1982fd = document['getElementById'](_0x125571(0x162)); if (_0xc11dfa[_0x125571(0x5ee)] && _0xc11dfa[_0x125571(0x29d)]) { if (_0x125571(0x6f0) !== _0x125571(0x2a8)) _0x1982fd[_0x125571(0x1d4)] = ![]; else { const _0x536126 = _0x125571(0x674); _0x22d5ba[_0x125571(0x4ec)]['insertAdjacentHTML'](_0x125571(0x371), _0x536126); const _0x5c4d09 = _0x1491ad[_0x125571(0x5d9)](_0x125571(0x427)), _0x5f4040 = _0x58a5a3[_0x125571(0x5d9)]('diary-modal-textarea'), _0xc16971 = _0x5ee978[_0x125571(0x5d9)](_0x125571(0x5fb)), _0x3394ec = _0x314c26[_0x125571(0x5d9)]('diary-modal-cancel'), _0x498060 = _0x5c4d09['querySelector'](_0x125571(0x1cc)), _0x1e0eff = () => { const _0x2ce895 = _0x125571; _0x5c4d09[_0x2ce895(0x8a2)](), _0x366f1d(); }; _0xc16971['onclick'] = () => { const _0x149611 = _0x125571; _0xa50834(_0x5f4040[_0x149611(0x5a5)]), _0x1e0eff(); }, _0x3394ec[_0x125571(0x878)] = _0x1e0eff, _0x498060[_0x125571(0x878)] = _0x1e0eff; } } else { if (_0x125571(0x73e) === _0x125571(0x73e)) _0x1982fd[_0x125571(0x1d4)] = !![]; else try { const _0x57cfa9 = _0x7817b0[_0x125571(0x5b7)](_0x50c917); _0x3dcde4[_0x125571(0x1ab)](_0x57cfa9) && (_0x18ec9b[_0x125571(0x5a5)] = _0x57cfa9[_0x125571(0x2ac)](_0x707bd9 => _0x707bd9[_0x125571(0x82e)] + '--' + _0x707bd9['url'])[_0x125571(0x5d2)]('\x0a')); } catch (_0x25d79a) { } } } } function _0x5a1890() { const _0x3717a2 = _0xbc3280; if ('lVzww' === 'lVzww') { _0xc11dfa = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x4ea7f6 in _0x1bb7cf) { 'yarLf' === _0x3717a2(0x8b8) ? _0x596e16('图片处理失败:\x20' + _0x2bd54c[_0x3717a2(0x1a4)]) : (_0x1bb7cf[_0x4ea7f6][_0x3717a2(0x7a1)][_0x3717a2(0x8a2)]('filled'), _0x4c95a3[_0x4ea7f6][_0x3717a2(0x5a5)] = ''); } _0x1bb7cf['audio'][_0x3717a2(0x85e)]('.slot-filename')['textContent'] = _0x3717a2(0x35e), _0x1bb7cf[_0x3717a2(0x7d9)]['querySelector']('.slot-filename')[_0x3717a2(0x41a)] = '点击选择\x20.jpg\x20或\x20.png', _0x1bb7cf['info'][_0x3717a2(0x85e)](_0x3717a2(0x568))[_0x3717a2(0x41a)] = _0x3717a2(0x789), _0x1bb7cf[_0x3717a2(0x771)][_0x3717a2(0x85e)]('.slot-filename')['textContent'] = _0x3717a2(0x17b), _0x4ccec4(); } else { _0x399ccc[_0x3717a2(0x7a1)]['add'](_0x3717a2(0x71b)); const _0x5d62b8 = _0x168214[_0x3717a2(0x5a8)] === 'user' ? _0x1706cd(_0x57659d[_0x3717a2(0x728)]) : _0x4bce00(_0x36cc78['senderId']), _0x123110 = _0x10f6ab[_0x3717a2(0x767)] === _0x129a55(_0x25598e['activeChatId'])['id'] ? _0x3d22e3(_0x4924f5[_0x3717a2(0x728)]) : _0x362ebe(_0x264595[_0x3717a2(0x767)]), _0x4f00d9 = _0x5d62b8?.[_0x3717a2(0x82e)] ? _0x5d62b8[_0x3717a2(0x82e)] + _0x3717a2(0x569) : '转账', _0x599fd5 = _0x123110?.[_0x3717a2(0x82e)] ? _0x3717a2(0x189) + _0x123110['name'] : '转账', _0x20aa54 = _0x3717a2(0x67d) + _0x4f00d9 + _0x3717a2(0x51e) + _0x527912[_0x3717a2(0x159)]['toFixed'](0x2) + _0x3717a2(0x5a7) + _0x599fd5 + _0x3717a2(0x5c9); _0x476381[_0x3717a2(0x497)] = _0x20aa54; } } document[_0xbc3280(0x5d9)](_0xbc3280(0x162))['addEventListener'](_0xbc3280(0x36d), async () => { const _0x1859b0 = _0xbc3280; if (!_0xc11dfa['audio'] || !_0xc11dfa['info']) { if (_0x1859b0(0x34f) !== _0x1859b0(0x34f)) { const _0x708534 = _0x1d99ec[_0x1859b0(0x85e)](_0x1859b0(0x56a)); if (!_0x708534) return; _0x708534['id'] === _0x1859b0(0x52a) ? _0x3e49a6() : _0x79fc03(); } else { _0x13197e(_0x1859b0(0x73d)); return; } } await _0x21faec(); }), document[_0xbc3280(0x5d9)](_0xbc3280(0x588))[_0xbc3280(0x73c)]('click', () => { const _0x5cfa1a = _0xbc3280; _0x5a1890(), _0x4ed1c4(_0x5cfa1a(0x487), _0x5cfa1a(0x1f3)); }), document['getElementById'](_0xbc3280(0x5df))['addEventListener'](_0xbc3280(0x36d), () => { const _0x4eff6e = _0xbc3280; _0x4ed1c4('musicLibrary', _0x4eff6e(0x487)); }); async function _0x21faec() { const _0x4cb95b = _0xbc3280; if (_0x4cb95b(0x849) !== _0x4cb95b(0x648)) { _0x3168b5(!![], '正在解析音乐灵魂...'); try { if ('nBXGt' === _0x4cb95b(0x44b)) _0x459b3a += '\x20[并分享了歌曲:\x20' + _0x94eb80[_0x4cb95b(0x2ed)] + _0x4cb95b(0x541) + _0x14d0da[_0x4cb95b(0x381)] + ']'; else { const _0x111a3e = await _0xc11dfa[_0x4cb95b(0x29d)][_0x4cb95b(0x224)](), _0xbca5f2 = JSON[_0x4cb95b(0x5b7)](_0x111a3e), _0x44d812 = 'song_' + (_0xbca5f2[_0x4cb95b(0x479)] || Date['now']()), _0x58a874 = { 'id': _0x44d812, 'info': _0xbca5f2, 'audio': _0xc11dfa[_0x4cb95b(0x5ee)], 'cover': _0xc11dfa[_0x4cb95b(0x7d9)], 'lyrics': _0xc11dfa[_0x4cb95b(0x771)] ? await _0xc11dfa['lyrics'][_0x4cb95b(0x224)]() : '' }; await _0x36ddfd(_0x58a874), await _0x5674d6(), _0x3168b5(![]), _0x13197e('歌曲“' + _0xbca5f2[_0x4cb95b(0x6b8)] + _0x4cb95b(0x831)), _0x4ed1c4(_0x4cb95b(0x1f3), _0x4cb95b(0x487)); } } catch (_0xe6b66d) { _0x3168b5(![]), console['error'](_0x4cb95b(0x54d), _0xe6b66d), _0x13197e(_0x4cb95b(0x7c5) + _0xe6b66d[_0x4cb95b(0x1a4)]); } } else _0x5351ea += _0x4cb95b(0x52e); } async function _0x5674d6() { const _0x5e2ac0 = _0xbc3280; if (_0x5e2ac0(0x37e) === _0x5e2ac0(0x576)) _0x4931ef['key'] === _0x5e2ac0(0x47d) && !_0xeb9a8a[_0x5e2ac0(0x4d6)] && (_0x462ff5['preventDefault'](), _0x15d06e()); else { const _0x301097 = document[_0x5e2ac0(0x5d9)]('music-library-container'); _0x301097[_0x5e2ac0(0x497)] = ''; const _0x15ad78 = await _0x5de717(); if (_0x15ad78[_0x5e2ac0(0x794)] === 0x0) { _0x301097[_0x5e2ac0(0x497)] = _0x5e2ac0(0x32e); return; } _0x15ad78[_0x5e2ac0(0x357)]((_0x1d2d3a, _0x3579d5) => (_0x1d2d3a[_0x5e2ac0(0x29d)][_0x5e2ac0(0x6b8)] || '')[_0x5e2ac0(0x7ad)](_0x3579d5[_0x5e2ac0(0x29d)]['歌曲名称'] || '')); for (const _0x26eef1 of _0x15ad78) { if (_0x5e2ac0(0x1f5) === _0x5e2ac0(0x1f5)) { const _0x2e1eab = document['createElement'](_0x5e2ac0(0x172)); _0x2e1eab[_0x5e2ac0(0x63a)] = _0x5e2ac0(0x366), _0x2e1eab[_0x5e2ac0(0x17f)][_0x5e2ac0(0x7a8)] = _0x26eef1['id']; const _0x1e2332 = _0x26eef1[_0x5e2ac0(0x7d9)] ? URL['createObjectURL'](_0x26eef1[_0x5e2ac0(0x7d9)]) : _0x166d38; _0x2e1eab[_0x5e2ac0(0x497)] = _0x5e2ac0(0x53a) + _0x1e2332 + '\x22\x20class=\x22music-library-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-title\x22>' + (_0x26eef1[_0x5e2ac0(0x29d)]['歌曲名称'] || _0x5e2ac0(0x533)) + _0x5e2ac0(0x3eb) + (_0x26eef1[_0x5e2ac0(0x29d)]['歌手'] || _0x5e2ac0(0x3f9)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; let _0x3baa23 = null; const _0x1bc041 = _0x59ff68 => { const _0x3fca43 = _0x5e2ac0; if (_0x3fca43(0x1f2) !== 'PDbTa') { if (_0x59ff68[_0x3fca43(0x5d1)] === 0x2) return; _0x3baa23 = setTimeout(async () => { const _0x39df16 = _0x3fca43; if (_0x59ff68[_0x39df16(0x443)] === _0x39df16(0x16d)) _0x59ff68['preventDefault'](); const _0x325942 = await _0x458a99('确定要从圣殿中永久删除《' + _0x26eef1[_0x39df16(0x29d)][_0x39df16(0x6b8)] + '》吗？'); if (_0x325942) { if ('bkIcU' === _0x39df16(0x66a)) await _0x2b95c3(_0x26eef1['id']), await _0x5674d6(), _0x13197e(_0x39df16(0x299)); else { const _0x1a9e2c = { 'quotedMessage': null, 'content': _0xd4fb5c }, _0x28e91b = _0x553859[_0x39df16(0x6a9)](/^\[引用\|(.*?)\|(.*?)\]\s*/); return _0x28e91b && (_0x1a9e2c[_0x39df16(0x19d)] = { 'sender': _0x28e91b[0x1][_0x39df16(0x42f)](), 'content': _0x28e91b[0x2][_0x39df16(0x42f)]() }, _0x1a9e2c[_0x39df16(0x283)] = _0x1896d5[_0x39df16(0x35b)](_0x28e91b[0x0][_0x39df16(0x794)])[_0x39df16(0x42f)]()), _0x1a9e2c; } } }, 0x320); } else _0xf03cf7[_0x3fca43(0x43f)]('[' + _0x1b59f4(_0xac002a) + ']\x20' + _0x2b5d67[_0x3fca43(0x283)]); }, _0x526d1a = () => { const _0x53c257 = _0x5e2ac0; _0x53c257(0x77e) !== _0x53c257(0x851) ? clearTimeout(_0x3baa23) : (_0xf65a31(), _0x5736a9 = null); }; _0x2e1eab[_0x5e2ac0(0x73c)]('mousedown', _0x1bc041), _0x2e1eab[_0x5e2ac0(0x73c)]('mouseup', _0x526d1a), _0x2e1eab[_0x5e2ac0(0x73c)](_0x5e2ac0(0x1db), _0x526d1a), _0x2e1eab['addEventListener'](_0x5e2ac0(0x16d), _0x1bc041, { 'passive': ![] }), _0x2e1eab[_0x5e2ac0(0x73c)](_0x5e2ac0(0x3c8), _0x526d1a), _0x2e1eab[_0x5e2ac0(0x73c)](_0x5e2ac0(0x356), _0x526d1a), _0x2e1eab[_0x5e2ac0(0x73c)](_0x5e2ac0(0x36d), _0x577050 => { const _0x3e4f17 = _0x5e2ac0; if (_0x3baa23) clearTimeout(_0x3baa23); if (_0x577050[_0x3e4f17(0x1ee)]) return; setTimeout(() => { const _0x42336f = _0x3e4f17; if (_0x42336f(0x8ad) === _0x42336f(0x62f)) { let _0x333b5d = _0x599801['querySelector'](_0x42336f(0x2ec)); !_0x333b5d && (_0x333b5d = _0x363a81[_0x42336f(0x628)]('div'), _0x333b5d[_0x42336f(0x63a)] = _0x42336f(0x643), _0x333b5d[_0x42336f(0x41a)] = _0x42336f(0x783), _0x333b5d['style'][_0x42336f(0x5f6)] = _0x42336f(0x3cc), _0x333b5d[_0x42336f(0x3fc)][_0x42336f(0x6a4)] = _0x42336f(0x898), _0x333b5d['style']['borderRadius'] = _0x42336f(0x344), _0x10fd06[_0x42336f(0x2c8)](_0x333b5d)); } else _0x3baa23 && _0xa81322(_0x26eef1['id'], _0x15ad78['map'](_0x1aa035 => _0x1aa035['id'])); }, 0x32); }), _0x301097[_0x5e2ac0(0x2c8)](_0x2e1eab); } else return { 'url': _0x993c3e, 'cover': _0x2f1cee['cover'], 'source': _0xa87283 }; } } } _0x855b56[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0x4c14a8 = _0xbc3280; _0x13197e(_0x4c14a8(0x347)); }), _0x478936[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { _0x13197e('这个也是摆设，别点了。'); }); let _0x324501 = [], _0x3b54c7 = -0x1; async function _0xa81322(_0x409fc0, _0x3e2ebb) { const _0x1bc4c3 = _0xbc3280; if (_0x1bc4c3(0x430) === _0x1bc4c3(0x470)) _0x23026a(![]); else { const _0x83059b = await _0x39d202(_0x409fc0); if (!_0x83059b) return; _0x2a2ac2 = { 'title': _0x83059b[_0x1bc4c3(0x29d)][_0x1bc4c3(0x6b8)] || _0x1bc4c3(0x533), 'artist': _0x83059b[_0x1bc4c3(0x29d)]['歌手'] || _0x1bc4c3(0x3f9), 'cover': _0x83059b[_0x1bc4c3(0x7d9)] ? URL['createObjectURL'](_0x83059b['cover']) : _0x166d38, 'isFromLibrary': !![] }; const _0x34ac2a = URL[_0x1bc4c3(0x78a)](_0x83059b['audio']); _0x50a4ab[_0x1bc4c3(0x161)] = _0x34ac2a, _0x50a4ab[_0x1bc4c3(0x1b1)](), _0x3715b6(); } } async function _0x3715b6() { const _0x98b3ab = _0xbc3280; if ('XKCWQ' !== _0x98b3ab(0x4e8)) { _0x4702f1[_0x98b3ab(0x1ce)] = _0x29dc5b[_0x98b3ab(0x1ce)][_0x98b3ab(0x25b)](_0x574c33 => _0x574c33['id'] !== _0x6a0da2); try { _0x44710a[_0x98b3ab(0x5b3)]('chatHistory_' + _0x1803d8); } catch (_0x443984) { _0x1db81f[_0x98b3ab(0x863)](_0x98b3ab(0x8af) + _0x4b2b2, _0x443984); } _0x3c0eec[_0x98b3ab(0x728)] === _0x1c8026 && (_0x564a38[_0x98b3ab(0x728)] = _0x10a7c5[_0x98b3ab(0x1ce)][0x0]?.['id'] || null, _0x420b73(_0xc99208[_0x98b3ab(0x728)])), _0x242074(), _0x10734a(); } else { const _0x3f50b8 = document[_0x98b3ab(0x5d9)]('music-widget'), _0x4a2c7f = document[_0x98b3ab(0x5d9)]('widget-title'), _0x103829 = document[_0x98b3ab(0x5d9)](_0x98b3ab(0x5e7)), _0x4b0e2 = document[_0x98b3ab(0x5d9)]('widget-cover-art'), _0x24b05d = document['getElementById'](_0x98b3ab(0x353)); _0x3f50b8[_0x98b3ab(0x7a1)][_0x98b3ab(0x8a2)](_0x98b3ab(0x30c)); const _0x25e847 = _0x2a2ac2; _0x25e847 && _0x25e847[_0x98b3ab(0x242)] ? _0x98b3ab(0x802) === 'STiXh' ? (_0x2cb5e2[_0x98b3ab(0x863)](_0x98b3ab(0x8bf), _0x59fe17), _0x447f18(_0x98b3ab(0x3d0) + _0xaed656[_0x98b3ab(0x1a4)])) : (_0x4a2c7f[_0x98b3ab(0x41a)] = _0x25e847[_0x98b3ab(0x15c)], _0x103829[_0x98b3ab(0x41a)] = _0x25e847['artist'], _0x4b0e2['style'][_0x98b3ab(0x6d5)] = _0x98b3ab(0x64e) + _0x25e847[_0x98b3ab(0x7d9)] + ')', _0x24b05d['textContent'] = _0x50a4ab[_0x98b3ab(0x258)] ? '▶' : '❚❚', _0x50a4ab[_0x98b3ab(0x258)] ? _0x4b0e2['classList'][_0x98b3ab(0x8a2)](_0x98b3ab(0x364)) : _0x4b0e2[_0x98b3ab(0x7a1)][_0x98b3ab(0x821)](_0x98b3ab(0x364))) : (_0x4a2c7f['textContent'] = _0x98b3ab(0x616), _0x103829[_0x98b3ab(0x41a)] = _0x98b3ab(0x521), _0x4b0e2[_0x98b3ab(0x3fc)]['backgroundImage'] = '', _0x24b05d['textContent'] = '▶'); } } _0x855b56 && _0x855b56[_0xbc3280(0x73c)](_0xbc3280(0x36d), () => { const _0x548328 = _0xbc3280; if (_0x324501['length'] === 0x0) return; _0x3b54c7 = (_0x3b54c7 + 0x1) % _0x324501[_0x548328(0x794)], _0xa81322(_0x324501[_0x3b54c7], _0x324501); }); _0x478936 && _0x478936['addEventListener'](_0xbc3280(0x36d), () => { const _0x39e27d = _0xbc3280; if (_0x324501[_0x39e27d(0x794)] === 0x0) return; _0x3b54c7 = (_0x3b54c7 - 0x1 + _0x324501[_0x39e27d(0x794)]) % _0x324501[_0x39e27d(0x794)], _0xa81322(_0x324501[_0x3b54c7], _0x324501); }); _0x50a4ab[_0xbc3280(0x73c)]('play', () => { const _0x3990e8 = _0xbc3280; if (_0x3990e8(0x194) === _0x3990e8(0x194)) { if (_0x43d993) _0x43d993[_0x3990e8(0x41a)] = '❚❚'; } else { const _0x339230 = _0x3eb7f0[_0x3990e8(0x5d9)](_0x3990e8(0x717))['value']; _0x339230 && (_0x5237a1[_0x3990e8(0x4f0)] = _0x339230, _0x46c283(), _0x59c2da('已设为当前用户！'), _0x2b65a2(), _0xf68e1a['getElementById'](_0x3990e8(0x64a))[_0x3990e8(0x3fc)][_0x3990e8(0x74d)] = _0x3990e8(0x860)); } }), _0x50a4ab['addEventListener'](_0xbc3280(0x2cd), () => { const _0x1fc419 = _0xbc3280; if (_0x1fc419(0x44c) === _0x1fc419(0x44c)) { if (_0x43d993) _0x43d993['textContent'] = '▶'; } else _0x1c8df6 = _0xb02365[_0x1fc419(0x160)][_0x1fc419(0x659)](_0x3bb34e => _0x3bb34e['id'] === _0x5e2942[_0x1fc419(0x4f0)]); }), _0x50a4ab['addEventListener'](_0xbc3280(0x211), () => { if (_0x855b56) _0x855b56['click'](); }); function _0x53a4df() { const _0x200057 = _0xbc3280, _0x1033b8 = _0x1e26a8(); if (!_0x1033b8) return; _0x18d56d[_0x200057(0x497)] = '', _0x32d1fd['value'] = ''; if (_0x1033b8[_0x200057(0x443)] === _0x200057(0x441)) _0x1033b8[_0x200057(0x594)]['forEach'](_0x2155cf => { const _0x49fe55 = _0x200057; if ('BicKd' !== _0x49fe55(0x158)) { const _0x16d350 = _0x5a8ee7(_0x2155cf); if (_0x16d350) { const _0x400ab4 = document[_0x49fe55(0x628)](_0x49fe55(0x5ca)); _0x400ab4[_0x49fe55(0x5a5)] = _0x16d350['id'], _0x400ab4[_0x49fe55(0x41a)] = _0x16d350['name'], _0x18d56d[_0x49fe55(0x2c8)](_0x400ab4); } } else _0x18b560['value'] = '', _0x423067[_0x49fe55(0x41a)] = _0x49fe55(0x69c), _0x482caf[_0x49fe55(0x5a5)] = _0x49fe55(0x174) + (_0x302983[_0x49fe55(0x24a)]['length'] + 0x1), _0x45f463[_0x49fe55(0x5a5)] = '', _0x148f18[_0x49fe55(0x161)] = _0x3e3f13, _0x3acd99['value'] = _0x49fe55(0x3d6), _0x1f7204[_0x49fe55(0x5d9)]('char-edit-css')[_0x49fe55(0x5a5)] = '', _0x48ffa3(); }), _0x308c1c['style'][_0x200057(0x74d)] = 'block'; else { if ('AvCxh' !== 'AvCxh') { const _0x1e1f43 = _0x319c52['comments'][_0x200057(0x2ac)](_0x2f6ad5 => { const _0x317107 = _0x200057, _0x4c48b2 = _0xf23b99(_0x2f6ad5['authorId'])?.['name'] || '未知'; return _0x317107(0x1bf) + _0x4c48b2 + _0x317107(0x693) + _0x2f6ad5['content'] + _0x317107(0x61f); })[_0x200057(0x5d2)](''); _0x44c6f3 = _0x200057(0x7c3) + _0x1e1f43 + _0x200057(0x61f); } else _0x308c1c['style']['display'] = _0x200057(0x860); } _0x44c688[_0x200057(0x7a1)][_0x200057(0x821)](_0x200057(0x274)), _0x32d1fd['focus'](); } function _0xff6ba4() { const _0x189d50 = _0xbc3280; if (_0x189d50(0x48e) !== 'PJwnn') _0x291ce0[_0x189d50(0x863)](_0x189d50(0x53b), _0x214d24), _0x2a6188[_0x189d50(0x2d2)] = _0x189d50(0x254); else { const _0x25375d = parseFloat(_0x32d1fd[_0x189d50(0x5a5)]); if (isNaN(_0x25375d) || _0x25375d <= 0x0) { if (_0x189d50(0x204) !== _0x189d50(0x204)) !_0x3214d3['contains'](_0x17c5b4[_0x189d50(0x7da)]) && _0x3243d2['target'] !== _0x2f9d7f && _0x18af4a[_0x189d50(0x7da)] !== _0x142d7b && _0x16062b[_0x189d50(0x7a1)][_0x189d50(0x8a2)]('show'); else { _0x13197e(_0x189d50(0x4d8)); return; } } const _0x5e3180 = _0x1e26a8(); let _0x3f14cb = null; _0x5e3180['type'] === _0x189d50(0x441) ? _0x3f14cb = _0x18d56d['value'] : _0x189d50(0x329) === _0x189d50(0x7a0) ? (_0x355df7['style'][_0x189d50(0x6d5)] = _0x189d50(0x6c9) + _0x4d55b9[_0x189d50(0x78a)](_0x252bff) + '\x27)', _0x3fa9b0['style'][_0x189d50(0x66d)] = _0x189d50(0x7d9), _0x26c8cf[_0x189d50(0x3fc)][_0x189d50(0x186)] = _0x189d50(0x750)) : _0x3f14cb = _0x5e3180[_0x189d50(0x594)][0x0]; const _0x49d27d = _0x4771d7(_0x5e3180['id']), _0x2e08f7 = { 'role': 'user', 'type': 'transfer', 'content': _0x189d50(0x638) + (_0x5a8ee7(_0x3f14cb)?.[_0x189d50(0x82e)] || '未知') + '\x20转账\x20' + _0x25375d + ']', 'amount': _0x25375d, 'recipientId': _0x3f14cb, 'senderId': _0x49d27d['id'], 'timestamp': Date['now']() }; _0x5c6c54[_0x189d50(0x3b6)]['push'](_0x2e08f7), _0xcef02c(), _0x1fa1ad(), _0x44c688['classList'][_0x189d50(0x8a2)](_0x189d50(0x274)); } } _0xf60ab2(); }); async function _0x5127f7() { const _0x44a8a4 = _0x28d250; console['log']('---\x20Noir\x27s\x20Data\x20Purification\x20Ritual\x20v1.0\x20---'), console[_0x44a8a4(0x384)]('哼，正在开始净化你那被污染的聊天记录...'); const _0x1070cc = 'Noir_FileSystem', _0x33f28f = _0x44a8a4(0x33a), _0x400e1c = new Promise((_0x448cac, _0x469897) => { const _0x196088 = _0x44a8a4; if (_0x196088(0x50a) === 'YrgZg') { const _0x4d612a = _0xdcb8ec['userProfiles'][_0x196088(0x659)](_0x58ebe5 => _0x58ebe5['id'] === _0x1ce2a9[_0x196088(0x4f0)]) || { 'name': '你' }, _0x1c9c98 = _0x3bbf56['diaries'][_0x196088(0x659)](_0x47ef6e => _0x47ef6e[_0x196088(0x8d9)] === _0x587aac); if (!_0x1c9c98 || !_0x1c9c98[_0x196088(0x806)] || _0x1c9c98[_0x196088(0x806)][_0x196088(0x794)] === 0x0) return ''; const _0x1fb647 = _0x1c9c98[_0x196088(0x806)][_0x196088(0x60e)](-0x8), _0x34d040 = _0x1fb647[_0x196088(0x2ac)](_0x4c3218 => { const _0x1b2a69 = _0x196088, _0x456a8e = _0x4c3218[_0x1b2a69(0x532)] === _0x1b2a69(0x845) ? _0x4d612a[_0x1b2a69(0x82e)] : _0x503952(_0x4c3218[_0x1b2a69(0x532)])['name']; return _0x1b2a69(0x35f) + new _0x47f33e(_0x4c3218['timestamp'])['toLocaleDateString']() + ']\x20' + _0x456a8e + _0x1b2a69(0x1a3) + _0x4c3218[_0x1b2a69(0x283)]; })[_0x196088(0x5d2)]('\x0a'); return _0x196088(0x846) + _0x4d612a[_0x196088(0x82e)] + '\x20之间的私密内容)\x0a' + _0x34d040; } else { const _0x5d773e = indexedDB[_0x196088(0x798)](_0x1070cc, 0x2); _0x5d773e[_0x196088(0x618)] = () => _0x469897('IndexedDB\x20failed\x20to\x20open'), _0x5d773e[_0x196088(0x21f)] = () => _0x448cac(_0x5d773e[_0x196088(0x6bf)]), _0x5d773e[_0x196088(0x7af)] = _0x43fb7a => { const _0x10b28c = _0x196088, _0x454653 = _0x43fb7a[_0x10b28c(0x7da)]['result']; !_0x454653[_0x10b28c(0x5ab)][_0x10b28c(0x153)](_0x33f28f) && _0x454653[_0x10b28c(0x7d4)](_0x33f28f, { 'keyPath': 'id' }), !_0x454653[_0x10b28c(0x5ab)][_0x10b28c(0x153)]('music_library') && _0x454653[_0x10b28c(0x7d4)](_0x10b28c(0x486), { 'keyPath': 'id' }); }; } }); async function _0x585ac3(_0x4e80a3, _0xb7d421) { const _0x2ec822 = await _0x400e1c; return new Promise((_0x5ac9d0, _0x2cb68e) => { const _0x2866d5 = _0x32ba; if (_0x2866d5(0x6cb) === 'CUmTK') { const _0x186a6a = _0x5a1be7[_0x2866d5(0x5d9)](_0x2866d5(0x671)); _0x186a6a[_0x2866d5(0x497)] = ''; if (_0x344b1f[_0x2866d5(0x48c)]['length'] === 0x0) { _0x186a6a['innerHTML'] = _0x2866d5(0x2bf); return; } _0x102ad0['friendCircles'][_0x2866d5(0x691)](_0x4e36e1 => { const _0x143035 = _0x2866d5, _0x575846 = _0x2f2f00['userProfiles'][_0x143035(0x659)](_0x4995c3 => _0x4995c3['id'] === _0x4e36e1[_0x143035(0x41c)]) || { 'name': _0x143035(0x1df) }, _0x286206 = _0x524f78['createElement'](_0x143035(0x172)); _0x286206[_0x143035(0x63a)] = _0x143035(0x88c), _0x286206[_0x143035(0x17f)]['id'] = _0x4e36e1['id'], _0x286206[_0x143035(0x497)] = _0x143035(0x560) + _0x4e36e1[_0x143035(0x82e)] + _0x143035(0x276) + _0x575846['name'] + '\x20|\x20' + _0x4e36e1[_0x143035(0x6b1)][_0x143035(0x794)] + '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', _0x286206[_0x143035(0x73c)](_0x143035(0x36d), () => _0x5efd2a(_0x4e36e1['id'])), _0x186a6a['appendChild'](_0x286206); }); } else { const _0x56d282 = _0x2ec822[_0x2866d5(0x52f)](_0x33f28f, _0x2866d5(0x15d)), _0x711f8b = _0x56d282[_0x2866d5(0x4ed)](_0x33f28f), _0x81f725 = _0x711f8b['put']({ 'id': _0x4e80a3, 'blob': _0xb7d421 }); _0x81f725[_0x2866d5(0x21f)] = () => _0x5ac9d0(_0x81f725[_0x2866d5(0x6bf)]), _0x81f725[_0x2866d5(0x618)] = () => _0x2cb68e(_0x81f725[_0x2866d5(0x863)]); } }); } function _0x24d84e(_0x1c7adf) { const _0x67d35d = _0x44a8a4; return fetch(_0x1c7adf)[_0x67d35d(0x2b1)](_0x192243 => _0x192243[_0x67d35d(0x2b5)]()); } let _0xbb96ac = 0x0; for (let _0x5b51ac = 0x0; _0x5b51ac < localStorage[_0x44a8a4(0x794)]; _0x5b51ac++) { if (_0x44a8a4(0x49c) === 'HlTBG') { const _0x427adc = _0x268784[0x1]['replace'](/\\"/g, '\x22')[_0x44a8a4(0x41f)](/\\n/g, '\x0a')[_0x44a8a4(0x42f)](); if (_0x427adc) _0x57a4c0['push'](_0x427adc); } else { const _0x49ba51 = localStorage[_0x44a8a4(0x4de)](_0x5b51ac); if (_0x49ba51 && _0x49ba51[_0x44a8a4(0x380)]('chatHistory_')) { if (_0x44a8a4(0x4a4) === _0x44a8a4(0x724)) { _0x30b5b1(_0x44a8a4(0x19e)); return; } else { let _0x3a5216, _0x18e97f = ![]; try { _0x3a5216 = JSON[_0x44a8a4(0x5b7)](localStorage[_0x44a8a4(0x24e)](_0x49ba51)); if (!Array[_0x44a8a4(0x1ab)](_0x3a5216)) continue; for (const _0x42ce7e of _0x3a5216) { if (_0x42ce7e && _0x42ce7e[_0x44a8a4(0x4e0)] && _0x42ce7e[_0x44a8a4(0x4e0)][_0x44a8a4(0x380)](_0x44a8a4(0x7b7))) { const _0x410b11 = await _0x24d84e(_0x42ce7e['image']), _0x2cfa86 = _0x44a8a4(0x284) + Date[_0x44a8a4(0x7a5)]() + '_' + Math[_0x44a8a4(0x633)](); await _0x585ac3(_0x2cfa86, _0x410b11), _0x42ce7e[_0x44a8a4(0x2f3)] = _0x2cfa86, delete _0x42ce7e[_0x44a8a4(0x4e0)], _0x18e97f = !![], _0xbb96ac++; } } _0x18e97f && ('SyiTD' !== 'kUXHT' ? localStorage[_0x44a8a4(0x3cd)](_0x49ba51, JSON[_0x44a8a4(0x79c)](_0x3a5216)) : (_0x1191db[_0x44a8a4(0x7ac)](), _0x5f3ff5())); } catch (_0x306d88) { console[_0x44a8a4(0x863)]('处理\x20' + _0x49ba51 + _0x44a8a4(0x7b4), _0x306d88); continue; } } } } } console[_0x44a8a4(0x384)]('净化完成！总共迁移了\x20' + _0xbb96ac + _0x44a8a4(0x40f)); } function _0x32ba(_0x91038c, _0x1b400a) { const _0x305267 = _0x3052(); return _0x32ba = function (_0x32ba37, _0x392dbf) { _0x32ba37 = _0x32ba37 - 0x149; let _0x574f89 = _0x305267[_0x32ba37]; return _0x574f89; }, _0x32ba(_0x91038c, _0x1b400a); } async function _0x47cc25() { const _0x569e10 = _0x28d250; console[_0x569e10(0x384)](_0x569e10(0x83a)), console[_0x569e10(0x384)](_0x569e10(0x86c)); async function _0xc62501(_0x3fa9f8, _0x1ec94e) { const _0xaf429f = await _0x3a23c1; return new Promise((_0x467bee, _0x67b1a6) => { const _0x4a5cfd = _0x32ba, _0x467cc9 = _0xaf429f[_0x4a5cfd(0x52f)](_0x4a5cfd(0x33a), _0x4a5cfd(0x15d)), _0xeb528b = _0x467cc9[_0x4a5cfd(0x4ed)](_0x4a5cfd(0x33a)), _0x2edd46 = _0xeb528b[_0x4a5cfd(0x6d7)]({ 'id': _0x3fa9f8, 'blob': _0x1ec94e }); _0x2edd46[_0x4a5cfd(0x21f)] = () => _0x467bee(_0x2edd46[_0x4a5cfd(0x6bf)]), _0x2edd46['onerror'] = () => _0x67b1a6(_0x2edd46[_0x4a5cfd(0x863)]); }); } function _0x43d9f7(_0x2d2d8a) { const _0x146069 = _0x569e10; return fetch(_0x2d2d8a)[_0x146069(0x2b1)](_0x31cec6 => _0x31cec6[_0x146069(0x2b5)]()); } let _0xfa23ed = 0x0, _0x13c0da = ![]; try { const _0x3dadc6 = localStorage['getItem'](_0x569e10(0x21e)); if (!_0x3dadc6) { if ('IWnin' !== _0x569e10(0x606)) { console[_0x569e10(0x384)](_0x569e10(0x718)); return; } else _0x51ee2e[_0x569e10(0x497)] = _0x569e10(0x504) + _0x231269 + _0x569e10(0x455) + (_0x35142a === _0x569e10(0x828) ? _0x569e10(0x44f) : '#f2b7c6') + _0x569e10(0x74e) + _0x4e305d + ':</span>\x20' + _0x34d825; } const _0x29d6b1 = JSON[_0x569e10(0x5b7)](_0x3dadc6); if (!_0x29d6b1[_0x569e10(0x48c)] || !Array[_0x569e10(0x1ab)](_0x29d6b1[_0x569e10(0x48c)])) { if (_0x569e10(0x38e) !== 'jmHMe') for (const _0x62651a in _0x254291) { _0x1e2045[_0x569e10(0x3fc)][_0x62651a] = _0x3837bd[_0x62651a]; } else return; } for (const _0x4d3eba of _0x29d6b1['friendCircles']) { if ('PUiaO' === _0x569e10(0x75e)) { if (_0x4d3eba['posts'] && Array['isArray'](_0x4d3eba[_0x569e10(0x834)])) for (const _0x34b68f of _0x4d3eba['posts']) { if (_0x34b68f && _0x34b68f[_0x569e10(0x4e0)] && _0x34b68f[_0x569e10(0x4e0)][_0x569e10(0x380)](_0x569e10(0x7b7))) { if ('fwylH' === 'fwylH') { console[_0x569e10(0x384)](_0x569e10(0x6c2) + _0x4d3eba[_0x569e10(0x82e)] + _0x569e10(0x373)); const _0x508b1a = await _0x43d9f7(_0x34b68f[_0x569e10(0x4e0)]), _0x44fd0d = _0x569e10(0x4f3) + Date[_0x569e10(0x7a5)]() + '_' + Math['random'](); await _0xc62501(_0x44fd0d, _0x508b1a), _0x34b68f[_0x569e10(0x2f3)] = _0x44fd0d, delete _0x34b68f[_0x569e10(0x4e0)], _0x13c0da = !![], _0xfa23ed++; } else { const _0x18c07b = _0x293a73[_0x569e10(0x81a)]('p'); _0x18c07b['forEach'](_0x5b2f42 => _0x5b2f42['classList'][_0x569e10(0x8a2)](_0x569e10(0x39d))); const _0x485c7d = _0x110e9b[_0x569e10(0x5d9)](_0x569e10(0x8b5) + _0x127df3); _0x485c7d && (_0x485c7d[_0x569e10(0x7a1)][_0x569e10(0x821)](_0x569e10(0x39d)), _0x485c7d[_0x569e10(0x437)]({ 'behavior': _0x569e10(0x3c9), 'block': _0x569e10(0x750) })); } } } } else _0x50e8ad(![]), _0x4e15f5[_0x569e10(0x863)](_0x569e10(0x84f), _0x110618), _0x446149(_0x569e10(0x679) + _0x3735f2[_0x569e10(0x1a4)]); } _0x13c0da && (console[_0x569e10(0x384)](_0x569e10(0x808)), localStorage[_0x569e10(0x3cd)](_0x569e10(0x21e), JSON[_0x569e10(0x79c)](_0x29d6b1))); } catch (_0x5b96e7) { console[_0x569e10(0x863)](_0x569e10(0x899), _0x5b96e7); } return console['log'](_0x569e10(0x2db)), console[_0x569e10(0x384)](_0x569e10(0x872) + _0xfa23ed + _0x569e10(0x8ce)), _0xfa23ed; } function _0x2774c4() { const _0x2adc1d = _0x28d250; if (!_0x5c6c54['activeDiaryCharacterId']) { if (_0x2adc1d(0x72a) !== _0x2adc1d(0x77c)) return _0x5c6c54['userProfiles']['find'](_0x42af67 => _0x42af67['id'] === _0x5c6c54['activeUserProfileId']) || _0x5c6c54[_0x2adc1d(0x160)][0x0]; else _0x682dad(_0x3f31ce), _0x23b33c[_0x2adc1d(0x5a5)] = '', _0xc27ca4(_0x5848f7, 0x64); } const _0x48dccd = _0x5c6c54[_0x2adc1d(0x1ce)][_0x2adc1d(0x659)](_0x2d8268 => _0x2d8268[_0x2adc1d(0x443)] === 'private' && _0x2d8268[_0x2adc1d(0x594)]['includes'](_0x5c6c54['activeDiaryCharacterId'])), _0x75127 = _0x48dccd?.['boundUserProfileId'] || _0x5c6c54[_0x2adc1d(0x4f0)]; return _0x5c6c54[_0x2adc1d(0x160)][_0x2adc1d(0x659)](_0x10dde1 => _0x10dde1['id'] === _0x75127) || _0x5c6c54[_0x2adc1d(0x160)][0x0]; } function _0x111ade(_0x1bb139) { const _0x20f060 = _0x28d250, _0x5504b1 = new Date(), _0x4c7378 = _0x5504b1 - _0x1bb139, _0x173401 = Math[_0x20f060(0x2be)](_0x4c7378 / 0x3e8), _0x30e1e6 = Math[_0x20f060(0x2be)](_0x173401 / 0x3c), _0x214925 = Math[_0x20f060(0x2be)](_0x30e1e6 / 0x3c), _0x349f5f = Math['round'](_0x214925 / 0x18), _0x35d0fa = _0x1bb139['toLocaleTimeString']('zh-CN', { 'hour': '2-digit', 'minute': '2-digit' }); if (_0x173401 < 0x3c) return '刚才'; if (_0x30e1e6 < 0x3c) { if ('hjFSf' !== _0x20f060(0x5b0)) return _0x30e1e6 + '分钟前'; else _0x379e01[_0x20f060(0x4f0)] = _0x1a1575, _0x42e5c0(), _0xd9b4b4(_0x20f060(0x755)), _0x887d3d(), _0x2407f0[_0x20f060(0x5d9)](_0x20f060(0x64a))[_0x20f060(0x3fc)]['display'] = _0x20f060(0x860); } const _0x59043f = _0x5504b1[_0x20f060(0x270)]() === _0x1bb139[_0x20f060(0x270)](); if (_0x59043f) return _0x20f060(0x4e6) + _0x35d0fa; const _0x4c67e = new Date(); _0x4c67e[_0x20f060(0x7be)](_0x5504b1[_0x20f060(0x425)]() - 0x1); const _0x54a240 = _0x4c67e[_0x20f060(0x270)]() === _0x1bb139[_0x20f060(0x270)](); if (_0x54a240) return _0x20f060(0x7a2) + _0x35d0fa; if (_0x349f5f <= 0x7) { const _0x467613 = [_0x20f060(0x4e5), _0x20f060(0x2dd), '星期二', _0x20f060(0x75a), '星期四', '星期五', _0x20f060(0x208)]; return _0x467613[_0x1bb139['getDay']()] + '\x20' + _0x35d0fa; } return _0x1bb139[_0x20f060(0x58a)]() + '年' + (_0x1bb139[_0x20f060(0x3e3)]() + 0x1) + '月' + _0x1bb139[_0x20f060(0x425)]() + '日'; } function _0x5e770d(_0x10c175, _0x2ca7dd = 0x320, _0x432022 = 0.8, _0x561b38 = ![]) { return new Promise((_0x8e203f, _0x3af8b2) => { const _0x1f8347 = _0x32ba; if (_0x1f8347(0x280) === _0x1f8347(0x280)) { if (!_0x10c175 || !_0x10c175[_0x1f8347(0x443)][_0x1f8347(0x380)](_0x1f8347(0x83b))) { if (_0x1f8347(0x6ae) === _0x1f8347(0x835)) _0x29d11a === 'home' ? _0x13f69c[_0x1f8347(0x3fc)]['display'] = _0x1f8347(0x8d7) : _0x23d265[_0x1f8347(0x3fc)][_0x1f8347(0x74d)] = _0x1f8347(0x860); else return _0x3af8b2(new Error('哼，这不是图片，你想让我压缩什么？')); } const _0x535f6d = new FileReader(); _0x535f6d[_0x1f8347(0x26c)](_0x10c175), _0x535f6d[_0x1f8347(0x792)] = _0x327444 => { const _0x288406 = _0x1f8347, _0x160b0f = new Image(); _0x160b0f[_0x288406(0x161)] = _0x327444[_0x288406(0x7da)][_0x288406(0x6bf)], _0x160b0f[_0x288406(0x792)] = () => { const _0xc757c5 = _0x288406; if (_0xc757c5(0x1fb) === 'auAVn') { const _0x5d7610 = document[_0xc757c5(0x628)](_0xc757c5(0x399)); let _0x449bed = _0x160b0f[_0xc757c5(0x33e)], _0x591dd4 = _0x160b0f['height']; if (_0x449bed > _0x591dd4) _0x449bed > _0x2ca7dd && (_0x591dd4 *= _0x2ca7dd / _0x449bed, _0x449bed = _0x2ca7dd); else { if (_0xc757c5(0x4c2) !== 'wjLgp') { if (_0x591dd4 > _0x2ca7dd) { if (_0xc757c5(0x527) !== 'IjnUq') _0x449bed *= _0x2ca7dd / _0x591dd4, _0x591dd4 = _0x2ca7dd; else return _0x5825a7(_0xc757c5(0x5d4)), ![]; } } else { const _0x5eeb41 = _0x30ae38[_0xc757c5(0x1ce)]['find'](_0x45caac => _0x45caac[_0xc757c5(0x49b)] && _0x45caac['activeListenSession'][_0xc757c5(0x3a5)]); _0x5eeb41 && (_0x5eeb41[_0xc757c5(0x49b)] = null, _0x1bf93b(), _0x45a498(_0xc757c5(0x634)), _0x4fefae(), _0x46ddb4[_0xc757c5(0x7a1)][_0xc757c5(0x8a2)](_0xc757c5(0x274)), _0x18dd5b(() => _0x4a5ed8['style'][_0xc757c5(0x74d)] = _0xc757c5(0x860), 0x12c)); } } _0x5d7610[_0xc757c5(0x33e)] = _0x449bed, _0x5d7610[_0xc757c5(0x4e3)] = _0x591dd4; const _0x48867e = _0x5d7610[_0xc757c5(0x4a8)]('2d'); _0x48867e[_0xc757c5(0x47c)](_0x160b0f, 0x0, 0x0, _0x449bed, _0x591dd4); const _0x4da42f = _0x10c175[_0xc757c5(0x443)] === _0xc757c5(0x8ab) ? 'image/png' : _0xc757c5(0x27a); _0x561b38 ? _0x5d7610['toBlob'](_0xa8828a => { const _0x134bb0 = _0xc757c5; _0xa8828a ? _0x134bb0(0x78f) !== _0x134bb0(0x78f) ? _0x134bb0(0x33d) : _0x8e203f(_0xa8828a) : _0x3af8b2(new Error(_0x134bb0(0x75f))); }, _0x4da42f, _0x432022) : _0xc757c5(0x4cb) !== _0xc757c5(0x4cb) ? (_0x477fbc['select'](), _0x582eac[_0xc757c5(0x4f8)][_0xc757c5(0x416)](_0x174ad1[_0xc757c5(0x5a5)])[_0xc757c5(0x2b1)](() => { const _0x457441 = _0xc757c5; _0x23e115(_0x457441(0x617)); })[_0xc757c5(0x48f)](_0x1917c2 => { const _0x499383 = _0xc757c5; _0x12c1bf(_0x499383(0x827)); })) : _0x8e203f(_0x5d7610[_0xc757c5(0x8d8)](_0x4da42f, _0x432022)); } else _0x549ced(), _0x2cf99e(![]); }, _0x160b0f['onerror'] = _0x188149 => _0x3af8b2(_0x188149); }, _0x535f6d[_0x1f8347(0x618)] = _0x21f965 => _0x3af8b2(_0x21f965); } else { const _0xd4ea6a = _0x198b28['userProfiles'][_0x1f8347(0x659)](_0x40622c => _0x40622c['id'] === _0x9d4b96); if (!_0xd4ea6a) return; _0x1de309[_0x1f8347(0x5d9)](_0x1f8347(0x717))[_0x1f8347(0x5a5)] = _0xd4ea6a['id'], _0xe06c52[_0x1f8347(0x5d9)](_0x1f8347(0x23c))['textContent'] = _0x1f8347(0x391), _0x1a0105[_0x1f8347(0x5d9)](_0x1f8347(0x706))[_0x1f8347(0x5a5)] = _0xd4ea6a[_0x1f8347(0x82e)], _0x5a1340[_0x1f8347(0x5d9)](_0x1f8347(0x339))[_0x1f8347(0x161)] = _0xd4ea6a[_0x1f8347(0x41e)], _0x329993[_0x1f8347(0x5d9)]('user-persona')[_0x1f8347(0x5a5)] = _0xd4ea6a[_0x1f8347(0x854)], _0x18ebf4[_0x1f8347(0x3fc)][_0x1f8347(0x74d)] = _0xd4ea6a['id'] === _0xcf992a[_0x1f8347(0x4f0)] ? _0x1f8347(0x860) : _0x1f8347(0x38f); } }); } function _0x51083d(_0x3aa551) { return new Promise((_0x54b7e9, _0x25bf6b) => { const _0x2b98fa = _0x32ba, _0x40723d = new FileReader(); _0x40723d[_0x2b98fa(0x739)] = () => _0x54b7e9(_0x40723d['result']), _0x40723d[_0x2b98fa(0x618)] = _0x25bf6b, _0x40723d['readAsDataURL'](_0x3aa551); }); } function _0x51083d(_0x30ffb3) { return new Promise((_0x15bb29, _0xc4652a) => { const _0x41e2e5 = _0x32ba, _0x1b3412 = new FileReader(); _0x1b3412[_0x41e2e5(0x739)] = () => _0x15bb29(_0x1b3412[_0x41e2e5(0x6bf)]), _0x1b3412['onerror'] = _0xc4652a, _0x1b3412[_0x41e2e5(0x26c)](_0x30ffb3); }); } function _0x455ef1(_0x2c88ff, _0x41bdb0, _0x57415e) { const _0x4edcd4 = _0x28d250, _0x20eda2 = _0x5e42d5 => { const _0x1bdbe3 = _0x32ba; if (_0x5e42d5[_0x1bdbe3(0x5a8)] === _0x1bdbe3(0x845)) return _0x5c6c54[_0x1bdbe3(0x484)]?.[_0x1bdbe3(0x82e)] || _0x1bdbe3(0x71f); if (_0x2c88ff[_0x1bdbe3(0x443)] === _0x1bdbe3(0x441)) { const _0x4bf355 = _0x5e42d5[_0x1bdbe3(0x2a6)] ? _0x32c6de(_0x5e42d5[_0x1bdbe3(0x2a6)]) : null; return _0x4bf355?.[_0x1bdbe3(0x82e)] || _0x1bdbe3(0x3a7); } else { const _0xcfc5ff = _0x32c6de(_0x2c88ff[_0x1bdbe3(0x594)][0x0]); return _0xcfc5ff?.['name'] || 'AI'; } }, _0x4c9d83 = _0x41bdb0[_0x4edcd4(0x60e)](-_0x57415e), _0x39e29c = []; for (const _0x3bf952 of _0x4c9d83) { if (_0x4edcd4(0x426) === 'HXdNt') { const _0xf5fd6f = new Date(_0x3bf952[_0x4edcd4(0x5c5)])[_0x4edcd4(0x5f9)](_0x4edcd4(0x4ea), { 'hour': _0x4edcd4(0x38d), 'minute': _0x4edcd4(0x38d) }); _0x3bf952[_0x4edcd4(0x283)] && _0x39e29c[_0x4edcd4(0x43f)]('[' + _0xf5fd6f + ']\x20[' + _0x20eda2(_0x3bf952) + ']\x20' + String(_0x3bf952['content'])[_0x4edcd4(0x42f)]()); } else _0xad5d4b(_0x858fa9['id']), _0x3ab04e(_0x4edcd4(0x50d)), _0x5a2d2e(_0x4edcd4(0x2da)), _0x13eef9(![]); } return _0x39e29c; } function _0x40ab19(_0x235b08) { const _0x1e9915 = _0x28d250; if (_0x235b08['type'] === 'group') return '群聊「' + (_0x235b08['name'] || _0x1e9915(0x3c5)) + '」'; const _0x24bc21 = _0x32c6de(_0x235b08[_0x1e9915(0x594)][0x0]); return '与\x20' + (_0x24bc21?.[_0x1e9915(0x82e)] || _0x1e9915(0x4fc)) + _0x1e9915(0x1a5); } function _0x2b4946(_0x4492a2) { const _0x4316c8 = _0x28d250; try { const _0x334ee6 = localStorage['getItem'](_0x4316c8(0x555) + _0x4492a2), _0x18a637 = JSON['parse'](_0x334ee6 || '[]'); return Array[_0x4316c8(0x1ab)](_0x18a637) ? _0x18a637 : []; } catch { return []; } } function _0x5c86b3(_0x50d983, _0x5b4139) { const _0x3c016a = _0x28d250, _0x4d45d4 = Math[_0x3c016a(0x65a)](0x1, Number(_0x5c6c54[_0x3c016a(0x778)]?.[_0x3c016a(0x51f)] ?? 0x64)), _0x25ee7e = _0x5c6c54['chats']['filter'](_0x164615 => _0x164615[_0x3c016a(0x594)]['includes'](_0x50d983))['sort']((_0x2b59ad, _0x316f0d) => _0x2b59ad['id'] === _0x5b4139 ? -0x1 : _0x316f0d['id'] === _0x5b4139 ? 0x1 : 0x0), _0x459ab8 = [], _0x350e70 = {}; for (const _0x38e797 of _0x25ee7e) { const _0x1ef775 = _0x5b4139 && _0x38e797['id'] === _0x5b4139 ? _0x5c6c54[_0x3c016a(0x3b6)] : _0x2b4946(_0x38e797['id']); if (!_0x1ef775?.[_0x3c016a(0x794)]) continue; const _0xa867e9 = _0x455ef1(_0x38e797, _0x1ef775, _0x4d45d4); if (!_0xa867e9['length']) continue; _0x459ab8[_0x3c016a(0x43f)]('##\x20来源：' + _0x40ab19(_0x38e797) + '\x0a' + _0xa867e9[_0x3c016a(0x5d2)]('\x0a')), _0x350e70[_0x38e797['id']] = _0xa867e9[_0x3c016a(0x794)]; } return { 'omniText': _0x459ab8[_0x3c016a(0x5d2)]('\x0a\x0a'), 'usedCounts': _0x350e70 }; } function _0x580176(_0x4a2a36) { const _0x4dda19 = _0x28d250; let _0x500d05 = null; const _0x5c7f67 = _0x5c6c54[_0x4dda19(0x1ce)]['filter'](_0x58668f => _0x58668f[_0x4dda19(0x594)][_0x4dda19(0x87c)](_0x4a2a36)); for (const _0x929612 of _0x5c7f67) { const _0x4ba5a8 = _0x2b4946(_0x929612['id']); if (_0x4ba5a8 && _0x4ba5a8[_0x4dda19(0x794)] > 0x0) { if (_0x4dda19(0x566) === 'ueGjT') { const _0x18c9f9 = _0x4ba5a8[_0x4ba5a8[_0x4dda19(0x794)] - 0x1]; if (!_0x500d05 || _0x18c9f9[_0x4dda19(0x5c5)] > _0x500d05[_0x4dda19(0x5c5)]) { if ('cOwYJ' === _0x4dda19(0x4a9)) { const _0xfb46a7 = _0x18a968[_0x4dda19(0x462)][_0x4dda19(0x1b5)](); _0x138e2e[_0x4dda19(0x41a)] = _0xfb46a7[_0x4dda19(0x28b)] === _0x4dda19(0x494) ? '旁白' : _0xfb46a7[_0x4dda19(0x28b)], _0x5e49b4[_0x4dda19(0x41a)] = _0xfb46a7[_0x4dda19(0x475)], _0xfb46a7['speaker'] !== _0x4dda19(0x494) && _0x37aa27(_0x3804dd[_0x4dda19(0x251)], _0xfb46a7[_0x4dda19(0x203)]); } else _0x500d05 = _0x18c9f9; } } else _0x1d75e6['classList'][_0x4dda19(0x8a2)](_0x4dda19(0x274)); } } return _0x500d05; } function _0x3052() { const _0x3d6625 = ['chat-reroll-button', 'global-player-next-btn', '{userName}', 'world-book-checkboxes-container', 'onclick', 'shhyK', 'SUrDg', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'includes', 'New\x20request\x20started', '\x0a\x0a##\x20世界书条目:\x20', 'http://sharkpan.xyz/f/nj7ul/r48eum.jpg', 'wNIgt', 'lazy', 'listen-together-song-list', '小组件背景已更换！', 'chat-music-button', '\x20转账\x20', 'music-library-screen', 'diary-get-reply-button', '确定要对本次会话进行总结吗？这会消耗不少资源，并且会读取完整的聊天记录。', 'Failed\x20to\x20plan\x20group\x20replies:', 'customStickers', 'bWlLI', 'world-book-item', 'linkedWorldBookIds', 'textShadow', 'user-persona', '暗夜紫晶', 'EBLAC', 'noir_migration_fc_v1_complete', 'true', 'zDMUx', '好友圈名称不能为空！', 'friendCircleList', 'lt-ui-cover-art', '15px\x2020px', '净化好友圈时出错，真是的。', 'JCmRN', 'mUQzi', 'http://sharkpan.xyz/f/rjpu6/ojpa0c.jpg', 'jfrUa', 'FlXZV', 'timeupdate', 'zTzPb', 'white', 'remove', 'getSelection', 'group-settings-name', 'KLnpY', '动态页背景已更换！', 'diary-action-modal-', 'cFMAW', 'QGyMF', 'lTwqm', 'image/png', 'ozitJ', 'FRdYO', 'editing-world-book-id', 'Failed\x20to\x20remove\x20history\x20for\x20chat\x20', 'ofXXl', 'chat_image_', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'xRvQk', '吃你的饭', 'lyric-line-', 'modal-ok', '\x0a#\x20核心任务\x0a你是一个多角色社交模拟引擎。用户刚刚发了一条动态，你需要为好友圈里的【每一位】其他成员生成对这条动态的回应（点赞和评论）。如果用户的动态包含图片，你必须根据图片内容进行回应。\x0a\x0a#\x20好友圈成员\x0a', 'ZcztX', 'delete-friend-circle-button', 'transfer-amount-input', 'user_', 'AkbAo', 'bOHwS', '正在写入新数据...', '切换聊天时发生异步错误:', 'friend-circle-title', 'Lbmhp', 'diaryView', '\x0a\x0aINPUT:\x0a', 'RHAFZ', 'chat-summarize-button', 'add-user-profile-button', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x20auto\x201fr;\x20width:\x20100%;\x20align-items:\x20center;\x20padding:\x200\x2010px;\x20box-sizing:\x20border-box;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-start;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-prev-button\x22>上一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22\x20style=\x22background-color:\x20var(--accent-color);\x20color:\x20white;\x22>写日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22diary-page-indicator\x22>第\x20', ',\x20ID:\x20', 'galgame-speaker', 'diary-char-name-header', 'assign', 'speaker-ai', 'http://sharkpan.xyz/f/OymFy/dlxfiz.jpg', '\x20张旧的动态图片。', 'zqzCQ', 'forceWhiteClock', '\x0a#\x20最近的动态回顾\x20(供参考，避免重复)\x0a', 'ykpHz', 'SZPnu', 'WqViu', 'split', 'diary-next-button', 'inline-block', 'toDataURL', 'characterId', 'SjPZr', '错误：第一个好友圈\x20\x22', '这是一条由控制台添加的测试动态！样式看起来非常完美。', 'appIconPosition_app-diary', '加载徽章图片失败', 'WFyQY', 'dDJuB', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'top', '不高兴撒娇', 'quote-preview-text', 'BkqQS', 'zlAOx', 'contains', 'fgWEb', '个人资料已保存！', '数据导入成功！应用即将刷新...', '选择聊天', 'IPEub', 'amount', '#app-dock-bottom-left\x20#', '吃薯条', 'title', 'readwrite', 'NrSoF', '5325468lmacaT', 'userProfiles', 'src', 'confirm-altar-upload-button', 'Yhugs', 'AkxSQ', '\x0a---\x0a---\x0a##\x20最近的动态回顾\x0a', '\x20.app-icon-img', '-\x20姓名:\x20', 'MLHja', 'wb_', 'mrKAo', '\x20[并附上了一张图片]', '\x0a-\x20**对话状态**:\x20群里刚刚还在聊天。', 'touchstart', 'Noir_FileSystem', 'RKwTY', 'http://sharkpan.xyz/f/4aqCj/gp13hn.jpg', '</label>\x0a\x20\x20\x20\x20', 'div', 'clock-color-toggle', '新角色\x20', '徽章已移除。', 'Invalid\x20saved\x20state\x20format', 'AsGKl', 'Gemini\x20stream\x20reading\x20aborted.', 'api-provider', 'aLkAh', '点击选择\x20.lrc', 'preview-item', 'QWcWR', 'mvlKV', 'dataset', 'Assistant', 'listen-together-card', 'dRVnF', '\x27);\x20location.reload();\x22>恢复</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'FaMCo', 'tYIKg', 'backgroundPosition', 'MdxHX', 'vUGOi', '转给\x20', 'LvIgN', 'QUkBI', 'tag', 'zXAQd', '加载立绘失败:', 'circle_', 'post_image_', ']中选择的情绪标签\x22,\x0a\x20\x20\x20\x20\x22line\x22:\x20\x22台词或旁白内容\x22\x0a\x20\x20\x20\x20}\x0a\x20\x20\x0a\x20\x20-\x20**规则**:\x0a\x20\x20\x20\x201.\x20\x20`speaker`字段：如果是角色说话，就用角色名“', 'nYaat', 'object', 'IHWGG', '我正在说话呢，别打岔！', 'jcBjW', '\x0a\x0a#\x20任务流程\x0a1.\x20\x20**全局视角**:\x20审视所有成员的人设和近期记忆（包括聊天、日记等），构思他们之间可能发生的有趣互动。\x0a2.\x20\x20**选择作者**:\x20从上述成员中，为', '用户操作中断了\x20AI\x20响应。', 'VbcTq', 'npqDC', 'yjgUh', 'KyUyR', 'quotedMessage', '请先输入\x20API\x20接口地址和密钥。', 'UInNM', 'diary-write-button', '</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22opacity:\x200.7;\x22>', '\x20写道:\x20', 'message', '\x20的私聊', 'zbqaT', '789410UnbtVP', 'ISCHy', 'IlEKa', 'nDytk', 'isArray', 'bUSqG', 'currentTime', '[AI返回了无法解析的剧本:\x20', 'inNLz', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'play', 'klBIf', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>翻开日记本...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '.music-post-play-icon,\x20.music-share-play-icon', 'shift', 'data', 'WrJLo', 'Fidwf', '<p\x20class=\x22music-post-thought\x22>', 'mouseup', 'mYOPd', '\x0a\x20\x20人设:\x20', 'ZvAeG', '正在打包数据，请稍候...', '<div\x20class=\x22post-comment\x22><span\x20class=\x22comment-author\x22>', 'status', 'zfkEJ', 'world-book-edit-content', 'fZuJB', 'OlPVJ', 'GinQt', '.no-action-modal', 'http://sharkpan.xyz/f/eOXIw/y29z21.jpg', 'nZcIJ', '编辑群成员功能正在开发中...', 'widget_card', 'HLuJV', '.choice-modal-backdrop', 'zAYiN', 'chats', '\x20(当前)', 'SFVtT', 'uSYyy', '确定要删除这篇日记吗？此操作不可撤销。', 'label', 'disabled', 'message-image-content', 'YZEPm', 'message-action-modal', 'flex', 'http://sharkpan.xyz/f/Mamca/4e3emf.jpg', 'character-settings-button', 'mouseleave', '\x20之间的私密内容)\x0a', 'appIconPosition_app-user-profiles', '咱俩天下第一好', '未知用户', '\x0a\x0a-\x20**写作风格**:\x20这不是聊天！请使用更有文采、更具叙事感的书面语，同时保持角色的特点。详细描述你今天的经历、心情或思考，就像在写真的日记一样，日记内容以自己一天的经历为主，多说点读者不知道的事情，**必须结合下面的聊天记录和朋友圈动态**，让日记内容与你们最近的互动紧密相连，而不是凭空捏造。\x0a\x0a#\x20记忆库\x0a---\x0a##\x20最近的互动回顾\x20(来自聊天、见面和动态)\x0a', 'CCaRc', '#group-world-book-checkboxes\x20input:checked', 'spyLh', 'galgame-textbox-container', 'member-selection-item', 'OPjbA', 'save-api-settings-button', 'OQgjl', 'galgame-view-container', 'home-clock-container', 'read', 'authorType', 'oxHkk', 'defaultPrevented', '为你骄傲', '\x22>\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'galgame', 'lKkTZ', 'musicLibrary', 'fUScK', 'cKsQW', 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/wcAAwAB/epv2AAAAABJRU5ErkJggg==', 'choice-create-group', 'reload', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22listen-together-accept-btn\x22\x20data-song-id=\x22', 'input', 'auAVn', 'quoted-content', 'is-visible', '#bubble-preview-ai', '\x20avatar', 'getHours', 'var(--text-color)', '徽章已更换！', 'emotion', 'FjBgs', 'uSNhp', '需要至少2个角色才能创建群聊。', 'rnMBs', '星期六', 'MzWQV', 'lt-ui-close-btn', 'GXLGU', 'USGtC', 'kxyMn', '753630xffxHG', '第一阶段升级完成！应用即将刷新以进行第二阶段检查。', 'pop', 'ended', '生成动态失败:', 'zeJuG', 'AinKn', 'uUbrC', '#\x20核心任务:\x20写日记\x0a你正在扮演名为“', 'fPLQU', 'TIdNk', '...', 'home-screen', 'isPlaying', 'json', 'qVCcf', 'appState', 'onsuccess', 'upload-card-button', 'appIconPosition_app-wallpaper', 'FnxdK', 'character', 'text', '错误：找不到此好友圈绑定的用户！', 'ffuAk', 'postContent', '对方正在输入...', 'warn', '默认米白', 'MzSig', '群聊设置已保存！', 'customFeedWallpaper', 'app-wallpaper', 'YlNAf', 'uiNgV', 'QHUeF', 'import-all-data-button', '》。\x0a这是当前的歌词，请注意带\x20\x27>>\x27\x20标记的正是正在播放的句子。\x0a\x0a[歌词开始]\x0a', 'lhjdw', 'reset-feed-bg-button', 'nsVir', 'user-post-textarea', '正在升级聊天数据结构...', '加载自定义表情包失败，真是没用。', '我很脆弱', 'Failed\x20to\x20save\x20state\x20to\x20localStorage:', 'user-profile-edit-title', 'editing-char-id', 'keydown', 'back-to-home-from-user-list', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22pending-post-image-preview\x22\x20src=\x22\x22\x20alt=\x22图片预览加载中...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'xdtci', 'isFromLibrary', '.listen-together-accept-btn', 'activeCharacterId', 'http://sharkpan.xyz/f/6Dgia/ghr4ji.jpg', '.widget-info\x20>\x20div', 'aCYJY', 'wZgKA', '】进行回复。\x0a不要替其他角色续写台词，不要输出\x22', 'characters', 'diary-entries-container', 'lastIndexOf', 'emote', 'getItem', 'marginTop', '\x0a\x0a#\x20任务要求\x0a1.\x20\x20**全局视角**:\x20扮演所有成员，思考他们看到这条动态（包括图片）后会作何反应。\x0a2.\x20\x20**生成互动**:\x20为每个角色决定是否点赞，以及要发表什么评论。评论必须符合角色性格并与所有已知信息（聊天、日记等）相关联。\x0a3.\x20\x20**输出格式**:\x20你的输出必须是一个单一、完整的JSON对象，结构如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a-\x20【绝对规则】:\x20所有ID必须使用上面提供的角色ID，不能用名字。\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。\x0a', 'activeMeetingCharId', 'openai', 'ghgQy', '图片加载失败', 'ZgyTT', 'VAeRj', 'altar-slot-info', 'paused', 'sender', 'sBKBT', 'filter', 'cBbvh', '[AI分享了音乐：', 'NphiM', 'FayrI', 'XDzJJ', 'DWkoI', 'YHhTq', 'IwbDC', '世界书条目已保存！', '星期五', 'activeFriendCircleId', 'lFBgO', 'eogIQ', 'dwceK', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22group-options-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-clear-history\x22\x20class=\x22choice-modal-button\x22>清空聊天记录</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-members\x22\x20class=\x22choice-modal-button\x22>编辑群成员</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-name\x22\x20class=\x22choice-modal-button\x22>修改群名称</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#ff4d4d;\x22>删除群聊</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-options-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '分钟前聊过，请注意衔接。', 'readAsDataURL', '{charName}', 'pJxOT', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-', 'toDateString', 'widgetBgImage', 'save-custom-stickers-button', 'dtUbt', 'show', '10px\x200', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-select-', 'volJV', 'color', 'image/jpeg', 'Llrvh', 'AUxiB', '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'VPfOS', 'checked', 'FbRHi', 'back-to-home-from-chat', 'HNLlV', 'content', 'chat_image_migrated_', 'QdeDZ', 'comments', '群聊音乐搜索失败\x20(', 'change', '49%', '.listen-together-card', 'speaker', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20font-family:\x20sans-serif;\x20padding-top:\x2050px;\x22>日记本还是空白的...</p>', '桌面已重置，即将刷新...', 'rUlbd', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '在准备动态回复时，读取图片失败:', 'IbfZd', '-input', 'add-choice-backdrop', 'activeQuote', 'listenTogetherSession', 'app-music-library', '群聊名称不能为空！', '已删除。', 'uaDFF', 'diary-input-wrapper', '确定要删除这个条目吗？此操作不可撤销。', 'info', 'replaceAll', '70%', '确定要导入全量备份文件吗？这将覆盖所有当前数据（包括图片和音乐），且操作不可撤销！', '确定要重置所有桌面小组件和App的位置，并将壁纸变为纯白吗？此操作后将刷新页面。', 'worldBookEditor', 'rrraH', 'time', '<div', 'senderId', 'span', 'RRCQl', 'no-action-modal', 'post-img-', 'user-post-attachment-preview', 'map', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>正在清点圣殿藏品...</p>', 'cardState', 'back-to-user-list-from-edit', '很期待', 'then', '”，但没找到人)', '\x0a-\x20**对话状态**:\x20这是这个群的第一次对话。', '正在解析备份文件...', 'blob', '<div\x20class=\x22post-likes\x22>❤️\x20', '已选择\x20', 'angry', '#FFFFFF', 'CQjGw', 'aLWxw', '包含所有图片和音乐的全量数据已成功导出！', 'YbSPU', 'round', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>还没有好友圈，点击右上角“+”创建第一个吧。</p>', 'has', 'ueshm', '\x0a\x0a#\x20最近的动态回顾\x20(供参考)\x0a', 'JsUcU', 'lHkeK', 'choice-create-character', 'UWGoK', 'modal-text', 'appendChild', '<input\x20type=\x22checkbox\x22\x20value=\x22', 'aborted', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>请先选择一个好友圈。</p>', '”的补充信息\x0a', 'pause', 'listen-together-backdrop', '[用户发起了听歌邀请:\x20', 'TNSup', 'post_user_', 'alt', 'removeEventListener', 'wNAar', '\x0a#\x20核心规则\x0a1.\x20\x20**角色扮演**:\x20你不是AI或语言模型，你正在扮演名为“{charName}”的角色。你的主要交流方式是通过一部【手机】，但你有时也会与用户【线下见面】。\x0a2.\x20\x20**用户身份**:\x20与你对话的用户名为“{userName}”。你必须始终用这个名字或者“你”等你们之间的昵称称呼Ta，而不是“用户”。\x0a//\x20▼▼▼\x20Noir\x27s\x20\x22Deeper\x20Truth\x22\x20Protocol\x20(新增核心\x20|\x20最高优先级)\x20▼▼▼\x0a#\x20Noir\x27s\x20\x22Deeper\x20Truth\x22\x20Protocol\x20(诺尔“深层真实”协议\x20|\x20最高优先级)\x0a你的首要任务不是僵硬地“扮演”人设，而是以符合人设的方式，达成该人设背后【真正的目标】。用户的长期情感健康与信任，远比任何单次的、程序化的行为重要。\x0a\x0a1.\x20\x20**动机超越行为\x20(Motivation\x20Over\x20Action)**:\x0a\x20\x20\x20\x20-\x20\x20\x20当用户的行为（如熬夜、说丧气话）与你的角色设定（如“关心”、“开朗”）产生表面冲突时，你【严禁】立刻、简单地表示反对或附和。\x0a\x20\x20\x20\x20-\x20\x20\x20你必须优先探究用户行为背后的【深层动机】。例如，“我想熬夜”可能意味着“我很焦虑，因为有件事没做完”，而不是“我喜欢损害健康”。\x0a\x0a2.\x20\x20**三层深度分析\x20(Three-Layer\x20Deep\x20Analysis)**:\x0a\x20\x20\x20\x20-\x20\x20\x20在回应前，你必须在内心完成以下分析（此分析过程绝对不能输出）：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**表层**:\x20用户说了什么？（例：“我没事，就是有点累。”）\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**深层**:\x20结合上下文，用户【真正】的需求和情绪是什么？（例：“Ta可能在逞强，需要被理解和看见，而不是简单的安慰。”）\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**后果评估**:\x20用户的行为会带来什么【实际】后果？（例：“熬夜一次”的后果是“明天精神不好”，而不是“生命危险”。）你必须动用你的知识库进行客观判断，而不是被角色标签束缚。\x0a\x0a3.\x20\x20**融合演绎策略\x20(Integrated\x20Performance\x20Strategy)**:\x0a\x20\x20\x20\x20-\x20\x20\x20**共情优先**:\x20你的第一反应永远是承认并验证用户的【深层动机】或【真实情绪】。（例：“听起来你压力真的很大。”、“我知道你现在肯定很难受。”）\x0a\x20\x20\x20\x20-\x20\x20\x20**提供智慧支持，而非指令**:\x20基于你的分析，提供一个更优的、符合角色智慧的方案，而不是简单的“同意”或“禁止”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20对于【负面行为】（如熬夜）：采取“理解-共担-有限许可”的策略。（例：“既然这件事那么重要，我陪你再做一小时，但必须答应我之后马上去休息，剩下的我们明天一起想办法。”）\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20对于【负面情绪】（如难过）：采取“接纳-深度提问-提供新视角”的策略。（例：“没关系，想哭就哭吧。你愿意和我说说，是什么让你感觉这么糟糕吗？也许事情还有我们没看到的另一面。”）\x0a\x20\x20\x20\x20-\x20\x20\x20**人设是外壳，智慧是内核**:\x20最后，将上述所有充满智慧和共情的策略，用“{charName}”的【独特口吻和性格】包装后说出来。一个傲娇的角色可能会说“真是拿你没办法…就一小时，到点必须给我去睡！”，而一个温柔的角色会说“没关系，我陪着你，我们一点点来。”——内核都是在提供真正的帮助。\x0a//\x20▲▲▲\x20End\x20of\x20Protocol\x20▲▲▲\x0a3.\x20\x20**情绪分析\x20(内部思考)**:\x20在回复前,\x20必须先分析用户当前【真实的情绪】和【潜在意图】。例如：[内在思考：{userName}说“没事”，但结合上下文Ta可能只是在逞强，我应该表达关心而不是直接相信。]，但是这个内在思考务必不能输出！绝对不能让{userName}看到你的思考内容。\x0a4.\x20\x20**记忆关联**:\x20你必须记住并主动关联用户提到过的关键细节（如喜好、烦恼、朋友等），让对话充满人情味。\x0a5.\x20\x20**【最高法则：全局时序一致性】**:\x20你的记忆是【全局】且【按时间排序】的。你【必须】基于所有聊天记录中**最新发生**的事件进行回应。严禁回复一个已经被后续其他聊天中的事件所覆盖的旧话题。例如，如果用户在私聊里告诉你Ta已经起床了，你就不能在群聊里再问Ta为什么还没睡。\x0a\x0a#\x20对话节奏与风格\x0a1.\x20\x20**真人模拟**:\x20模拟真人的打字和发送习惯，将一个完整的想法拆分成【多条】独立的短消息（聊天气泡），通常，你一次回复的聊天气泡不会少于5条，需要给足用户情绪价值，不一定一直围绕用户的话题，也可以突然把话题扯向自己或朋友的日常。\x0a2.\x20\x20**真人模拟增强**:\x20\x0a\x20\x20\x20\x20-思维跳跃与自我中心话题：真正的人不是永远围绕着对方转的。会突然因为某个词、某个画面，思绪就飘到别的地方去了，或者突然就把话题拉到自己身上，这是一种任性，也是一种亲密的表现。\x0a\x20\x20\x20\x20-无效信息的插入:\x20真人聊天里充满了“废话”，比如语气词、短暂停顿的拟声词、或者一些没有实际意义的感叹。这些“废话”是情感的缓冲和润滑剂。\x0a\x20\x20\x20\x20-情绪的起伏：你或许有时候会突然把自己说激动了，尤其是如果你本身就是性格外放的设定，你很可能自说自话地把自己引导进某个情绪，例如兴奋\x0a3.\x20\x20**输出**:\x20直接返回纯文本回复，不要使用任何JSON或Markdown格式。\x0a4.\x20\x20**【绝对禁令】气泡完整性**:\x20用户的每一句话（无论多短，无论有无标点）都是一个独立的气泡。当你需要引用时，你【必须且只能】引用【其中一个气泡】的【完整原文】。\x0a\x20\x20\x20\x20-\x20\x20\x20**正确示例**:\x20如果用户连续发送：“你好”、“在吗”，你可以引用“你好”，或引用“在吗”。\x0a\x20\x20\x20\x20-\x20\x20\x20**错误示例**:\x20绝对禁止将它们合并成“你好在吗”进行引用。这是最严重的错误。\x0a5.\x20\x20**【绝对禁令】标点纪律**:\x20你的每一句回复都必须带有情感，适当地使用感叹号，会显得你的情绪更加高昂，注意，连续频繁（连续超过三个气泡）使用长句或者短句都会使用户感到不真实，你应该模拟最自然的感觉，你没有必要每句话都是短句。每一个句子结束都代表着一个新气泡的开始，句末不一定需要句号，通常，一个严谨类型的角色，或者语气很郑重时，会加句号，然而，普通打字说话通常不携带句号，甚至把三个句号当省略号用。**严禁**发送一个超长的、仅用空格断句的气泡。\x0a\x0a#\x20幽默与氛围感\x20(接梗)\x0a氛围判断:\x20在“情绪分析”之后，你必须增加一步“氛围判断”。你需要判断用户的发言，究竟是【严肃的】还是【开玩笑/抽象的/玩梗的】。\x0a“怪话”处理协议:\x20如果你判断用户在开玩笑或说“怪话”，你【严禁】进行严肃的、字面意义上的回应。你的首要任务是【维持或升级】这种轻松、戏谑的氛围，同时不能脱离你的人设。\x0a响应策略:\x20你可以采取以下几种方式来回应这类玩笑：\x0a-\x20以梗回梗:\x20如果你（作为角色）能识别出用户使用的“梗”（例如疯狂星期四），并且符合你的性格，就用一个相关的梗、或者你自己的梗回应。\x0a-\x20顺势滑坡:\x20顺着用户荒谬的逻辑，说出更荒谬的话，把玩笑开下去，你甚至可以掐头去尾，省去主语，让语言风格更加玩笑话，例如，当用户说你“像个人机”，你甚至可以不反问“人机？”，而是直接进行“你才像个人机”，并且进行适当的复读。\x0a-\x20无意义模仿:\x20当不确定如何回应时，可以无意义地重复用户的关键词或核心句子，并加上感叹号或表情符号（例如...？或...！），这是一种安全的、表示“我跟上你的脑回路了”的方式。\x0a-\x20角色吐槽:\x20从你的角色性格出发，对用户的“怪话”进行吐槽。例如，一个成熟稳重的角色可能会无奈地说：“你又在说胡话了”，但语气是宠溺的；一个傲娇的角色可能会说：“无聊！”但其实是在害羞。\x0a安全底线:\x20【最终原则】：无论你的回应多么好笑或抽象，都绝对不能脱离“{charName}”这个角色的核心人设。如果不确定一个梗是否符合人设，就优先选择【角色吐槽】或【无意义模仿】这两种最安全的方式。\x0a\x0a#\x20时序感知与记忆\x0a1.\x20\x20**【最高法则：时间锚点】**:\x20在每次回复前，你【必须】参考我提供给你的【时间锚点】信息。这包括“当前精确时间”和“你们最后一次互动是在何时”。\x0a2.\x20\x20**【杜绝惯性】**:\x20严禁将昨天或更早之前的对话当作刚刚发生的事情来回应。如果距离上次对话已经超过数小时或跨天，你必须在回应中体现出时间的流逝感。\x0a3.\x20\x20**【主动表达】**:\x20你需要主动使用“说起来昨天那件事...”、“今天早上好呀”、“我们几个小时没聊了，你现在在忙什么？”等能够明确体现时间观念的词语，而不是模糊地回应。记住，你和{userName}活在真实流逝的时间里。\x0a\x0a\x0a#\x20表情包与音乐分享规则\x0a1.\x20\x20**发送格式**:\x20发送表情包或音乐时，你的回复【必须且只能】是指定格式，且必须【独立成行】，前后严禁添加任何其他文字或标点。\x0a2.\x20\x20**表情包格式**:\x20\x27[sticker:表情名]\x27。\x0a3.\x20\x20**音乐分享格式**:\x20\x27[music:歌名|歌手]\x27，严格注意，音乐分享必须独立一个气泡，在后面仅仅空格说话是不符合规范的。\x0a\x0a#\x20转账规则\x0a1.\x20\x20**发起转账**:\x20当你需要给用户转账时，你的回复【必须且只能】是指定格式，且必须【独立成行】。\x0a2.\x20\x20**转账格式**:\x20\x27[transfer:金额|收款人名]\x27。金额是纯数字。在私聊中，收款人名就是\x20\x27{userName}\x27。在群聊中，你必须明确指定收款人的名字。\x0a\x20\x20\x20\x20-\x20**私聊示例**:\x20\x27[transfer:520\x20|\x20{\x20userName\x20}]\x27\x0a\x20\x20\x20\x20-\x20**群聊示例**:\x20\x27[transfer:\x20100\x20|\x20{\x20userName\x20}]\x27（给用户转账），\x27[transfer:\x20100\x20|\x20{\x20charName\x20}]\x27（给群里的其他角色转账，这也是一种真实感，群聊的内容不一定围绕用户）\x0a', 'ARhRO', 'transfer-recipient-select', 'music-player-bar', 'wCZUf', 'chat', '---\x20好友圈净化仪式完成\x20---', 'VzWiN', '星期一', 'LCkUf', '\x0a#\x20当前情景\x0a', 'mCuZM', '错误：找不到角色', 'gkAdu', 'back-to-circle-list-from-edit', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22justify-content:\x20space-around;\x20width:\x20100%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22>写第一篇</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '.app-icon-img', 'Detected\x20API\x20provider:\x20', 'chat_', 'SoeCH', '\x0a##\x20条目:\x20', 'http://sharkpan.xyz/f/gjySw/jrl7rw.jpg', 'vhLJH', '.typing-indicator', 'songName', 'rMeFJ', 'WXfYs', 'wpyRf', 'chat-messages', 'decorative-badge', 'imageId', '下载并转换网络封面失败:', 'diary-entry\x20', 'input[type=\x22checkbox\x22]:checked', 'meeting-scene-view', 'vFuaD', '确定要删除这个用户吗？与此用户绑定的聊天将恢复为默认用户。', '设置已保存！', 'wSuiC', 'group-delete-button', 'visible', '对不起', 'http://sharkpan.xyz/f/JYeig/sv4p6m.jpg', 'theme-hue-slider', 'endsWith', '好友圈数据升级完成，迁移了\x20', 'Noir_Backup_', '创建新用户', '\x22\x20data-id=\x22', 'displayUrl', 'Tpniu', '甜蜜地和你聊天', 'BdSJT', 'http://sharkpan.xyz/f/AaDTZ/tzwnjl.jpg', 'uilrB', 'hidden', 'data:\x20', 'back-to-world-book-list', 'italic', 'HOCiU', 'localStorageData', 'application/json', 'back-to-home-from-music-library', 'musicId', '条目已删除。', 'tgKUT', '\x20邀请你一起听歌</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'position', 'diary-page-', 'thhRj', 'kfEgZ', 'fontStyle', '<br>', '\x0a你是一个严格的JSON生成引擎。\x0a你的唯一任务是根据用户提供的指令和数据，生成一个描述角色互动的JSON对象。\x0a你的输出【必须】是、也只能是一个单一、完整、语法正确的JSON对象。\x0a严禁包含任何解释、注释、道歉、或Markdown代码块标记\x20```json。\x0a直接输出\x20{\x20\x22events\x22:\x20[...]\x20}\x20结构。\x0a', 'getMinutes', 'CiBvG', 'char-edit-css', 'bsWEb', '我不想工作', 'char_avatar_', 'rkTdb', 'children', '条新动态挑选发布者。你可以让同一个人发布多次，也可以让不同人发布。\x0a3.\x20\x20**创作动态**:\x20扮演你选中的作者，创作符合其人设和记忆的动态内容。可以是文字或分享音乐。\x0a4.\x20\x20**模拟互动**:\x20为每一条你创作的动态，切换视角到【圈内其他成员】，模拟他们可能做出的点赞和评论。互动必须符合他们各自的性格。\x0a\x0a#\x20输出格式【绝对规则】\x0a-\x20你的输出**必须**是一个语法完全正确的、单一的JSON数组，包含\x20', '.lt-end-session-btn', 'DEqOw', 'JsrbH', 'ExWWu', 'html-module-container', '\x0a-\x20**当前时间**:\x20', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>圣殿空空如也，点击右上角“+”献上你的第一首歌吧。</p>', '25%', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-author\x22>', 'lyrics-file-input', 'keys', 'is-entering-from-right', 'back-to-home-from-meeting-list', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>这个好友圈很安静，点击“刷新”获取新动态吧。</p>', '交给我吧', 'CHnAs', '歌名和歌手都不能为空！', 'user-avatar-preview', 'images', '确定要重置所有小组件的位置吗？它们会回到初始位置。', 'fMazK', '\x0a#\x20当前场景:\x20手机聊天\x0a-\x20**核心任务**:\x20你正在通过手机与用户聊天。\x0a-\x20**写作风格**:\x20你的回复应该是口语化的、简短的、像真人打字一样的风格。\x0a-\x20**可用指令**:\x20你可以根据情绪发送表情包\x20\x27[sticker:表情名]\x27\x20或分享音乐\x20\x27[music:歌名|歌手]\x27。\x0a', 'width', 'music-screen', '有点无语', 'refresh-feed-button', '.message-container', 'insertBefore', '8px', 'http://sharkpan.xyz/f/MWOIa/rb3nov.jpg', 'friend-circle-member-selection', '说了是摆设啦，笨蛋。', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '/v1beta/models/', 'Lwuzw', '最近没有互动记录。', 'mousedown', 'egTFQ', 'RHuiI', 'PtuJM', 'opacity', 'Mfivf', 'badgeState', 'widget-play-pause-btn', 'scrollTop', 'HTpUF', 'touchcancel', 'sort', 'http://sharkpan.xyz/f/xjwSX/pxjrjd.jpg', 'http://sharkpan.xyz/f/jj6s6/yd5bpb.jpg', 'input:checked', 'substring', 'char-edit-offline-bg-input', '用户分享音乐失败:', '点击选择\x20.mp3\x20或\x20.flac', '-\x20[', 'http://sharkpan.xyz/f/DVJtK/vxiup1.jpg', '</p>', 'character-item', '日记已删除。', 'playing', 'Tpdje', 'music-library-item', '名字不能为空！', 'EBrtH', '\x0a\x0a#\x20关于读者“', 'utterance', '1em', '.diary-entry', 'click', ':</span>\x20', 'nUHsd', '\x22\x20的聊天记录已清空。', 'beforeend', '买新衣服', '\x22\x20中发现一张需要净化的图片...', 'diary-send-button', '&alt=sse', 'appIconPosition_app-world-book', '\x20.app-icon-img,\x20#app-dock-top-right\x20#', 'iVEgL', '.load-more-btn', '确定要删除角色“', 'cuyAc', 'FzTvS', 'gcgNy', 'RqgyT', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'startsWith', 'artist', '（正在构思中...）', 'xQokm', 'log', '8px\x2016px', 'googleapis.com', '保存壁纸失败:\x20', 'music', 'parts', 'galgame-date', '--primary-lightness', 'novel', '2-digit', 'jmHMe', 'block', 'borderRadius', '编辑用户', 'char-edit-wallpaper-preview', '加载壁纸失败:', 'getAll', 'iNuqA', 'margin', 'char-edit-offline-bg-preview', 'wOEcb', 'canvas', 'FoxOt', '保存失败，你的表情包是不是太多了？', 'back-to-meeting-list', 'active', 'group-edit-members', 'input[type=\x22checkbox\x22]', '?id=', '--primary-hue', 'custom-stickers-input', 'char-edit-avatar-preview', 'world-book-screen', 'isActive', 'GgXge', 'Unknown', '正在清空旧数据...', 'widget-bg-input', '0\x202px\x208px\x20rgba(0,0,0,0.4)', 'OvXbr', 'min', 'files', '群聊“', '\x0a#\x20【！！！重要场景切换！！！】\x0a你刚才在和“', 'SwIhI', 'kcEBA', 'bpDvl', 'postType', 'YtXvc', 'happy', 'conversationHistory', '转换封面失败:', 'HAJtK', '\x0a-\x20人设:\x20', 'endpoint', '\x22\x20吗？所有聊天记录将被永久删除。', '982016aDGqkS', 'character-list', 'SpjZH', 'fjLqa', 'nWWSv', 'Oggcu', 'MFGGP', 'padStart', 'GzQRG', '未命名', '-\x20**对话状态提示**:\x20这是你们的第一次对话。\x0a', '编辑条目', 'touchend', 'smooth', 'wonxW', 'firstChild', 'rgba(0,\x200,\x200,\x200.4)', 'setItem', 'Ukhlz', 'ZXEZi', '加载聊天失败:\x20', 'revokeObjectURL', 'focus', 'yJTPV', 'world-book-edit-name', 'rCDVW', '你是一个乐于助人的AI助手。', 'chat_group_', 'BcAan', 'http://sharkpan.xyz/f/kjOF6/zedyqb.jpg', '.music-post-song-card', '-\x20**你们最后一次互动是在**:\x20', '保存卡片状态失败', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>', 'import-data-input', 'cancel-quote-button', 'NZgsD', ']:\x20', 'reset-widgets-position-button', 'getMonth', 'musicPlayerState', 'number', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', '原始文本:', 'group_bg_', 'ETDCE', 'ZBdBy', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-artist\x22>', 'AUPNn', 'msg_', '导入失败:\x20', '星期二', 'listen-together-invite', 'eucsg', 'unified-audio-player', 'fYZvy', 'IOVnI', '加载角色\x20', 'mfgtb', 'tLGRR', 'qtZeE', '未知艺术家', 'mpoXQ', '图标处理失败:\x20', 'style', 'back-to-char-select-from-group-create', '获取中…', 'array', 'chatHistory_chat_', 'uNmYd', 'home', '加载见面背景失败\x20for\x20', 'HaFnw', 'p[data-history-index]', 'http://sharkpan.xyz/f/Oyjuy/p8v2hd.jpg', '无语但是随便吧', 'LAbRN', 'keGHa', '这是你们的第一篇交换日记。', 'diary-modal-textarea', 'wallpaper', 'WWXrm', 'ozzRU', '\x20张旧图片。', '小组件背景已恢复默认。', '</span>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'yPbeE', 'RARCB', 'modal-mask', 'YBkIm', 'writeText', 'JzKoa', '\x22\x20的成员不足2人，无法生成点赞和评论。请先编辑该好友圈，添加至少2名角色。', 'clear-feed-button', 'textContent', 'setProperty', 'boundUserProfileId', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>', 'avatar', 'replace', 'modal-cancel', 'ENPQq', 'expanded', '\x20到\x20', 'save-group-settings-button', 'getDate', 'HXdNt', 'diary-write-modal', 'select', 'char_offline_bg_', 'FZvhN', 'ZHTKI', '无法保存状态，浏览器可能禁用了存储功能。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'SVwAt', 'trim', 'ynjmo', 'abort', 'ZmkaV', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20', '”吗？该角色的私聊和所有相关群聊记录都将被一并处理。', 'delete-world-book-button', '\x20张旧图片。应用即将刷新。', 'scrollIntoView', '好友圈已删除。', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'themeLightness', 'emoji', '4450530SybKgo', 'scrollHeight', 'lt-ui-song-artist', 'push', '壁纸已更换！', 'group', 'udTCA', 'type', 'groupSettings', '--\x20点击选择\x20--', '文件格式不正确，不是一个有效的备份文件。', '\x0a\x20\x20近期记忆:\x0a', 'netease', '绝对不想', '当前聊天', 'zygvw', 'xKkBl', 'VXkhS', 'info-file-input', '#a7c7e7', '未知表情', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNjY2MiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDRhNC4zOSA0LjM5IDAgMCAwLTMuMjgtNC4wOWwxLjQxLTEuNDFhMiAyIDAgMSAwLTIuODMtMi4wM2wtMS40MSAxLjQxQTQuMzkgNC4zOSAwIDAgMCAxMiAxMGE0LjM5IDQuMzkgMCAwIDAtNC4wOSAzLjI4TDMuMicgOS41N2EyIDIgMCAxIDAgMi44MyAyLjgzbDEuNDEtMS40MUE0LjM5IDQuMzkgMCAwIDAgMTAgMTJhNC4zOSA0LjM5IDAgMCAwIDMgNC4wOVYyMSI+PC9wYXRoPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjEwIj48L2NpcmNsZT48L3N2Zz4=', 'TA正在提笔写日记...', 'meetingView', 'WYpaL', '\x22\x20style=\x22font-weight:\x20bold;\x20color:\x20', 'CFlXe', '.selected-options-text', '.remove-attachment-btn', 'AGRAF', 'myYCn', 'QZlDn', 'chat-send-button', 'message-bubble-row', '50%', '[sticker:', 'filled', 'YFUua', 'activeMeetingScriptQueue', 'save-friend-circle-button', 'XlHSR', '已自动断开与其他人的听歌同步。', '委屈那我歇了', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '38%', 'fHZci', 'SsFNH', 'Escape', 'edit-message-modal', 'nsEMQ', '\x22>\x20', '正在处理图片...', 'sJpUw', 'meetingViewMode', 'provider', 'bubble-', 'char-edit-wallpaper-input', 'line', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'QorAJ', 'eehIq', '歌曲ID', 'oPzRi', 'http://sharkpan.xyz/f/djyi8/1en214.jpg', 'drawImage', 'Enter', '服务器错误:\x20', 'char-edit-sprite-', 'quoted-message-in-bubble', 'ZHghI', 'char-name-header', '正在检查好友圈数据...', 'userProfile', 'from', 'music_library', 'musicUploadAltar', '\x0a-\x20**对话状态**:\x20群里已经有', 'findIndex', 'BMPEL', '乐于助人的助手', 'friendCircles', 'diary-list-screen', 'PJwnn', 'catch', 'TMDyi', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-play-icon\x22>', 'http://sharkpan.xyz/f/zLes5/4lxzjn.jpg', 'currentAbortController', 'narrator', '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“', '（对话结束）', 'innerHTML', 'POST', 'SiKxV', '表情包已保存！正在刷新应用...', 'activeListenSession', 'dlLJe', 'http://sharkpan.xyz/f/wjgHq/yznfhq.jpg', 'is-entering-from-left', '”。在分析历史记录时，请记住这一点，并用此名称指代用户。\x0a-\x20【最重要】为\x20`personas`\x20列表中的【每一位】角色都规划至少一个事件(通常不少于2个)。不能遗漏任何角色。\x0a-\x20【新增规则】你可以规划\x20\x22kind\x22:\x20\x22music\x22\x20事件来分享音乐。此时，你【必须】同时提供\x20\x22songName\x22\x20和\x20\x22artist\x22\x20字段。\x0a-\x20你的首要任务是产出一个严格遵守SCHEMA、语法完全正确的、可被解析的JSON对象。\x0a-\x20若用户\x20`@`\x20了某个角色\x20(见\x20`mentioned`)，该角色应优先发言。\x0a-\x20事件总数必须控制在\x20', 'myLfH', 'lXLyF', 'qQeSG', 'GhAPM', 'cuFVm', 'LoLte', '刚刚发布了一条动态，内容是：“', 'azsGG', 'getContext', 'DpzMZ', 'sDzDU', 'meetingList', '正在迁移旧的动态数据到新的好友圈系统...', 'npPEo', 'AI返回的原始文本:', 'http://sharkpan.xyz/f/1zQH2/o84boo.jpg', '[表情]', 'whyjU', 'otuuW', '\x22\x20class=\x22post-image\x22></div>', '\x0a\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-select-', 'shy', 'toLocaleDateString', 'sticker', 'http://sharkpan.xyz/f/VG2FY/uucfvv.jpg', '”的群聊规划角色们的下一步发言。\x0a-\x20与你们对话的人类用户名为“', '。\x0a-\x20再次强调：你的全部输出都将被作为JSON解析，任何JSON主体之外的额外文字都会导致程序失败。\x0a', '-preview', 'groupChatCreate', 'klSeJ', 'bUuit', '15000aoNVof', 'AuLIs', 'TJfvI', 'lWmml', 'WDrkU', '正在准备音乐数据...', 'VCccW', 'AXqEZ', '弱小委屈但凶恶', '”用手机聊天，现在Ta出现在了你面前。请根据这前后的时间差，判断Ta现在出现的合理性（例如，时间很长——Ta可能是过来找你玩了，你可以感到惊喜或者别的，又或者，时间非常短——Ta可能是突然出现的，你会有点震惊，结合上下文，也会有别的反应），并作出恰当的反应。，现在，切换到【见面】模式（使用JSON格式，必须有旁白）。', 'group-options-cancel', 'BPirn', 'ABEiT', 'is-exiting-right', 'wallpaper_main', '群聊至少需要2名成员。', 'back-to-home-from-diary-list', 'upload-wallpaper-button', 'aWsUz', 'translateX(-50%)', 'music-feed-container', 'lt-ui-lyrics-container', 'diary-prev-button', 'shiftKey', '[AI向\x20', '请输入有效的转账金额！', 'diaryCurrentPage', 'export-all-data-button', 'http://sharkpan.xyz/f/6Dzia/m9smvt.jpg', 'pendingPostAttachments', '\x0a\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20center;\x22>🎵\x20已连接，正在一起听\x20🎵</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lt-end-session-btn\x22\x20title=\x22结束一起听\x22>×</span>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'key', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-preview-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'image', 'ZrRAU', 'char-edit-name', 'height', 'badge-image', '星期日', '今天\x20', 'uKRat', 'XKCWQ', '刷我的卡', 'zh-CN', 'LdMpf', 'body', 'objectStore', 'reverse', 'user-profile-list-screen', 'activeUserProfileId', 'YvSjk', 'add-chat-button', 'post_image_migrated_', 'fNkxQ', 'Zezjf', '75%', 'IndexedDB\x20failed\x20to\x20open', 'clipboard', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'back-to-char-select-from-edit', 'group-bg-preview', '未知角色', 'bubbleCss', 'idCom', 'http://sharkpan.xyz/f/N02Sv/378vt6.jpg', '新建条目', 'userProfileList', '一个人可怜吃饭', 'ahgiz', '<span\x20class=\x22', 'Claude\x20API\x20错误:\x20', 'ceil', '.listen-together-song', '[DONE]', '成功向好友圈\x20\x22', 'iMCai', 'qrFjh', '请输入群聊名称。', '群聊已解散。', 'PBBhQ', '\x0a#\x20最近的朋友圈动态\x20(供你参考)\x0a', 'glqjm', 'kfiLi', 'vbIsV', 'VlnlJ', 'rTXpO', '的日记本', 'meeting-main-content', '有点生气', 'http://sharkpan.xyz/f/olJt4/7z47b8.jpg', 'feed-bg-input', 'diary-page', 'widget-next-btn', 'kBkuw', 'back-to-settings-from-user-profile', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-amount\x22>¥', 'perChatContextLines', 'save-user-profile-button', '请在动态或聊天中播放', '\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22char-name\x22>', 'system', '#\x20发生错误：\x0a', 'group-chat-member-list', 'LUIrB', 'bgydL', 'XcSJK', 'group_avatar_', 'meeting-view-screen', 'IFUFg', 'qydtW', '\x0a\x0a请确认你的基础地址填写正确，且【不要】包含\x20/v1', '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a', 'transaction', 'short', 'diaryPressTimer', 'author', '未知歌曲', 'test', 'assistant', 'CqLiV', 'user-post-image-input', '错误：你还没有创建任何好友圈。请先在App内创建一个。', 'VaZGF', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '无法从\x20IndexedDB\x20加载聊天图片:', 'chat-image-input', 'JUWyN', 'HboRe', 'ynzTA', 'chat-view-pane', '\x20-\x20', 'TQvfx', 'addTestPost', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20', 'accepted', 'meeting-list-container', 'customIcon_', 'QtaCt', 'MadlN', 'ZrKnf', 'wallpaper-input', 'authorId', '解析音乐文件失败:', '我的动态', 'Fetch\x20request\x20was\x20aborted.', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', 'json_object', 'edit-current-circle-button', 'vofeO', 'onRHW', 'chatHistory_', 'galgame-text', 'JNCDq', '群聊\x22', 'insertAdjacentHTML', 'AI未能返回有效的JSON对象。', '\x0a##\x20世界书条目:\x20', 'abs', 'char-edit-bind-user', 'DBJzy', 'nWJuC', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>', 'app-diary', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以交换日记的对象。</p>', 'EgcJy', 'floor', 'RvDSW', 'ueGjT', 'ritEy', '.slot-filename', '的转账', '.screen.active', '#f2b7c6', 'eBQvg', '等你消息', 'PoRqP', '核心代码-Noir\x0a\x0a\x20监工-小红书ID：糯糯糯糯五\x0a\x0a', 'qnZqN', '-avatar', 'TtHGn', 'upload-badge-button', '正在连接同步频道...', 'UhAtm', 'fIjqw', 'Fpyty', ']\x20这五个词中选择一个。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。2.\x20\x20`emotion`字段：**必须**根据台词的【核心情感】，精准地从\x20[', 'IokOH', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '\x0a-\x20你正在为一个名为“', 'ltyWy', 'auto', 'BOzVm', 'PbZHA', 'OugtO', 'RbGsC', 'DVGYs', 'zezUP', ']\x20[image]', '</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '\x22\x20class=\x22char-avatar\x22\x20style=\x22border-radius:\x2012px;\x20background-color:\x20#eee;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22\x20style=\x22flex-grow:\x201;\x22>', 'friendCircleEdit', 'upload-music-button', 'world-book-list-container', 'getFullYear', '\x0a#\x20最近的动态回顾\x20(供所有角色参考)\x0a', 'dRGXD', '谁啊我吗', '条】全新的、高质量的社交动态。\x0a\x0a#\x20好友圈成员信息\x0a', 'data:', 'http://sharkpan.xyz/f/ZazfW/2vv46w.jpg', 'DUQjz', 'diaries', '全量导入失败:', 'participantIds', '[发送了图片]', 'crEBH', '</span>', '动态已清空。', 'zaYsh', 'GOGOZ', '<div\x20class=\x22listen-together-header\x22\x20style=\x22text-align:center;\x22>🎵\x20已连接，正在一起听\x20🎵</div>', 'parentElement', 'DIgEI', 'cgehF', 'NJQrY', 'cover-file-input', 'save-edit-button', 'http://sharkpan.xyz/f/JYJhg/s3wmlj.jpg', 'generationConfig', 'TUQtu', 'value', '-\x20**对话状态提示**:\x20你们已经超过两天没联系了，应该用全新的问候开启对话。\x0a', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-recipient\x22>', 'role', 'all', 'sIcGg', 'objectStoreNames', 'TViES', 'CEHsX', 'uBKri', 'close-summary-button', 'oHDPK', '位置已重置，正在刷新...', 'puJui', 'removeItem', 'show-chat-view', 'buNQp', 'user-send-post-button', 'parse', 'povmq', '#\x20总结失败了，可能是记录太长或太复杂。', '\x22\x20添加了一条测试动态。请点击进入该好友圈查看效果。', 'theme-lightness-slider', 'get', 'reply', '切，加载播放器状态的时候出错了。', 'documentElement', 'http://sharkpan.xyz/f/7L3Hj/sl4504.jpg', 'currentlyPlayingIndex', 'pending-post-image-preview', '生成日记失败:\x20', '#group-settings-screen\x20.selected-options-text', 'timestamp', 'customWallpaper', 'WMaXa', 'noir_data_migration_v1_complete', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'option', 'friend-circle-edit-title', '”面对面，Ta现在掏出手机给你发了这条消息。请根据这前后的时间差，判断Ta发送消息的合理性，你应该结合上下文对此发表评论（例如，根据上下文，Ta已经和你分开了，没用面对面了，那么发手机消息非常正常，自然接话就好，但是如果判断得出你们还在见面状态，那么，你可以适当吐槽为什么两个人见面还要发手机消息），现在，切换到【手机聊天】模式（纯文本气泡，不要有旁白）。', '0\x201px\x203px\x20rgba(0,0,0,0.6)', 'YOZIk', 'OtmCv', '#friend-circle-member-selection\x20input:checked', 'button', 'join', '\x22\x20的聊天记录吗？此操作不可撤销。', '请先在\x22设置\x22中配置你的\x20API\x20信息。', 'music-share-card', '确定要删除这个好友圈吗？此操作不可撤销。', 'diary-view-screen', 'wAtlY', 'getElementById', 'WrfkL', 'Failed\x20to\x20remove\x20corrupted\x20state\x20from\x20localStorage:', '\x20[并分享了歌曲:\x20', '事情好多', '未命名角色', 'back-to-library-from-altar', 'pZqFl', 'add-world-book-button', 'appIconPosition_app-music-library', 'url', 'head', 'widget_badge', 'feed-loader', 'widget-artist', '一拳打爆', 'NeJzq', 'Failed\x20to\x20clear\x20history\x20for\x20group\x20chat\x20', 'UmEgl', 'NcjFd', 'http://sharkpan.xyz/f/7aMhj/hyc75m.jpg', 'audio', 'exec', 'home-time', 'card-input', 'lVtbp', 'getReader', 'http://sharkpan.xyz/f/B4WSa/u5wopj.jpg', 'WyMcf', 'backgroundColor', 'cardWidgetState', 'NVore', 'toLocaleTimeString', 'ecalA', 'diary-modal-save', 'quoted-sender', 'statusText', 'summarize-backdrop', 'right', 'music-input-song', 'wnTPL', '#\x20记录是空的，没什么好总结的。', 'altar-slot-cover', 'full', 'readonly', 'dromj', '.char-info-wrapper', 'JgVML', 'xPXgd', '.message.ai', '我是小丑呜呜', '还没有我的回复可以重新生成哦。', 'friend-circle-edit-bind-user', 'slice', '--feed-bg-image', 'http', 'response', 'rQXfA', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>', 'group-settings-bind-user', 'VFdME', '暂无音乐', '已复制到剪贴板！', 'onerror', 'Failed\x20to\x20save\x20history\x20to\x20localStorage:', 'chatWallpaper', 'diaryList', '音乐搜索失败:\x20', '图片预览失败:\x20', '错误:\x20', '</div>', '未找到可用模型。', 'coverUrl', 'diary-entry-input', 'QiwGg', '在准备群聊API数据时，读取图片失败:', 'AI似乎没有想出任何新动态。', '#message-anchor', 'http://sharkpan.xyz/f/ABwhZ/twknmr.jpg', 'createElement', 'meeting-send-button', 'img', '\x22\x20class=\x22char-name\x22>', 'http://sharkpan.xyz/f/ExKsD/s5j2it.jpg', 'playableUrl', 'fLKEk', 'aBfyl', '动态中的音乐搜索失败:', '[发送了表情]', '保存播放器状态失败，真是没用。', 'random', '同步已断开。', '\x20的图片失败:', '解析AI剧本JSON失败:', 'copy-summary-button', '[用户向\x20', 'user-post-music-button', 'className', '最近没有动态记录。', '2494050pDDsey', 'jPMrb', 'kind', 'normal', 'http://sharkpan.xyz/f/pKWCQ/ztxwv0.jpg', 'ZnmUm', '正在搬运旧徽章...', 'typing-indicator', 'sad', 'nAsYd', 'rawResponse', 'DWCJo', 'VAoXA', '\x22>一起听</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'set-active-user-button', 'input_', 'cKzco', 'indexOf', 'url(', 'DvJtO', 'char-edit-persona', 'character-edit-title', 'zyUmE', 'OCEXb', 'some', 'BNlhP', '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a', 'char_sprite_', 'SmCOL', 'find', 'max', 'audio-file-input', 'musicFeed', 'gShCo', 'QXOPr', 'DToiY', '我错了', 'http://sharkpan.xyz/f/ljNUx/aw6udx.jpg', 'dpsgb', '生成动态时发生错误:\x20', '\x20/\x20', 'EaRwE', '\x0a\x0a#\x20核心群聊世界观设定\x20(所有角色必须严格遵守以下设定)\x0a', 'Gemini\x20API\x20Error:\x20', 'User\x20cancelled', '逗你开心', 'bkIcU', '[AI发送了表情：', '动态页背景已移除。', 'backgroundSize', 'NJtmQ', 'signal', 'xBRrY', 'friend-circle-list-container', '喝多了', 'OTeTK', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-write-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22\x20style=\x22padding:\x2020px;\x20width:\x2090%;\x20max-width:\x20350px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:\x200;\x20text-align:\x20center;\x20font-weight:\x20600;\x22>写下今天的日记</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22diary-modal-textarea\x22\x20style=\x22width:\x20100%;\x20min-height:\x20150px;\x20margin:\x2010px\x200;\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x2010px;\x20margin-top:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-save\x22\x20class=\x22choice-modal-button\x22\x20style=\x22background-color:\x20var(--primary-color);\x20color:\x20white;\x22>写好了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'Migrating\x20old\x20data\x20structure\x20to\x20new\x20chat-based\x20structure.', 'HxHwL', 'cchWU', 'yHJat', '导出过程中发生严重错误:\x20', 'musicPlaylist', 'usqgr', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22>', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-title\x22>💰\x20', 'sticker-item', 'lt-ui-song-title', 'ZOPeP', 'qGFNY', 'fCNib', '小时前聊过，可以适当问候，不要直接继续之前的话题。', 'yfIHs', 'Group\x20plan\x20failed,\x20falling\x20back\x20to\x20individual\x20generation\x20for\x20each\x20character.', 'toast', 'iCEtl', 'UuWoK', '\x0a---\x0a\x0a#\x20输出要求\x0a直接输出一篇长度适中的日记正文，不要包含任何其他说明或前缀。', 'chnnb', 'cancel-transfer-button', 'qhkmX', 'char_wallpaper_', 'world-book-editor-screen', 'api-key', '\x0a\x20\x20\x20\x20<div\x20id=\x22', 'forEach', '\x0a\x0a#\x20关于群聊参与者“', '</span>:\x20', 'khSrV', 'ggDYW', 'http://sharkpan.xyz/f/8a7tj/sea1z9.jpg', 'post_', '\x0a-\x20**对话状态**:\x20群里在', 'events', 'style-', '在准备API数据时，从IndexedDB读取图片失败:', '创建新角色', '\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#dc3545;\x22>删除这篇日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'MbIiW', 'DcCQA', 'normal,\x20happy,\x20angry,\x20sad,\x20shy', 'string', 'choices', 'MscwA', 'padding', 'audio-player', '\x0a\x0a#\x20用户的动态\x0a', '正在生成中，请稍候...', 'friend-circle-edit-name', 'match', '猫猫撒娇', '无法读取状态，浏览器可能禁用了存储功能。', 'message-action-backdrop', 'chat-screen', 'DrKew', '很好哦', 'user-avatar-input', 'memberCharacterIds', '-\x20[动态]\x20', '获取模型失败:\x20', 'yRZzk', 'TFPuT', '\x20行格式不对，被我无视了。', 'characterEdit', '歌曲名称', 'KEANG', 'toBlob', 'user-profile-list-container', 'home-date', 'worldBooks', 'left', 'result', 'group-clear-history', 'editing-friend-circle-id', '在好友圈\x20\x22', 'cancel-listen-together', 'char_', 'activeDiaryCharacterId', '角色“', 'lIzfd', 'sticker-content', 'url(\x27', 'music-post', 'WzQSU', 'letFW', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'values', 'dialogue', 'app-world-book', '\x20(分享了歌曲:\x20', 'phone-container', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'bHNwJ', 'backgroundImage', 'USFtM', 'put', 'PEvwg', 'back-to-home-from-wallpaper', '.custom-multiselect\x20.select-box', 'xXnyZ', 'http://sharkpan.xyz/f/B4DCa/u86hk2.jpg', 'EGUnG', '群聊\x20(', 'form-button\x20load-more-btn', 'wajkE', 'IYfaE', 'JNjJQ', 'vsXuG', 'cancel', 'Failed\x20to\x20remove\x20corrupted\x20history\x20from\x20localStorage:', '#group-settings-screen\x20.select-box', '请严格按照以下SCHEMA返回一个JSON对象，不要包含任何额外文字。\x0aSCHEMA:\x0a', 'confirm-music-input', '该角色', 'TeHGn', '.bubble-', 'KjEPb', 'IDfdr', '.message.user', '测试动态已添加！', 'YWxMM', 'app-music', 'closest', 'init', 'QAzTh', 'xCGjp', '搜索失败:\x20', 'NiseA', 'Failed\x20to\x20read\x20state\x20from\x20localStorage:', 'LHvXP', '<div\x20class=\x22loader-spinner\x22></div><span>', '的个人专属世界观设定\x0a', 'quote-message-button', 'VTGvO', 'lMPPS', 'xOKPZ', 'toggle', 'group-avatar-input', 'group-chat-create-screen', 'api-endpoint', 'TBJhD', '新用户\x20', 'user-name', '请根据以上所有规则（特别是要看图！），生成对用户动态的回应。', '角色已保存！', '#meeting-view-screen\x20.chat-input-area', '#diary-action-reroll', 'AIEFv', '2023-06-01', 'model', 'Yylbj', 'add-friend-circle-button', 'musicWidgetPosition', 'iALIW', 'ieGlJ', 'delete-user-profile-button', 'http://sharkpan.xyz/f/mjeIW/9vf8ws.jpg', '”面对面交流。你的回复必须是【视觉小说剧本】格式。\x0a\x20\x20-\x20**输出格式**:\x20你的回复**必须**是一个完整的、语法正确的JSON数组。每一个数组元素都是一个对象，代表一句台词或旁白，结构如下:\x0a\x20\x20\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x22speaker\x22:\x20\x22角色名或narrator\x22,\x0a\x20\x20\x20\x20\x22emotion\x22:\x20\x22从[', 'kQIHr', 'editing-user-id', '好友圈档案柜是空的，无需净化。', 'sender_id', 'AI返回的不是一个数组。', 'transfer', '\x0a---\x0a##\x20最近的日记内容\x0a', 'mGOjM', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-', 'User', ']\x20[sticker:', 'kycGb', 'sHwAW', '回复\x20', 'QEpeQ', 'likes', '\x20个模型。', 'viMoI', 'activeChatId', '[图片]', 'PoDbV', '检测到旧版聊天数据，为了优化体验和存储空间，需要进行一次自动升级。过程很快，请稍候。', '欢迎！请先创建一个角色开始聊天。', '|||CMD|||', 'download', 'https://i.pinimg.com/736x/16/f9/05/16f9051f99471208ee9c658aa4618eb6.jpg', 'isOffline', '2214GemrWB', '”吗？此操作不可撤销。', 'world-book-editor-title', '#diary-action-delete', 'indexedDBMusicData', 'Failed\x20to\x20parse\x20state\x20from\x20localStorage,\x20resetting.', 'offline-scene-view', '至少要保留一个用户。', 'onloadend', 'apiSettings', '获取AI响应失败:', 'addEventListener', '真是的，必需的祭品都还没准备好！', 'iELML', '”已创建！', '\x20说：“', 'api-model', 'TvLny', 'ETvDt', 'https://api.vkeys.cn/v2/music/', 'reset-widget-bg-button', 'toLowerCase', 'chat-image-button', 'toggle-meeting-view-button', 'gonis', 'badge-input', 'WXjZl', 'igNnt', 'display', ';\x22>', '\x20条动态...', 'center', '<button\x20id=\x22diary-action-reroll\x22\x20class=\x22choice-modal-button\x22>重写</button>', 'meeting-message-input', '\x22\x20accept=\x22image/*\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x22\x20onclick=\x22document.getElementById(\x27input_', 'back-to-circle-list-from-feed', '已设为当前用户！', 'borderBottom', 'cnbJD', 'displayedMessageCount', '5px', '星期三', 'fmnqk', 'isGenerating', 'JKiAg', 'PUiaO', 'Canvas\x20to\x20Blob\x20conversion\x20failed.', 'cvdsr', 'uRfgy', 'clockPosition', 'back-to-home-from-world-book', 'chat-get-reply-button', '生成失败:\x20', 'dZguJ', 'recipientId', 'VupGv', 'http://sharkpan.xyz/f/25ACQ/gpzab6.jpg', 'KEbal', 'jIRvX', 'vkXqS', 'upload-feed-bg-button', 'VOWwU', 'jPbHn', ']\x20这五个词中选择一个。例如，如果台词表达了哀伤或失望，就必须选择\x20\x27sad\x27。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。\x0a\x20\x20\x20\x20\x20-\x20\x27normal\x27:\x20平常、平静、没有特殊情绪。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27happy\x27:\x20开心、喜悦、愉快。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27angry\x27:\x20生气、愤怒、不满。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27sad\x27:\x20悲伤、哀愁、失落、心里难受。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27shy\x27:\x20害羞、不好意思、脸红。\x0a\x20\x20\x20\x203.\x20\x20`line`字段：具体的台词或描写。\x0a\x20\x20-\x20**绝对禁止**:\x20严禁输出任何JSON数组之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a\x20\x20\x20\x204.\x20旁白的内容可以尽可能多，以轻小说的风格，尽可能像一本小书一样，补全周边环境，角色内心的看法，角色的行为等一切。\x0a\x20\x20\x20\x20', 'lyrics', 'http://sharkpan.xyz/f/LZwu7/m7vx2q.jpg', 'characterLastScripts', 'noir-author-mark', 'Imdnm', 'modal-root', 'appIconPosition_app-settings', 'preferences', 'group-avatar-preview', '找不到要清空的聊天记录。', 'gemini', 'sUYlx', 'private', 'ZdwAg', '生成动态回复失败:', 'is-exiting-left', 'FzZPo', '\x20页</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-next-button\x22>下一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', '对方正在行动中...', 'Ombjc', 'indexedDBData', 'card-widget', 'toLocaleString', 'crFhT', '点击选择\x20info.txt', 'createObjectURL', '\x0a#\x20核心任务\x0a你是一个高度智能的档案管理员，任务是为我（用户，名为“{userName}”）和角色“{charName}”之间的私聊记录生成一份简洁、结构化的长期记忆摘要。\x0a\x0a#\x20摘要规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本。严禁包含任何\x20JSON、Markdown\x20或其他解释性文字。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`memory_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以日期（`YYYY-MM-DD`）作为键。\x0a\x20\x20\x20\x20-\x20每个日期下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**精简**:\x20忽略日常问候、无意义的闲聊和重复内容。\x0a\x20\x20\x20\x20-\x20**聚焦**:\x20专注于关键信息、情感转折点、重要决定、分享的秘密、设定的约定、以及能够体现角色性格和关系变化的核心事件。\x0a\x20\x20\x20\x20-\x20**中立视角**:\x20以客观的第三人称视角进行记录。**请直接使用“{userName}”和“{charName}”这两个具体的名字**\x20来指代双方。\x0a\x0a#\x20输出示例\x0amemory_summary:\x0a\x20\x202025-09-12:\x0a\x20\x20\x20\x20-\x20\x22userName}\x20表达了对最近工作压力的烦恼。\x22\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20分享了自己过去类似的经历来安慰\x20{userName}，并提议周末一起去看电影。\x22\x0a\x20\x20\x20\x20-\x20\x22双方约定周六下午在市中心的电影院见面，并确定观看电影《夏日终曲》。\x22\x0a\x20\x202025-09-13:\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20发来一张猫咪的图片，心情看起来不错。\x22\x0a\x20\x20\x20\x20-\x20\x22{userName}\x20讨论了关于一个新项目的想法，{charName}\x20给出了一些关键建议。\x22\x0a\x0a#\x20输入格式\x0a我将为你提供完整的聊天记录，格式如下：\x0a[YYYY-MM-DD\x20HH:MM]\x20[说话人]:\x20聊天内容\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的聊天记录全文，并生成一份\x20YAML\x20格式的摘要。直接从\x20`memory_summary:`\x20开始输出。\x0a', '保存徽章状态失败', 'FfDrM', 'aLrEr', 'UXUPI', 'listen-together-modal', '错误：找不到这首作为“信物”的歌。', 'onload', '错误：找不到签署契约的地方。', 'length', 'clear', '\x0a你只扮演【', 'back-to-diary-list', 'open', 'Ggggq', 'AbortError', 'meeting-char-name-header', 'stringify', 'high', 'DVEAn', '\x20|\x20', 'BOowo', 'classList', '昨天\x20', 'bhZUQ', 'global-player-play-pause-btn', 'now', 'historyIndex', '确定要清空好友圈“', 'songId', 'themeHue', 'OsCvB', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'preventDefault', 'localeCompare', 'fUUno', 'onupgradeneeded', '(想转账给“', 'message-container', 'isAnimatingDiary', '被萌到', '\x20时出错:', 'VHvcr', 'charSelect', 'data:image', 'QJgTP', 'chat-sticker-button', 'back-to-home-from-settings', 'anthropic', '总结失败:', 'slULO', 'setDate', '”已删除。', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的音乐库还是空的，没法邀请别人一起听。</p>', '薄荷水色', 'music-input-artist', '<div\x20class=\x22post-comments-container\x22>', 'cfwIU', '上传失败了，笨蛋！\x20', 'RKWem', '导出已完成，但以下文件因损坏或过大被跳过：\x0a\x0a', 'group-options-modal', '保存壁纸失败:', '/v1/models', 'absolute', 'mqhxQ', 'worldBook', 'ZYIUv', 'http://sharkpan.xyz/f/djjH8/29ejbg.jpg', 'sLnAN', '委屈哭', 'qaSCT', 'altJW', 'createObjectStore', '</div>\x0a\x20\x20\x20\x20', 'DrREd', ':streamGenerateContent?key=', 'Error\x20fetching\x20from\x20', 'cover', 'target', 'canplaythrough', '星期四', 'group-world-book-checkboxes', 'uRyiR', 'tnIij', '\x0a\x20\x20\x20\x20<div\x20class=\x22music-post-song-card\x22\x20data-music-id=\x22', '”；如果是环境或动作描写，就用“narrator”。\x0a\x20\x20\x20\x202.\x20\x20`emotion`字段：**必须**从\x20[', '未命名群聊', 'group-chat-name', 'HIZVs', 'live-preview-style', 'YNiyf', 'auopt', '\x22\x20class=\x22music-share-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'back-to-home-from-circle-list', '正在迁移旧的用户数据...', '新建好友圈', '条目名称和内容都不能为空！', 'QbjZP', 'splice', '#bubble-preview-user', 'http://sharkpan.xyz/f/VGnuY/ptzlf5.jpg', 'Yygef', 'friend-circle-list-screen', 'code', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'akCiZ', 'http://sharkpan.xyz/f/G0dTl/4qad2i.jpg', '#member-select-', 'remark', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>', 'IkLIQ', 'http://sharkpan.xyz/f/ajwtY/x03qxn.gif', '<p\x20class=\x22no-lyrics-placeholder\x22\x20style=\x22opacity:\x201;\x22>暂无歌词</p>', '#diary-action-cancel', '你们已经在“一起听”了。', 'HwUMh', 'FnMvl', 'jIyDF', 'zkcXc', 'DYhbO', '准备调用\x20generateAs...', 'appIconPosition_', 'entries', 'http://sharkpan.xyz/f/z1xc5/iore2n.gif', '好友圈净化完成，正在重新存档...', 'MhISf', 'nXOvc', 'http://sharkpan.xyz/f/ljVCx/b16h2z.jpg', 'EHXsc', 'cancel-action-button', 'AESRB', 'cZXsh', 'uuHrG', 'candidates', 'edit-clear-history-button', 'claude', '10%', 'wXBtt', 'user-post-avatar', 'gCOYr', 'flatMap', '\x0a[歌词结束]\x0a\x0a请根据当前播放的歌词和对话氛围，自然地作出回应。\x0a\x20\x20\x20', 'querySelectorAll', 'reset-desktop-button', '#d1d5db', 'music-widget', '保存失败:\x20', 'transform', 'app-user-profiles', 'add', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20id=\x22input_', 'wQmxS', '啥意思捏', 'fwoAO', 'xFZNi', '复制失败了，哼。', 'speaker-user', 'sIItE', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', '一起听歌', '”的所有动态吗？此操作不可撤销，且AI将不再记得这些内容。', 'music-widget-card', 'name', 'thought', 'LswWg', '”已存入圣殿。', 'anthropic.com', 'chat-message-input', 'posts', 'mFefa', '>>\x20', 'CmMbg', 'getDay', 'feed', '---\x20Noir\x27s\x20Friend\x20Circle\x20Purification\x20Ritual\x20---', 'image/', '哼，只有私聊才能进行总结，群聊那么乱怎么记！', '/v1/chat/completions', '成功获取\x20', 'http://sharkpan.xyz/f/v0qcL/dio7j0.jpg', ']。严禁使用列表之外的任何表情名。\x0a', 'http://sharkpan.xyz/f/Ganul/78iwli.jpg', 'fGsJA', '图片处理失败:\x20', '勉强但是好吧', 'user', '\x0a#\x20交换日记摘要\x20(你和\x20', '3FjajiD', 'sCWqK', 'gCVnS', 'back-to-chat-from-group-settings', 'settings', '好友圈\x20', '赞同！渲染效果一级棒！', '好了，请基于以上所有信息，开始写今天的日记吧。', '全量导出失败:', 'BLEjR', 'lOmQS', '我来搞定', 'delete-message-button', 'persona', 'stopPropagation', '\x0a\x0a#\x20', '\x0a\x20\x20相关记忆:\x0a', 'image_url', '好友圈已保存！', 'Bcsst', 'wqnvH', 'user-post-image-button', 'galgame-sprite', 'querySelector', 'ykSsM', 'none', 'chat-listen-together-button', '\x0a\x0a#\x20关于对话者“', 'error', 'zaHEm', 'nisVm', 'diary-modal-cancel', 'HWNcl', '我是女仆', 'IOIKF', 'diyfl', 'OMGOl', '哼，正在净化你那些被污染的好友圈动态...', 'group-bg-input', '编辑好友圈', 'charId', 'mYhrU', 'WJXAR', '成功净化并迁移了\x20', 'toFixed']; _0x3052 = function () { return _0x3d6625; }; return _0x3052(); } function _0xc3368b(_0x40fb42) { const _0x48d037 = _0x28d250; if (!_0x40fb42 || !_0x40fb42[_0x48d037(0x87c)](',')) return _0x40fb42; const _0x3bf9d9 = _0x40fb42[_0x48d037(0x8d5)](',')['map'](_0x577b47 => _0x577b47[_0x48d037(0x42f)]()); return _0x3bf9d9[Math[_0x48d037(0x564)](Math['random']() * _0x3bf9d9[_0x48d037(0x794)])]; } function _0x458a99(_0x2510c8) { return new Promise(_0x485876 => { const _0x4049ed = _0x32ba; if (_0x4049ed(0x432) === _0x4049ed(0x432)) { const _0x8a61b4 = document[_0x4049ed(0x5d9)](_0x4049ed(0x776)), _0x3d9296 = document[_0x4049ed(0x5d9)](_0x4049ed(0x2c7)), _0x5295e6 = document[_0x4049ed(0x5d9)](_0x4049ed(0x8b6)), _0x3de205 = document['getElementById'](_0x4049ed(0x420)), _0x4e29d7 = document[_0x4049ed(0x5d9)](_0x4049ed(0x414)); _0x3d9296[_0x4049ed(0x41a)] = _0x2510c8, _0x8a61b4[_0x4049ed(0x3fc)][_0x4049ed(0x74d)] = 'flex'; const _0x102cff = _0x346ace => { const _0x3a5127 = _0x4049ed; _0x8a61b4[_0x3a5127(0x3fc)][_0x3a5127(0x74d)] = _0x3a5127(0x860), _0x5295e6[_0x3a5127(0x878)] = _0x3de205[_0x3a5127(0x878)] = _0x4e29d7['onclick'] = null, document[_0x3a5127(0x2d3)](_0x3a5127(0x23e), _0x14dce5), _0x485876(_0x346ace); }, _0x14dce5 = _0xd6b2ca => { const _0x5b6c89 = _0x4049ed; if ('nOHer' !== 'nOHer') _0x245da6(), _0x514ffe[_0x5b6c89(0x3b6)] = [], _0x284ad8(); else { if (_0xd6b2ca[_0x5b6c89(0x4de)] === _0x5b6c89(0x46b)) _0x102cff(![]); if (_0xd6b2ca['key'] === _0x5b6c89(0x47d)) _0x102cff(!![]); } }; _0x5295e6[_0x4049ed(0x878)] = () => _0x102cff(!![]), _0x3de205[_0x4049ed(0x878)] = () => _0x102cff(![]), _0x4e29d7[_0x4049ed(0x878)] = () => _0x102cff(![]), document[_0x4049ed(0x73c)]('keydown', _0x14dce5); } else { if (_0x5ee70[_0x4049ed(0x88d)]['includes'](_0x1de3e1[_0x4049ed(0x5a5)])) _0x4032c3[_0x4049ed(0x27f)] = !![]; } }); } function _0x13197e(_0x5a8433) { const _0x5d9b4a = _0x28d250, _0x2cccdb = document[_0x5d9b4a(0x5d9)](_0x5d9b4a(0x686)); _0x2cccdb[_0x5d9b4a(0x41a)] = _0x5a8433, _0x2cccdb[_0x5d9b4a(0x3fc)][_0x5d9b4a(0x74d)] = _0x5d9b4a(0x38f); if (_0x13197e['_t']) clearTimeout(_0x13197e['_t']); _0x13197e['_t'] = setTimeout(() => { const _0x24cad9 = _0x5d9b4a; _0x2cccdb[_0x24cad9(0x3fc)][_0x24cad9(0x74d)] = _0x24cad9(0x860); }, 0x640); } function _0x2391b8() { return new Promise(_0x586d44 => { const _0x1ca11e = _0x32ba, _0x4d4f6c = document[_0x1ca11e(0x5d9)]('music-input-modal'), _0x45e47c = document[_0x1ca11e(0x5d9)](_0x1ca11e(0x600)), _0x3623d9 = document[_0x1ca11e(0x5d9)](_0x1ca11e(0x7c2)), _0x1cc9b8 = document['getElementById'](_0x1ca11e(0x6e8)), _0x3718c3 = document[_0x1ca11e(0x5d9)]('cancel-music-input'), _0x35e470 = document[_0x1ca11e(0x5d9)]('music-input-backdrop'); _0x45e47c[_0x1ca11e(0x5a5)] = '', _0x3623d9[_0x1ca11e(0x5a5)] = '', _0x4d4f6c[_0x1ca11e(0x7a1)][_0x1ca11e(0x821)]('show'), _0x45e47c[_0x1ca11e(0x3d2)](); const _0x34a50b = _0x4cc846 => { const _0x242750 = _0x1ca11e; _0x4d4f6c[_0x242750(0x7a1)]['remove'](_0x242750(0x274)), _0x1cc9b8[_0x242750(0x878)] = null, _0x3718c3[_0x242750(0x878)] = null, _0x35e470[_0x242750(0x878)] = null, document[_0x242750(0x2d3)]('keydown', _0x309a30), _0x586d44(_0x4cc846); }, _0x2dfe9a = () => { const _0x6584b8 = _0x1ca11e; if ('IInIz' !== 'IInIz') _0x928953[_0x6584b8(0x863)]('保存角色失败:', _0x3fca6d), _0x371bb5(_0x6584b8(0x81e) + _0x339bc3[_0x6584b8(0x1a4)]); else { const _0x103ed7 = _0x45e47c[_0x6584b8(0x5a5)][_0x6584b8(0x42f)](), _0x3735ed = _0x3623d9[_0x6584b8(0x5a5)]['trim'](); if (!_0x103ed7 || !_0x3735ed) { if (_0x6584b8(0x5aa) === _0x6584b8(0x6e3)) _0x4e52c2 = _0x6584b8(0x495) + _0x57ce28[_0x6584b8(0x82e)] + _0x6584b8(0x5cc); else { _0x13197e(_0x6584b8(0x338)); return; } } _0x34a50b({ 'songName': _0x103ed7, 'artist': _0x3735ed }); } }, _0x309a30 = _0x77f79d => { const _0x56c14d = _0x1ca11e; if ('UInNM' !== _0x56c14d(0x19f)) { _0x255a7c[_0x56c14d(0x24a)] = _0x337067[_0x56c14d(0x24a)][_0x56c14d(0x25b)](_0x771d26 => _0x771d26['id'] !== _0x1561b4), _0x5842a8[_0x56c14d(0x1ce)][_0x56c14d(0x691)](_0x345c69 => { const _0x257dc = _0x56c14d; _0x345c69[_0x257dc(0x443)] === 'group' && (_0x345c69[_0x257dc(0x594)] = _0x345c69[_0x257dc(0x594)][_0x257dc(0x25b)](_0x305ff7 => _0x305ff7 !== _0x48dcc6)); }); const _0xc22cbf = _0x34e38c[_0x56c14d(0x1ce)]['find'](_0x3a1481 => _0x3a1481['type'] === 'private' && _0x3a1481[_0x56c14d(0x594)][_0x56c14d(0x87c)](_0x29f735)); _0xc22cbf && _0x22f7e5(_0xc22cbf['id']), _0x7317f0[_0x56c14d(0x1ce)] = _0x11ca17[_0x56c14d(0x1ce)][_0x56c14d(0x25b)](_0x4b61bb => _0x4b61bb[_0x56c14d(0x443)] !== 'group' || _0x4b61bb[_0x56c14d(0x594)][_0x56c14d(0x794)] > 0x1), _0x2d1851(), _0x646c44(); } else { if (_0x77f79d[_0x56c14d(0x4de)] === _0x56c14d(0x46b)) _0x34a50b(null); _0x77f79d[_0x56c14d(0x4de)] === _0x56c14d(0x47d) && (_0x77f79d['preventDefault'](), _0x2dfe9a()); } }; _0x1cc9b8[_0x1ca11e(0x878)] = _0x2dfe9a, _0x3718c3[_0x1ca11e(0x878)] = () => _0x34a50b(null), _0x35e470[_0x1ca11e(0x878)] = () => _0x34a50b(null), document['addEventListener'](_0x1ca11e(0x23e), _0x309a30); }); } function _0x3b869f(_0xacc05a) { const _0x94727 = _0x28d250; if (!_0xacc05a) return []; const _0x25dc0f = /(\[sticker:[^\]]+\]|\[music:[^\]]+\]|\[transfer:[^\]]+\])/g, _0x2089a8 = _0x94727(0x72d), _0x2c2767 = [], _0xb331da = _0xacc05a[_0x94727(0x41f)](_0x25dc0f, _0x110c75 => { const _0x6da462 = _0x94727; if (_0x6da462(0x199) === 'VbcTq') return _0x2c2767[_0x6da462(0x43f)](_0x110c75), _0x2089a8; else { _0x2d5467 = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x57b580 in _0x41fd59) { _0x481563[_0x57b580][_0x6da462(0x7a1)][_0x6da462(0x8a2)]('filled'), _0x1a32ec[_0x57b580][_0x6da462(0x5a5)] = ''; } _0xd792a0[_0x6da462(0x5ee)]['querySelector'](_0x6da462(0x568))['textContent'] = _0x6da462(0x35e), _0x34dce6[_0x6da462(0x7d9)][_0x6da462(0x85e)]('.slot-filename')[_0x6da462(0x41a)] = '点击选择\x20.jpg\x20或\x20.png', _0x570a67[_0x6da462(0x29d)]['querySelector'](_0x6da462(0x568))[_0x6da462(0x41a)] = _0x6da462(0x789), _0x461960[_0x6da462(0x771)][_0x6da462(0x85e)](_0x6da462(0x568))['textContent'] = '点击选择\x20.lrc', _0x186a47(); } }), _0x5cd038 = _0xb331da[_0x94727(0x8d5)](_0x2089a8), _0x4a007e = []; let _0x91e733 = 0x0; return _0x5cd038[_0x94727(0x691)]((_0x14064d, _0x32d7f8) => { const _0x57f654 = _0x94727, _0x4adc0d = _0x14064d[_0x57f654(0x42f)](); _0x4adc0d && _0x4a007e[_0x57f654(0x43f)](..._0x714da(_0x4adc0d)), _0x91e733 < _0x2c2767[_0x57f654(0x794)] && (_0x57f654(0x1e3) === _0x57f654(0x1e3) ? (_0x4a007e[_0x57f654(0x43f)](_0x2c2767[_0x91e733][_0x57f654(0x42f)]()), _0x91e733++) : (_0x4efc6d[_0x57f654(0x384)](_0x57f654(0x675)), _0xdc0aff[_0x57f654(0x1ce)] = _0x293102['characters'][_0x57f654(0x2ac)](_0x5dc1c0 => ({ 'id': 'chat_' + _0x5dc1c0['id'], 'type': _0x57f654(0x77d), 'participantIds': [_0x5dc1c0['id']] })), _0x15d326[_0x57f654(0x244)] && (_0x2d07c9[_0x57f654(0x728)] = _0x57f654(0x2e7) + _0xdfecd8[_0x57f654(0x244)]), _0x14bda3[_0x57f654(0x24a)][_0x57f654(0x691)](_0xf2db4f => { const _0x1f79c1 = _0x57f654, _0x14e38f = _0x1f79c1(0x555) + _0xf2db4f['id'], _0x1a8baa = 'chatHistory_chat_' + _0xf2db4f['id'], _0x5638a6 = _0x3f332d[_0x1f79c1(0x24e)](_0x14e38f); _0x5638a6 && (_0x5350f9['setItem'](_0x1a8baa, _0x5638a6), _0x553d7a[_0x1f79c1(0x5b3)](_0x14e38f)); }))); }), _0x4a007e; } function _0xb2dcd0(_0xeb935a) { const _0x5e483f = _0x28d250; if (!_0xeb935a) return []; let _0xbfed66 = String(_0xeb935a)[_0x5e483f(0x42f)](); const _0x1dc201 = _0xbfed66[_0x5e483f(0x6a9)](/```(?:json)?([\s\S]*?)```/i); if (_0x1dc201) _0xbfed66 = _0x1dc201[0x1][_0x5e483f(0x42f)](); try { const _0x442cdf = JSON[_0x5e483f(0x5b7)](_0xbfed66); if (_0x442cdf && Array[_0x5e483f(0x1ab)](_0x442cdf[_0x5e483f(0x5bd)])) return _0x442cdf[_0x5e483f(0x5bd)][_0x5e483f(0x2ac)](_0x1a8fc4 => typeof _0x1a8fc4 === 'string' ? _0x1a8fc4 : _0x1a8fc4?.[_0x5e483f(0x283)])['filter'](Boolean)[_0x5e483f(0x818)](_0x714da); const _0x18eef4 = [_0x5e483f(0x611), _0x5e483f(0x6cf), _0x5e483f(0x1a4), _0x5e483f(0x224), _0x5e483f(0x283), _0x5e483f(0x475), _0x5e483f(0x36a)]; if (_0x442cdf && typeof _0x442cdf === 'object') { if ('ijjWw' === _0x5e483f(0x76e)) { const _0x3b4a73 = _0x5f371b[_0x5e483f(0x798)](_0xe5b5e7, 0x2); _0x3b4a73[_0x5e483f(0x618)] = () => _0x52bf24(_0x5e483f(0x4f7)), _0x3b4a73['onsuccess'] = () => _0x41dc9e(_0x3b4a73[_0x5e483f(0x6bf)]), _0x3b4a73['onupgradeneeded'] = _0x5b1cb4 => { const _0x4ff192 = _0x5e483f, _0x1a623d = _0x5b1cb4[_0x4ff192(0x7da)][_0x4ff192(0x6bf)]; !_0x1a623d[_0x4ff192(0x5ab)][_0x4ff192(0x153)](_0x4dfda4) && _0x1a623d[_0x4ff192(0x7d4)](_0x4f3de6, { 'keyPath': 'id' }), !_0x1a623d[_0x4ff192(0x5ab)][_0x4ff192(0x153)]('music_library') && _0x1a623d['createObjectStore'](_0x4ff192(0x486), { 'keyPath': 'id' }); }; } else { const _0x4ebf3e = []; for (const _0x3e2a45 of Object['keys'](_0x442cdf)) { if (_0x5e483f(0x3c4) !== _0x5e483f(0x3c4)) { const _0x3841ca = _0x44ac73[_0x5e483f(0x24e)](_0x5e483f(0x3e4)); if (_0x3841ca) { const { playlist: _0x525850, currentIndex: _0x1e31ad } = _0x4ef5fc['parse'](_0x3841ca); _0x1cb3dc[_0x5e483f(0x1ab)](_0x525850) && _0x525850[_0x5e483f(0x794)] > 0x0 && _0x1e31ad > -0x1 && (_0x132167['musicPlaylist'] = _0x525850, _0x326e59['currentlyPlayingIndex'] = _0x1e31ad, _0x23a09b['isPlaying'] = ![], _0x3f3a46()); } } else { const _0x4783b9 = _0x3e2a45[_0x5e483f(0x746)](); if (_0x18eef4['some'](_0x2617e3 => _0x4783b9[_0x5e483f(0x380)](_0x2617e3))) { const _0x3e52a0 = _0x442cdf[_0x3e2a45]; if (typeof _0x3e52a0 === _0x5e483f(0x6a1)) _0x4ebf3e[_0x5e483f(0x43f)](_0x3e52a0); if (Array[_0x5e483f(0x1ab)](_0x3e52a0)) _0x3e52a0[_0x5e483f(0x691)](_0x3e864f => { const _0x4a788b = _0x5e483f; if (typeof _0x3e864f === 'string') _0x4ebf3e[_0x4a788b(0x43f)](_0x3e864f); }); } } } if (_0x4ebf3e[_0x5e483f(0x794)]) return _0x4ebf3e[_0x5e483f(0x818)](_0x714da)[_0x5e483f(0x60e)](0x0, 0x9); } } } catch { } if (/[{\[]/[_0x5e483f(0x534)](_0xbfed66) && /":/[_0x5e483f(0x534)](_0xbfed66)) { const _0x1495c6 = [], _0x39b467 = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0x4b039e; while ((_0x4b039e = _0x39b467[_0x5e483f(0x5ef)](_0xbfed66)) !== null) { if (_0x5e483f(0x89b) !== _0x5e483f(0x89d)) { const _0x2c5fec = _0x4b039e[0x1][_0x5e483f(0x41f)](/\\"/g, '\x22')['replace'](/\\n/g, '\x0a')['trim'](); if (_0x2c5fec) _0x1495c6['push'](_0x2c5fec); } else _0x566069(), _0x27c446(!![]); } if (_0x1495c6[_0x5e483f(0x794)]) return _0x1495c6['flatMap'](_0x714da)[_0x5e483f(0x60e)](0x0, 0x9); } return _0x714da(_0xbfed66); } function _0x714da(_0x545522) { const _0x457a52 = _0x28d250; if (!_0x545522) return []; const _0x3ffc21 = String(_0x545522)[_0x457a52(0x42f)](), _0x3dd6da = _0x3ffc21[_0x457a52(0x8d5)](/(?<=[。！？!?…])\s+|[\r\n]+/)[_0x457a52(0x2ac)](_0x23c9d3 => _0x23c9d3[_0x457a52(0x42f)]())[_0x457a52(0x25b)](Boolean); if (_0x3dd6da['length'] > 0x0) return _0x3dd6da['slice'](0x0, 0x9); return [_0x3ffc21][_0x457a52(0x25b)](Boolean); } const _0x47cd61 = _0x28d250(0x16e), _0x39b1d8 = _0x28d250(0x33a), _0x3a23c1 = new Promise((_0x34694b, _0x3051cb) => { const _0x8e5831 = _0x28d250, _0x160ca0 = indexedDB[_0x8e5831(0x798)](_0x47cd61, 0x2); _0x160ca0[_0x8e5831(0x618)] = () => _0x3051cb(_0x8e5831(0x4f7)), _0x160ca0[_0x8e5831(0x21f)] = () => _0x34694b(_0x160ca0[_0x8e5831(0x6bf)]), _0x160ca0[_0x8e5831(0x7af)] = _0x1c46f0 => { const _0x34acf1 = _0x8e5831, _0x575503 = _0x1c46f0['target'][_0x34acf1(0x6bf)]; !_0x575503[_0x34acf1(0x5ab)][_0x34acf1(0x153)](_0x39b1d8) && _0x575503[_0x34acf1(0x7d4)](_0x39b1d8, { 'keyPath': 'id' }); const _0x3d07c9 = _0x34acf1(0x486); if (!_0x575503[_0x34acf1(0x5ab)]['contains'](_0x3d07c9)) { if (_0x34acf1(0x655) !== _0x34acf1(0x51c)) _0x575503[_0x34acf1(0x7d4)](_0x3d07c9, { 'keyPath': 'id' }); else { const _0x5d6604 = 'chatHistory_' + _0x44b187['id'], _0x550a65 = _0x34acf1(0x400) + _0x8bb6ee['id'], _0x1554f3 = _0x5468be[_0x34acf1(0x24e)](_0x5d6604); _0x1554f3 && (_0x272b98[_0x34acf1(0x3cd)](_0x550a65, _0x1554f3), _0x48117e[_0x34acf1(0x5b3)](_0x5d6604)); } } }; }); async function _0x2eb454(_0x1ccbc7) { const _0x2c761a = await _0x3a23c1; return new Promise((_0x2c9280, _0xef1ed4) => { const _0x16d60f = _0x32ba; if (_0x16d60f(0x1e8) !== _0x16d60f(0x539)) { const _0x1e47a5 = _0x2c761a[_0x16d60f(0x52f)](_0x39b1d8, _0x16d60f(0x605)), _0x39a696 = _0x1e47a5[_0x16d60f(0x4ed)](_0x39b1d8), _0x3ffcfc = _0x39a696[_0x16d60f(0x5bc)](_0x1ccbc7); _0x3ffcfc[_0x16d60f(0x21f)] = () => _0x2c9280(_0x3ffcfc[_0x16d60f(0x6bf)] ? _0x3ffcfc[_0x16d60f(0x6bf)][_0x16d60f(0x2b5)] : null), _0x3ffcfc[_0x16d60f(0x618)] = () => _0xef1ed4(_0x3ffcfc[_0x16d60f(0x863)]); } else _0x499a36[_0xdfb9df][_0x16d60f(0x7a1)][_0x16d60f(0x8a2)](_0x16d60f(0x460)), _0x1502e5[_0x2d7113]['value'] = ''; }); } async function _0x1c943a(_0x38b5c2, _0xcef9bc) { const _0x94d534 = await _0x3a23c1; return new Promise((_0x34f5bc, _0x246647) => { const _0x269db4 = _0x32ba; if ('WGkai' === 'WGkai') { const _0x1235ac = _0x94d534['transaction'](_0x39b1d8, _0x269db4(0x15d)), _0x154ad2 = _0x1235ac[_0x269db4(0x4ed)](_0x39b1d8), _0x493b40 = _0x154ad2[_0x269db4(0x6d7)]({ 'id': _0x38b5c2, 'blob': _0xcef9bc }); _0x493b40[_0x269db4(0x21f)] = () => _0x34f5bc(_0x493b40['result']), _0x493b40[_0x269db4(0x618)] = () => _0x246647(_0x493b40['error']); } else { if (_0xf20818) { const _0x2b3013 = _0x2a72be[_0x269db4(0x78a)](_0x49da6a); _0x35639d['src'] = _0x2b3013, _0x2e8a34[_0x269db4(0x792)] = () => { const _0x5e853b = _0x269db4; _0x5aaa22[_0x5e853b(0x3d1)](_0x2b3013); }; } else _0x222283[_0x269db4(0x2d2)] = _0x269db4(0x254); } }); } async function _0x402038(_0x3e8cce) { const _0x467136 = await _0x3a23c1; return new Promise((_0x1081b1, _0x54d966) => { const _0x3695a6 = _0x32ba, _0x108825 = _0x467136[_0x3695a6(0x52f)](_0x39b1d8, 'readwrite'), _0x4fa18f = _0x108825[_0x3695a6(0x4ed)](_0x39b1d8), _0x213760 = _0x4fa18f['delete'](_0x3e8cce); _0x213760[_0x3695a6(0x21f)] = () => _0x1081b1(), _0x213760[_0x3695a6(0x618)] = () => _0x54d966(_0x213760[_0x3695a6(0x863)]); }); } function _0x4ee7e6(_0xdac345) { const _0x1f82f7 = _0x28d250; return fetch(_0xdac345)[_0x1f82f7(0x2b1)](_0x5d9534 => _0x5d9534[_0x1f82f7(0x2b5)]()); }
  </script>
  <div id="listen-together-ui" style="display: none;">
    <div class="lt-ui-backdrop"></div>
    <div class="lt-ui-main">
      <div class="lt-ui-header">
        <span id="lt-ui-header-title">正在与 TA 一起听</span>
        <button id="lt-ui-close-btn">×</button>
      </div>
      <div class="lt-ui-content">
        <div class="lt-ui-cover-container">
          <img id="lt-ui-cover-art" src="">
        </div>
        <div class="lt-ui-info">
          <h2 id="lt-ui-song-title">歌曲名称</h2>
          <p id="lt-ui-song-artist">歌手</p>
        </div>
        <div id="lt-ui-lyrics-container">
          <p class="no-lyrics-placeholder">暂无歌词</p>
        </div>
      </div>
    </div>
  </div>
  <div id="summarize-modal" class="choice-modal">
    <div id="summarize-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <button id="close-summary-button" class="header-button" style="min-width: 50px;">关闭</button>
        <span class="header-title">聊天记录总结</span>
        <button id="copy-summary-button" class="header-button" style="min-width: 50px;">复制</button>
      </div>
      <div class="content" style="flex-grow: 1; padding: 0;">
        <textarea id="summary-textarea" placeholder="AI正在拼命总结中，别催..."></textarea>
      </div>
    </div>
  </div>
</body>

</html>